(function(){var G={lib:{}},D=function(q,a,c){q.attachEvent?q.attachEvent("on"+a,c):q.addEventListener(a,c,!1)},gb=function(){var q={locationChange:[],beforeLocationChange:[]},a=!1,c=/(?:(\w+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/,b=!!history.pushState,d="onhashchange"in window,e=function(a){var d=location.protocol+"//"+location.hostname;location.port&&(d+=":"+location.port);a=a.replace(d,"");b||(a=encodeURIComponent(a));return a},f=function(a){a=(""+
a).match(c);var d,e;b||(e=a[6],"!"==e.substr(0,1)&&(d=e.substr(1)));d||(d=a[4],a[5]&&(d+="?"+a[5]));return d},g=function(){var a;b?a=location.pathname+location.search:(a=location.hash.substr(1))?("!"==a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a)):a=location.pathname+location.search;return a},l=function(b,a,d){d=d||g();for(var c,e=-1,f=q[b].length;++e<f;)if(c=q[b][e].call(null,d),a&&!1===c)return!1;return G.trigger(b,d)};D(window,"load",function(){a=!0});history.initPushState=function(){if(b)history.origPushState=
history.pushState,history.origReplaceState=history.replaceState,D(window,"popstate",function(){l("locationChange")}),history.pushState=function(b,a,d){if(!1===l("beforeLocationChange",!0,d))return!1;history.origPushState(b,a,e(d));l("locationChange")},history.replaceState=function(b,a,d){if(!1===l("beforeLocationChange",!0,d))return!1;history.origReplaceState(b,a,e(d));l("locationChange")};else if(d)history.replaceState=history.pushState=function(b,a,d){if(!1===l("beforeLocationChange",!0,d))return!1;
b=e(d);location.hash=b?"!"+b:""},D(window,"hashchange",function(){l("locationChange")});else{var g=null,r=!1;window.onIframeHistoryChange=function(b){r||(location.hash=b?"!"+b:"",l("locationChange"))};var E=function(b){var a=g.contentWindow.document;a.open();a.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+b+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');a.close()};history.pushState=function(b,a,
d){if(!1===l("beforeLocationChange",!0,d))return!1;E(e(d))};history.replaceState=function(b,a,d){if(!1===l("beforeLocationChange",!0,d))return!1;b=e(d);g.contentWindow.hashValue=b};var x=function(){g=document.createElement("iframe");g.src="about:blank";g.style.display="none";document.body.appendChild(g);r=!0;E(e(location.hash.substr(1)));r=!1};a?x():D(window,"load",x)}D(document.documentElement,"click",function(b){b=b||window.event;for(var a=b.target||b.srcElement,d;a&&"a"!=a.nodeName.toLowerCase();)a=
a.parentNode;if(a){if(a=(d=a.getAttribute("href"))&&"#"!=d.substr(0,1)&&!a.getAttribute("target"))a=d.match(c),a=a[1]&&location.protocol!=a[1]||a[2]&&location.hostname!=a[2]?!1:a[2]||a[3]?location.port==a[3]:!0;if(a&&f(d)!=f(window.location))return history.pushState(null,null,f(d)),b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),!1}return null});history.initPushState=function(){}};history.onBeforeChange=function(b){q.beforeLocationChange.push(b)};history.onChange=function(b){q.locationChange.push(b)};
return{pushUrl:function(b){history.pushState(null,null,b)},replaceUrl:function(b){history.replaceState(null,null,b)},currentUrl:function(){return g()}}}(),hb=gb.currentUrl,xb=gb.pushUrl,F=function(q){return"function"===typeof q},q=function(q){return"string"==typeof q},ga=function(q){return null!=q&&"object"===typeof q},Oa=function(s){s||(s=new Ea);var a=function(b,a){return d(function(){},b,a)},c=function(b,a,d){return function(){var c=void 0,e=this.supr;this.supr=b.prototype[a]||function(){};try{c=
d.apply(this,arguments)}catch(E){}this.supr=e;return c}},b=function(b,a,d){for(var e in a)a.hasOwnProperty(e)&&(b[e]=F(a[e])&&d.prototype&&F(d.prototype[e])?c(d,e,a[e]):a[e])},d=function(a,d,c){var e=function(){};e.prototype=a.prototype;e=new e;c=c||function(){this.initialize&&this.initialize.apply(this,arguments)};b(e,d,a);c.prototype=e;c.prototype.constructor=c;c.prototype.getClass=function(){return this.__proto__.constructor.__class};c.prototype.getParentClass=function(){return this.__proto__.constructor.__parentClass};
c.__instantiate=function(b){return function(){var a=function(){},d;a.prototype=b.prototype;a=new a;d=b.prototype.constructor.apply(a,arguments);return ga(d)?d:a}}(c);return c},e=function(b,c,e,k,r,E){null===b&&(b="");F(b)?(r=e,q(c)?(r=k,k=e):(k=c,e=b,c=null),b=null):q(b)||(r=c,k=b,b=e=c=null);q(c)||F(c)||(r=k,k=e,e=c,c=null);F(e)||(r=k,k=e,e=null);k=k||{};var x=c&&q(c)?s.get(c):c;if(c&&!x)throw Error(c+" not found");c=x?d(x,k,e):a(k,e);c.__isMetaphorClass=!0;c.__parent=x;c.__parentClass=x?x.__class:
null;c.__class=s;if(r)for(var y in r)r.hasOwnProperty(y)&&(c[y]=r[y]);b&&(E?s.add(b,c):s.register(b,c));r&&r.alias&&s.add(r.alias,c);return c};this.factory=function(b){var a=s.get(b),d=ia.call(arguments,1);if(!a)throw Error(b+" not found");return a.__instantiate.apply(this,d)};this.isSubclassOf=function(b,a){var d=b,c=s.get;q(a)||(a=a.getClass?a.getClass():a.prototype.constructor.__class);for(q(b)&&(d=c(b));d;){if(d.prototype.constructor.__class==a)return!0;d&&(d=d.getParentClass?c(d.getParentClass()):
d.__parent)}return!1};this.isInstanceOf=function(b,a){var d=q(a)?s.get(a):a;return d?b instanceof d:!1};this.define=e;this.defineCache=function(b,a,d,c,r){return e(b,a,d,c,r,!0)}};Oa.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,defineCache:null};G.lib.Class=Oa;var z=function(q){return"undefined"==typeof q},Ea=function(q,a){var c={};q||(q=z(global)?window:global);this.register=function(b,d){var e;e=b;var f=e.split("."),g,l=f.pop();g=f.join(".");var k=f.length,r,E=q;if(c[g])e=
[c[g],l,e];else{if(0<k)for(g=0;g<k;g++){r=f[g];if(a&&0==g)if(r==a){E=q;continue}else e=a+"."+e;z(E[r])&&(E[r]={});E=E[r]}else a&&(e=a+"."+e);e=[E,l,e]}f=e[0];l=e[1];ga(f)&&z(f[l])&&(f[l]=d,c[e[2]]=d);return d};this.exists=function(b){return!z(c[b])};this.get=function(b,d){if(!z(c[b]))return c[b];if(a&&!z(c[a+"."+b]))return c[a+"."+b];if(!d){var e=b.split("."),f,g=e.length,l,k=q;for(f=0;f<g;f++)if(l=e[f],a&&0==f&&l==a)k=q;else{if(z(k[l]))return;k=k[l]}k&&(c[b]=k);return k}};this.add=function(b,d){a&&
0!==b.indexOf(a)&&(b=a+"."+b);z(c[b])&&(c[b]=d);return d};this.remove=function(b){delete c[b]}};Ea.prototype={register:null,exists:null,get:null,add:null,remove:null};G.lib.Namespace=Ea;var ja=new Ea(G,"MetaphorJs"),Fa=new Oa(ja),K=Fa.define,B=Function.prototype.bind?function(q,a){return q.bind(a)}:function(q,a){return function(){return q.apply(a,arguments)}},ia=Array.prototype.slice,Aa=function(q){return!(!q||q.constructor!==Object)},ua=function(q){return"boolean"==typeof q},Pa=function(q){return null===
q},s=function a(){var c=!1,b=!1,d=ia.call(arguments),e=d.shift(),f,g,l;ua(d[d.length-1])&&(c=d.pop());ua(d[d.length-1])&&(b=c,c=d.pop());for(;d.length;)if(f=d.shift())for(g in f)if(f.hasOwnProperty(g)&&!z(l=f[g]))if(b)if(e[g]&&Aa(e[g])&&Aa(l))a(e[g],l,c,b);else{if(!0===c||z(e[g])||null===e[g])Aa(l)?(e[g]={},a(e[g],l,c,!0)):e[g]=l}else if(!0===c||z(e[g])||null===e[g])e[g]=l;return e},N=function(){},qa=function(a){var c=document.createDocumentFragment();if(q(a)){var b=document.createElement("div");
b.innerHTML=a;a=b.childNodes}if(a.nodeType)c.appendChild(a);else for(var b=-1,d=a.length>>>0;++b!==d;c.appendChild(a[0]));return c},na=function(){var a=["0","0","0"];return function(){for(var c=a.length,b;c;){c--;b=a[c].charCodeAt(0);if(57==b)return a[c]="A",a.join("");if(90==b)a[c]="0";else return a[c]=String.fromCharCode(b+1),a.join("")}a.unshift("0");return a.join("")}}(),I=function(){var a={};return function(c,b,d){c=c._mjsid||(c._mjsid=na());var e=a[c];if(z(d))return e?e[b]:void 0;e||(e=a[c]=
{});return e[b]=d}}(),Qa=function(){var a={};return function(c){return a[c]||(a[c]=new RegExp(c))}}(),Ba=function(a,c){return c?Qa("(?:^|\\s)"+c+"(?!\\S)").test(a.className):!1},L=function(a,c){c&&!Ba(a,c)&&(a.className+=" "+c)},S=function(a,c){c&&(a.className=a.className.replace(Qa("(?:^|\\s)"+c+"(?!\\S)"),""))},oa=ja.get,Ra=Object.prototype.toString,Ga=function(a){return"number"==typeof a&&!isNaN(a)},M=function(a){return!!(a&&ga(a)&&Ga(a.length)&&"[object Array]"==Ra.call(a))},Ha=function(a){var c,
b,d;if(M(a)){d=[];c=0;for(b=a.length;c<b;c++)d.push(Ha(a[c]));return d}if(a)switch(a.nodeType){case 1:return a.cloneNode(!0);case 3:return document.createTextNode(a.innerText||a.textContent);case 11:return a.cloneNode(!0)}return null},ib=function(){var a=["Moz","Webkit","ms","O","Khtml"],c="animationDelay",b="animationDuration",d="transitionDelay",e="transitionDuration",f=null;(function(){var f=document.createElement("div"),l=!1,k,r,E;if(void 0!==f.style.animationName)l=!0;else for(r=0,E=a.length;r<
E;r++)if(k=a[r],void 0!==f.style[k+"AnimationName"]){l=!0;c=k+"AnimationDelay";b=k+"AnimationDuration";d=k+"TransitionDelay";e=k+"TransitionDuration";break}return l})()&&(f={animationDelay:c,animationDuration:b,transitionDelay:d,transitionDuration:e});return function(){return f}}(),yb=function(){var a=function(b){if(!b)return 0;var a=parseFloat(b);-1==b.indexOf("ms")&&(a*=1E3);return a},c=function(b,d,c){var e,f,g=d.length;for(e=0;e<g;e++)f=a(d[e])+a(c[e]),b=Math.max(f,b);return b},b=ib(),d=b?b.animationDuration:
null,e=b?b.animationDelay:null,f=b?b.transitionDuration:null,g=b?b.transitionDelay:null;return function(a){if(!b)return 0;var k=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var r=(k[d]||"").split(","),E=(k[e]||"").split(","),x=(k[f]||"").split(","),k=(k[g]||"").split(",");a=Math.max(a,c(a,r,E));return a=Math.max(a,c(a,x,k))}}(),ha=function(a){var c;return a&&(ga(a)||F(a))?F(c=a.then)?c:!1:!1},V=function(){var a=[],c=!1,b="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,
0)},d=function(){c=!0;var e=a.shift();b(function(){e[0].apply(e[1],e[2]);a.length?d():c=!1},0)},e=function(b,e,f){f=f||[];a.push([b,e,f]);c||d()},f=function(a,b){return function(d){try{b.resolve(a(d))}catch(c){b.reject(c)}}},g=function(b,a){if(b instanceof g)return b;if(!(this instanceof g))return new g(b,a);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(!z(b))if(ha(b)||!F(b))this.resolve(b);else try{b.call(a,B(this.resolve,this),B(this.reject,this))}catch(d){this.reject(d)}};
g.prototype={_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(b,a){var d;if(0==this._state)if(b===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(d=
ha(b)){b instanceof g?b.then(B(this._processResolveValue,this),B(this._processRejectReason,this)):(new g(d,b)).then(B(this._processResolveValue,this),B(this._processRejectReason,this));return}}catch(c){0==this._state&&this._doReject(c);return}a.call(this,b)}},_callResolveHandlers:function(){this._done();for(var b=this._fulfills,a;a=b.shift();)e(a[0],a[1],[this._value]);this._cleanup()},_doResolve:function(b){this._value=b;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(b){this._processValue(b,
this._doResolve)},resolve:function(b){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(b);return this},_callRejectHandlers:function(){this._fail();for(var b=this._rejects,a;a=b.shift();)e(a[0],a[1],[this._reason]);this._cleanup()},_doReject:function(b){this._state=2;this._reason=b;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(b){this._processValue(b,this._doReject)},reject:function(b){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(b);
return this},then:function(b,a){var d=new g,c=this._state;0==c||0!=this._wait?(b&&F(b)?this._fulfills.push([f(b,d),null]):this._fulfills.push([d.resolve,d]),a&&F(a)?this._rejects.push([f(a,d),null]):this._rejects.push([d.reject,d])):1==c?b&&F(b)?e(f(b,d),null,[this._value]):d.resolve(this._value):2==c&&(a&&F(a)?e(f(a,d),null,[this._reason]):d.reject(this._reason));return d},"catch":function(b){return this.then(null,b)},_done:function(){for(var b=this._dones,a;a=b.shift();)a[0].call(a[1]||null,this._value)},
done:function(b,a){var d=this._state;1==d&&0==this._wait?b.call(a||null,this._value):0==d&&this._dones.push([b,a]);return this},_fail:function(){for(var b=this._fails,a;a=b.shift();)a[0].call(a[1]||null,this._reason)},fail:function(b,a){var d=this._state;2==d&&0==this._wait?b.call(a||null,this._reason):0==d&&this._fails.push([b,a]);return this},always:function(b,a){this.done(b,a);this.fail(b,a);return this},promise:function(){return{then:B(this.then,this),done:B(this.done,this),fail:B(this.fail,this),
always:B(this.always,this)}},after:function(b){var a=this;if(ha(b)){a._wait++;var d=function(){a._wait--;0==a._wait&&0!=a._state&&(1==a._state?a._callResolveHandlers():a._callRejectHandlers())};F(b.done)?b.done(d):b.then(d)}return a}};g.resolve=function(b){return new g(b)};g.reject=function(b){var a=new g;a.reject(b);return a};g.all=function(b){if(!b.length)return g.resolve(null);var a=new g,d=b.length,c=Array(d),e=d,f,v,m=function(b,d){c[d]=b;e--;0==e&&a.resolve(c)};for(f=0;f<d;f++)(function(d){v=
b[f];v instanceof g?v.done(function(b){m(b,d)}).fail(a.reject,a):ha(v)||F(v)?(new g(v)).done(function(b){m(b,d)}).fail(a.reject,a):m(v,d)})(f);return a};g.when=function(){return g.all(arguments)};g.allResolved=function(b){if(!b.length)return g.resolve(null);var a=new g,d=b.length,c=[],e=d,f,v,m=function(b){c.push(b);t()},t=function(){e--;0==e&&a.resolve(c)};for(f=0;f<d;f++)v=b[f],v instanceof g?v.done(m).fail(t):ha(v)||F(v)?(new g(v)).done(m).fail(t):m(v);return a};g.race=function(b){if(!b.length)return g.resolve(null);
var a=new g,d=b.length,c,e;for(c=0;c<d&&(e=b[c],e instanceof g?e.done(a.resolve,a).fail(a.reject,a):ha(e)||F(e)?(new g(e)).done(a.resolve,a).fail(a.reject,a):a.resolve(e),a.isPending());c++);return a};return g}();G.lib.Promise=V;var aa=function(){var a={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},c=0,b=!!ib(),d=window.requestAnimationFrame?window.requestAnimationFrame:function(b){window.setTimeout(b,0)},e=function(b,a,c){var e=function(){(new Date).getTime()-
a>=c?b():d(e)};d(e)},f=function k(b,a,c,g,v,m,t){var h=function(){var a=I(b,"mjsAnimationQueue");return a&&a.length&&a[0].id==t?!1:(v.reject(b),!0)},u=function(){if(!h()){var d=c;c++;if(c==a.length){v.resolve(b);I(b,"mjsAnimationQueue").shift();var e=I(b,"mjsAnimationQueue");e.length?(e=e[0],f(e.el,e.stages,0,e.start,e.deferred,!1,e.id)):I(b,"mjsAnimationQueue",null)}else I(b,"mjsAnimationQueue")[0].position=c,k(b,a,c,null,v);S(b,a[d]);S(b,a[d]+"-active")}},p=function(){if(!h()){L(b,a[c]+"-active");
var d=yb(b);d?e(u,(new Date).getTime(),d):u()}},w=function(){if(!h()){L(b,a[c]);var e;g&&(e=g(b),g=null);ha(e)?e.done(p):d(p)}};m?d(w):w()},g=function(d,e,g,x){var y=new V,v=I(d,"mjsAnimationQueue")||[],m=++c,t=d.getAttribute("mjs-animate"),h,u,p,w,H,n,A;e=e||t;x&&null===t&&(e=null);if(e){q(e)?"["==e.substr(0,1)?h=(new Function("","return "+e))():(h=a[e],e=oa&&oa("animate."+e,!0)):F(e)?u=e:M(e)&&(q(e[0])?h=e:(p=e[0],w=e[1]));Aa(e)&&(h=e.stages,u=e.fn,p=e.before,w=e.after,H=e.options?s({},e.options):
{},n=e.context||null,A=e.duration||null,g=g||H.start);if(b&&h)return v.push({el:d,stages:h,start:g,deferred:y,position:0,id:m}),I(d,"mjsAnimationQueue",v),1==v.length&&f(d,h,0,g,y,!0,m),y;H=H||{};g&&(H.start=function(){g(d)});H.complete=function(){y.resolve(d)};A&&(H.duration=A);if(u&&F(u))return p&&s(d.style,p,!0,!1),g&&g(d),I(d,"mjsAnimationQueue",u.call(n,d,function(){y.resolve(d)})),y;if(window.jQuery){e=$(d);p&&e.css(p);I(d,"mjsAnimationQueue","stop");if(u&&q(u))return e[u](H),y;if(w)return e.animate(w,
H),y}}g?(u=g(d),ha(u)?u.done(function(){y.resolve(d)}):y.resolve(d)):y.resolve(d);return y};g.addAnimationType=function(b,d){a[b]=d};return g}(),J=function(){return String.prototype.trim?function(a){return q(a)?a.trim():a}:function(a){return q(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),Sa=function(a){return"[object Date]"===Ra.call(a)},Ta=function(a){return"[object RegExp]"===Ra.call(a)},Ua=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},va=function(){var a=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,
c=function(b){if(!q(b))return!0;var a=b.substr(0,1),d=b.length-1;return'"'!=a&&"'"!=a||b.indexOf(a,1)!=d?!1:b.substring(1,d)},b=function(a,d){if(Ua(a))throw Error("Cannot copy window object");if(d){if(a===d)throw Error("Objects are identical");if(M(a))for(var c=d.length=0;c<a.length;c++)d.push(b(a[c]));else{for(c in d)delete d[c];for(c in a)d[c]=b(a[c])}}else(d=a)&&(M(a)?d=b(a,[]):Sa(a)?d=new Date(a.getTime()):Ta(a)?d=new RegExp(a.source):ga(a)&&(d=b(a,{})));return d},d=function(b,a){if(b===a)return!0;
if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,e;if(c==typeof a&&"object"==c)if(M(b)){if(!M(a))return!1;if((c=b.length)==a.length){for(e=0;e<c;e++)if(!d(b[e],a[e]))return!1;return!0}}else{if(Sa(b))return Sa(a)&&b.getTime()==a.getTime();if(Ta(b)&&Ta(a))return b.toString()==a.toString();if(Ua(b)||Ua(a)||M(a))return!1;c={};for(e in b)if(("$"!==e.charAt(0)||"object"!=typeof b[e])&&!F(b[e])){if(!d(b[e],a[e]))return!1;c[e]=!0}for(e in a)if(!c.hasOwnProperty(e)&&"$"!==e.charAt(0)&&
void 0!==a[e]&&!F(a[e]))return!1;return!0}return!1},e=function(b,a){var c=b.length,e=a.length,f=Array(c+1),m=Array(c+1),h,n,g,t,k=0;if(c==e&&0==c)return{changes:0,distance:0,prescription:[]};for(h=0;h<=c;h++)f[h]=Array(e+1),m[h]=Array(e+1),f[h][0]=h,m[h][0]="D";for(h=0;h<=e;h++)f[0][h]=h,m[0][h]="I";for(h=1;h<=c;h++)for(n=1;n<=e;n++)g=d(b[h-1],a[n-1])?0:1,f[h][n-1]<f[h-1][n]&&f[h][n-1]<f[h-1][n-1]+g?(f[h][n]=f[h][n-1]+1,m[h][n]="I"):f[h-1][n]<f[h-1][n-1]+g?(f[h][n]=f[h-1][n]+1,m[h][n]="D"):(f[h][n]=
f[h-1][n-1]+g,m[h][n]=1==g?"R":"-");t=[];h=c;n=e;do g=m[h][n],t.push(g),"-"!=g&&k++,"R"==g||"-"==g?(h--,n--):"D"==g?h--:n--;while(0!=h||0!=n);return{changes:k/t.length,distance:f[c][e],prescription:t.reverse()}},f,g=function(b,a,d,e,h,n){f||(f=new Z);var g=na(),t;n&&(this.namespace=n,this.nsGet=n.get);this.origCode=a;M(b)&&null===a?t="array":(q(a)||(e=d,d=a,a=null,t="object"),q(b)&&(e=d,d=a,a=b,b=null),a&&b&&(t=b.hasOwnProperty(a)?"attr":"expr"),a&&!b&&(t="expr"));if(d)f.on(g,d,e||this,{append:[h],
allowDupes:!0});if("expr"==t){a=this._processInputPipes(a,b);a=this._processPipes(a,b);if(this.inputPipes||this.pipes)a=k(b,a),t=b.hasOwnProperty(a)?"attr":"expr";if(this.staticValue=c(a))t="static"}this.userData=h;this.code=a;this.id=g;this.type=t;this.obj=b;"expr"==t&&(this.getterFn=m(a));this.curr=this._getValue()};g.prototype={namespace:null,nsGet:null,staticValue:null,origCode:null,code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,pipes:null,inputPipes:null,
lastSetValue:null,userData:null,_processInputPipes:function(a,b){if(-1==a.indexOf(">>"))return a;for(var d=0,c=a.length,e=[],h,f,m,n=a;d<c&&-1!=(h=a.indexOf(">>",d));)f=a.charAt(h-1),m=a.charAt(h+2),"\\"!=f&&"'"!=f&&'"'!=f&&"'"!=m&&'"'!=m&&(d=J(a.substring(d,h)).split(":"),n=a.substr(h+2),this._addPipe(e,d,b,this.onInputParamChange)),d=h+2;e.length&&(this.inputPipes=e);return J(n)},_addPipe:function(a,b,d,c){var e=b.shift(),h=null,f=[],m;this.nsGet&&(h=this.nsGet("filter."+e,!0));h||(h=window[e]||
d[e]);if(F(h)){e=-1;for(m=b.length;++e<m;f.push(l(d,b[e],c,this,null,this.namespace)));a.push([h,b,f])}},_processPipes:function(a,b){if(-1==a.indexOf("|"))return a;for(var d=0,c=a.length,e=[],h,f,m,n=!1,g=a;d<c;)if(-1!=(h=a.indexOf("|",d)))f=a.charAt(h-1),m=a.charAt(h+1),"|"!=f&&"'"!=f&&'"'!=f&&"|"!=m&&"'"!=m&&'"'!=m&&(n?(d=J(a.substring(d,h)).split(":"),this._addPipe(e,d,b)):(n=!0,g=J(a.substring(0,h)))),d=h+1;else{n&&(d=J(a.substr(d)).split(":"),this._addPipe(e,d,b,this.onPipeParamChange));break}e.length&&
(this.pipes=e);return g},_checkCode:function(){var a=this._getValue(),b=!1,d=this.curr;if(M(d)&&M(a))return b=e(d,a),b.changes?(this.curr=a.slice(),f.trigger(this.id,b,a,d),!0):!1;a!==d&&(this.curr=a,f.trigger(this.id,a,d),b=!0);return b},_checkObject:function(){var a=this.obj,c=this.curr;return d(c,a)?!1:(this.curr=b(a),f.trigger(this.id,a,c),!0)},_checkArray:function(){var a=this.curr,b=this.obj,d=e(a,b);return d.changes?(this.curr=b.slice(),f.trigger(this.id,d,b,a),!0):!1},_getValue:function(){var a;
switch(this.type){case "static":a=this.staticValue;break;case "attr":a=this.obj[this.code];break;case "expr":a=this.getterFn(this.obj);z(a)&&(a="");break;case "object":a=b(this.obj);break;case "array":a=this.obj}M(a)&&(a=a.slice());return a=this._runThroughPipes(a,this.pipes)},_runThroughPipes:function(a,b){if(b){var d,c,e,h=b.length,f=this.obj,m,n;for(d=0;d<h;d++){e=b[d][1];c=[];m=-1;for(n=e.length;++m<n;c.push(H(e[m],f)));c.unshift(f);c.unshift(a);a=b[d][0].apply(null,c)}}return a},subscribe:function(a,
b,d){f.on(this.id,a,b,d)},unsubscribe:function(a,b){return f.un(this.id,a,b)},hasPipes:function(){return null!==this.pipes},hasInputPipes:function(){return null!=this.inputPipes},getValue:function(){return this._getValue()},setValue:function(a){var b=this.type;this.lastSetValue=a;a=this._runThroughPipes(a,this.inputPipes);if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||(this.setterFn=u(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";
},onInputParamChange:function(){this.setValue(this.lastSetValue)},onPipeParamChange:function(){this.check()},check:function(){switch(this.type){case "expr":case "attr":case "static":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},
clearInterval:function(){this.itv&&(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,b){var d=this.id;f.un(d,a,b);return f.hasListener(d)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b=this.inputPipes,d,c,e,h,m;this.itv&&this.clearInterval();if(a)for(d=-1,c=a.length;++d<c;)for(m=a[d][2],e=-1,h=m.length;++e<h;)m[e].unsubscribeAndDestroy(this.check,this);if(b)for(d=-1,c=b.length;++d<c;)for(m=b[d][2],e=-1,h=m.length;++e<h;)m[e].unsubscribeAndDestroy(this.onInputParamChange,
this);this.obj&&delete this.obj.$$watchers[this.origCode];delete this.id;delete this.curr;delete this.obj;delete this.pipes;delete this.inputPipes;delete this.origCode;delete this.code;delete this.getterFn;delete this.setterFn;delete this.lastSetValue;delete this.staticValue;delete this.userData;delete this.namespace;delete this.nsGet;f.destroyEvent(this.id)}};var l=function(a,b,d,c,e,h){b=k(a,J(b));return a?(a.$$watchers||(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&
this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof g&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof g)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].subscribe(d,c,{append:[e],allowDupes:!0}):a.$$watchers[b]=new g(a,b,d,c,e,h),a.$$watchers[b]):new g(a,b,d,c,e,h)},k=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var d;if("."==b.charAt(0)&&(d=b.substr(1),a.hasOwnProperty(d)))return d}return b},r=Function,
E=function(a,b,d,c){for(;d&&!d.$isRoot;)if(d=d.$parent)try{return 4==arguments.length?b.call(null,d,c,N,b):b.call(null,d,N,b)}catch(e){}},x=function(a){return function(){var b=ia.call(arguments);b.push(E);b.push(a);var d=b=a.apply(null,b);return z(d)||!d&&"number"==typeof d&&isNaN(d)?(b=ia.call(arguments),b.unshift(a),b.unshift(null),E.apply(null,b)):b}},y={},v=0,m=function(b){try{return y[b]?y[b]:(v++,y[b]=x(new r("____","$$interceptor","$$itself","".concat("try {","return ",b.replace(a,"$1____.$3"),
";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }"))))}catch(d){return N}},t={},h=0,u=function(b){try{if(!t[b]){h++;var d=b.replace(a,"$1____.$3");return t[b]=x(new r("____","$$$$","$$interceptor","$$itself","".concat("try {",d," = $$$$",";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____, $$$$); }")))}return t[b]}catch(c){return N}},p={},w=0,H=function(a,b){var d;return(d=c(a))?d:m(a)(b)},n=function(){1E3<=v&&(y={});1E3<=h&&(t={});1E3<=w&&(p={})};
g.create=l;g.unsubscribeAndDestroy=function(a,b,d,c){b=J(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(d,c)&&delete a[b]};g.normalizeExpr=k;g.prepareCode=function(b){return b.replace(a,"$1____.$3")};g.createGetter=m;g.createSetter=u;g.createFunc=function(b){try{return p[b]?p[b]:(w++,p[b]=x(new r("____","$$interceptor","$$itself","".concat("try {",b.replace(a,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }"))))}catch(d){return N}};g.eval=H;g.enableResetCacheInterval=
function(){setTimeout(n,1E4)};return g}(),pa=G.lib.Watchable=va,pa=va.create,Va=ja.register,ca=function(a){if(!a||z(a.length)||q(a))return a?[a]:[];for(var c=[],b=-1,d=a.length>>>0;++b!==d;c[b]=a[b]);return c},jb=function(a,c,b){setTimeout(function(){a.apply(c,b||[])},0)},ra=function(a){var c=a.stack||Error().stack;jb(function(){!z(console)&&console.log&&(console.log(a),c&&console.log(c))})},Q=function(){var a=/^[\w[:#.][\w\]*^|=!]*$/,c=/=([^\]]+)/,b=/ *, */,d=/(\([^)]*)\+/,e=/(\[[^\]]+)~/,f=/(~|>|\+)/,
g=/ +/,l=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,k=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,r=/\D/,E=/[^(]*\(([^)]*)\)/,x=/\(.*/,y=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,v=document,m=!!v.getElementsByClassName,t=!!v.querySelectorAll,h={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=a.nextSibling)&&1!=a.nodeType;);return!!a},root:function(a){return"html"!==
a.nodeName.toLowerCase()},"nth-child":function(a,b){var d=a.nodeIndex||0,c=b[3]=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(d)return!((d+c)%e);var h=a.parentNode.firstChild;d++;do if(1==h.nodeType&&(h.nodeIndex=++d)&&a===h&&(d+c)%e)return 0;while(h=h.nextSibling);return 1},"nth-last-child":function(a,b){var d=a.nodeIndexLast||0,c=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(d)return!((d+c)%e);var h=a.parentNode.lastChild;d++;do if(1==h.nodeType&&(h.nodeLastIndex=d++)&&a===h&&(d+c)%e)return 0;while(h=h.previousSibling);
return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!=a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},lang:function(a,b){return a.lang!==b&&v.documentElement.lang!==b},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},u={},p=function(a){return u[a]||(u[a]=new RegExp("(^| +)"+a+"($| +)"))},w={"":function(a,
b){return!!a.getAttribute(b)},"=":function(a,b,d){return(b=a.getAttribute(b))&&b===d},"&=":function(a,b,d){return(b=a.getAttribute(b))&&p(d).test(b)},"^=":function(a,b,d){return(b=a.getAttribute(b)+"")&&!b.indexOf(d)},"$=":function(a,b,d){return(b=a.getAttribute(b)+"")&&b.indexOf(d)==b.length-d.length},"*=":function(a,b,d){return(b=a.getAttribute(b)+"")&&-1!=b.indexOf(d)},"|=":function(a,b,d){return(b=a.getAttribute(b)+"")&&(b===d||!!b.indexOf(d+"-"))},"!=":function(a,b,d){return!(b=a.getAttribute(b))||
!p(d).test(b)}};return function(u,n){n=n||v;var A=[],R=null,U,p,q,C,s,W,X;if(t)try{A=ca(n.querySelectorAll(u.replace(c,'="$1"')))}catch(z){R=!0}if(!t||R)if(a.test(u))switch(R=0,u.charAt(0)){case "#":R=u.slice(1);A=v.getElementById(R);A.id!==R&&(A=v.all[R]);A=A?[A]:[];break;case ".":U=u.slice(1);if(m)A=ca((A=n.getElementsByClassName(U)).length?A:[]);else{U=" "+U+" ";p=n.getElementsByTagName("*");for(q=0;C=p[q++];)-1!=(" "+C.className+" ").indexOf(U)&&(A[R++]=C);A=R?A:[]}break;case ":":p=n.getElementsByTagName("*");
q=0;s=u.replace(E,"$1");for(W=u.replace(x,"");C=p[q++];)h[W]&&!h[W](C,s)&&(A[R++]=C);A=R?A:[];break;case "[":p=n.getElementsByTagName("*");q=0;C=y.exec(u);U=C[1];X=C[2]||"";for(s=C[3];C=p[q++];)w[X]&&(w[X](C,U,s)||"class"===U&&w[X](C,"className",s))&&(A[R++]=C);A=R?A:[];break;default:A=ca((A=n.getElementsByTagName(u)).length?A:[])}else{for(var B=u.split(b),D=B.length-1,F=!!D,G,M,P,N,I,J,K,L,T,O,Q,S;R=B[D--];){M=(G=R.replace(d,"$1%").replace(e,"$1&").replace(f," $1 ").split(g)).length;q=0;N=" ";for(p=
[n];P=G[q++];)if(" "!==P&&">"!==P&&"~"!==P&&"+"!==P&&p){P=P.match(l);I=P[1]||"*";J=P[2];K=P[3]?" "+P[3]+" ":"";U=P[4];X=P[5]||"";W=P[7];s="nth-child"===W||"nth-last-child"===W?k.exec("even"===P[8]&&"2n"||"odd"===P[8]&&"2n%1"||!r.test(P[8])&&"0n%"+P[8]||P[8]):P[8];L=[];R=T=0;for(Q=q==M;O=p[T++];)switch(N){case " ":S=O.getElementsByTagName(I);for(O=0;C=S[O++];)J&&C.id!==J||K&&-1==(" "+C.className+" ").indexOf(K)||!(!U||w[X]&&(w[X](C,U,P[6])||"class"===U&&w[X](C,"className",P[6])))||C.yeasss||(h[W]?
h[W](C,s):W)||(Q&&(C.yeasss=1),L[R++]=C);break;case "~":for(I=I.toLowerCase();(O=O.nextSibling)&&!O.yeasss;)1!=O.nodeType||"*"!==I&&O.nodeName.toLowerCase()!==I||J&&O.id!==J||K&&-1==(" "+O.className+" ").indexOf(K)||!(!U||w[X]&&(w[X](C,U,P[6])||"class"===U&&w[X](C,"className",P[6])))||O.yeasss||(h[W]?h[W](O,s):W)||(Q&&(O.yeasss=1),L[R++]=O);break;case "+":for(;(O=O.nextSibling)&&1!=O.nodeType;);!O||O.nodeName.toLowerCase()!==I.toLowerCase()&&"*"!==I||J&&O.id!==J||K&&-1==(" "+C.className+" ").indexOf(K)||
!(!U||w[X]&&(w[X](C,U,P[6])||"class"===U&&w[X](C,"className",P[6])))||O.yeasss||(h[W]?h[W](O,s):W)||(Q&&(O.yeasss=1),L[R++]=O);break;case ">":for(S=O.getElementsByTagName(I),q=0;C=S[q++];)C.parentNode!==O||J&&C.id!==J||K&&-1==(" "+C.className+" ").indexOf(K)||!(!U||w[X]&&(w[X](C,U,P[6])||"class"===U&&w[X](C,"className",P[6])))||C.yeasss||(h[W]?h[W](C,s):W)||(Q&&(C.yeasss=1),L[R++]=C)}p=L}else N=P;if(F){if(!p.concat){L=[];for(O=0;C=p[O];)L[O++]=C;p=L}A=p.concat(1==A.length?A[0]:A)}else A=p}for(R=A.length;R--;)A[R].yeasss=
A[R].nodeIndex=A[R].nodeIndexLast=null}return A}}(),Wa=function(){var a=document.createTextNode("");return q(a.textContent)?"textContent":"nodeValue"}(),Z=function(){this.events={}};Z.prototype={createEvent:function(a,c){a=a.toLowerCase();var b=this.events;b[a]||(b[a]=new Xa(a,c));return b[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,c,b,d){a=a.toLowerCase();var e=this.events;e[a]||(e[a]=new Xa(a));return e[a].on(c,b,d)},once:function(a,c,b,d){d=d||{};d.limit=1;
return this.on(a,c,b,d)},un:function(a,c,b){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(c,b)},hasListener:function(a,c,b){a=a.toLowerCase();var d=this.events;return d[a]?d[a].hasListener(c,b):!1},removeAllListeners:function(a){var c=this.events;c[a]&&c[a].removeAllListeners()},trigger:function(){var a=arguments[0],c=this.events,a=a.toLowerCase();if(!c[a])return null;a=c[a];return a.trigger.apply(a,ia.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var c=this.events;c[a]&&c[a].suspend()},
suspendAllEvents:function(){var a=this.events,c;for(c in a)a[c].suspend()},resumeEvent:function(a){a=a.toLowerCase();var c=this.events;c[a]&&c[a].resume()},resumeAllEvents:function(){var a=this.events,c;for(c in a)a[c].resume()},destroyEvent:function(a){var c=this.events;c[a]&&(c[a].removeAllListeners(),c[a].destroy(),delete c[a])},destroy:function(a){var c=this.events;if(a)a=a.toLowerCase(),c[a]&&(c[a].destroy(),delete c[a]);else{for(var b in c)c[b].destroy();this.events={}}},getApi:function(){if(!this.api){for(var a=
"createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),c={},b,d=-1,e=a.length;++d<e;b=a[d],c[b]=B(this[b],this));this.api=c}return this.api}};var Xa=function(a,c){this.name=a;this.listeners=[];this.map={};this.hash=na();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=z(c)?null:c};Xa.prototype={getName:function(){return this.name},destroy:function(){this.map=this.listeners=
null},on:function(a,c,b){if(!a)return null;c=c||null;b=b||{};var d=this.uni,e=c||a;if(e[d]&&!b.allowDupes)return null;var f=++this.lid,g=b.first||!1;e[d]=f;a={fn:a,scope:c,uniScope:e,id:f,called:0,limit:b.limit||0,start:b.start||1,count:0,append:b.append,prepend:b.prepend};g?this.listeners.unshift(a):this.listeners.push(a);this.map[f]=a;return f},once:function(a,c,b){b=b||{};b.once=!0;return this.on(a,c,b)},un:function(a,c){var b=-1,d=this.uni,e=this.listeners,f;f=a==parseInt(a)?a:(c||a)[d];if(!f)return!1;
for(var g=0,l=e.length;g<l;g++)if(e[g].id==f){b=g;delete e[g].uniScope[d];break}if(-1==b)return!1;e.splice(b,1);delete this.map[f];return!0},hasListener:function(a,c){var b=this.listeners,d;if(a){c=c||a;d=F(a)?c[this.uni]:a;if(!d)return!1;for(var e=0,f=b.length;e<f;e++)if(b[e].id==d)return!0;return!1}return 0<b.length},removeAllListeners:function(){var a=this.listeners,c=this.uni,b,d;b=0;for(d=a.length;b<d;b++)delete a[b].uniScope[c];this.listeners=[];this.map={}},suspend:function(){this.suspended=
!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,c){var b;a.append||a.prepend?(b=ia.call(c),a.prepend&&(b=a.prepend.concat(b)),a.append&&(b=b.concat(a.append))):b=c;return b},trigger:function(){var a=this.listeners,c=this.returnResult;if(this.suspended||0==a.length)return null;for(var b="all"==c?[]:null,d,e,a="first"==c?[a[0]]:ia.call(a);d=a.shift();)if(d&&this.map[d.id]&&(d.count++,!(d.count<d.start))){e=d.fn.apply(d.scope,this._prepareArgs(d,arguments));d.called++;d.called==d.limit&&
this.un(d.id);"all"==c&&b.push(e);if("first"==c)return e;"last"==c&&(b=e);if(!1==c&&!1===e)break}if(c)return b}};(function(){var a=new Z;s(G,a.getApi(),!0,!1)})();G.lib.Observable=Z;var da=function(a){this.$$observable=new Z;s(this,a,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)};da.prototype={$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$checking:!1,
$$destroyed:!1,$new:function(){return new da({$parent:this,$root:this.$root,$app:this.$app})},$newIsolated:function(){return new da({$app:this.$app})},$on:function(a,c,b){return this.$$observable.on(a,c,b)},$un:function(a,c,b){return this.$$observable.un(a,c,b)},$watch:function(a,c,b){return va.create(this,a,c,b,null)},$unwatch:function(a,c,b){return va.unsubscribeAndDestroy(this,a,c,b)},$get:function(a){for(var c=this;c;){if(void 0!=c[a])return c[a];c=c.$parent}},$$onParentDestroy:function(){this.$destroy()},
$$onParentCheck:function(){this.$check()},$check:function(){var a;this.$$checking||(this.$$checking=!0,this.$$watchers&&(a=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",a))},$destroy:function(){this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;delete this.$app;delete this.$root;delete this.$parent;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);this.$$destroyed=!0}};G.lib.Scope=da;
var kb=function(){var a=/\\{/g,c=new Z,b=function(a,b,c,l,k){return!b||!q(b)||-1==b.indexOf("{{")&&-1==b.indexOf("{[")?null:new d(a,b,c,l,k)},d=function(a,b,d,c,k){this.id=na();this.origin=b;this.scope=a;this.parent=d;this.isRoot=!d;this.data=c;this.lang=a.$app.lang;if(!0===k||!1===k)this.recursive=k;this.watchers=[];this.children=[];this.dataChangeDelegate=B(this.doDataChange,this);this.processed=this.processText(b);this.render()};d.prototype={id:null,parent:null,isRoot:null,scope:null,origin:"",
processed:null,text:null,watchers:null,children:null,data:null,recursive:!1,dataChangeDelegate:null,changeTmt:null,lang:null,subscribe:function(a,b){return c.on(this.id,a,b)},unsubscribe:function(a,b){return c.un(this.id,a,b)},getString:function(){null===this.text&&this.render();var b=this.text;return-1!=b.indexOf("\\{")?b.replace(a,"{"):b},render:function(){var a=this.processed,b,c,l;this.children.length||this.createChildren();l=this.children;b=-1;for(c=l.length;++b<c;a=a.replace("---"+b+"---",l[b]instanceof
d?l[b].getString():l[b]));return this.text=a},processText:function(a){for(var b=0,d=a.length,c,k,r="";b<d;)if(-1!=(c=a.indexOf("{{",b))&&-1!=(k=a.indexOf("}}",c+2))&&"\\"!=a.substr(c-1,1))r+=a.substring(b,c),k!=c+2&&(r+=this.watcherMatch(a.substring(c+2,k))),b=k+2;else{b!==d&&(r+=a.substring(b));break}b=0;a=r;d=a.length;for(r="";b<d;)if(-1!=(c=a.indexOf("{[",b))&&-1!=(k=a.indexOf("]}",c+2))&&"\\"!=a.substr(c-1,1))r+=a.substring(b,c),k!=c+2&&(r+=this.watcherMatch(a.substring(c+2,k),!0)),b=k+2;else{b!==
d&&(r+=a.substring(b));break}return r},watcherMatch:function(a,b){var d=this.watchers;if(b){a=J(a);var c=a.split("|"),k=J(c[0]);"."!=k.substr(0,1)&&(c[0]="'"+k+"'");1==c.length&&c.push("l");a=c.join(" | ")}d.push(pa(this.scope,a,this.onDataChange,this,null,ja));return"---"+(d.length-1)+"---"},onDataChange:function(){this.changeTmt||(this.changeTmt=setTimeout(this.dataChangeDelegate,0))},doDataChange:function(){this.destroyChildren();this.triggerChange();this.changeTmt=null},triggerChange:function(){this.text=
null;this.isRoot?c.trigger(this.id,this,this.data):this.parent.triggerChange()},createChildren:function(){var a=this.watchers,d=this.children,c=this.scope,l=this.recursive,k,r,E;k=-1;for(r=a.length;++k<r;)E=a[k].getLastResult(),d.push(l&&b(c,E,this,null,!0)||E)},destroyChildren:function(){var a=this.children,b,c;b=-1;for(c=a.length;++b<c;)a[b]instanceof d&&a[b].destroy();this.children=[]},destroyWatchers:function(){var a=this.watchers,b,d;b=-1;for(d=a.length;++b<d;a[b].unsubscribeAndDestroy(this.onDataChange,
this));this.watchers=[]},destroy:function(){this.destroyChildren();this.destroyWatchers();c.destroyEvent(this.id);delete this.watchers;delete this.children;delete this.origin;delete this.processed;delete this.text;delete this.scope;delete this.data;delete this.dataChangeDelegate;delete this.lang;this.changeTmt&&clearTimeout(this.changeTmt);delete this.changeTmt}};d.create=b;Va("MetaphorJs.view.TextRenderer",d);return d}(),Y=ja.add,Ya=function(){var a=[],c=[],b=!1,d=!1,e=function(a,b){return a.priority<
b.priority?-1:a.priority>b.priority?1:0};return{registerAttributeHandler:function(d,c,e){oa("attr."+d,!0)||(a.push({priority:c,name:d,handler:Y("attr."+d,e)}),b=!1)},getAttributeHandlers:function(){b||(a.sort(e),b=!0);return a},registerTagHandler:function(a,b,e){oa("tag."+a,!0)||(c.push({priority:b,name:a,handler:Y("tag."+a,e)}),d=!1)},getTagHandlers:function(){d||(c.sort(e),d=!0);return c}}}(),zb=Ya.getAttributeHandlers,Za=function(){var a=null,c=kb.create,b=function(a,b,d,c,e,g){var m=[];if(a&&
!0!==a){if(a.nodeType){g.countdown+=1;f(a,d,c,e,g);return}m=ca(a)}m.length||(m=ca(b.childNodes));b=m.length;g.countdown+=b;for(a=-1;++a<b;f(m[a],d,c,e,g));},d=function(a,b){if(b)if(b.nodeType)a.push(b);else if(M(b))for(var c=-1,e=b.length;++c<e;d(a,b[c]));},e=/^(script|template|mjs-template|style)$/i,f=function(a,d,c,f,g){if(a){var v,m=a.nodeName;g||(g={countdown:1});if(!m||!m.match(e)){if(a.nodeType)try{v=d.call(c,a)}catch(t){ra(t)}if(!1!==v){if(ha(v)){v.done(function(e){!1!==e&&b(e,a,d,c,f,g);0==
--g.countdown&&f&&f.call(c)});return}b(v,a,d,c,f,g)}}0==--g.countdown&&f&&f.call(c)}},g=new Z,l=function(a,b,d){this.id=na();this.el=a;this.scope=b;this.texts=[];this.parent=d;b instanceof da&&b.$on("destroy",this.destroy,this);if(d)d.on("destroy",this.destroy,this)};l.prototype={id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,on:function(a,b,d){return g.on(a+"-"+this.id,b,d)},un:function(a,b,d){return g.un(a+"-"+this.id,b,d)},createChild:function(a){return new l(a,
this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,d,c){var e=a.$isolateScope?b.$newIsolated():a.$breakScope?b.$new():b;b=b.$app;var f={$scope:e,$node:d,$attrValue:c,$renderer:this};d=[e,d,c,this];return a.__isMetaphorClass?(d=b.inject(a,null,!0,f,d),a.$stopRenderer?!1:d):b.inject(a,null,!1,f,d)},processNode:function(b){var e=b.nodeType,f=this.texts,g=this.scope,y,l;if(3==e){if(l=null!==b.parentNode.getAttribute("mjs-recursive"),y=c(g,b[Wa],null,f.length,l))y.subscribe(this.onTextChange,
this),f.push({node:b,tr:y}),this.renderText(f.length-1)}else if(1==e){a||(a=zb());var m=b.attributes;y=[];var t=[],h,u,p,e="tag."+b.tagName.toLowerCase();if(h=oa(e,!0)){p=this.runHandler(h,g,b);if(!1===p)return!1;ha(p)?y.push(p):d(t,p)}h=0;for(u=a.length;h<u;h++)if(l=a[h].name,null!==(p=b.getAttribute(l))){p=this.runHandler(a[h].handler,g,b,p);b.removeAttribute(l);if(!1===p)return!1;ha(p)?y.push(p):d(t,p)}if(y.length){var w=new V;V.all(y).done(function(a){d(t,a);w.resolve(t)});return w}l=null!==b.getAttribute("mjs-recursive");
h=0;for(u=m.length;h<u;h++)!oa(e,!0)&&(y=c(g,m[h].value,null,f.length,l))&&(y.subscribe(this.onTextChange,this),f.push({node:b,attr:m[h].name,tr:y}),this.renderText(f.length-1));return t.length?t:!0}return!0},process:function(){f(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){g.trigger("rendered-"+this.id,this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.tr.getString(),d=a.attr;d?(a.node.setAttribute(d,
b),"value"==d&&(a.node.value=b),"class"==d&&(a.node.className=b)):a.node[Wa]=b},destroy:function(){var a=this.texts,b,d;if(!this.destroyed){this.destroyed=!0;b=-1;for(d=a.length;++b<d;a[b].tr.destroy());this.parent&&this.parent.un("destroy",this.destroy,this);delete this.texts;delete this.el;delete this.scope;delete this.parent;g.trigger("destroy-"+this.id)}}};Va("MetaphorJs.view.Renderer",l);return l}(),Ab=function(){return z(JSON)?function(a){return JSON.parse(a)}:function(a){return(new Function("return "+
a))()}}(),lb=function(a,c){var b,d;if(!a||!q(a))return null;try{d=new DOMParser,b=d.parseFromString(a,c||"text/xml")}catch(e){b=void 0}if(!b||b.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return b},ka=function(){var a=/#.*$/,c=/([?&])_=[^&]*/,b=/\?/,d=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,e=/^(?:GET|HEAD)$/i,f=0,g=function(a,b,d){var c,e;if(q(a)&&d)b.push(encodeURIComponent(d)+"="+encodeURIComponent(a));else if(M(a)&&d)for(c=0,e=a.length;c<e;c++)g(a[c],
b,d+"["+c+"]");else if(ga(a))for(c in a)a.hasOwnProperty(c)&&g(a[c],b,d?d+"["+c+"]":c)},l=function(d,h){d.replace(a,"");if(!1===h.cache){var m=(new Date).getTime();return c.test(d)?d.replace(c,"$1_="+m):d+(b.test(d)?"&":"?")+"_="+m}!h.data||window.FormData&&h.data instanceof window.FormData||(q(h.data)?m=h.data:(m=[],g(h.data,m,null),m=m.join("&").replace(/%20/g,"+")),h.data=m,e.test(h.method)&&(d+=(b.test(d)?"&":"?")+h.data,h.data=null));return d},k={xml:"application/xml, text/xml",html:"text/html",
script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},r={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},E={},x=new Z,y=function(a){var b;
b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},v=function(a,b,d){var c,e;if(!ga(a)&&!F(a)&&d)c=document.createElement("input"),c.setAttribute("type","hidden"),c.setAttribute("name",d),c.setAttribute("value",a),b.appendChild(c);else if(M(a)&&d)for(c=0,e=a.length;c<e;c++)v(a[c],b,d+"["+c+"]");else if(ga(a))for(c in a)a.hasOwnProperty(c)&&v(a[c],b,d?d+"["+c+"]":c)},m=function(a){for(var b,d,c="",e=0;e<
a.elements.length;e++)if(b=a.elements[e],b.hasAttribute("name"))if(d="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT","FILE"===d)for(d=0;d<b.files.length;c+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[d++].name));else if("RADIO"!==d&&"CHECKBOX"!==d||b.checked)c+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return c},t=function(a,b,d){var c=b?b.dataType:null;b=b?b.selector:null;if(!q(a))return a;d=d||"";if("xml"===c||!c&&0<=d.indexOf("xml"))return a=
lb(J(a)),b?Q(b,a):a;if("html"===c)return a=lb(a,"text/html"),b?Q(b,a):a;if("fragment"==c){d=document.createDocumentFragment();c=document.createElement("div");for(c.innerHTML=a;c.firstChild;)d.appendChild(c.firstChild);return d}if("json"===c||!c&&0<=d.indexOf("json"))return Ab(J(a));("script"===c||!c&&0<=d.indexOf("javascript"))&&y(a);return a+""},h=function(a){var b=z(window)?"":window.location.href,b=d.exec(b.toLowerCase())||[],c=d.exec(a.url.toLowerCase());this._opt=a;a.crossDomain=!(!c||c[1]===
b[1]&&c[2]===b[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(b[3]||("http:"===b[1]?"80":"443")));b=new V;"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||!z(window)&&window.FormData||"iframe"==a.transport||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):m(a.form));a.url=l(a.url,a);c=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new H(a,b,this):new p(a,b,this):new w(a,
b,this);this._deferred=b;this._transport=c;b.done(function(a){x.trigger("success",a)});b.fail(function(a){x.trigger("error",a)});b.always(function(){x.trigger("end")});x.trigger("start");a.timeout&&(this._timeout=setTimeout(B(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===x.trigger("beforeSend",a,c)&&(this._promise=V.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,c)&&(this._promise=V.reject());this._promise||(jb(c.send,c),b.abort=B(this.abort,this),b.always(this.destroy,
this),this._promise=b)};h.prototype={_jsonpName:null,_transport:null,_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);v(this._opt.data,a,null);document.body.appendChild(a);this._form=a;
this._removeForm=!0},createJsonp:function(){var a=this._opt,d=a.jsonpParam||"callback",c=a.jsonpCallback||"jsonp_"+ ++f;a.url+=(b.test(a.url)?"&":"?")+d+"="+c;this._jsonpName=c;z(window)||(window[c]=B(this.jsonpCallback,this));z(global)||(global[c]=B(this.jsonpCallback,this));return c},jsonpCallback:function(a){try{this._deferred.resolve(this.processResponseData(a))}catch(b){this._deferred.reject(b)}},processResponseData:function(a,b){var d=this._opt;a=t(a,d,b);x.hasListener("processResponse")&&(a=
x.trigger("processResponse",a,this._deferred));d.processResponse&&(a=d.processResponse.call(d.callbackScope,a,this._deferred));return a},processResponse:function(a,b){var d=this._deferred;if(this._opt.jsonp)if(a){try{y(a)}catch(c){d.reject(c)}d.isPending()&&d.reject("jsonp script didn't invoke callback")}else d.reject("jsonp script is empty");else try{d.resolve(this.processResponseData(a,b))}catch(e){d.reject(e)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&
this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.destroy();delete this._transport;delete this._opt;delete this._deferred;delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&(z(window)||delete window[this._jsonpName],z(global)||delete global[this._jsonpName])}};var u=function(a,b){b=b||{};a&&!q(a)?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),!b.url))throw"Must provide url";s(b,E,!1,!0);s(b,r,!1,!0);b.method=b.method?b.method.toUpperCase():
b.form?b.form.getAttribute("method").toUpperCase()||"GET":"GET";return(new h(b)).promise()};u.setup=function(a){s(E,a,!0,!0)};u.on=function(){x.on.apply(x,arguments)};u.un=function(){x.un.apply(x,arguments)};u.get=function(a,b){b=b||{};b.method="GET";return u(a,b)};u.post=function(a,b){b=b||{};b.method="POST";return u(a,b)};u.load=function(a,b,d){d=d||{};q(b)||(d=b);d.dataType="fragment";return u(b,d).done(function(b){if(d.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};
u.loadScript=function(a){return u(a,{transport:"script"})};u.submit=function(a,b){b=b||{};b.form=a;return u(null,b)};var p=function(a,b,d){var c;if(!(window.XMLHttpRequest&&(c=new XMLHttpRequest)||(c=new ActiveXObject("Msxml2.XMLHTTP"))||(c=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=c;this._deferred=b;this._opt=a;this._ajax=d;a.progress&&D(c,"progress",B(a.progress,a.callbackScope));a.uploadProgress&&c.upload&&D(c.upload,"progress",B(a.uploadProgress,a.callbackScope));
try{var e;if(a.xhrFields)for(e in a.xhrFields)c[e]=a.xhrFields[e];a.data&&a.contentType&&c.setRequestHeader("Content-Type",a.contentType);c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.setRequestHeader("Accept",a.dataType&&k[a.dataType]?k[a.dataType]+", */*; q=0.01":k._default);for(e in a.headers)c.setRequestHeader(e,a.headers[e])}catch(h){}c.onreadystatechange=B(this.onReadyStateChange,this)};p.prototype={_xhr:null,_deferred:null,_ajax:null,onReadyStateChange:function(){var a=this._xhr,
b=this._deferred;if(0===a.readyState)a.onreadystatechange=N,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=N;var d;a:{try{d=!a.status&&!z(location)&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(c){}d=!1}d?this._ajax.processResponse(q(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=N;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,
a.url,!0,a.username,a.password),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}};var w=function(a,b,d){this._opt=a;this._ajax=d;this._deferred=b};w.prototype={_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);D(a,"load",B(this.onLoad,this));D(a,
"error",B(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}};var H=function(a,b,d){this._opt=a;this._ajax=d;this._deferred=b};H.prototype={_opt:null,
_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+ ++f,d=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);d.setAttribute("action",this._opt.url);d.setAttribute("target",b);D(a,"load",B(this.onLoad,this));D(a,"error",B(this.onError,this));this._el=a;try{d.submit()}catch(c){this._deferred.reject(c)}},onLoad:function(){var a=this._el;this._opt&&!this._opt.jsonp&&(a=a.contentDocument||
a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}};return u}(),wa=function(){var a=new Z,c={},b=function(a){if(!c[a]){var b=document.getElementById(a),d;b&&(d=b.tagName.toLowerCase(),"script"==
d?(d=document.createElement("div"),d.innerHTML=b.innerHTML,c[a]=qa(d.childNodes)):c[a]="content"in b?b.content:qa(b.childNodes))}return c[a]},d=function(a){return c[a]?c[a]:c[a]=ka(a,{dataType:"fragment"}).then(function(b){return c[a]=b})},e=function(a){s(this,a,!0,!1);this.id=na();this.tpl&&(this.tpl=J(this.tpl));this.url&&(this.url=J(this.url));a=this.node;var b=this.tpl||this.url;a&&a.removeAttribute("mjs-include");a||(this.deferRendering=!0);if(b){if(a&&a.firstChild&&I(a,"mjs-transclude",qa(a.childNodes)),
"."!=b.substr(0,1)||this.replace||(this.ownRenderer=!0,this._watcher=pa(this.scope,b,this.onChange,this,null,ja)),this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof da&&this.scope.$on("destroy",this.onScopeDestroy,
this)};e.prototype={_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,doRender:function(){this._renderer||(this._renderer=new Za(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){a.trigger("rendered-"+this.id,this)},on:function(b,d,c){return a.on(b+"-"+this.id,d,c)},un:function(b,d,c){return a.un(b+
"-"+this.id,d,c)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,c=a.url,e=a._watcher?a._watcher.getLastResult():a.tpl||c,k=new V;(new V(function(a){c?a(b(e)||d(c)):a(b(e)||qa(e))})).done(function(b){a._fragment=b;k.resolve(a.ownRenderer?!1:a.node)}).fail(k.reject,
k);return k},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=this.node;a.firstChild;)a.removeChild(a.firstChild);this.replace?a.parentNode.replaceChild(Ha(this._fragment),a):a.appendChild(Ha(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new V;this._initial?(this.doApplyTemplate(),b.resolve()):(aa(a,"leave",null,!0).done(this.doApplyTemplate,
this).done(b.resolve,b),aa(a,"enter",null,!0));this._initial=!1;return b},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();delete this._renderer},onScopeDestroy:function(){this.destroy();delete this._renderer},destroy:function(){delete this.node;delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),delete this._watcher);delete this.tpl}};e.getTemplate=b;e.loadTemplate=d;Va("MetaphorJs.view.Template",e);return e}(),
mb=function(){var a,c=function(){this.store={}};c.prototype={store:null,getApi:function(){return{value:B(this.value,this),constant:B(this.constant,this),factory:B(this.factory,this),service:B(this.service,this),provider:B(this.provider,this),resolve:B(this.resolve,this),inject:B(this.inject,this)}},instantiate:function(a,d){var c=function(){},f;c.prototype=a.prototype;c=new c;f=a.prototype.constructor.apply(c,d);return ga(f)?f:c},inject:function(a,d,c,f,g){f=f||{};g=g||[];if(F(a))if(a.inject)g=ia.call(a.inject),
g.push(a),a=g;else return c||a.__isMetaphorClass?this.instantiate(a,g):a.apply(d,g);a=ia.call(a);var l=this;g=[];var k=a.pop(),r,q;r=-1;for(q=a.length;++r<q;g.push(l.resolve(a[r],f)));return V.all(g).then(function(a){return c||k.__isMetaphorClass?l.instantiate(k,a):k.apply(d,a)})},value:function(a,d){this.store[a]={type:1,value:d}},constant:function(a,d){var c=this.store;c[a]||(c[a]={type:2,value:d})},factory:function(a,d,c,f){ua(c)&&(f=c,c=null);this.store[a]={type:3,singleton:f,fn:d,context:c}},
service:function(a,d,c){this.store[a]={type:4,singleton:c,fn:d}},provider:function(a,d){this.store[a+"Provider"]={name:a,type:5,fn:d,instance:null}},resolve:function(b,d){var c=this.store,f,g,l;if(!z(d[b]))return d[b];if(g=c[b]){f=g.type;if(1==f||2==f)return g.value;if(3==f)l=this.inject(g.fn,g.context,!1,d);else if(4==f)l=this.inject(g.fn,null,!0,d);else if(5==f)return g.instance||(g.instance=V.resolve(this.inject(g.fn,null,!0,d)).done(function(a){g.instance=a;c[g.name]={type:3,fn:a.$get,context:a}})),
g.instance;g.singleton&&(g.type=1,g.value=l,3==f&&ha(l)&&l.done(function(a){g.value=a}));return d[b]=l}if(c[b+"Provider"])return this.resolve(b+"Provider",d),this.resolve(b,d);if(this===a)throw"Could not provide value for "+b;return a.resolve(b)},destroy:function(){delete this.store;delete this.scope}};c.global=function(){return a};a=new c;return G.lib.Provider=c}(),xa=function(a,c,b,d,e){var f=!1!==c;c=c||{};e=e||[];b=b||c.scope;d=d||c.node;c.scope=c.scope||b;c.node=c.node||d;var g=q(a)?oa(a):a;
if(!g)throw"Component "+a+" not found";b&&g.$isolateScope&&(c.scope=b=b.$newIsolated());var l,k=[];a=g.template||c.template||null;var r=g.templateUrl||c.templateUrl||null,E=b?b.$app:null,x=mb.global(),y=E?E.inject:x.inject,v=E?E:x,m=d?d.getAttribute("mjs-cloak"):null,t={$node:d||null,$scope:b||null,$config:c||null,$args:e||null};if(g.resolve)for(l in g.resolve)(function(a){var h=new V,m;k.push(h.done(function(b){t[a]=b;c[a]=b;e.push(b)}));m=g.resolve[l];F(m)?h.resolve(m(b,d)):q(m)?h.resolve(y.resolve(m)):
h.resolve(y.call(v,m,null,!1,s({},t,c,!1,!1)))})(l);f&&(a||r)&&(c.template=new wa({scope:b,node:d,deferRendering:!0,ownRenderer:!0,tpl:a,url:r}),k.push(c.template.initPromise),d&&d.firstChild&&I(d,"mjs-transclude",qa(d.childNodes)));f&&e.unshift(c);var h;k.length?(h=new V,V.all(k).done(function(){h.resolve(y.call(v,g,null,!0,s({},t,c,!1,!1),e))})):h=V.resolve(y.call(v,g,null,!0,s({},t,c,!1,!1),e));d&&h.isPending()&&null!==m&&(m?L(d,m):d.style.visibility="hidden",h.done(function(){m?S(d,m):d.style.visibility=
""}));return h},Bb=function(){var a=function(a,b){"pt_BR"==b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1==
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0==a||1==a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1==a?0:2<=a&&4>=a?1:2;case "ga":return 1==a?0:2==a?1:2;case "lt":return 1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1==a%100?0:2==a%100?1:3==a%100||4==a%100?2:3;
case "mk":return 1==a%10?0:1;case "mt":return 1==a?0:0==a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0==a?0:1==a%10&&11!=a%100?1:2;case "pl":return 1==a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1==a?0:2==a?1:8==a||11==a?2:3;case "ro":return 1==a?0:0==a||0<a%100&&20>a%100?1:2;case "ar":return 0==a?0:1==a?1:2==a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},c=function(a){this.store={};a&&(this.locale=a)};c.prototype={store:null,locale:"en",setLocale:function(a){this.locale=
a},set:function(a,b){var c=this.store;z(c[a])&&(c[a]=b)},load:function(a){s(this.store,a,!1,!1)},get:function(a){return this.store[a]||(this===b?"-- "+a+" --":b.get(a))},plural:function(b,c){var f=this.get(b),g=a(c,this.locale);return M(f)?f[g]:Aa(f)?f[c]?f[c]:1==c&&void 0!=f.one?f.one:0>c&&void 0!=f.negative?f.negative:f.other:f}};var b=new c;c.global=function(){return b};return G.lib.Text=c}();K("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(a){a=a||{};this._observable=
new Z;s(this,this._observable.getApi(),!0,!1);if(a.callback){var c=a.callback,b=c.scope||this;delete c.scope;for(var d in c)if(c.hasOwnProperty(d))this.on(d,c[d],b);delete a.callback}s(this,a,!0,!1)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",this);this._observable.destroy();delete this._observable}},onDestroy:N});K("MetaphorJs.cmp.App","MetaphorJs.cmp.Base",{lang:null,scope:null,renderer:null,
cmpListeners:null,components:null,initialize:function(a,c){var b=c instanceof da?c:new da(c),d,e;b.$app=this;this.supr();d=new mb;e=new Z;this.lang=new Bb;s(this,d.getApi(),!0,!1);this.destroyProvider=B(d.destroy,d);s(this,e.getApi(),!0,!1);this.destroyObservable=B(e.destroy,e);this.scope=b;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",b.$root);this.value("$lang",this.lang);this.renderer=new Za(a,
b);d=ia.call(arguments);d[1]=b;this.initApp.apply(this,d)},initApp:N,run:function(){this.renderer.process()},getParentCmp:function(a){a=a.parentNode;for(var c;a;){if(c=a.getAttribute("cmp-id"))return this.getCmp(c);a=a.parentNode}return null},onAvailable:function(a,c,b){var d=this.cmpListeners;d[a]||(d[a]=new V);c&&d[a].done(c,b);return d[a]},getCmp:function(a){return this.components[a]||null},registerCmp:function(a){var c=this;c.components[a.id]=a;c.onAvailable(a.id).resolve(a);a.on("destroy",function(a){delete c.cmpListeners[a.id];
delete c.components[a.id]})},destroy:function(){var a;this.destroyObservable();this.destroyProvider();this.renderer.destroy();this.scope.$destroy();for(a in this)this.hasOwnProperty(a)&&delete this[a]}});var Ca=function(a){var c=document.body;return a===c?!0:c.contains(a)};K("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,initialize:function(a){this.supr(a);
this.scope||(this.scope=new da);a.as&&(this.scope[a.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);this.id=this.id||"cmp-"+na();this.node||this._createNode();this.initComponent.apply(this,arguments);this.scope.$app&&this.scope.$app.registerCmp(this);var c=this.template,b=this.templateUrl;c&&c instanceof wa?c instanceof wa&&(this.template.node=this.node):this.template=c=new wa({scope:this.scope,node:this.node,deferRendering:!c,ownRenderer:!0,tpl:c,url:b});if(this.parentRenderer)this.parentRenderer.on("destroy",
this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(c.initPromise?c.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display="none")},render:function(){this.rendered||(this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},
onRenderingFinished:function(){this.renderTo?this.renderTo.appendChild(this.node):Ca(this.node)||document.body.appendChild(this.node);this.rendered=!0;this.afterRender();this.trigger("afterrender",this)},show:function(){if(this.hidden){if(!1===this.trigger("beforeshow",this))return!1;this.node.style.display="block";this.hidden=!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("beforehide",this))return!1;this.node.style.display="none";this.hidden=!0;
this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:N,afterRender:N,onShow:N,onHide:N,onParentRendererDestroy:function(){this.destroy()},onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?Ca(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||
this.node.removeAttribute("id"));this.destroyScope&&this.scope&&this.scope.$destroy();delete this.scope;delete this.node;this.supr()}});var Da=function(a){var c=I(a,"mjsAnimationQueue"),b;M(c)&&c.length?(b=c[0])&&b.stages&&(c=b.position,b=b.stages,S(a,b[c]),S(a,b[c]+"-active")):F(c)?c(a):"stop"==c&&$(a).stop(!0,!0);I(a,"mjsAnimationQueue",null)};K("MetaphorJs.cmp.View",{route:null,node:null,scope:null,cmp:null,currentComponent:null,watchable:null,defaultCmp:null,initialize:function(a){s(this,a,!0,
!1);(a=this.node)&&a.firstChild&&I(a,"mjs-transclude",qa(a.childNodes));this.cmp||(this.cmp=a.getAttribute("mjs-view-cmp"));this.defaultCmp=a.getAttribute("mjs-view-default");a.removeAttribute("mjs-view");a.removeAttribute("mjs-view-cmp");a.removeAttribute("mjs-view-default");this.route?(history.initPushState(),G.on("locationChange",this.onLocationChange,this),this.onLocationChange()):this.cmp&&(this.watchable=pa(this.scope,this.cmp,this.onCmpChange,this,null,ja),this.onCmpChange())},onCmpChange:function(){var a=
this.watchable.getLastResult()||this.defaultCmp;this.clearComponent();a&&this.setComponent(a)},onLocationChange:function(){var a=hb(),c=this.route,b,d,e,f,g;d=0;for(e=c.length;d<e;d++){f=c[d];if(g=a.match(f.reg)){this.changeRouteComponent(f,g);return}f["default"]&&!b&&(b=f)}b?this.setRouteComponent(b,[]):this.clearComponent();!b&&this.defaultCmp&&this.setComponent(this.defaultCmp)},changeRouteComponent:function(a,c){Da(this.node);this.clearComponent();this.setRouteComponent(a,c)},clearComponent:function(){var a=
this,c=a.node;a.currentComponent&&aa(c,"leave",null,!0).done(function(){a.currentComponent.destroy();for(a.currentComponent=null;c.firstChild;)c.removeChild(c.firstChild)})},setRouteComponent:function(a,c){var b=this,d=b.node,e=a.params;aa(d,"enter",function(){var f=c||[],g={destroyEl:!1,node:d,scope:a.$isolateScope?b.scope.$newIsolated():b.scope.$new()},l,k;a.as&&(g.as=a.as);a.template&&(g.template=a.template);f.shift();if(e)for(l=-1,k=e.length;++l<k;g[e[l]]=f[l]);return xa(a.cmp||"MetaphorJs.cmp.Component",
g,g.scope,d,null,f).done(function(a){b.currentComponent=a})},!0)},setComponent:function(a){var c=this,b=c.node;aa(b,"enter",function(){var d=ga(a)?a:{},e=(q(a)?a:null)||"MetaphorJs.cmp.Component",f=d.scope||c.scope.$new();d.destroyEl=!1;return xa(e,d,f,b).done(function(a){c.currentComponent=a})},!0)},destroy:function(){this.clearComponent();this.route&&(G.un("locationchange",this.onLocationChange,this),delete this.route);this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),
delete this.watchable);delete this.scope;delete this.currentComponent}});var T=Ya.registerAttributeHandler,ya=function(){return!1};T("mjs-app",0,ya);var $a=function(a){var c=a.nodeName.toLowerCase();a=a.type;return"input"!=c&&"textarea"!=c&&"select"!=c||"submit"==a||"reset"==a||"button"==a?!1:!0},sa=function(){var a=/\r/,c={option:function(a){var d=a.getAttribute("value")||a.value;return null===d||z(d)?J(a.innerText||a.textContent):d},select:function(a){for(var d,c=a.options,f=a.selectedIndex,g=(a=
"select-one"===a.type||0>f)?null:[],l=a?f+1:c.length,k,r=0>f?l:a?f:0;r<l;r++)if(d=c[r],k=d.disabled||d.parentNode.disabled,(d.selected||r===f)&&!k){d=sa(d);if(a)return d;g.push(d)}return g},radio:function(a){return Pa(a.getAttribute("value"))?"on":a.value},checkbox:function(a){return Pa(a.getAttribute("value"))?"on":a.value}};return function(b){var d,e;if((d=c[b.type]||c[b.nodeName.toLowerCase()])&&!z(e=d(b,"value")))return e;e=b.value;return q(e)?e.replace(a,""):null==e?"":e}}(),Ia=Array.prototype.indexOf;
Ia||(Ia=Array.prototype.indexOf=function(a,c){var b;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;b=+c||0;Infinity===Math.abs(b)&&(b=0);if(b>=e)return-1;for(b=Math.max(0<=b?b:e-Math.abs(b),0);b<e;){if(b in d&&d[b]===a)return b;b++}return-1});var ab=function(){var a={select:function(a,b){for(var d,e,f=a.options,g=ca(b),l=f.length,k=-1;l--;)e=f[l],(e.selected=g?-1!=Ia.call(g,e.value):!1)?d=!0:Pa(e.getAttribute("mjs-default-option"))||
(k=l);d||(a.selectedIndex=k);return g}};a.radio=a.checkbox=function(a,b){if(M(b)){var d;d=sa(a);d=b?-1!=Ia.call(b,d):!1;return a.checked=d}};return function(c,b){if(1===c.nodeType){null===b?b="":Ga(b)&&(b+="");var d=a[c.type]||a[c.nodeName.toLowerCase()];if(!d||z(d(c,b,"value")))c.value=b}}}();K("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,initialize:function(a,c,b){b=J(b);this.node=c;this.expr=b;this.scope=a;this.watcher=pa(a,b,this.onChange,this,null,ja);if(this.watcher.getLastResult())this.onChange();
a instanceof da&&a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){this.destroy()},onChange:function(){},destroy:function(){delete this.node;delete this.scope;this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)}});T("mjs-bind",1E3,K(null,"MetaphorJs.view.AttributeHandler",{isInput:!1,recursive:!1,textRenderer:null,initialize:function(a,c,b){this.isInput=$a(c);(this.recursive=null!==c.getAttribute("mjs-recursive"))?(this.scope=a,this.node=c,
this.textRenderer=new kb(a,"{{"+b+"}}",null,null,!0),this.textRenderer.subscribe(this.onTextRendererChange,this),this.onTextRendererChange(),a instanceof da&&a.$on("destroy",this.onScopeDestroy,this)):this.supr(a,c,b)},onTextRendererChange:function(){this.updateElement(this.textRenderer.getString())},onChange:function(){var a=this.watcher.getLastResult();this.updateElement(a)},updateElement:function(a){this.isInput?ab(this.node,a):this.node[Wa]=a},destroy:function(){this.textRenderer&&(this.textRenderer.destroy(),
delete this.textRenderer);this.supr()}}));T("mjs-bind-html",1E3,K(null,"attr.mjs-bind",{updateElement:function(a){this.node.innerHTML=a}}));(function(){var a=function(a,b,d,e){if(null!==d){if(d==Ba(a,b))return;d=!d}else d=Ba(a,b);d?e?aa(a,[b+"-remove"],null,!0).done(function(){S(a,b)}):S(a,b):e?aa(a,[b+"-add"],null,!0).done(function(){L(a,b)}):L(a,b)};T("mjs-class",1E3,K(null,"MetaphorJs.view.AttributeHandler",{initial:!0,onChange:function(){var c=this.node,b=this.watcher.getLastResult(),d;Da(c);
if(q(b))a(c,b,null,!this.initial);else if(M(b)){var e;d=-1;for(e=b.length;++d<e;a(c,b[d],!0,!this.initial));}else for(d in b)a(c,d,b[d]?!0:!1,!this.initial);this.initial=!1}}))})();T("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,c,b){a&&(a[b]=c)}]);(function(){var a=function(a,b,d,e){var f,g,l,k,r;b.removeAttribute("mjs-cmp");d=d.split(" ");l=0;for(k=d.length;l<k;l++)r=d[l],""!=r&&"as"!=r&&(f?g=r:f=r);xa(f,{scope:a,node:b,as:g,parentRenderer:e,destroyScope:!0},a,b);return!1};a.$breakScope=
!0;T("mjs-cmp",200,a)})();T("mjs-each",100,K(null,"MetaphorJs.view.AttributeHandler",{model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,initialize:function(a,c,b){this.parseExpr(b);c.removeAttribute("mjs-each");c.removeAttribute("mjs-include");this.tpl=c;this.renderers=[];this.prevEl=c.previousSibling;this.nextEl=c.nextSibling;this.parentEl=c.parentNode;this.node=c;this.scope=a;try{this.watcher=pa(a,this.model,this.onChange,this,null,ja)}catch(d){ra(d)}this.parentEl.removeChild(c);
this.render(ca(this.watcher.getValue()))},onScopeDestroy:function(){var a=this.renderers,c,b;c=0;for(b=a.length;c<b;c++)a[c].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.supr()},doUpdate:function(a,c){for(var b=this.renderers,d=c,e=b.length,f=e-1,g=!(d%2),l,k;d<e;d++)l=b[d],k=l.scope,k.$index=d,k.$first=0===d,k.$last=d===f,k.$even=g,k.$odd=!g,g=!g,l.renderer?k.$check():(l.renderer=new Za(l.el,l.scope),l.renderer.process())},
render:function(a){var c=this.renderers,b=this.tpl,d=this.parentEl,e=this.nextEl,f=document.createDocumentFragment(),g,l,k;l=0;for(k=a.length;l<k;l++)g=b.cloneNode(!0),f.appendChild(g),c.push(this.createItem(g,a,l));d.insertBefore(f,e);this.doUpdate(a,0)},createItem:function(a,c,b){var d=this.itemName,e=this.scope.$new();e[d]=c[b];return{el:a,scope:e}},onChange:function(a){var c=this,b=c.renderers;a=a.prescription||[];var d=c.tpl,e=0,f=c.parentEl,g=ca(c.watcher.getValue()),l=null,k,r,q,x;r=0;for(q=
a.length;r<q;r++)x=a[r],"-"==x?(b[e].scope.$index=e,e++):(null===l&&(l=0<r?r-1:0),"I"!=x&&b[e]&&(k=b[e],k.scope.$destroy(),aa(k.el,"leave",null,!0).done(function(a){Ca(a)&&a.parentNode.removeChild(a)})),"D"==x?b.splice(e,1):(k=d.cloneNode(!0),aa(k,"enter",function(a){return function(d){0<a?f.insertBefore(d,b[a-1].el.nextSibling):c.prevEl?f.insertBefore(d,c.prevEl.nextSibling):f.insertBefore(d,f.firstChild)}}(e),!0),"R"==x?b[e]=c.createItem(k,g,e):"I"==x&&(r<b.length?b.splice(e,0,c.createItem(k,g,
e)):b.push(c.createItem(k,g,e))),e++));c.doUpdate(g,l)},parseExpr:function(a){a=a.split(" ");var c,b,d,e,f;c=0;for(b=a.length;c<b;c++)if(f=a[c],""!=f&&"in"!=f)if(e){d=a.slice(c).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"}},{$stopRenderer:!0}));var bb=va.createFunc,Ja=function(){return!0},za=function(a){if(a instanceof za)return a;if(!(this instanceof za))return new za(a);for(var c in a)if(!this[c])try{this[c]=a[c]}catch(b){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&
(this.target=a.srcElement);var d,e=a.button;z(this.pageX)&&null!==a.clientX&&(d=this.target?this.target.ownerDocument||document:document,c=d.documentElement,d=d.body,this.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0),this.pageY=a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0));this.which||void 0===e||(this.which=e&1?1:e&2?3:e&4?2:0);this.isDefaultPrevented=a.defaultPrevented||z(a.defaultPrevented)&&!1===a.returnValue?Ja:
ya;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};za.prototype={isDefaultPrevented:ya,isPropagationStopped:ya,isImmediatePropagationStopped:ya,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Ja;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Ja;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=
Ja;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}};G.lib.NormalizedEvent=za;var ba=function(a){return new za(a)};(function(){var a="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste enter".split(" "),c,b;c=0;for(b=a.length;c<b;c++)(function(a){var b=a;"enter"==b&&(b="keyup");T("mjs-"+a,1E3,function(c,g,l){var k=bb(l);D(g,b,function(b){b=b||window.event;b=ba(b);if("enter"==
a&&13!=b.keyCode)return null;c.$event=b;try{k(c)}catch(e){ra(e)}delete c.$event;c instanceof da?c.$root.$check():c.$$watchers&&c.$$watchers.$checkAll();b.preventDefault();return!1})})})(a[c])})();T("mjs-show",500,K(null,"MetaphorJs.view.AttributeHandler",{initial:!0,initialize:function(a,c,b){this.supr(a,c,b)},runAnimation:function(a){var c=this.node.style,b=function(){c.display=a?"":"none"};this.initial?b():aa(this.node,a?"show":"hide",function(){a&&(c.display="")},!0).done(b)},onChange:function(){var a=
this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));T("mjs-hide",500,K(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(!a);this.initial=!1}}));T("mjs-if",500,K(null,"MetaphorJs.view.AttributeHandler",{parentEl:null,prevEl:null,el:null,initial:!0,initialize:function(a,c,b){this.parentEl=c.parentNode;this.prevEl=c.previousSibling;this.supr(a,c,b)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=
this,c=a.watcher.getLastResult(),b=a.parentEl,d=a.node,e=function(){a.prevEl?b.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):b.appendChild(d)},f=function(){b.removeChild(d)};c?Ca(d)||(a.initial?e():aa(d,"enter",e,!0)):Ca(d)&&(a.initial?f():aa(d,"leave",null,!0).done(f));a.initial=!1}}));T("mjs-ignore",0,ya);T("mjs-include",900,function(a,c,b,d){a=new wa({scope:a,node:c,url:b,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});T("mjs-init",250,function(a,c,b){c.removeAttribute("mjs-init");
bb(b)(a)});var ea=function(a,c,b){a.detachEvent?a.detachEvent("on"+c,b):a.removeEventListener(c,b,!1)},cb=navigator.userAgent.toLowerCase(),Cb=function(){var a=parseInt((/android (\d+)/.exec(cb)||[])[1],10)||!1;return function(){return a}}(),nb=function(){var a=parseInt((/msie (\d+)/.exec(cb)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/.exec(cb)||[])[1],10)||!1);return function(){return a}}(),ob=function(){var a={};return function(c){if(void 0===a[c]){if("input"==c&&9==nb())return a[c]=
!1;var b=document.createElement("div");a[c]=!!("on"+c in b)}return a[c]}}(),Ka=function(a,c,b,d){this.el=a;this.cb=c;this.scb=d;this.cbContext=b;this.inputType=c=a.getAttribute("mjs-input-type")||a.type.toLowerCase();this.listeners=[];b=a.type?a.type.toLowerCase():"";this.submittable="input"==a.nodeName.toLowerCase()&&"radio"!=b&&"checkbox"!=b;"radio"==c?this.initRadioInput():"checkbox"==c?this.initCheckboxInput():this.initTextInput()};Ka.prototype={el:null,inputType:null,cb:null,scb:null,cbContext:null,
listeners:[],radio:null,submittable:!1,destroy:function(){var a=this.inputType,c=this.listeners,b=this.radio,d=this.el,e,f,g,l;e=0;for(f=c.length;e<f;e++)if("radio"==a)for(g=0,l=b.length;g<l;g++)ea(b[g],c[e][0],c[e][1]);else ea(d,c[e][0],c[e][1]);delete this.radio;delete this.el;delete this.cb;delete this.cbContext},initRadioInput:function(){var a=this.el,c=a.type,a=a.name,b,d,e;this.onRadioInputChangeDelegate=B(this.onRadioInputChange,this);if(document.querySelectorAll)b=document.querySelectorAll("input[name="+
a+"]");else{var f=document.getElementsByTagName("input"),g;b=[];d=0;for(e=f.length;d<e;d++)g=f[d],g.type==c&&g.name==a&&b.push(g)}this.radio=b;this.listeners.push(["click",this.onRadioInputChangeDelegate]);d=0;for(e=b.length;d<e;d++)D(b[d],"click",this.onRadioInputChangeDelegate)},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=B(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate]);D(this.el,"click",this.onCheckboxInputChangeDelegate)},
initTextInput:function(){var a=!1,c=this,b=c.el,d=c.listeners,e;if(!Cb()){var f=function(){a=!0},g=function(){a=!1;l()};d.push(["compositionstart",f]);d.push(["compositionend",g]);D(b,"compositionstart",f);D(b,"compositionend",g)}var l=c.onTextInputChangeDelegate=function(){if(!a)c.onTextInputChange()};if(ob("input"))d.push(["input",l]),D(b,"input",l);else{var k=function(a){e||(e=window.setTimeout(function(){l(a);e=null},0))},f=function(a){a=a||window.event;var b=a.keyCode;if(13==b&&c.submittable&&
c.scb)return c.scb.call(c.cbContext,a);91===b||15<b&&19>b||37<=b&&40>=b||k(a)};d.push(["keydown",f]);D(b,"keydown",f);ob("paste")&&(d.push(["paste",k]),d.push(["cut",k]),D(b,"paste",k),D(b,"cut",k))}d.push(["change",l]);D(b,"change",l)},processValue:function(a){switch(this.inputType){case "number":a=parseInt(a,10),isNaN(a)&&(a=0)}return a},onTextInputChange:function(){var a=this.getValue();this.cb.call(this.cbContext,a)},onCheckboxInputChange:function(){var a=this.el;this.cb.call(this.cbContext,a.checked?
a.getAttribute("value")||!0:!1)},onRadioInputChange:function(a){a=a||window.event;this.cb.call(this.cbContext,(a.target||a.srcElement).value)},setValue:function(a){var c=this.inputType,b,d;if("radio"==c)for(c=this.radio,b=0,d=c.length;b<d;b++){if(c[b].value==a){c[b].checked=!0;break}}else"checkbox"==c?(c=this.el,c.checked=!0===a||a==c.value):ab(this.el,a)},getValue:function(){var a=this.inputType,c,b;if("radio"==a){a=this.radio;c=0;for(b=a.length;c<b;c++)if(a[c].checked)return a[c].value;return null}return"checkbox"==
a?this.el.checked?this.el.getAttribute("value")||!0:!1:this.processValue(sa(this.el))}};G.lib.Input=Ka;T("mjs-model",1E3,K(null,"MetaphorJs.view.AttributeHandler",{inProg:!1,input:null,binding:null,initialize:function(a,c,b){this.node=c;this.input=new Ka(c,this.onInputChange,this);this.binding=c.getAttribute("mjs-data-binding")||"both";var d=this.input.getValue();this.supr(a,c,b);a=this.watcher.getLastResult();if("scope"!=this.binding&&this.watcher&&(d||a&&this.watcher.hasInputPipes()))this.onInputChange(a||
d)},onInputChange:function(a){var c=this.scope;"scope"!=this.binding&&(a&&q(a)&&-1!=a.indexOf("\\{")&&(a=a.replace(/\\{/g,"{")),this.watcher.setValue(a),this.inProg=!0,c instanceof da?c.$root.$check():this.watcher.checkAll(),this.inProg=!1)},destroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var a=this.watcher.getLastResult();"input"==this.binding||this.inProg||this.input.setValue(a)}}));var pb=va.createGetter;T("mjs-options",100,K(null,"MetaphorJs.view.AttributeHandler",
{model:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,initialize:function(a,c,b){this.parseExpr(b);c.removeAttribute("mjs-options");this.node=c;this.scope=a;for(this.defOption=c.options.length?c.options[0]:null;c.firstChild;)c.removeChild(c.firstChild);this.defOption&&this.defOption.setAttribute("mjs-default-option","");try{this.watcher=pa(a,this.model,this.onChange,this,null,ja)}catch(d){ra(d)}this.render(ca(this.watcher.getValue()))},onChange:function(){this.render(ca(this.watcher.getValue()))},
renderOption:function(a,c,b){var d=this.groupEl||this.fragment,e=nb();b.item=a;b.$index=c;a=this.getterFn(b);void 0!=a.group&&(a.group=""+a.group);a.group!==this.prevGroup&&(a.group?(this.groupEl=d=document.createElement("optgroup"),d.setAttribute("label",a.group),a.disabledGroup&&d.setAttribute("disabled","disabled"),this.fragment.appendChild(d)):(d=this.fragment,this.groupEl=null));this.prevGroup=a.group;c=document.createElement("option");c.setAttribute("value",a.value);c.text=a.name;e&&9>e&&(c.innerHTML=
a.name);a.disabled&&c.setAttribute("disabled","disabled");d.appendChild(c)},render:function(a){var c=this.node,b=sa(c),d=this.defOption,e=this.scope.$new(),f,g;this.fragment=document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;c.firstChild;)c.removeChild(c.firstChild);f=0;for(g=a.length;f<g;f++)this.renderOption(a[f],f,e);d&&c.insertBefore(d,c.firstChild);e.$destroy();c.appendChild(this.fragment);this.fragment=null;ab(c,b)},parseExpr:function(a){var c=a.indexOf(" in "),b;-1==c?(b=
a,a="{name: .item, value: .$index}"):(b=a.substr(c+4),a=a.substr(0,c));this.model=b;this.getterFn=pb(a)}}));(function(){var a="selected checked disabled readonly required open".split(" "),c,b;c=0;for(b=a.length;c<b;c++)(function(a){T("mjs-"+a,1E3,K(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.watcher.getLastResult()?this.node.setAttribute(a,!0):this.node.removeAttribute(a)}}))})(a[c])})();var qb=function(a){var c;a:{for(var b=a,d;b;){d=I(b,"mjs-transclude");if(void 0!=d){c=d;
break a}b=b.parentNode}c=void 0}if(c){a.firstChild&&I(a,"mjs-transclude",qa(a.childNodes));b=a.parentNode;d=a.nextSibling;c=Ha(c);var e=ca(c.childNodes);b.removeChild(a);b.insertBefore(c,d);return e}return null};T("mjs-transclude",1E3,function(a,c){return qb(c)});T("mjs-view",200,function(a,c,b){c.removeAttribute("mjs-view");xa(b||"MetaphorJs.cmp.View",{scope:a,node:c},a,c);return!1});var rb=Ya.registerTagHandler;rb("mjs-include",900,function(a,c,b,d){return(new wa({scope:a,node:c,tpl:c.getAttribute("src"),
parentRenderer:d,replace:!0})).initPromise});rb("mjs-transclude",900,function(a,c){return qb(c)});(function(){var a=function(a,d,c){if(""===d||z(d))return!0;if(!z(a)){if(ua(a))return a===d;if(c instanceof RegExp)return d.test(""+a);if("strict"==c)return""+a===""+d;if(!0===c||null===c||z(c))return-1!=""+a.indexOf(d);if(!1===c)return-1==""+a.indexOf(d)}return!1},c=function(b,d,c){if(ga(b)){var f,g;for(f in d)if("$"==f)for(g in b){if(a(b[g],d.$,c))return!0}else if(a(b[f],d[f],c))return!0}else return z(d.$)?
!0:a(b,d.$,c);return!1};Y("filter.filter",function(a,d,e,f){d=e;ga(d)||(d={$:d});e=[];var g,l;g=-1;for(l=a.length;++g<l;)c(a[g],d,f)&&e.push(a[g]);return e})})();Y("filter.fromList",function(a,c,b){b=b||", ";return a&&a.length?(M(a)||(a=ca(a)),a.join(b)):""});Y("filter.l",function(a,c){return c.$app.lang.get(a)});Y("filter.limitTo",function(a,c,b){c=q(a);if(!M(a)&&!c)return a;b=Infinity===Math.abs(Number(b))?Number(b):parseInt(b,10);if(c)return b?0<=b?a.slice(0,b):a.slice(b,a.length):"";c=[];var d;
b>a.length?b=a.length:b<-a.length&&(b=-a.length);0<b?d=0:(d=a.length+b,b=a.length);for(;d<b;d++)c.push(a[d]);return c});Y("filter.linkify",function(a,c,b){return a?a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(b?' target="'+b+'"':"")+">$1</a>"):""});Y("filter.lowercase",function(a){return a.toLowerCase()});var Db={};Y("filter.moment",function(a,c,b){b=Db[b]||b;return moment(a).format(b)});var Eb={};Y("filter.numeral",function(a,c,b){b=Eb[b]||
b;return numeral(a).format(b)});Y("filter.p",function(a,c,b){return c.$app.lang.plural(a,parseInt(b,10)||0)});Y("filter.sortBy",function(a,c,b,d){d||(d="asc");a=a.slice();a.sort(function(a,d){var c=typeof a,l=a,k=d;if(c!=typeof d)return 0;"object"==c&&(l=a[b],k=d[b]);if("number"==typeof l)return l-k;l=(""+l).toLowerCase();k=(""+k).toLowerCase();return l===k?0:l>k?1:-1});return"desc"==d?a.reverse():a});Y("filter.toArray",function(a){return ca(a)});Y("filter.toList",function(a,c,b,d){d=d||void 0;b=
b||"/\\n|,/";if(!a)return[];a=""+a;"/"==b.substr(0,1)&&"/"==b.substr(b.length-1)&&(b=Qa(b.substring(1,b.length-1)));a=a.split(b,d);c=-1;for(b=a.length;++c<b;a[c]=J(a[c]));return a});Y("filter.ucfirst",function(a){return a.substr(0,1).toUpperCase()+a.substr(1)});Y("filter.uppercase",function(a){return a.toUpperCase()});var sb=function(a){var c=!1,b=!0,d=window,e=d.document,f=e.documentElement,g=function(b){if("readystatechange"!=b.type||"complete"==e.readyState)ea("load"==b.type?d:e,b.type,g),!c&&
(c=!0)&&a.call(d,b.type||b)},l=function(){try{f.doScroll("left")}catch(a){setTimeout(l,50);return}g("poll")};if("complete"==e.readyState)a.call(d,"lazy");else{if(e.createEventObject&&f.doScroll){try{b=!d.frameElement}catch(k){}b&&l()}D(e,"DOMContentLoaded",g);D(e,"readystatechange",g);D(d,"load",g)}},tb=function(a,c,b){a.removeAttribute("mjs-app");try{return xa(c||"MetaphorJs.cmp.App",!1,b,a,[a,b])}catch(d){return ra(d),V.reject(d)}};sb(function(){var a=Q("[mjs-app]"),c,b,d,e=function(a){a.run()};
c=-1;for(b=a.length;++c<b;)d=a[c],tb(d,d.getAttribute&&d.getAttribute("mjs-app")).done(e)});var la=Fa.factory;(function(){var a={},c={};K("MetaphorJs.data.Model",{type:null,fields:null,record:null,store:null,plain:!1,initialize:function(a){this.fields={};s(this,{record:{load:null,save:null,"delete":null,id:null,data:null,success:null,extra:{}},store:{load:null,save:null,"delete":null,id:null,data:null,total:null,start:null,limit:null,success:null,extra:{}}},!1,!0);s(this,a,!0,!0);this.plain=!this.type},
isPlain:function(){return this.plain},getRecordProp:function(a,d){return this.getProp("record",a,d)},setRecordProp:function(a,d){this.record[a]=d},getStoreProp:function(a,d){return this.getProp("store",a,d)},setStoreProp:function(a,d){this.store[a]=d},getProp:function(a,d,c){a=this[a];return a[d]&&a[d][c]||a[c]||this[c]||null},setProp:function(a,d){return this[a]=d},_createAjaxCfg:function(a,d,c,f){var g=this,l=g[a],k=s({},q(l[d])?{url:l[d]}:l[d]),r=g.getProp(a,d,"id"),E=g.getProp(a,d,"data"),x=g.getProp(a,
d,"url"),y=g.getProp(a,d,"json");if(!k)if(x)k={url:x};else throw a+"."+d+" not defined";q(k)&&(k={url:k});if(!k.url){if(!x)throw a+"."+d+" url not defined";k.url=x}k.data=s({},k.data,g.extra,l.extra,l[d]?l[d].extra:{},!1,!0);k.method||(k.method="load"==d?"GET":"POST");c&&(k.data[r]=c);f&&(E?k.data[E]=f:k.data=f);y&&k.data&&"GET"!=k.method&&(k.data=JSON.stringify(k.data));k.callbackScope=g;"record"==a?k.processResponse=function(a,b){g._processRecordResponse(d,a,b)}:"store"==a&&(k.processResponse=function(a,
b){g._processStoreResponse(d,a,b)});return k},_processRecordResponse:function(a,d,c){var f=this.getRecordProp(a,"id"),g=this.getRecordProp(a,"data"),f=(g=g?d[g]:d)&&g[f]||d[f];this._getSuccess("record",a,d)?c.resolve({id:f,data:g}):c.reject(d)},_processStoreResponse:function(a,d,c){var f=this.getStoreProp(a,"data"),g=this.getStoreProp(a,"total"),f=f?d[f]:d,g=g?d[g]:null;this._getSuccess("store",a,d)?c.resolve({data:f,total:g}):c.reject(d)},_getSuccess:function(a,d,c){return(a=this.getProp(a,d,"success"))&&
void 0!=c[a]?c[a]:!0},loadRecord:function(a){return ka(this._createAjaxCfg("record","load",a))},saveRecord:function(a,d,c){return ka(this._createAjaxCfg("record",a.getId()?"save":"create",a.getId(),s({},a.storeData(a.getData(d)),c)))},deleteRecord:function(a){return ka(this._createAjaxCfg("record","delete",a.getId()))},loadStore:function(a,d){return ka(s(this._createAjaxCfg("store","load"),d,!0,!0))},saveStore:function(a,d){return ka(this._createAjaxCfg("store","save",null,d))},deleteRecords:function(a,
d){return ka(this._createAjaxCfg("store","delete",d))},getFields:function(){return this.fields},restoreField:function(a,d,c){var f=this.fields[d];if(f){switch(q(f)?f:f.type){case "int":c=parseInt(c);break;case "bool":case "boolean":q(c)?(c=c.toLowerCase(),c=!("off"===c||"no"===c||"0"===c||"false"==c||"null"==c)):c=c?!0:!1;break;case "double":case "float":c=parseFloat(c);break;case "date":f.parseFn?c=f.parseFn(c,f.format):Date.parse?c=Date.parse(c,f.format):("timestamp"==f.format&&(c=1E3*parseInt(c)),
c=new Date(c))}f.restore&&(c=f.restore.call(a,c,d))}return this.onRestoreField(a,d,c)},onRestoreField:function(a,d,c){return c},storeField:function(a,d,c){var f=this.fields[d];if(f){switch(q(f)?f:f.type){case "bool":case "boolean":c=c?"1":"0";break;case "date":c=f.formatFn?f.formatFn(c,f.format):Date.format?Date.format(c,f.format):"timestamp"==f.format?c.getTime()/1E3:c.format?c.format(f.format):c.toString();break;default:c=c.toString()}f.store&&(c=f.store.call(a,c,d))}return this.onStoreField(a,
d,c)},onStoreField:function(a,d,c){return c}},{create:function(b,d){return"MetaphorJs.data.Model"==b?la(b,d):d?la(b,d):a[b]?a[b]:a[b]=la(b)},addToCache:function(a){var d=a.getClass(),e=a.getId();"MetaphorJs.data.Record"!=d&&(c[d]||(c[d]={}),c[d][e]=a)},getFromCache:function(a,d){return c[a]&&c[a][d]?c[a][d]:null},removeFromCache:function(a,d){c[a]&&c[a][d]&&delete c[a][d]}})})();var La=G.data.Model,ub=Fa.isInstanceOf;K("MetaphorJs.data.Record","MetaphorJs.cmp.Base",{id:null,data:null,orig:null,modified:null,
loaded:!1,dirty:!1,destroyed:!1,model:null,standalone:!0,stores:null,initialize:function(a,c,b){var d=arguments.length;1==d?(b=a,c=a=null):2==d&&(b=c,c=null);this.data={};this.orig={};this.stores=[];this.modified={};b=b||{};this.supr(b);q(this.model)?this.model=la(this.model):ub(this.model,"MetaphorJs.data.Model")||(this.model=la("MetaphorJs.data.Model",this.model));this.id=a;c?this.importData(c):!1!==b.autoLoad&&a&&this.load();"MetaphorJs.data.Record"!=this.getClass()&&La.addToCache(this)},isLoaded:function(){return this.loaded},
isStandalone:function(){return this.standalone},isDirty:function(){return this.dirty},getModel:function(){return this.model},attachStore:function(a){a=a.getId();-1==this.stores.indexOf(a)&&this.stores.push(a)},detachStore:function(a){a=a.getId();var c;this.destroyed||-1==(c=this.stores.indexOf(a))||(this.stores.splice(c,1),0!=this.stores.length||this.standalone||this.destroy())},setDirty:function(a){this.dirty!=a&&(this.dirty=!!a,this.trigger("dirtychange",this,a))},importData:function(a){var c={},
b;if(a){for(b in a)c[b]=this.model.restoreField(this,b,a[b]);this.data=c}this.orig=s({},this.data);this.modified={};this.loaded=!0;this.setDirty(!1)},storeData:function(a){var c={},b;for(b in a)c[b]=this.model.storeField(this,b,a[b]);return c},getId:function(){return this.id},getData:function(a){if(a){var c={},b,d;a=q(a)?[a]:a;b=0;for(d=a.length;b<d;b++)c[a[b]]=this.data[a[b]];return c}return s({},this.data)},getChanged:function(){return s({},this.modified)},isChanged:function(a){return this.modified[a]||
!1},get:function(a){return this.data[a]},setId:function(a){!this.id&&a&&(this.id=a)},set:function(a,c){var b=this.data[a];c=this.model.restoreField(this,a,c);this.data[a]=c;b!=c&&(this.modified[a]=!0,this.setDirty(!0),this.trigger("change",this,a,c,b),this.trigger("change-"+a,this,a,c,b))},revert:function(){this.dirty&&(this.data=s({},this.orig),this.modified={},this.setDirty(!1))},load:function(){var a=this;a.trigger("beforeload",a);return a.model.loadRecord(a.id).done(function(c){a.setId(c.id);
a.importData(c.data);a.trigger("load",a)}).fail(function(){a.trigger("failedload",a)})},save:function(a,c){var b=this;b.trigger("beforesave",b);return b.model.saveRecord(b,a,c).done(function(a){b.setId(a.id);b.importData(a.data);b.trigger("save",b)}).fail(function(a){b.trigger("failedsave",b)})},"delete":function(){var a=this;a.trigger("beforedelete",a);return a.model.deleteRecord(a).done(function(){a.trigger("delete",a);a.destroy()}).fail(function(){a.trigger("faileddelete",a)})},reset:function(){this.id=
null;this.data={};this.orig={};this.modified={};this.dirty=this.loaded=!1;this.trigger("reset",this)},destroy:function(){this.destroyed||(this.destroyed=!0,this.trigger("destroy",this),this.stores=this.model=this.modified=this.orig=this.data=null,La.removeFromCache(this.getClass(),this.id),this.supr())}});var ma=G.data.Record;(function(){var a=0,c={};K("MetaphorJs.data.Store","MetaphorJs.cmp.Base",{id:null,autoLoad:!1,clearOnLoad:!0,model:null,extraParams:null,loaded:!1,loading:!1,local:!1,items:null,
map:null,keys:null,length:0,totalLength:0,start:0,pageSize:null,pages:null,filtered:!1,filterBackup:null,filterFn:null,filterScope:null,filterParams:null,initialize:function(b,d,e){this.items=[];this.map={};this.keys=[];this.loaded=!1;this.extraParams=this.extraParams||{};b&&!q(b)&&(e=d,d=b,b=null);d=d||{};this.supr(d);this.id=this.id||++a;c[this.id]=this;q(this.model)?this.model=la(this.model):ub(this.model,La)||(this.model=la("MetaphorJs.data.Model",this.model));if(b||d.url)this.model.store.load=
b||d.url;!this.local&&this.autoLoad?this.load():e&&(M(e)?this.loadArray(e):this.loadAjaxData(e));this.local&&(this.loaded=!0)},getId:function(){return this.id},isLoaded:function(){return this.loaded},isLocal:function(){return this.local},setLocal:function(a){this.local=!!a},isLoading:function(){return this.loading},isFiltered:function(){return this.filtered},getLength:function(){return this.length},getTotalLength:function(){return this.filtered?this.length:this.totalLength||this.length},getPagesCount:function(){return null!==
this.pageSize?parseInt(this.totalLength/this.pageSize):1},setParam:function(a,d){this.extraParams[a]=d},getParam:function(a){return this.extraParams[a]},setStart:function(a){this.start=a},setPageSize:function(a){this.pageSize=a},getAjaxData:function(){return this.ajaxData},hasDirty:function(){if(this.model.isPlain())return!1;var a=!1;this.each(function(d){return d.isDirty()?(a=!0,!1):!0});return a},getDirty:function(){var a=[];if(this.model.isPlain())return a;this.each(function(d){d.isDirty()&&a.push(d)});
return a},getModel:function(){return this.model},importData:function(a){this.suspendAllEvents();for(var d=0;d<a.length;d++)this.add(a[d]);this.resumeAllEvents();this.loaded=!0;this.loading=!1;this.onLoad();this.trigger("load",this)},load:function(a){var d=this,c=d.model.store,f=c.start,c=c.limit;if(d.local)return null;a=s({},d.extraParams,a||{});null===d.pageSize||a[f]||a[c]||(a[f]=d.start,a[c]=d.pageSize);return!1===d.trigger("beforeload",d)?null:d.model.loadStore(d,a).done(function(a){d.totalLength=
parseInt(a.total);d.importData(a.data);d.totalLength=parseInt(a.total)}).fail(function(a){d.onFailedLoad();d.trigger("failedload",d,a)})},onLoad:N,onFailedLoad:N,save:function(){var a=this,d={},c=0;if(a.local)return null;if(a.model.isPlain())throw Error("Cannot save plain store");a.each(function(a){a.isDirty()&&(d[a.getId()]=a.storeData(a.getData()),c++)});if(!c)throw Error("Nothing to save");return!1===a.trigger("beforesave",a,d)?null:a.model.saveStore(a,d).done(function(d){var c,e,k=d.data;if(k&&
k.length)for(d=0,c=k.length;d<c;d++)e=a.getRecordId(k[d]),(e=a.getById(e))&&e.importData(k[d]);a.onSave();a.trigger("save",a)}).fail(function(){a.onFailedSave();a.trigger("failedsave",a)})},onSave:N,onFailedSave:N,deleteById:function(a){var d=this,c,f,g;if(d.local)return null;if(!a||M(a)&&!a.length)throw Error("Record id required");M(a)||(a=[a]);c=0;for(f=a.length;c<f;c++)g=d.getById(a[c]),g instanceof ma?g.destroy():d.removeId(a[c]);return!1===d.trigger("beforedelete",d,a)?null:d.model.deleteRecords(d,
a).done(function(){d.onDelete();d.trigger("delete",d,a)}).fail(function(){d.onFailedDelete();d.trigger("faileddelete",d,a)})},onDelete:N,onFailedDelete:N,deleteAt:function(a){var d=this.getAt(a);if(!d)throw Error("Record not found at "+a);return this.deleteRecord(d)},"delete":function(a){return this.deleteById(this.getRecordId(a))},deleteRecords:function(a){var d=[],c,f;c=0;for(f=a.length;c<f;c++)d.push(this.getRecordId(a[c]));return this.deleteById(d)},loadAjaxData:function(a){var d=this;!1!==d.trigger("beforeload",
d)&&d.model._processStoreResponse("load",a,{resolve:function(a,b){d.importData(a);d.totalLength=parseInt(b)},reject:function(){}})},loadArray:function(a,d){!1!==this.trigger("beforeload",this)&&(!d&&this.clearOnLoad&&0<this.length&&this.clear(),M(a)&&(this.importData(a),this.totalLength=this.length))},loadOr:function(a,d){this.local||this.isLoading()||(this.isLoaded()?a&&a.call(d||this):this.load())},addNextPage:function(){!this.local&&this.length<this.totalLength&&this.load({start:this.length,limit:this.pageSize},
!0)},loadNextPage:function(){this.local||(this.start+=this.pageSize,this.load())},loadPrevPage:function(){this.local||(this.start-=this.pageSize,this.load())},getRecordId:function(a){return a instanceof ma?a.getId():a[this.model.getStoreProp("load","id")]||null},processRawDataItem:function(a){if(a instanceof ma||this.model.isPlain())return a;var d=this.model.type,c=this.getRecordId(a),f;c&&(f=La.getFromCache(d,c));f||(f=la(d,c,a,{model:this.model,standalone:!1}));return f},bindRecord:function(a,d){d[a]("change",
this.onRecordChange,this);d[a]("destroy",this.onRecordDestroy,this);d[a]("dirtychange",this.onRecordDirtyChange,this);return d},onRecordDirtyChange:function(a){this.trigger("update",this,a)},onRecordChange:function(a,d,c,f){this.trigger("update",this,a)},onRecordDestroy:function(a){this.remove(a)},add:function(a,c,e){if(this.filtered)throw"Cannot add to filtered store";if(!q(a)&&!Ga(a)){c=a;if(M(c)){if(!c.length)return;a=this.length;for(var f=0,g=c.length;f<g;f++)c[f]=this.processRawDataItem(c[f]),
this.add(this.getRecordId(c[f]),c[f],!0);this.onAdd(a,c);e||this.trigger("add",a,c);return}c=this.processRawDataItem(c);a=this.getRecordId(c)}if(!z(a)&&null!==a){if(!z(this.map[a])){this.replace(a,c);return}this.map[a]=c}this.length++;this.items.push(c);this.keys.push(a);c instanceof ma&&(c.attachStore(this),this.bindRecord("on",c));this.onAdd(this.length-1,[c]);e||this.trigger("add",this.length-1,[c])},onAdd:N,removeAt:function(a){if(a<this.length&&0<=a){this.length--;this.totalLength--;var c=this.items[a];
this.items.splice(a,1);var e=this.keys[a];z(e)||delete this.map[e];this.keys.splice(a,1);this.onRemove(c,e);this.trigger("remove",c,e);return c instanceof ma?(this.bindRecord("un",c),c.detachStore(this),null):c}return!1},onRemove:N,insert:function(a,c,e,f){if(this.filtered)throw Error("Cannot insert into filtered store");2==arguments.length&&(e=arguments[1],c=this.getRecordId(e));e=this.processRawDataItem(e);this.containsId(c)&&(this.suspendAllEvents(),this.removeId(c),this.resumeAllEvents());if(a>=
this.length)return this.add(c,e,f);this.length++;this.items.splice(a,0,e);z(c)||null===c||(this.map[c]=e);this.keys.splice(a,0,c);e instanceof ma&&(e.attachStore(this),this.bindRecord("on",e));this.onAdd(a,[e]);f||this.trigger("add",a,[e]);return e},replace:function(a,c){var e,f;1==arguments.length&&(c=arguments[0],a=this.getRecordId(c));c=this.processRawDataItem(c);e=this.map[a];if(z(a)||null===a||z(e))return this.add(a,c);e instanceof ma&&(this.bindRecord("un",e),e.detachStore(this));f=this.indexOfId(a);
this.items[f]=c;this.map[a]=c;c instanceof ma&&(this.bindRecord("on",c),c.attachStore(this));this.onReplace(a,e,c);this.trigger("replace",a,e,c);return c},onReplace:N,remove:function(a){return this.removeAt(this.indexOf(a))},removeId:function(a){return this.removeAt(this.indexOfId(a))},contains:function(a){return-1!=this.indexOf(a)},containsId:function(a){return!z(this.map[a])},clear:function(){var a=this.getRange();this.clearFilter(!0);this._reset();this.onClear();this.trigger("clear",a)},onClear:N,
reset:function(){this._reset()},_reset:function(a){var c,e;if(!a)for(a=0,c=this.items.length;a<c;a++)e=this.items[a],e instanceof ma&&(this.bindRecord("un",e),e.detachStore(this));this.totalLength=this.length=this.start=0;this.items=[];this.keys=[];this.map={};this.loaded=this.local},filter:function(a,c,e){this.filtered&&this.clearFilter(!0);this.filtered=!0;this.filterFn=a;this.filterScope=c;this.filterParams=e;this.trigger("beforefilter",this);this.suspendAllEvents();this.filterBackup={length:this.length,
items:this.items,keys:this.keys,map:this.map};this._reset(!0);a=this.filterBackup.keys;c=this.filterBackup.items;e=0;for(var f=c.length;e<f;e++)this._filterRecord(c[e],a[e])&&(this.items.push(c[e]),this.keys.push(a[e]),this.length++,this.map[a[e]]=c[e]);this.resumeAllEvents();this.onFilter();this.trigger("filter",this)},onFilter:N,_filterRecord:function(a,c){return this.filtered&&this.filterFn.call(this.filterScope,a,c,this.filterParams)},clearFilter:function(a){this.filtered&&(a||this.trigger("beforeclearfilter",
this),this.suspendAllEvents(),this.filtered=!1,this._reset(!0),this.length=this.filterBackup.length,this.items=this.filterBackup.items,this.keys=this.filterBackup.keys,this.map=this.filterBackup.map,this.filterBackup=null,this.resumeAllEvents(),this.onClearFilter(),a||this.trigger("clearfilter",this))},onClearFilter:N,getAt:function(a){return this.items[a]||null},getById:function(a){return this.map[a]||null},indexOf:function(a){return this.items.indexOf(a)},indexOfId:function(a){return this.keys.indexOf(a)},
each:function(a,c){var e=[].concat(this.items);c=c||window;for(var f=0,g=e.length;f<g&&!1!==a.call(c,e[f],f,g);f++);},eachId:function(a,c){c=c||window;for(var e=0,f=this.keys.length;e<f;e++)a.call(c,this.keys[e],this.items[e],e,f)},collect:function(a){var c=[],e=!this.model.isPlain();this.each(function(f){(f=e?f.get(a):f[a])&&c.push(f)});return c},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},getRange:function(a,c){var e=this.items;if(1>e.length)return[];
a=a||0;c=Math.min(z(c)||null===c?this.length-1:c,this.length-1);var f,g=[];if(a<=c)for(f=a;f<=c;f++)g[g.length]=e[f];else for(f=a;f>=c;f--)g[g.length]=e[f];return g},findBy:function(a,c,e){a=this.findIndexBy(a,c,e);return-1==a?null:this.getAt(a)},findIndexBy:function(a,c,e){c=c||this;var f=this.keys,g=this.items;e=e||0;for(var l=g.length;e<l;e++)if(a.call(c,g[e],f[e]))return e;return-1},find:function(a,c,e){var f=!this.model.isPlain(),g;return this.findIndexBy(function(l){g=f?l.get(a):l[a];return e?
g===c:g==c},this)},findExact:function(a,c){return this.find(a,c,!0)},findBySet:function(a){var c=null,e,f;this.each(function(g){e=!0;for(f in a)if(a[f]!=g[f]){e=!1;break}return e?(c=g,!1):!0});return c},onDestroy:function(){delete c[this.id];this.clear();this.supr()}},{createFromSelect:function(a){var c=[];a=a.options;for(var e=0,f=a.length;e<f;e++){var g=a[e],l=(g.hasAttribute?g.hasAttribute("value"):g.getAttributeNode("value").specified)?g.value:g.text;c.push([l,g.text])}a=la("MetaphorJs.data.Store",
{server:{load:{id:0}}});a.loadArray(c);return a},lookupStore:function(a){return c[a]||null},eachStore:function(a,d){for(var e in c)if(!1===a.call(d||window,c[e]))break}})})();T("mjs-each-in-store",100,K(null,"attr.mjs-each",{store:null,initialize:function(a,c,b){this.parseExpr(b);c.removeAttribute("mjs-each-in-store");c.removeAttribute("mjs-include");this.tpl=c;this.renderers=[];this.prevEl=c.previousSibling;this.nextEl=c.nextSibling;this.parentEl=c.parentNode;this.node=c;this.scope=a;this.store=
a=pb(this.model)(a);this.parentEl.removeChild(c);this.initWatcher();this.render(this.watcher.getValue());this.bindStore(a,"on")},onScopeDestroy:function(){this.bindStore(this.store,"un");delete this.store;this.supr()},initWatcher:function(){this.watcher=pa(this.store,".items",null);this.watcher.subscribe(this.onChange,this)},resetWatcher:function(){this.watcher.setValue(this.store.items)},bindStore:function(a,c){a[c]("load",this.onStoreUpdate,this);a[c]("update",this.onStoreUpdate,this);a[c]("add",
this.onStoreUpdate,this);a[c]("remove",this.onStoreUpdate,this);a[c]("replace",this.onStoreUpdate,this);a[c]("filter",this.onStoreFilter,this);a[c]("clearfilter",this.onStoreFilter,this);a[c]("clear",this.onStoreClear,this);a[c]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},onStoreFilter:function(){this.resetWatcher();this.onStoreUpdate()},onStoreClear:function(){this.resetWatcher();this.onStoreUpdate()},onStoreDestroy:function(){this.onStoreClear();this.watcher.unsubscribeAndDestroy(this.onChange,
this);delete this.watcher}},{$stopRenderer:!0}));var db=function(a,c){var b=Q(c,a.parentNode),d,e;d=-1;for(e=b.length;++d<e;)if(b[d]===a)return!0;return!1},ta=function(a){return a.substr(0,1).toUpperCase()+a.substr(1)},eb=function(){if(z(window.pageYOffset)){var a=document.body,c=document.documentElement;return c.clientHeight?function(){return c.scrollTop}:function(){return a.scrollTop}}return function(){return window.pageYOffset}}(),fb=function(){if(z(window.pageXOffset)){var a=document.body,c=document.documentElement;
return c.clientWidth?function(){return c.scrollLeft}:function(){return a.scrollLeft}}return function(){return window.pageXOffset}}(),fa=function(a){var c;c=eb();var b=fb();if(a===window)b=document.documentElement,c={left:0,right:b.clientWidth,top:c,bottom:b.clientHeight+c,width:b.clientWidth,height:b.clientHeight};else if(a.getBoundingClientRect)a=a.getBoundingClientRect(),c={left:a.left+b,top:a.top+c,right:a.right+b,bottom:a.bottom+c},c.width=c.right-c.left,c.height=c.bottom-c.top;else{var d=a.style;
c={left:(parseInt(d.left,10)||0)+b,top:(parseInt(d.top,10)||0)+c,width:a.offsetWidth,height:a.offsetHeight,right:0,bottom:0}}c.getCenter=function(){return this.width/2};c.getCenterX=function(){return this.left+this.width/2};return c},Ma={},Fb=function(a,c,b,d){var e=c+"-"+b,f=function(a){a=ba(a);return db(a.target,c)?d(a):null};Ma[e]||(Ma[e]=[]);Ma[e].push({el:a,ls:f,fn:d});D(a,b,f)},Gb=function(a,c,b,d){var e,f;if(f=Ma[c+"-"+b])for(c=-1,e=f.length;++c<e;)f[c].el===a&&f[c].fn===d&&ea(a,b,f[c].ls)},
vb=function(){var a=function(a,b){var c=a.style,d;for(d in b)c[d]=b[d]},c={t:"b",r:"l",b:"t",l:"r"},b={t:"top",r:"right",b:"bottom",l:"left"},d={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]},e=document.all&&!window.XMLHttpRequest,f=function(){var a={},b={};return{register:function(c){var d=c.getInstanceId(),e=c.getGroup(),f,h,g;a[d]=c;f=0;for(h=e.length;f<h;f++)g=e[f],b[g]||(b[g]={}),b[g][d]=!0;c.on("destroy",this.unregister,this)},unregister:function(b){b=b.getInstanceId();delete a[b]},hideAll:function(c){var d=
c.getInstanceId();c=c.getGroup();var e,f,h,g;e=0;for(f=c.length;e<f;e++)for(g in h=c[e],h=b[h],h)a[g]?g==d||a[g].isHideAllIgnored()||a[g].hide(null,!0,!0):delete h[g]}}}(),g=function(f,k,y){var l,m=this,t,h={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"},u=k.size,p=k.width||2*u;s(m,{init:function(){k.border&&m.createInner()},getEl:function(){return l},getDialogPositionOffset:function(){var a=(m.detectPointerPosition()||"").substr(0,1),b=
(f.getCfg().position.type||"").replace(/(w|m|c)/,"").substr(0,1),d={x:0,y:0};a==c[b]&&(d["t"==a||"b"==a?"y":"x"]="b"==a||"r"==a?-u:u);return d},createInner:function(){var a=s({},k);a.size=u-2*k.border;a.width=p-4*k.border;delete a.border;delete a.borderColor;delete a.borderCls;delete a.offset;t=new g(f,a,k.border)},detectPointerPosition:function(){if(k.position)return k.position;var a=(f.getCfg().position.type||"").replace(/(w|m|c)/,"").substr(0,1);return a?c[a]:null},detectPointerDirection:function(a){return k.direction?
k.direction:a},getBorders:function(a,h,m){var f={},t=a.substr(0,1);a=h.substr(0,1);var g=h.substr(1);h=e?"dotted":"solid";f["border"+ta(b[c[t]])]=u+"px solid "+m;f["border"+ta(b[t])]="0 "+h+" transparent";g?(f["border"+ta(b[g])]="0 solid transparent",f["border"+ta(b[c[g]])]=p+"px "+h+" transparent"):(m=Math.floor(p/2),f["border"+ta(b[d[a][0]])]=m+"px "+h+" transparent",f["border"+ta(b[d[a][1]])]=m+"px "+h+" transparent");return f},getOffsets:function(a,d){var e={},h=a.substr(0,1),m="t"==h||"b"==h?
"r":"b";if(!u)switch(document.body.appendChild(l),h){case "t":case "b":u=fa(l).height;p=fa(l).width;break;case "l":case "r":p=fa(l).height,u=fa(l).width}e[b[h]]=y?"auto":-u+"px";e[b[m]]="auto";if(y){var h=d.substr(0,1),f=d.substr(1);e[b[c[m]]]=f?"l"==f||"t"==f?y+"px":-p-y+"px":Math.floor(-p/2)+"px";e[b[c[h]]]=-(u+2*y)+"px"}else{switch(a){case "t":case "r":case "b":case "l":h=d!=a?"l"==d||"t"==d?k.offset:-p+k.offset:-p/2+k.offset;break;case "bl":case "tl":case "lt":case "rt":h=k.offset;break;default:h=
-p-k.offset}e["margin"+ta(b[c[m]])]=h+"px";switch(a){case "t":case "r":case "b":case "l":h="50%";break;case "tr":case "rb":case "br":case "lb":h="100%";break;default:h=0}e[b[c[m]]]=h}return e},render:function(){if(!l){var b=m.detectPointerPosition();if(b)if(k.el){if(q(k.el)){var c=document.createElement("div");c.innerHTML=k.el;l=c.firstChild}else l=k.el;a(l,{position:"absolute"});a(l,m.getOffsets(b));L(l,k.cls);f.getElem().appendChild(l)}else{c=m.detectPointerDirection(b);l=document.createElement("div");
var d=document.createComment(" ");l.appendChild(d);a(l,h);a(l,m.getBorders(b,c,k.borderColor||k.color));a(l,m.getOffsets(b,c));L(l,k.borderCls||k.cls);t&&(t.render(),l.appendChild(t.getEl()));y||f.getElem().appendChild(l)}}},destroy:function(){m.remove();t=m=null},remove:function(){t&&t.remove();l&&(l.parentNode.removeChild(l),l=null)}},!0,!1);m.init();return m},l=function(a){if(!a)return{};var b=function(b,c,d){var e=a[b],h=!1;if(!z(e)){switch(d){case "string":h=q(e);break;case "function":h=F(e);
break;case "number":h=Ga(e)||e==parseInt(e);break;case "dom":h=e&&(e.tagName||e.nodeName)?!0:!1;break;case "jquery":(h=e&&e.jquery?!0:!1)&&(e=e.get(0));break;case "boolean":if(!0===e||!1===e)h=!0;break;default:!0===d&&!0===e&&(h=!0),!1===d&&!1===e&&(h=!0)}h&&(a[b]={},a[b][c]=e)}};b("content","value","string");b("content","value","boolean");b("content","fn","function");b("ajax","url","string");b("cls","dialog","string");b("render","tpl","string");b("render","fn","function");b("render","el","dom");
b("render","el","jquery");b("show","events",!1);b("show","events","string");b("hide","events",!1);b("hide","events","string");b("toggle","events",!1);b("toggle","events","string");b("position","type","string");b("position","type",!1);b("position","get","function");b("overlay","enabled","boolean");b("pointer","position","string");b("pointer","size","number");return a},k={target:null,debug:!1,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},ajax:{url:null,data:null,dataType:"text",
method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",fn:null,el:null,zIndex:null,lazy:!0,style:null,appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{click:{preventDefault:!0,stopPropagation:!0,returnValue:!1,process:null}}},show:{delay:null,single:!1,events:null,animate:!1,ignoreHideAll:!1,focus:!1,preventScroll:!1},hide:{delay:null,timeout:null,events:null,destroy:!1,animate:!1,cancelShowDelay:!0},
toggle:{events:null},position:{type:"t",offsetX:0,offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1,preventScroll:!1},callback:{scope:null,contentchange:null,beforeshow:null,show:null,beforehide:null,hide:null,render:null,lifetime:null,targetchange:null,button:null}},r=function(b,
c){b&&!q(b)&&(c=b,b=null);c=c||{};var d=this,e={},m=na(),t=new Z,h=s({},k,l(r.defaults),l(r[b]),l(c),!0,!0),u=h.callback.scope||e,p,w,H,n={bindSelfOnRender:!1,target:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,hideTimeout:null,hideDelay:null,showDelay:null,dynamicTarget:!1,dynamicTargetEl:null,images:0,position:null,destroyDelay:null};c=null;s(e,t.getApi(),{getElem:function(){return p},getInstanceId:function(){return m},getCfg:function(){return s({},h)},getGroup:function(){return h.group?q(h.group)?
[h.group]:h.group:[""]},setTarget:function(a){if(!a)return e;var b=!1,c=n.target;n.target?(d.setHandlers("unbind","_target"),b=!0):n.dynamicTarget&&(b=!0);q(a)?(n.dynamicTarget=!0,n.target=null):(n.dynamicTarget=!1,n.target=a);b&&(d.setHandlers("bind","_target"),d.trigger("targetchange",e,a,c));return e},getTarget:function(){return n.dynamicTarget?n.dynamicTargetEl:h.target},isEnabled:function(){return n.enabled},isVisible:function(){return n.visible},isHideAllIgnored:function(){return h.show.ignoreHideAll},
isFrozen:function(){return n.frozen},enable:function(){n.enabled=!0;return e},disable:function(){d.hide();n.enabled=!1;return e},freeze:function(){n.frozen=!0;return e},unfreeze:function(){n.frozen=!1;return e},toggle:function(a,b){return a&&a.stopPropagation&&n.dynamicTarget&&n.visible&&d.isDynamicTargetChanged(a)?d.show(a):d[n.visible?"hide":"show"](a,b)},show:function(a,b){var c=a&&a.stopPropagation?null:e,m=h.show;if(!e.isEnabled())return h.debug&&console.log("show: not enabled",e.getTarget()),
c;a&&a.stopPropagation&&h.events.show&&h.events.show[a.type]&&(c=h.events.show[a.type],c.process?c=c.process(e,a):(c.stopPropagation&&a.stopPropagation(),c.preventDefault&&a.preventDefault(),c=c.returnValue));if(n.visible&&n.hideTimeout)return window.clearTimeout(n.hideTimeout),n.hideTimeout=window.setTimeout(d.hide,h.hide.timeout),h.debug&&console.log("show: hide timeout was set",e.getTarget()),c;if(n.hideDelay)return window.clearTimeout(n.hideDelay),n.hideDelay=null,n.visible=!0,h.debug&&console.log("show: hide delay was set; already shown",
e.getTarget()),c;if(n.frozen)return h.debug&&console.log("show: frozen",e.getTarget()),c;n.destroyDelay&&(window.clearTimeout(n.destroyDelay),n.destroyDelay=null);var t=!1;a&&a.stopPropagation&&n.dynamicTarget&&(t=d.changeDynamicTarget(a));if(n.visible)if(t)if(h.render.fn)d.hide(null,!0);else return d.reposition(a),c;else return h.debug&&console.log("show: already shown",p),c;p?t&&d.changeDynamicContent():d.render();if(!1===d.trigger("beforeshow",e,a))return h.debug&&console.log("show: beforeshow return false",
e.getTarget()),c;Da(p);n.visible=!0;m.single&&f.hideAll(d);d.toggleTitleAttribute(!1);m.delay&&!b?n.showDelay=window.setTimeout(function(){d.showAfterDelay(a)},m.delay):d.showAfterDelay(a,b);return c},hide:function(a,b,c){n.hideTimeout=null;var m=a&&a.stopPropagation?null:e;a&&a.stopPropagation&&h.events.hide&&h.events.hide[a.type]&&(m=h.events.hide[a.type],m.process?m=m.process(e,a):(m.stopPropagation&&a.stopPropagation(),m.preventDefault&&a.preventDefault(),m=m.returnValue));!n.visible&&n.hideDelay&&
b&&(window.clearTimeout(n.hideDelay),n.hideDelay=null,n.visible=!0);if(!p||!n.visible||!d.isEnabled())return h.debug&&console.log("hide: elem/visible/enabled: ",p,n.visible,d.isEnabled()),m;if(n.showDelay)return h.hide.cancelShowDelay||c?(window.clearTimeout(n.showDelay),n.showDelay=null,n.visible=!1,h.debug&&console.log("hide: cancelShowDelay: ",d.getTarget())):h.debug&&console.log("hide: show delay was set",d.getTarget()),m;if(n.frozen)return h.debug&&console.log("hide: frozen",d.getTarget()),m;
if(!1===d.trigger("beforehide",e,a))return h.debug&&console.log("hide: beforehide returned false",d.getTarget()),m;Da(p);n.visible=!1;d.toggleTitleAttribute(!0);n.dynamicTarget&&d.resetDynamicTarget();h.hide.delay&&!b?n.hideDelay=window.setTimeout(function(){d.hideAfterDelay(a)},h.hide.delay):d.hideAfterDelay(a,b);return m},setPositionType:function(a){a&&(q(a)?(h.position.get=a,h.position.type=!1):(h.position.get=null,h.position.type=a));a=h.position.type;!1===a?n.position=!1:h.position.get&&"m"!=
a?n.position="fn":(a=a.substr(0,1),n.position="w"==a?"window":"m"==a?"mouse":"target");w&&(w.remove(),p&&w.render())},getPosition:function(a){if(!p)return null;var b,c=h.position;switch(n.position){case !1:return null;case "target":b=d.getTargetPosition(a);break;case "mouse":b=d.getMousePosition(a);break;case "window":b=d.getWindowPosition(a);break;case "fn":b=c.get.call(u,e,a)}if(!1!==c.screenX||!1!==c.screenY)b=d.correctScreenPosition(b,c.screenX,c.screenY);return b},reposition:function(b){b&&(b=
ba(b));if(b=d.getPosition(b))void 0!=b.x&&a(p,{left:b.x+"px"}),void 0!=b.y&&a(p,{top:b.y+"px"}),void 0==b.x&&void 0==b.y&&a(p,b)},getContentElem:function(){return p?h.selector.content?Q(h.selector.content,p).shift()||p:p:null},setContent:function(a,b){b=b||"";if(!p)return h.content.value=a,e;h.content.prepare&&(a=h.content.prepare(e,b,a));var c=e.getContentElem(),m=n.rendered&&!h.selector.content&&w,f=m&&w.getEl();if(m&&f)try{p.removeChild(f)}catch(t){}if(q(a))c.innerHTML=a;else for(var g in a){var k=
h.selector[g];k&&(k=Q(k,c).shift())&&(k.innerHTML=a[g])}if(m&&f)try{p.appendChild(f)}catch(u){}c=Q("img",c);n.images=c.length;g=-1;for(m=c.length;++g<m;D(c[g],"load",d.onImageLoad));d.trigger("contentchange",e,a,b);d.onContentChange();return e},readContent:function(){var a=e.getTarget(),b;a&&(b=h.content.attr?a.getAttribute(h.content.attr):a.getAttribute("tooltip")||a.getAttribute("title")||a.getAttribute("alt"));b&&d.setContent(b,"attribute");return e},loadContent:function(a){L(p,h.cls.loading);
a=s({},h.ajax,a,!0,!0);d.trigger("beforeajax",e,a);return ka(a).done(d.onAjaxLoad)},destroy:function(){d.trigger("destroy",e);ea(window,"resize",d.onWindowResize);ea(window,"scroll",d.onWindowScroll);d.destroyElem();w&&(w.destroy(),w=null);d.setHandlers("unbind");t.destroy();H=n=e=d=t=null},setFocus:function(){var a=h.show.focus,b;if(!0===a)if(a=Q("input",p).concat(Q("textarea",p)),0<a.length)a[0].focus();else{if(h.buttons)for(b in h.buttons){(b=Q(h.buttons[b],p).shift())&&b.focus();break}}else(b=
Q(a,p).shift())&&b.focus()}},!0,!1);s(d,e,{init:function(){f.register(d);h.modal&&(h.overlay.enabled=!0);d.setPositionType();d.setTarget(h.target);if(h.pointer.size||h.pointer.el)w=new g(d,h.pointer);h.render.lazy||d.render();d.setHandlers("bind")},setHandlers:function(a,b){for(var c=["show","hide","toggle"],m="bind"==a?D:ea,f="bind"==a?Fb:Gb,t,g,k,u,l,r,w,s,A,x;t=c.shift();)if(g=h[t].events,!1!==g){if(q(g)||M(g))n.dynamicTarget?(l={},l[g]=h.target,g={_html:l}):g={_target:g};for(k in g){if(b)if("_self"==
b){if("_self"!=k&&"_overlay"!=k&&">"!=k.substr(0,1))continue}else if(k!=b)continue;if("_self"!=k&&"_overlay"!=k&&">"!=k.substr(0,1)||p){if(w=g[k]){switch(k){case "_target":s=[d.getTarget()];break;case "_self":s=[p];break;case "_window":s=[window];break;case "_document":s=[document];break;case "_html":s=[document.documentElement];break;case "_overlay":s=[H];break;default:s=">"==k.substr(0,1)?Q(k.substr(1),p):Q(k)}if(s&&s.length)if(q(w)&&(w=[w]),M(w))for(l=0,r=w.length;l<r;l++)for(A=-1,x=s.length;++A<
x;m(s[A],w[l],e[t]));else for(u in w)for(A=-1,x=s.length;++A<x;f(s[A],w[u],u,e[t]));}}else n.bindSelfOnRender=!0}}},resetDynamicTarget:function(){var a=n.dynamicTargetEl;a&&(d.setHandlers("unbind","_target"),d.trigger("targetchange",e,null,a))},isDynamicTargetChanged:function(a){var b=h.target;a=a.target;for(var c=n.dynamicTargetEl;a&&!db(a,b);)a=a.parentNode;return a?!c||c!==a:!1},changeDynamicTarget:function(a){var b=h.target;a=a.target;for(var c=n.dynamicTargetEl;a&&!db(a,b);)a=a.parentNode;if(!a||
c&&c===a)return!1;c&&d.setHandlers("unbind","_target");n.dynamicTargetEl=a;d.setHandlers("bind","_target");d.trigger("targetchange",e,a,c);return!0},showAfterDelay:function(a,b){n.showDelay=null;if(n.visible){h.position.manual||d.reposition(a);"mouse"==n.position&&D(document.documentElement,"mousemove",d.onMouseMove);var c=h.position;(c.resize||c.screenX||c.screenY)&&D(window,"resize",d.onWindowResize);(c.scroll||c.screenX||c.screenY)&&D(window,"scroll",d.onWindowScroll);if(b||!1!==d.trigger("afterdelay",
e,a)){H&&(h.overlay.animateShow?d.animate("show",null,!0):H.style.display="");if(h.show.preventScroll){var c=h.show.preventScroll,m,f;!0===c&&(c="body");c=Q(c);m=-1;for(f=c.length;++m<f;D(c[m],"mousewheel",d.onPreventScroll)&&D(c[m],"touchmove",d.onPreventScroll));}h.show.animate&&!b?d.animate("show").done(function(){d.showAfterAnimation(a)}):d.showAfterAnimation(a)}else n.visible=!1,h.debug&&console.log("showAfterDelay: afterdelay returned false",e.getTarget())}else h.debug&&console.log("showAfterDelay: already hidden",
d.getTarget())},showAfterAnimation:function(a){n.visible?(S(p,h.cls.hidden),L(p,h.cls.visible),h.render.keepVisible||(p.style.display=""),h.hide.timeout&&(n.hideTimeout=window.setTimeout(d.hide,h.hide.timeout)),h.show.focus&&window.setTimeout(d.setFocus,20),d.trigger("show",e,a)):h.debug&&console.log("showAfterAnimation: already hidden",d.getTarget())},hideAfterDelay:function(a,b){n.hideDelay=null;if(n.visible)h.debug&&console.log("hideAfterDelay: already shown again",d.getTarget());else{"mouse"==
n.position&&ea(document.documentElement,"mousemove",d.onMouseMove);var c=h.position;(c.resize||c.screenX||c.screenY)&&ea(window,"resize",d.onWindowResize);(c.scroll||c.screenX||c.screenY)&&ea(window,"scroll",d.onWindowScroll);if(b||!1!==d.trigger("afterhidedelay",e,a)){if(h.show.preventScroll){var c=h.show.preventScroll,m,f;!0===c&&(c="body");c=Q(c);m=-1;for(f=c.length;++m<f;ea(c[m],"mousewheel",d.onPreventScroll)&&ea(c[m],"touchmove",d.onPreventScroll));}H&&(h.overlay.animateShow?d.animate("hide",
null,!0).done(function(){H.style.display="none"}):H.style.display="none");h.hide.animate&&!b?d.animate("hide").done(function(){d.hideAfterAnimation(a)}):d.hideAfterAnimation(a)}else n.visible=h.cls.hidden?!Ba(p,h.cls.hidden):!(0>=p.offsetWidth||0>=p.offsetHeight),h.debug&&console.log("hideAfterDelay: afterhdelay returned false",d.getTarget())}},hideAfterAnimation:function(a){n.visible?h.debug&&console.log("hideAfterAnimation: already shown again",d.getTarget()):(S(p,h.cls.visible),L(p,h.cls.hidden),
h.render.keepVisible||(p.style.display="none"),d.trigger("hide",e,a),a=h.render.lifetime,null!==a&&(0===a?d.destroyElem():n.destroyDelay=window.setTimeout(d.destroyElem,a)),p&&h.hide.destroy&&window.setTimeout(function(){I(p,h.instanceName,null);d.destroy()},0))},render:function(){if(p)h.debug&&console.log("element already rendered",p);else{var b=h.render,c=h.cls;if(b.fn){var m=b.fn.call(u,e);b[q(m)?"tpl":"el"]=m}b.el?q(b.el)?(p=Q(b.el).shift(),b.keepInDOM=!0):p=b.el:(m=document.createElement("div"),
m.innerHTML=b.tpl,p=m.firstChild);p||(p=document.createElement("div"));b.id&&p.setAttribute("id",b.id);h.render.keepVisible||(p.style.display="none");L(p,c.dialog);L(p,c.hidden);b.style&&a(p,b.style);h.overlay.enabled&&(H=document.createElement("div"),a(H,{display:"none",position:"fixed",left:0,top:0,right:0,bottom:0,opacity:h.overlay.opacity,backgroundColor:h.overlay.color}),document.body.appendChild(H),D(H,"click",d.onOverlayClick),b.zIndex&&a(H,{zIndex:b.zIndex}),h.overlay.cls&&L(H,h.overlay.cls));
b.appendTo?b.appendTo.appendChild(p):!1!==b.appendTo&&document.body.appendChild(p);b.zIndex&&a(p,{zIndex:b.zIndex});b=h.content;if(!1!==b.value)if(b.value)d.setContent(b.value);else if(b.fn)d.setContent(b.fn.call(u,e));else d[h.ajax.url?"loadContent":"readContent"]();w&&w.render();if(h.buttons)for(var f in h.buttons)if(b=Q(h.buttons[f],p).shift())I(b,"metaphorjsTooltip-button-id",f),D(b,"click",d.onButtonClick),D(b,"keyup",d.onButtonKeyup);n.bindSelfOnRender&&(d.setHandlers("bind","_self"),n.bindSelfOnRender=
!1);n.rendered=!0;d.trigger("render",e)}},animate:function(a,b,c){var e,m;e=c?"show"==a?h.overlay.animateShow:h.overlay.animateHide:h[a].animate;F(e)&&(e=e(d,b));m=e.skipDisplayChange||!1;ua(e)?e=a:q(e)&&(e=[e]);return aa(p,e,function(){"show"!=a||m||(c?H.style.display="":p.style.display="")})},toggleTitleAttribute:function(a){var b=e.getTarget(),c;b&&(!1===a?(I(b,"tmp-title",b.getAttribute("title")),b.removeAttribute("title")):(c=I(b,"tmp-title"))&&b.setAttribute("title",c))},changeDynamicContent:function(){h.content.fn?
d.setContent(h.content.fn.call(u,e)):h.content.attr&&d.readContent()},getDialogSize:function(){var b=h.cls.hidden?Ba(p,h.cls.hidden):!!(0>=p.offsetWidth||0>=p.offsetHeight),c,d=p.style.left;b&&(a(p,{left:"-1000px"}),p.style.display="");c={width:fa(p).width,height:fa(p).height};b&&(a(p,{left:d}),p.style.display="none");return c},getTargetSize:function(){var a=d.getTarget();return a?{width:fa(a).width,height:fa(a).height}:null},getTargetPosition:function(a,b){var c=d.getTarget();if(!c)return null;var e=
d.getDialogSize(),c=fa(c),m=d.getTargetSize(),f={};b=b||h.position.type;var g=b.substr(0,1),t=b.substr(1),k=h.position.offsetX,p=h.position.offsetY,u=w?w.getDialogPositionOffset():null;switch(g){case "t":f.y=c.top-e.height-p;break;case "r":f.x=c.left+m.width+k;break;case "b":f.y=c.top+m.height+p;break;case "l":f.x=c.left-e.width-k}switch(t){case "t":f.y=c.top+p;break;case "r":f.x=c.left+m.width-e.width-k;break;case "b":f.y=c.top+m.height-e.height-p;break;case "l":f.x=c.left+k;break;case "rc":f.x=
c.left+m.width+k;break;case "lc":f.x=c.left-e.width-k;break;case "":switch(g){case "t":case "b":f.x=c.left+m.width/2-e.width/2;break;case "r":case "l":f.y=c.top+m.height/2-e.height/2}}u&&(f.x+=u.x,f.y+=u.y);return f},getMousePosition:function(a){if(!a)return null;var b=d.getDialogSize(),c={},m=h.position.type.substr(1),f=h.position.offsetX,g=h.position.offsetY,t=h.position.axis,k=w?w.getDialogPositionOffset():null;switch(m){case "":c=h.position.get.call(u,e,a);break;case "t":c.y=a.pageY-b.height-
g;c.x=a.pageX-b.width/2;break;case "r":c.y=a.pageY-b.height/2;c.x=a.pageX+f;break;case "b":c.y=a.pageY+g;c.x=a.pageX-b.width/2;break;case "l":c.y=a.pageY-b.height/2;c.x=a.pageX-b.width-f;break;case "rt":c.y=a.pageY-b.height-g;c.x=a.pageX+f;break;case "rb":c.y=a.pageY+g;c.x=a.pageX+f;break;case "lt":c.y=a.pageY-b.height-g;c.x=a.pageX-b.width-f;break;case "lb":c.y=a.pageY+g,c.x=a.pageX-b.width-f}k&&(c.x+=k.x,c.y+=k.y);t&&(a=d.getTargetPosition(a,m))&&("x"==t?c.y=a.y:c.x=a.x);return c},getWindowPosition:function(){var a=
d.getDialogSize(),b={},c=h.position.type.substr(1),e=h.position.offsetX,m=h.position.offsetY,f=eb(),g=fb(),t=fa(window).width,k=fa(window).height;switch(c){case "c":b.y=k/2-a.height/2+f;b.x=t/2-a.width/2+g;break;case "t":b.y=f+m;b.x=t/2-a.width/2+g;break;case "r":b.y=k/2-a.height/2+f;b.x=t-a.width+g-e;break;case "b":b.y=k-a.height+f-m;b.x=t/2-a.width/2+g;break;case "l":b.y=k/2-a.height/2+f;b.x=g+e;break;case "rt":b.y=f+m;b.x=t-a.width+g-e;break;case "rb":b.y=k-a.height+f-m;b.x=t-a.width+g-e;break;
case "lt":b.y=f+m;b.x=g+e;break;case "lb":b.y=k-a.height+f-m,b.x=g+e}return b},correctScreenPosition:function(a,b,c){var e=d.getDialogSize(),h=eb(),m=fb(),f=fa(window).width,g=fa(window).height;c&&a.y+e.height>g+h-c&&(a.y=g+h-c-e.height);b&&a.x+e.width>f+m-b&&(a.x=f+m-b-e.width);c&&a.y<h+c&&(a.y=h+c);b&&a.x<m+b&&(a.x=m+b);return a},onMouseMove:function(a){d.reposition(ba(a))},onWindowResize:function(a){d.reposition(ba(a))},onWindowScroll:function(a){d.reposition(ba(a))},onPreventScroll:function(a){ba(a).preventDefault()},
onOverlayClick:function(a){return h.modal?(a=ba(a),a.preventDefault(),a.stopPropagation(),!1):null},onButtonClick:function(a){var b=ba(a).target;(b=I(b,"metaphorjsTooltip-button-id"))&&d.trigger("button",e,b,a)},onButtonKeyup:function(a){if(13==a.keyCode||32==a.keyCode){var b=I(a.target,"metaphorjsTooltip-button-id");b&&d.trigger("button",e,b,ba(a))}},onAjaxLoad:function(a){S(p,h.cls.loading);d.setContent(a,"ajax")},onImageLoad:function(){n.images--;d.onContentChange()},onContentChange:function(){n.visible&&
d.reposition()},destroyElem:function(){d.setHandlers("unbind","_self");n.bindSelfOnRender=!0;w&&w.remove();H&&(H.parentNode.removeChild(H),H=null);p&&(h.render.keepInDOM||p.parentNode.removeChild(p),p=null);d.trigger("lifetime",e)}},!0,!1);delete h.callback.scope;for(var A in h.callback)e.on(A,h.callback[A],u);h.target&&h.useHref&&(A=h.target.getAttribute("href"),"#"==A.substr(0,1)?h.render.el=A:h.ajax.url=A);d.init();return e};s(r,{defaults:{}});return r}();G.lib.Dialog=vb;K("MetaphorJs.cmp.Dialog",
"MetaphorJs.cmp.Component",{dialog:null,dialogPreset:null,dialogCfg:null,initComponent:function(){this.supr();this._createDialog();this._oldShow=this.show;this._oldHide=this.hide},_getDialogCfg:function(){return s({},this.dialogCfg||{},{render:{el:this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=new vb(this.dialogPreset,this._getDialogCfg());this.dialog.on("show",this._oldShow,this);this.dialog.on("hide",this._oldHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},
show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},onDialogDestroy:function(){this.destroying||(delete this.dialog,this.destroy())},onDestroy:function(){this.destroying=!0;this.dialog&&this.dialog.destroy();delete this.dialog;delete this.dialogCfg;delete this.dialogPreset;this.supr();this.destroying=!1}});var Na=function(a,c,b){var d,e=a.childNodes;if(!1!==c.call(b,a))for(a=-1,d=e.length>>>0;++a!==d;Na(e[a],c,b));},wb=function(){var a=0,c={},b=function(a,b){var c=0;switch(b.nodeName.toLowerCase()){case "select":return Na(b,
function(a){a.selected&&c++}),c;case "input":if(/radio|checkbox/i.test(b.type))return Na(b.form,function(a){a.type==b.type&&a.name==b.name&&a.checked&&c++}),c}return a.length},d=function(a,c){if(!c)return void 0===a||""===a||null===a;switch(c.nodeName.toLowerCase()){case "select":var d=sa(c);return!d||0==d.length;case "input":if(/radio|checkbox/i.test(c.type))return 0==b(a,c)}return 0==J(a).length},e=function(a,b){if(F(b))return a;M(b)||(b=[b]);var c,d=b.length;for(c=-1;++c<d;a=a.replace(new RegExp("\\{"+
c+"\\}","g"),b[c]));return a},f={};s(f,{required:function(a,b,c){return!1===c?!0:!d(a,b)},regexp:function(a,b,c){c=c instanceof RegExp?c:new RegExp(c);return d(a,b)||c.test(a)},notregexp:function(a,b,c){c=c instanceof RegExp?c:new RegExp(c);return d(a,b)||!c.test(a)},minlength:function(a,c,e){return d(a,c)||(c?b(J(a),c)>=e:a.toString().length>=e)},maxlength:function(a,c,e){return d(a,c)||(c?b(J(a),c)<=e:a.toString().length<=e)},rangelength:function(a,c,e){var f=c?b(J(a),c):a.toString().length;return d(a,
c)||f>=e[0]&&f<=e[1]},min:function(a,b,c){return d(a,b)||parseInt(a,10)>=c},max:function(a,b,c){return d(a,b)||parseInt(a,10)<=c},range:function(a,b,c){a=parseInt(a,10);return d(a,b)||a>=c[0]&&a<=c[1]},email:function(a,b){return d(a,b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a)},
url:function(a,b){return d(a,b)||/^((https?|ftp):\/\/|)(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a,b){return d(a,b)||!/Invalid|NaN/.test(new Date(a))},dateiso:function(a,b){return d(a,b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return d(a,b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return d(a,b)||/^\d+$/.test(a)},creditcard:function(a,b){if(d(a,b))return!0;if(/[^0-9-]+/.test(a))return!1;var c=0,e=!1,f;a=a.replace(/\D/g,"");for(var g=a.length-1;0<=g;g--)f=a.charAt(g),f=parseInt(f,10),e&&9<(f*=2)&&(f-=9),c+=f,e=!e;return 0==
c%10},accept:function(a,b,c){c=q(c)?c.replace(/,/g,"|"):"png|jpe?g|gif";return d(a,b)||a.match(new RegExp(".("+c+")$","i"))},equalto:function(a,b,c,d){c=(b=d.getValidator().getField(c))?b.getElem():c;return a==sa(c)},notequalto:function(a,b,c,d){c=(b=d.getValidator().getField(c))?b.getElem():c;return a!=sa(c)},zxcvbn:function(a,b,c){return zxcvbn(a).score>=parseInt(c)}});var g={required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",
date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:"Please enter no more than {0} characters.",minlength:"Please enter at least {0} characters.",rangelength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",
max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."},l={allowSubmit:!0,alwaysCheck:!1,alwaysDisplayState:!1,data:null,ignore:null,disabled:!1,cls:{valid:"",error:"",ajax:""},errorBox:{cls:"",fn:null,tag:"",position:"after",elem:null,enabled:!0},callback:{scope:null,destroy:null,statechange:null,errorchange:null,submit:null,check:null,beforeAjax:null,afterAjax:null,displaystate:null},rules:{},messages:{}},k=function(a){if(!a)return{};var b=
function(b,c,d){var e=a[b],f=!1;if(void 0!==e){switch(d){case "string":f=q(e);break;case "function":f=F(e);break;case "boolean":f=ua(e)}f&&(a[b]={},a[b][c]=e)}};b("errorBox","enabled","boolean");b("errorBox","tag","string");b("errorBox","fn","function");return a},r=function(a,b,c){b=b||{};var d,e;this._observable=new Z;s(this,this._observable.getApi());this.cfg=d=s({},l,k(v.fieldDefaults),k(b),!0,!0);this.input=new Ka(a,this.onInputChange,this,this.onInputSubmit);this.elem=a;this.vldr=c;this.callbackScope=
e=d.callback.scope;this.enabled=!a.disabled;this.id=a.getAttribute("name")||a.getAttribute.attr("id");this.data=b.data;this.rules={};d.messages=s({},g,v.messages,d.messages,!0,!0);a.setAttribute("data-validator",c.getVldId());this.input.radio&&this.initRadio();for(var f in d.callback)if(d.callback[f])this.on(f,d.callback[f],e);d.rules&&this.setRules(d.rules,!1);this.readRules();this.prev=this.input.getValue();d.disabled&&this.disable()};r.prototype={vldr:null,elem:null,rules:null,cfg:null,callbackScope:null,
input:null,enabled:!0,valid:null,dirty:!1,id:null,prev:"",error:null,errorRule:null,pending:null,rulesNum:0,displayState:!1,data:null,checking:!1,checkTmt:null,errorBox:null,customError:!1,getValidator:function(){return this.vldr},initRadio:function(){var a=this.input.radio,b=this.vldr.getVldId(),c,d;c=0;for(d=a.length;c<d;c++)a[c].setAttribute("data-validator",b)},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check(!1):this.setValidState(null);return this},
setRule:function(a,b,c){var d=this.rules;c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check(!1):this.setValidState(null);return this},setMessage:function(a,b){this.cfg.messages[a]=b;return this},setMessages:function(a){for(var b in a)this.setMessage(b,a[b]);return this},getMessages:function(){return s({},this.cfg.messages)},readRules:function(){var a=this.elem,b=a.className,c={},d,e;for(e in f)f.hasOwnProperty(e)&&
(d=a.getAttribute(e)||a.getAttribute("data-validate-"+e),null!==d&&void 0!=d&&!1!==d&&("minlength"!=e&&"maxlength"!=e||-1!=parseInt(d,10))&&(c[e]=d,(d=a.getAttribute("data-message-"+e))&&this.setMessage(e,d)));if(d=a.getAttribute("remote"))c.remote=d;if(b)for(b=b.split(" "),e=0,d=b.length;e<d;e++)if(a=J(b[e]),f[a]||"remote"==a)c[a]=!0;for(e in c)this.setRule(e,c[e],!1)},getRules:function(){return this.rules},hasRule:function(a){return this.rules[a]?!0:!1},getValue:function(){return this.input.getValue()},
getUserData:function(){return this.data},setUserData:function(a){var b=this.data;this.data=a;return b},isEmpty:function(){return d(this.getValue(),this.elem)},enable:function(){this.enabled=!0;this.vldr.reset();return this},disable:function(){this.enabled=!1;!1===this.valid&&(this.setValidState(!0),this.doDisplayState());return this},enableDisplayState:function(){this.displayState=!0},disableDisplayState:function(){this.displayState=!1},isDisplayStateEnabled:function(){return this.displayState},toggleErrorBox:function(a){var b=
this.cfg,c=b.errorBox.enabled;b.errorBox.enabled=a;!c&&a&&a.displayState&&!1===this.valid()&&this.doDisplayState()},isEnabled:function(){return this.enabled},getElem:function(){return this.elem},getName:function(){return this.id},getError:function(){return this.error},getErrorRule:function(){return this.errorRule},isValid:function(){return this.isEnabled()?this.customError?!1:!0===this.valid&&!this.pending||0===this.rulesNum:!0},getExactValidState:function(){return this.valid},setCustomError:function(a,
b){this.customError=a?!0:!1;this.setValidState(a?!1:!0);this.setError(!0===a?null:a,b);this.doDisplayState()},reset:function(){this.abort();this.dirty=!1;this.prev="";this.setValidState(null);this.setError(null);this.doDisplayState();return this},abort:function(){this.pending&&(this.pending.abort(),this.pending=null);return this},check:function(a){var b=this.rules,c=this.cfg,d=this.elem;if(!this.isEnabled())return!0;if(this.customError)return!1;if(0==this.rulesNum&&!1!==this.valid)return!0;if(this.checking)return this.checkTmt||
(this.checkTmt=setTimeout(B(this.checkTimeout,this),100)),!0===this.valid;this.checking=!0;if(!(!0===a||b.equalTo||b.notEqualTo||this.dirty||null===this.valid||c.alwaysCheck))return this.pending||this.doDisplayState(),this.checking=!1,!0===this.valid;var g=!0,k=!1,l=this.getValue(),n,q;for(q in b)if("remote"==q){if(this.dirty||c.alwaysCheck||null===this.valid||!0===a)if(l||b[q].checkEmpty)k=!0}else if(!0!==(n=(F(b[q])?b[q]:f[q]).call(this.callbackScope,l,d,b[q],this))){g=!1;this.setError(e(n||c.messages[q]||
"",b[q]),q);break}k=k&&g;g&&this.setError(null);k?this.ajaxCheck():(this.setValidState(g),this.doDisplayState());this.checking=this.dirty=!1;this.trigger("check",this,this.valid);return!0===this.valid&&!k},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,d=a.cls.valid,e=this.elem;this.displayState||a.alwaysDisplayState||(b=null);null===this.valid&&(b=null);c&&(!1===b?L(e,c):S(e,c));d&&(!0===b?L(e,d):S(e,d));c=this.getErrorBox();d=this.error;c&&(!1===b&&d&&(c.innerHTML=state.error),
c.style.display=!1===b&&d&&a.errorBox.enabled?"block":"none");this.trigger("displaystate",this,b,this.error)},getErrorBox:function(){var a=this.cfg.errorBox;return a.tag||a.fn||a.selector?(!this.errorBox&&a.enabled&&this.createErrorBox(),this.errorBox):null},destroy:function(){this.trigger("destroy",this);this.elem.removeAttribute("data-validator");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this.input.destroy();delete this.input;this._observable.destroy();delete this._observable;
delete this.vldr;delete this.cfg;delete this.errorBox;delete this.rules;delete this.elem},isPending:function(){return null!==this.pending},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("statechange",this,a))},setError:function(a,b){if(this.error!=a||this.errorRule!=b)this.error=a,this.errorRule=b,this.trigger("errorchange",this,a,b)},checkTimeout:function(){this.checkTmt=null;this.checking||this.check(!1)},onInputChange:function(a){this.prev!==a&&(this.dirty=!0,this.customError=
!1,this.abort(),this.pending||this.check(!1),this.prev=this.input.getValue())},onInputSubmit:function(a){a=ba(a);if(!(a.isDefaultPrevented&&a.isDefaultPrevented()||!1!==this.trigger("submit",this,a)))return a.preventDefault(),!1},createErrorBox:function(){var a=this.cfg.errorBox,b=a.tag,c=a.cls,d=a.fn,e=a.position,a=a.elem;d?this.errorBox=d.call(this.callbackScope,this):a?this.errorBox=a:(this.errorBox=document.createElement(b),this.errorBox.className=c,b=(b=this.input.radio)?b[b-1]:this.elem,"appendParent"==
e?b.parentNode.appendChild(this.errorBox):"before"==e?b.parentNode.insertBefore(this.errorBox,b):b.parentNode.insertBefore(this.errorBox,b.nextSibling))},ajaxCheck:function(){var a=this.elem,b=this.rules.remote,c=this.getValue(),d=this.cfg,b=s({},q(b)?{url:b}:b,!0);b.data=b.data||{};b.data[b.paramName||a.getAttribute("name")||a.getAttribute("id")]=c;b.handler||(b.dataType="text");b.cache=!1;d.cls.ajax&&L(a,d.cls.ajax);this.trigger("beforeAjax",this,b);this.pending=(window.MetaphorJs?G.ajax:jQuery.ajax)(b);
this.pending.done(B(this.onAjaxSuccess,this));this.pending.fail(B(this.onAjaxError,this))},onAjaxSuccess:function(a){var b=this.rules,c=this.cfg;this.pending=null;var d=!0;b.remote.handler?(a=b.remote.handler.call(this.callbackScope,this,a),!0!==a&&(this.setError(e(a||c.messages.remote||"",b.remote),"remote"),d=!1)):a?(this.setError(a,"remote"),d=!1):this.setError(null);c.cls.ajax&&S(this.elem,c.cls.ajax);this.setValidState(d);this.doDisplayState();this.trigger("afterAjax",this)},onAjaxError:function(a,
b){var c=this.cfg;c.cls.ajax&&S(this.elem,c.cls.ajax);this.pending=null;"abort"!=b&&"abort"!=a&&(this.setValidState(!1),this.doDisplayState(),this.trigger("afterAjax",this))}};var z={alwaysCheck:!1,alwaysDisplayState:!1,disabled:!1,value:null,elem:null,errorBox:null,errorField:null,data:null,cls:{valid:"",error:""},fields:[],rules:{},messages:{},callback:{scope:null,destroy:null,statechange:null,errorchange:null,displaystate:null}},x=function(a,b){a=a||{};var c,d;this._observable=new Z;this._vldr=
b;s(this,this._observable.getApi());this.cfg=c=s({},z,v.groupDefaults,a,!0,!0);this.callbackScope=d=c.callback.scope;this.data=a.data;this.el=a.elem;this.fields={};this.rules={};c.messages=s({},g,v.messages,c.messages,!0,!0);var e;if(c.callback)for(e in c.callback)if(c.callback[e])this.on(e,c.callback[e],d);c.rules&&this.setRules(c.rules,!1);if(c.fields)for(e=0,d=a.fields.length;e<d;e++)this.add(b.getField(c.fields[e]));this.enabled=!c.disabled};x.prototype={fields:null,rules:null,cfg:null,callbackScope:null,
vldr:null,enabled:!1,invalid:null,valid:null,displayState:!1,rulesNum:0,error:null,data:null,errorBox:null,el:null,enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},isValid:function(){return!this.enabled||0===this.invalid&&!0===this.valid},getExactValidState:function(){return this.valid},reset:function(){this.invalid=0;this.setValidState(null);this.setError(null);this.doDisplayState();return this},getUserData:function(){return this.data},
getName:function(){return this.cfg.name},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check():this.setValidState(null);return this},setRule:function(a,b,c){var d=this.rules;c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check():this.setValidState(null);return this},getRules:function(){return s({},this.rules)},hasRule:function(a){return this.rules[a]?!0:!1},setError:function(a){var b=
this.cfg;this.error!=a&&(b.errorField?(this.vldr.getField(b.errorField).setError(a),this.error=null):(this.error=a,this.trigger("errorchange",this,a)))},getError:function(){return this.error},getFields:function(){return this.fields},enableDisplayState:function(){this.displayState=!0;return this},disableDisplayState:function(){this.displayState=!1;return this},check:function(){var a=this.cfg,b=this.fields,c=this.rules;if(!this.enabled||0==this.rulesNum)return this.setValidState(null),this.doDisplayState(),
!0;this.countInvalid();if(0<this.invalid)return this.setValidState(null),this.doDisplayState(),!0;var d={},g=!0,k=null,l;if(a.value){for(l in b)d[l]=b[l].getValue();k=a.value.call(this.callbackScope,d,this)}for(l in c)if(!0!==(b=(F(c[l])?c[l]:f[l]).call(this.callbackScope,k,null,c[l],this,d))){g=!1;b||a.messages[l]?this.setError(e(b||a.messages[l]||"",c[l])):this.setError(null);break}g&&this.setError(null);this.setValidState(g);this.doDisplayState();return!0===this.valid},doDisplayState:function(){var a=
this.valid,b=this.cfg;this.displayState||b.alwaysDisplayState||(a=null);if(b.errorBox){var c=this.getErrorBox();null!==a?c&&(c.innerHTML=this.error||"",c.style.display=!1===this.valid?"block":"none"):c&&(c.style.display="none")}c=b.cls.error;b=b.cls.valid;a=this.valid;c&&(!1===a?L(this.el,c):S(this.el,c));b&&(!0===a?L(this.el,b):S(this.el,b));this.trigger("displaystate",this,this.valid)},getErrorBox:function(){var a=this.cfg,b=this.fields,c=a.errorBox;if(b[c])return b[c].getErrorBox();this.errorBox||
(F(a.errorBox)?this.errorBox=a.errorBox.call(this.callbackScope,this):this.errorBox=a.errorBox);return this.errorBox},destroy:function(){var a=this.fields,b;for(b in a)a[b]&&(this.setFieldEvents(a[b],"un"),delete a[b]);this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this._observable.destroy();delete this._observable;delete this.vldr;delete this.rules;delete this.fields;delete this.cfg},add:function(a){var b=this.fields,c=a.getName();b[c]||(b[c]=a,this.setFieldEvents(a,"on"))},setFieldEvents:function(a,
b){a[b]("statechange",this.onFieldStateChange,this)},remove:function(a){var b=this.fields,c=a.getName();b[c]&&(delete b[c],this.setFieldEvents(a,"un"));return this},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("statechange",this,a))},countInvalid:function(){var a=this.fields;this.invalid=0;for(var b in a)this.invalid+=a[b].isValid()?0:1},onFieldStateChange:function(a,b){this.trigger("fieldstatechange",this,a,b);this.check()}};var y={form:null,all:{},fields:{},rules:{},cls:{valid:"",
error:"",checking:""},groups:{},callback:{scope:null,destroy:null,reset:null,beforesubmit:null,submit:null,statechange:null,check:null,displaystate:null,displaystatechange:null}},v=function(b,d,e){var f=b.nodeName.toLowerCase();this.vldId=++a;c[this.vldId]=this;b.setAttribute("data-validator",this.vldId);this.el=b;d&&!q(d)&&(e=d,d=null);this._observable=new Z;this.cfg=b=s({},y,v.defaults,v[d],e,!0,!0);this.callbackScope=d=b.callback.scope;this.isForm="form"==f;this.isField=/input|select|textarea/.test(f);
this.fields={};this.groups={};s(this,this._observable.getApi());this.onRealSubmitClickDelegate=B(this.onRealSubmitClick,this);this.resetDelegate=B(this.reset,this);this.onSubmitClickDelegate=B(this.onSubmitClick,this);this.onFormSubmitDelegate=B(this.onFormSubmit,this);delete b.callback.scope;var g,k;for(k in b.callback)this.on(k,b.callback[k],d);this.initFields();f=this.fields;for(g in b.rules)f[g]&&f[g].setRules(b.rules[g],!1);b.rules=null;for(g in b.groups)this.addGroup(g,b.groups[g]);this.initForm("bind");
delete b.rules;delete b.fields;delete b.groups;this.enabled=!0};v.prototype={vldId:null,el:null,cfg:null,enabled:!1,invalid:null,pending:0,grps:0,outside:!0,submitted:!1,displayState:!1,isForm:!1,isField:!1,submitButton:null,hidden:null,callbackScope:null,_observable:null,fields:null,groups:null,getVldId:function(){return this.vldId},getElem:function(){return this.el},getGroup:function(a){return this.groups[a]||null},getField:function(a){return this.fields[a]||null},enable:function(){this.enabled=
!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},enableDisplayState:function(){var a=this.fields,b=this.groups,c;if(!0!==this.displayState){this.displayState=!0;for(c in a)a[c].enableDisplayState();for(c in b)b[c].enableDisplayState();this.trigger("displaystatechange",this,!0)}return this},disableDisplayState:function(){var a=this.groups,b=this.fields,c;if(!1!==this.displayState){this.displayState=!1;for(c in b)b[c].disableDisplayState();for(c in a)a[c].disableDisplayState();
this.trigger("displaystatechange",this,!1)}return this},isDisplayStateEnabled:function(){return this.displayState},isValid:function(){return!1===this.enabled?!0:0===this.invalid&&0===this.pending&&0===this.grps&&!0===this.outside},getErrors:function(a){var b=!0==a?[]:{},c,d,e,f=[this.fields,this.groups],g;if(!this.isEnabled())return b;for(e=0;2>e;e++)for(d in g=f[e],g)null===g[d].getExactValidState()&&g[d].check(),g[d].isValid()||(c=g[d].getError())&&(a?b.push(c):b[d]=c);return b},check:function(){var a=
this.fields,b=this.groups;if(!this.isEnabled())return!0;var c=this.isValid(),d;for(d in a)a[d].check();for(d in b)b[d].check();this.outside=!1!==this.trigger("check",this);a=this.isValid();c!=a&&(this.doDisplayState(),this.trigger("statechange",this,!1));return a},add:function(a,b){if(!$a(a)||null!==a.getAttribute("data-no-validate")||null!==a.getAttribute("data-validator"))return this;var c=a.getAttribute("name")||a.getAttribute("id"),d=this.cfg,e=this.fields;if(!c)return this;c=d.fields&&d.fields[c]?
d.fields[c]:b||{};q(c)&&(c={rules:[c]});c=s({},d.all||{},c,!0,!0);if(c.ignore)return this;c.callback||(c.callback={scope:this.callbackScope});d=new r(a,c,this);c=d.getName();if(e[c])return this;e[c]=d;this.setFieldEvents(d,"on");this.displayState&&d.enableDisplayState();this.isEnabled()&&null!==this.invalid&&d.check();return this},addGroup:function(a,b){var c=this.groups;c[a]||(b.name=a,c[a]=new x(b,this),this.setGroupEvents(c[a],"on"),this.isEnabled()&&null!==this.invalid&&c[a].check())},focusInvalid:function(){var a=
this.fields,b;for(b in a)if(!a[b].isValid()){a[b].getElem().focus();break}},reset:function(){var a=this.fields,b=this.groups,c;this.submitted=!1;this.disableDisplayState();for(c in b)b[c].reset();for(c in a)a[c].reset();this.pending=0;this.invalid=null;this.grps=0;this.outside=!1;this.doDisplayState();this.trigger("reset",this);return this},submit:function(){var a=this.el;if(this.isForm)if(F(a.submit))!1!==this.trigger("beforesubmit",this)&&!1!==this.trigger("submit",this)&&a.submit();else this.onSubmit();
else this.onSubmit()},setFieldEvents:function(a,b){a[b]("statechange",this.onFieldStateChange,this);a[b]("beforeAjax",this.onBeforeAjax,this);a[b]("afterAjax",this.onAfterAjax,this);a[b]("submit",this.onFieldSubmit,this);a[b]("destroy",this.onFieldDestroy,this)},setGroupEvents:function(a,b){a[b]("statechange",this.onGroupStateChange,this)},initFields:function(){var a=this.el,b,c;if(this.isField)return this.add(a),this;a=Q("input, textarea, select",a);b=-1;for(c=a.length;++b<c;this.add(a[b]));return this},
initForm:function(a){var b=this.el,c=b.getElementsByTagName("input"),d=Q(".submit",b),e=Q(".reset",b);a="bind"==a?D:ea;var f,g,k,l;f=0;for(g=c.length;f<g;f++)l=c[f],k=l.type,"submit"==k?a(l,"click",this.onRealSubmitClickDelegate):"reset"==k&&a(l,"click",this.resetDelegate);f=-1;for(g=d.length;++f<g;"submit"!=d[f].type&&a(d[f],"click",this.onSubmitClickDelegate));f=-1;for(g=e.length;++f<g;"reset"!=e[f].type&&a(e[f],"click",this.resetDelegate));this.isForm&&a(b,"submit",this.onFormSubmitDelegate)},
onRealSubmitClick:function(a){a=ba(a||window.event);this.submitButton=a.target||a.srcElement;return this.onSubmit(a)},onSubmitClick:function(a){return this.onSubmit(ba(a||window.event))},onFormSubmit:function(a){a=ba(a);if(!this.isValid())return a.preventDefault(),!1},onFieldSubmit:function(a,b){this.enableDisplayState();this.submitted=!0;return this.onSubmit(b)},onSubmit:function(a){this.enableDisplayState();if(this.pending)return a&&a.preventDefault(),!1;var b=this.submitButton?!0:!1;this.isForm&&
(this.hidden&&(this.el.removeChild(this.hidden),this.hidden=null),this.submitButton&&/input|button/.test(this.submitButton.nodeName)&&(this.hidden=document.createElement("input"),this.hidden.type="hidden",this.hidden.setAttribute("name",this.submitButton.name),this.hidden.value=this.submitButton.value,this.el.appendChild(this.hidden)));this.submitButton=null;if(!this.isValid()&&(this.check(),this.onFieldStateChange(),this.pending))return a&&a.preventDefault(),!1;if(!1===this.trigger("beforesubmit",
this)||!this.isValid())return a&&(a.preventDefault(),a.stopPropagation()),this.pending||(this.focusInvalid(),this.submitted=!1),this.trigger("failedsubmit",this,b),!1;this.pending||(this.submitted=!1);return!1!==this.trigger("submit",this)},onFieldDestroy:function(a){a=a.getElem();a=a.getAttribute("name")||a.getAttribute("id");delete this.fields[a]},onFieldStateChange:function(a,b){var c=this.invalid,d=this.fields;this.invalid=0;for(var e in d)this.invalid+=d[e].isValid()?0:1;a&&this.trigger("fieldstatechange",
this,a,b);if(null===c||null!==c&&this.invalid!==c)this.doDisplayState(),this.trigger("statechange",this,this.isValid())},onGroupStateChange:function(){var a=this.groups,b=this.grps;this.grps=0;for(var c in a)this.grps+=a[c].isValid()?0:1;if(null===b||null!==b&&this.grps!==b)this.doDisplayState(),this.trigger("statechange",this,this.isValid())},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,a=a.cls.valid,d=this.el;if(this.isField||!this.displayState)b=null;null===this.invalid&&
(b=null);c&&(!1===b?L(d,c):S(d,c));a&&(!0===b?L(d,a):S(d,a));this.trigger("displaystate",this,b)},onBeforeAjax:function(){this.pending++;this.cfg.cls.ajax&&L(this.el,this.cfg.cls.ajax)},onAfterAjax:function(){var a=this.fields,b=this.cfg;this.pending=0;for(var c in a)this.pending+=a[c].isPending()?1:0;this.doDisplayState();b.cls.ajax&&S(this.el,b.cls.ajax);this.submitted&&0==this.pending&&(this.submitted=!1,this.isValid()?this.submit():this.focusInvalid())},destroy:function(){var a=this.groups,b=
this.fields,d;this.reset();this.trigger("destroy",this);delete c[this.vldId];for(d in a)a.hasOwnProperty(d)&&a[d]&&(this.setGroupEvents(a[d],"un"),a[d].destroy(),delete a[d]);for(d in b)b.hasOwnProperty(d)&&b[d]&&(this.setFieldEvents(b[d],"un"),b[d].destroy(),delete b[d]);this._observable.destroy();delete this._observable;this.initForm("unbind");delete this.fields;delete this.groups;delete this.el;delete this.cfg}};v.defaults={};v.messages={};v.fieldDefaults={};v.groupDefaults={};v.addMethod=function(a,
b,c){f[a]||(f[a]=b,c&&(v.messages[a]=c))};v.getValidator=function(a){a=a.getAttribute("data-validator");return c[a]||null};return v}();G.lib.Validator=wb;K("MetaphorJs.view.Validator",{node:null,scope:null,validator:null,scopeState:null,initialize:function(a,c){this.node=a;this.scope=c;this.scopeState={};this.validator=this.createValidator();this.initScope();this.initScopeState();this.initValidatorEvents()},createValidator:function(){var a=this.node,c={},b;if(b=a.getAttribute("mjs-validator-submit"))c.callback=
c.callback||{},c.callback.submit=function(a,b){return function(){try{return a(b)}catch(c){ra(c)}}}(bb(b),this.scope);return new wb(a,c)},initValidatorEvents:function(){var a=this.validator;a.on("fieldstatechange",this.onFieldStateChange,this);a.on("statechange",this.onFormStateChange,this);a.on("displaystatechange",this.onDisplayStateChange,this);a.on("reset",this.onFormReset,this)},initScope:function(){var a=this.scope,c=this.node,c=c.getAttribute("name")||c.getAttribute("id")||"$form";a[c]=this.scopeState},
initScopeState:function(){var a=this.node,c=this.scopeState,b,d,e;a.elements?b=a.elements:(b=[],Na(a,function(a){$a(a)&&b.push(a)}));a=-1;for(e=b.length;++a<e;)d=b[a],(d=d.getAttribute("name")||d.getAttribute("id"))&&!c[d]&&(c[d]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null});c.$invalid=!1;c.$pristine=!0;c.$submit=B(this.validator.onSubmit,this.validator)},onDisplayStateChange:function(a,c){if(c){c=this.scopeState;var b,d;for(b in c)d=c[b],d.$real&&(c[b]=d.$real);c.$invalid=!a.isValid();
c.$pristine=!1;this.scope.$check()}else this.onFormReset(a)},onFormReset:function(a){a=this.scopeState;var c,b;for(c in a)b=a[c],b.$error=null,b.$errorMessage=null,b.$invalid=null,b.$pristine=!0;a.$invalid=!1;a.$pristine=!0;this.scope.$check()},onFormStateChange:function(a,c){var b=this.scopeState;b.$invalid=!1===c&&a.isDisplayStateEnabled();b.$pristine=!1;this.scope.$check()},onFieldStateChange:function(a,c,b){var d=this.scopeState,e=c.getName();a=a.isDisplayStateEnabled();c={$error:c.getErrorRule(),
$errorMessage:c.getError(),$invalid:!1===b,$pristine:null===c.getExactValidState()};a?d[e]=c:d[e].$real=c;this.scope.$check()}});T("mjs-validate",250,function(a,c,b){b=b||"MetaphorJs.view.Validator";var d=oa(b);d?new d(c,a):ra(Error("Class '"+b+"' not found"))});G.onReady=sb;G.initApp=tb;G.cs=Fa;G.resolveComponent=xa;G.animate=aa;G.stopAnimation=Da;G.ajax=ka;G.trim=J;G.pushUrl=xb;G.currentUrl=hb;"undefined"!=typeof global?global.MetaphorJs=G:window.MetaphorJs=G})();
