define("metaphorjs","metaphorjs-observable metaphorjs-promise metaphorjs-ajax metaphorjs-animate metaphorjs-input metaphorjs-class metaphorjs-namespace metaphorjs-select metaphorjs-validator metaphorjs-watchable metaphorjs-dialog metaphorjs-history".split(" "),function(E,u,pa,t,fa,X,A,qa,Ca,R,Da,L){var Ea=fa.getValue,ra=fa.setValue,Fa=L.pushUrl,p={lib:{},cmp:{},view:{}},B=new A(p,"MetaphorJs");X=new X(B);var n=X.define,w=Function.prototype.bind?function(l,a){return l.bind(a)}:function(l,a){return function(){return l.apply(a,
arguments)}},Y=Array.prototype.slice,Z=function(l){return!(!l||l.constructor!==Object)},aa=function(l){return"boolean"==typeof l},r=function(l){return"undefined"==typeof l},v=function a(){var b=!1,c=!1,d=Y.call(arguments),e=d.shift(),g,f,h;aa(d[d.length-1])&&(b=d.pop());aa(d[d.length-1])&&(c=b,b=d.pop());for(;d.length;)if(g=d.shift())for(f in g)if(g.hasOwnProperty(f)&&!r(h=g[f]))if(c)if(e[f]&&Z(e[f])&&Z(h))a(e[f],h,b,c);else{if(!0===b||r(e[f])||null===e[f])Z(h)?(e[f]={},a(e[f],h,b,!0)):e[f]=h}else if(!0===
b||r(e[f])||null===e[f])e[f]=h;return e};A=function(){};var x=function(a){this.$$observable=new E;v(this,a,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)};x.prototype={$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$checking:!1,$$destroyed:!1,$new:function(){return new x({$parent:this,$root:this.$root,$app:this.$app})},$newIsolated:function(){return new x({$app:this.$app})},
$on:function(a,b,c){return this.$$observable.on(a,b,c)},$un:function(a,b,c){return this.$$observable.un(a,b,c)},$watch:function(a,b,c){return R.create(this,a,b,c,null)},$unwatch:function(a,b,c){return R.unsubscribeAndDestroy(this,a,b,c)},$get:function(a){for(var b=this;b;){if(void 0!=b[a])return b[a];b=b.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$check:function(){var a;this.$$checking||(this.$$checking=!0,this.$$watchers&&(a=this.$$watchers.$checkAll()),
this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",a))},$destroy:function(){this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;delete this.$app;delete this.$root;delete this.$parent;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);this.$$destroyed=!0}};var S=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]="0";else return a[b]=
String.fromCharCode(c+1),a.join("")}a.unshift("0");return a.join("")}}(),Ga=Object.prototype.toString,M=function(a){return null!=a&&"object"===typeof a},F=function(a){var b;if(b=a&&M(a))b=a.length,b="number"==typeof b&&!isNaN(b);return!(!b||"[object Array]"!=Ga.call(a))},y=function(a){return"string"==typeof a},C=function(a){if(!a||r(a.length)||y(a))return a?[a]:[];for(var b=[],c=-1,d=a.length>>>0;++c!==d;b[c]=a[c]);return b},T=function(a){return"function"===typeof a},ba=function(a){var b;return a&&
(M(a)||T(a))?T(b=a.then)?b:!1:!1},N=B.get,Ha=function(a,b,c){setTimeout(function(){a.apply(b,c||[])},0)},G=function(a){var b=a.stack||Error().stack;Ha(function(){!r(console)&&console.log&&(console.log(a),b&&console.log(b))})},ga=function(){var a=document.createTextNode("");return y(a.textContent)?"textContent":"nodeValue"}(),H=function(){return String.prototype.trim?function(a){return y(a)?a.trim():a}:function(a){return y(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),sa=function(){var a=/\\{/g,
b=new E,c=function(a,b,c,h,k){return!b||!y(b)||-1==b.indexOf("{{")&&-1==b.indexOf("{[")?null:new d(a,b,c,h,k)},d=function(a,b,c,d,k){this.id=S();this.origin=b;this.scope=a;this.parent=c;this.isRoot=!c;this.data=d;this.lang=a.$app.lang;if(!0===k||!1===k)this.recursive=k;this.watchers=[];this.children=[];this.dataChangeDelegate=w(this.doDataChange,this);this.processed=this.processText(b);this.render()};d.prototype={id:null,parent:null,isRoot:null,scope:null,origin:"",processed:null,text:null,watchers:null,
children:null,data:null,recursive:!1,dataChangeDelegate:null,changeTmt:null,lang:null,subscribe:function(a,c){return b.on(this.id,a,c)},unsubscribe:function(a,c){return b.un(this.id,a,c)},getString:function(){null===this.text&&this.render();var b=this.text;return-1!=b.indexOf("\\{")?b.replace(a,"{"):b},render:function(){var a=this.processed,b,c,h;this.children.length||this.createChildren();h=this.children;b=-1;for(c=h.length;++b<c;a=a.replace("---"+b+"---",h[b]instanceof d?h[b].getString():h[b]));
return this.text=a},processText:function(a){for(var b=0,c=a.length,d,k,m="";b<c;)if(-1!=(d=a.indexOf("{{",b))&&-1!=(k=a.indexOf("}}",d+2))&&"\\"!=a.substr(d-1,1))m+=a.substring(b,d),k!=d+2&&(m+=this.watcherMatch(a.substring(d+2,k))),b=k+2;else{b!==c&&(m+=a.substring(b));break}b=0;a=m;c=a.length;for(m="";b<c;)if(-1!=(d=a.indexOf("{[",b))&&-1!=(k=a.indexOf("]}",d+2))&&"\\"!=a.substr(d-1,1))m+=a.substring(b,d),k!=d+2&&(m+=this.watcherMatch(a.substring(d+2,k),!0)),b=k+2;else{b!==c&&(m+=a.substring(b));
break}return m},watcherMatch:function(a,b){var c=this.watchers;if(b){a=H(a);var d=a.split("|"),k=H(d[0]);"."!=k.substr(0,1)&&(d[0]="'"+k+"'");1==d.length&&d.push("l");a=d.join(" | ")}c.push(I(this.scope,a,this.onDataChange,this,null,B));return"---"+(c.length-1)+"---"},onDataChange:function(){this.changeTmt||(this.changeTmt=setTimeout(this.dataChangeDelegate,0))},doDataChange:function(){this.destroyChildren();this.triggerChange();this.changeTmt=null},triggerChange:function(){this.text=null;this.isRoot?
b.trigger(this.id,this,this.data):this.parent.triggerChange()},createChildren:function(){var a=this.watchers,b=this.children,d=this.scope,h=this.recursive,k,m,ha;k=-1;for(m=a.length;++k<m;)ha=a[k].getLastResult(),b.push(h&&c(d,ha,this,null,!0)||ha)},destroyChildren:function(){var a=this.children,b,c;b=-1;for(c=a.length;++b<c;)a[b]instanceof d&&a[b].destroy();this.children=[]},destroyWatchers:function(){var a=this.watchers,b,c;b=-1;for(c=a.length;++b<c;a[b].unsubscribeAndDestroy(this.onDataChange,
this));this.watchers=[]},destroy:function(){this.destroyChildren();this.destroyWatchers();b.destroyEvent(this.id);delete this.watchers;delete this.children;delete this.origin;delete this.processed;delete this.text;delete this.scope;delete this.data;delete this.dataChangeDelegate;delete this.lang;this.changeTmt&&clearTimeout(this.changeTmt);delete this.changeTmt}};d.create=c;return d}(),q=B.add,ia=function(){var a=[],b=[],c=!1,d=!1,e=function(a,b){return a.priority<b.priority?-1:a.priority>b.priority?
1:0};return{registerAttributeHandler:function(b,d,e){N("attr."+b,!0)||(a.push({priority:d,name:b,handler:q("attr."+b,e)}),c=!1)},getAttributeHandlers:function(){c||(a.sort(e),c=!0);return a},registerTagHandler:function(a,c,e){N("tag."+a,!0)||(b.push({priority:c,name:a,handler:q("tag."+a,e)}),d=!1)},getTagHandlers:function(){d||(b.sort(e),d=!0);return b}}}(),Ia=ia.getAttributeHandlers,ja=function(){var a=null,b=sa.create,c=function(a,b,c,d,e,f){var h=[];if(a&&!0!==a){if(a.nodeType){f.countdown+=1;
g(a,c,d,e,f);return}h=C(a)}h.length||(h=C(b.childNodes));b=h.length;f.countdown+=b;for(a=-1;++a<b;g(h[a],c,d,e,f));},d=function(a,b){if(b)if(b.nodeType)a.push(b);else if(F(b))for(var c=-1,e=b.length;++c<e;d(a,b[c]));},e=/^(script|template|mjs-template|style)$/i,g=function(a,b,d,g,f){if(a){var h,l=a.nodeName;f||(f={countdown:1});if(!l||!l.match(e)){if(a.nodeType)try{h=b.call(d,a)}catch(p){G(p)}if(!1!==h){if(ba(h)){h.done(function(e){!1!==e&&c(e,a,b,d,g,f);0==--f.countdown&&g&&g.call(d)});return}c(h,
a,b,d,g,f)}}0==--f.countdown&&g&&g.call(d)}},f=new E,h=function(a,b,c){this.id=S();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof x&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",this.destroy,this)};h.prototype={id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,on:function(a,b,c){return f.on(a+"-"+this.id,b,c)},un:function(a,b,c){return f.un(a+"-"+this.id,b,c)},createChild:function(a){return new h(a,this.scope,this)},getEl:function(){return this.el},
runHandler:function(a,b,c,d){var e=a.$isolateScope?b.$newIsolated():a.$breakScope?b.$new():b;b=b.$app;var g={$scope:e,$node:c,$attrValue:d,$renderer:this};c=[e,c,d,this];return a.__isMetaphorClass?(c=b.inject(a,null,!0,g,c),a.$stopRenderer?!1:c):b.inject(a,null,!1,g,c)},processNode:function(c){var e=c.nodeType,g=this.texts,f=this.scope,h,l;if(3==e){if(l=null!==c.parentNode.getAttribute("mjs-recursive"),h=b(f,c[ga],null,g.length,l))h.subscribe(this.onTextChange,this),g.push({node:c,tr:h}),this.renderText(g.length-
1)}else if(1==e){a||(a=Ia());var p=c.attributes;h=[];var n=[],s,q,z,e="tag."+c.tagName.toLowerCase();if(s=N(e,!0)){z=this.runHandler(s,f,c);if(!1===z)return!1;ba(z)?h.push(z):d(n,z)}s=0;for(q=a.length;s<q;s++)if(l=a[s].name,null!==(z=c.getAttribute(l))){z=this.runHandler(a[s].handler,f,c,z);c.removeAttribute(l);if(!1===z)return!1;ba(z)?h.push(z):d(n,z)}if(h.length){var r=new u;u.all(h).done(function(a){d(n,a);r.resolve(n)});return r}l=null!==c.getAttribute("mjs-recursive");s=0;for(q=p.length;s<q;s++)!N(e,
!0)&&(h=b(f,p[s].value,null,g.length,l))&&(h.subscribe(this.onTextChange,this),g.push({node:c,attr:p[s].name,tr:h}),this.renderText(g.length-1));return n.length?n:!0}return!0},process:function(){g(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){f.trigger("rendered-"+this.id,this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.tr.getString(),c=a.attr;c?(a.node.setAttribute(c,b),"value"==c&&(a.node.value=
b),"class"==c&&(a.node.className=b)):a.node[ga]=b},destroy:function(){var a=this.texts,b,c;if(!this.destroyed){this.destroyed=!0;b=-1;for(c=a.length;++b<c;a[b].tr.destroy());this.parent&&this.parent.un("destroy",this.destroy,this);delete this.texts;delete this.el;delete this.scope;delete this.parent;f.trigger("destroy-"+this.id)}}};return h}(),ta=function(){var a,b=function(){this.store={}};b.prototype={store:null,getApi:function(){return{value:w(this.value,this),constant:w(this.constant,this),factory:w(this.factory,
this),service:w(this.service,this),provider:w(this.provider,this),resolve:w(this.resolve,this),inject:w(this.inject,this)}},instantiate:function(a,b){var e=function(){},g;e.prototype=a.prototype;e=new e;g=a.prototype.constructor.apply(e,b);return M(g)?g:e},inject:function(a,b,e,g,f){g=g||{};f=f||[];if(T(a))if(a.inject)f=Y.call(a.inject),f.push(a),a=f;else return e||a.__isMetaphorClass?this.instantiate(a,f):a.apply(b,f);a=Y.call(a);var h=this;f=[];var k=a.pop(),m,l;m=-1;for(l=a.length;++m<l;f.push(h.resolve(a[m],
g)));return u.all(f).then(function(a){return e||k.__isMetaphorClass?h.instantiate(k,a):k.apply(b,a)})},value:function(a,b){this.store[a]={type:1,value:b}},constant:function(a,b){var e=this.store;e[a]||(e[a]={type:2,value:b})},factory:function(a,b,e,g){aa(e)&&(g=e,e=null);this.store[a]={type:3,singleton:g,fn:b,context:e}},service:function(a,b,e){this.store[a]={type:4,singleton:e,fn:b}},provider:function(a,b){this.store[a+"Provider"]={name:a,type:5,fn:b,instance:null}},resolve:function(b,d){var e=this.store,
g,f,h;if(!r(d[b]))return d[b];if(f=e[b]){g=f.type;if(1==g||2==g)return f.value;if(3==g)h=this.inject(f.fn,f.context,!1,d);else if(4==g)h=this.inject(f.fn,null,!0,d);else if(5==g)return f.instance||(f.instance=u.resolve(this.inject(f.fn,null,!0,d)).done(function(a){f.instance=a;e[f.name]={type:3,fn:a.$get,context:a}})),f.instance;f.singleton&&(f.type=1,f.value=h,3==g&&ba(h)&&h.done(function(a){f.value=a}));return d[b]=h}if(e[b+"Provider"])return this.resolve(b+"Provider",d),this.resolve(b,d);if(this===
a)throw"Could not provide value for "+b;return a.resolve(b)},destroy:function(){delete this.store;delete this.scope}};b.global=function(){return a};a=new b;return b}(),Ja=function(){var a=function(a,b){"pt_BR"==b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1==
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0==a||1==a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1==a?0:2<=a&&4>=a?1:2;case "ga":return 1==a?0:2==a?1:2;case "lt":return 1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1==a%100?0:2==a%100?1:3==a%100||4==a%100?2:3;
case "mk":return 1==a%10?0:1;case "mt":return 1==a?0:0==a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0==a?0:1==a%10&&11!=a%100?1:2;case "pl":return 1==a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1==a?0:2==a?1:8==a||11==a?2:3;case "ro":return 1==a?0:0==a||0<a%100&&20>a%100?1:2;case "ar":return 0==a?0:1==a?1:2==a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},b=function(a){this.store={};a&&(this.locale=a)};b.prototype={store:null,locale:"en",setLocale:function(a){this.locale=
a},set:function(a,b){var c=this.store;r(c[a])&&(c[a]=b)},load:function(a){v(this.store,a,!1,!1)},get:function(a){return this.store[a]||(this===c?"-- "+a+" --":c.get(a))},plural:function(b,c){var g=this.get(b),f=a(c,this.locale);return F(g)?g[f]:Z(g)?g[c]?g[c]:1==c&&void 0!=g.one?g.one:0>c&&void 0!=g.negative?g.negative:g.other:g}};var c=new b;b.global=function(){return c};return b}();n("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(a){a=a||{};this._observable=new E;v(this,
this._observable.getApi(),!0,!1);if(a.callback){var b=a.callback,c=b.scope||this;delete b.scope;for(var d in b)if(b.hasOwnProperty(d))this.on(d,b[d],c);delete a.callback}v(this,a,!0,!1)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",this);this._observable.destroy();delete this._observable}},onDestroy:A});n("MetaphorJs.cmp.App","MetaphorJs.cmp.Base",{lang:null,scope:null,renderer:null,cmpListeners:null,
components:null,initialize:function(a,b){var c=b instanceof x?b:new x(b),d,e;c.$app=this;this.supr();d=new ta;e=new E;this.lang=new Ja;v(this,d.getApi(),!0,!1);this.destroyProvider=w(d.destroy,d);v(this,e.getApi(),!0,!1);this.destroyObservable=w(e.destroy,e);this.scope=c;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",c.$root);this.value("$lang",this.lang);this.renderer=new ja(a,c);d=Y.call(arguments);
d[1]=c;this.initApp.apply(this,d)},initApp:A,run:function(){this.renderer.process()},getParentCmp:function(a){a=a.parentNode;for(var b;a;){if(b=a.getAttribute("cmp-id"))return this.getCmp(b);a=a.parentNode}return null},onAvailable:function(a,b,c){var d=this.cmpListeners;d[a]||(d[a]=new u);b&&d[a].done(b,c);return d[a]},getCmp:function(a){return this.components[a]||null},registerCmp:function(a){var b=this;b.components[a.id]=a;b.onAvailable(a.id).resolve(a);a.on("destroy",function(a){delete b.cmpListeners[a.id];
delete b.components[a.id]})},destroy:function(){var a;this.destroyObservable();this.destroyProvider();this.renderer.destroy();this.scope.$destroy();for(a in this)this.hasOwnProperty(a)&&delete this[a]}});var U=function(a){var b=document.body;return a===b?!0:b.contains(a)},J=function(){var a={};return function(b,c,d){b=b._mjsid||(b._mjsid=S());var e=a[b];if(r(d))return e?e[c]:void 0;e||(e=a[b]={});return e[c]=d}}(),K=function(a){var b=document.createDocumentFragment();if(y(a)){var c=document.createElement("div");
c.innerHTML=a;a=c.childNodes}if(a.nodeType)b.appendChild(a);else for(var c=-1,d=a.length>>>0;++c!==d;b.appendChild(a[0]));return b},ca=function(a){var b,c,d;if(F(a)){d=[];b=0;for(c=a.length;b<c;b++)d.push(ca(a[b]));return d}if(a)switch(a.nodeType){case 1:return a.cloneNode(!0);case 3:return document.createTextNode(a.innerText||a.textContent);case 11:return a.cloneNode(!0)}return null},I=R.create,O=function(){var a=new E,b={},c=function(a){if(!b[a]){var c=document.getElementById(a),d;c&&(d=c.tagName.toLowerCase(),
"script"==d?(d=document.createElement("div"),d.innerHTML=c.innerHTML,b[a]=K(d.childNodes)):b[a]="content"in c?c.content:K(c.childNodes))}return b[a]},d=function(a){return b[a]?b[a]:b[a]=pa(a,{dataType:"fragment"}).then(function(c){return b[a]=c})},e=function(a){v(this,a,!0,!1);this.id=S();this.tpl&&(this.tpl=H(this.tpl));this.url&&(this.url=H(this.url));a=this.node;var b=this.tpl||this.url;a&&a.removeAttribute("mjs-include");a||(this.deferRendering=!0);if(b){if(a&&a.firstChild&&J(a,"mjs-transclude",
K(a.childNodes)),"."!=b.substr(0,1)||this.replace||(this.ownRenderer=!0,this._watcher=I(this.scope,b,this.onChange,this,null,B)),this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof x&&this.scope.$on("destroy",
this.onScopeDestroy,this)};e.prototype={_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,doRender:function(){this._renderer||(this._renderer=new ja(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){a.trigger("rendered-"+this.id,this)},on:function(b,c,d){return a.on(b+"-"+this.id,c,d)},
un:function(b,c,d){return a.un(b+"-"+this.id,c,d)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,b=a.url,e=a._watcher?a._watcher.getLastResult():a.tpl||b,k=new u;(new u(function(a){b?a(c(e)||d(b)):a(c(e)||K(e))})).done(function(b){a._fragment=
b;k.resolve(a.ownRenderer?!1:a.node)}).fail(k.reject,k);return k},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=this.node;a.firstChild;)a.removeChild(a.firstChild);this.replace?a.parentNode.replaceChild(ca(this._fragment),a):a.appendChild(ca(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new u;this._initial?(this.doApplyTemplate(),
b.resolve()):(t(a,"leave",null,!0).done(this.doApplyTemplate,this).done(b.resolve,b),t(a,"enter",null,!0));this._initial=!1;return b},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();delete this._renderer},onScopeDestroy:function(){this.destroy();delete this._renderer},destroy:function(){delete this.node;delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),delete this._watcher);delete this.tpl}};e.getTemplate=c;
e.loadTemplate=d;return e}();n("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,initialize:function(a){this.supr(a);this.scope||(this.scope=new x);a.as&&(this.scope[a.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);this.id=this.id||"cmp-"+S();this.node||this._createNode();this.initComponent.apply(this,arguments);
this.scope.$app&&this.scope.$app.registerCmp(this);var b=this.template,c=this.templateUrl;b&&b instanceof O?b instanceof O&&(this.template.node=this.node):this.template=b=new O({scope:this.scope,node:this.node,deferRendering:!b,ownRenderer:!0,tpl:b,url:c});if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(b.initPromise?b.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=document.createElement(this.tag||
"div")},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display="none")},render:function(){this.rendered||(this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},onRenderingFinished:function(){this.renderTo?this.renderTo.appendChild(this.node):U(this.node)||document.body.appendChild(this.node);this.rendered=!0;this.afterRender();this.trigger("afterrender",this)},
show:function(){if(this.hidden){if(!1===this.trigger("beforeshow",this))return!1;this.node.style.display="block";this.hidden=!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("beforehide",this))return!1;this.node.style.display="none";this.hidden=!0;this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},
initComponent:A,afterRender:A,onShow:A,onHide:A,onParentRendererDestroy:function(){this.destroy()},onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?U(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.destroyScope&&this.scope&&this.scope.$destroy();delete this.scope;delete this.node;this.supr()}});var ka=function(){var a={};return function(b){return a[b]||
(a[b]=new RegExp(b))}}(),V=function(a,b){b&&(a.className=a.className.replace(ka("(?:^|\\s)"+b+"(?!\\S)"),""))},la=function(a){var b=J(a,"mjsAnimationQueue"),c;F(b)&&b.length?(c=b[0])&&c.stages&&(b=c.position,c=c.stages,V(a,c[b]),V(a,c[b]+"-active")):T(b)?b(a):"stop"==b&&$(a).stop(!0,!0);J(a,"mjsAnimationQueue",null)},ma=function(a,b){return b?ka("(?:^|\\s)"+b+"(?!\\S)").test(a.className):!1},na=function(a,b){b&&!ma(a,b)&&(a.className+=" "+b)},P=function(a,b,c,d,e){var g=!1!==b;b=b||{};e=e||[];c=c||
b.scope;d=d||b.node;b.scope=b.scope||c;b.node=b.node||d;var f=y(a)?N(a):a;if(!f)throw"Component "+a+" not found";c&&f.$isolateScope&&(b.scope=c=c.$newIsolated());var h,k=[];a=f.template||b.template||null;var m=f.templateUrl||b.templateUrl||null,l=c?c.$app:null,p=ta.global(),n=l?l.inject:p.inject,q=l?l:p,r=d?d.getAttribute("mjs-cloak"):null,t={$node:d||null,$scope:c||null,$config:b||null,$args:e||null};if(f.resolve)for(h in f.resolve)(function(a){var g=new u,m;k.push(g.done(function(c){t[a]=c;b[a]=
c;e.push(c)}));m=f.resolve[h];T(m)?g.resolve(m(c,d)):y(m)?g.resolve(n.resolve(m)):g.resolve(n.call(q,m,null,!1,v({},t,b,!1,!1)))})(h);g&&(a||m)&&(b.template=new O({scope:c,node:d,deferRendering:!0,ownRenderer:!0,tpl:a,url:m}),k.push(b.template.initPromise),d&&d.firstChild&&J(d,"mjs-transclude",K(d.childNodes)));g&&e.unshift(b);var s;k.length?(s=new u,u.all(k).done(function(){s.resolve(n.call(q,f,null,!0,v({},t,b,!1,!1),e))})):s=u.resolve(n.call(q,f,null,!0,v({},t,b,!1,!1),e));d&&s.isPending()&&null!==
r&&(r?na(d,r):d.style.visibility="hidden",s.done(function(){r?V(d,r):d.style.visibility=""}));return s},ua=L.currentUrl;n("MetaphorJs.cmp.View",{route:null,node:null,scope:null,cmp:null,currentComponent:null,watchable:null,defaultCmp:null,initialize:function(a){v(this,a,!0,!1);(a=this.node)&&a.firstChild&&J(a,"mjs-transclude",K(a.childNodes));this.cmp||(this.cmp=a.getAttribute("mjs-view-cmp"));this.defaultCmp=a.getAttribute("mjs-view-default");a.removeAttribute("mjs-view");a.removeAttribute("mjs-view-cmp");
a.removeAttribute("mjs-view-default");this.route?(L.initPushState(),L.on("locationChange",this.onLocationChange,this),this.onLocationChange()):this.cmp&&(this.watchable=I(this.scope,this.cmp,this.onCmpChange,this,null,B),this.onCmpChange())},onCmpChange:function(){var a=this.watchable.getLastResult()||this.defaultCmp;this.clearComponent();a&&this.setComponent(a)},onLocationChange:function(){var a=ua(),b=this.route,c,d,e,g,f;d=0;for(e=b.length;d<e;d++){g=b[d];if(f=a.match(g.reg)){this.changeRouteComponent(g,
f);return}g["default"]&&!c&&(c=g)}c?this.setRouteComponent(c,[]):this.clearComponent();!c&&this.defaultCmp&&this.setComponent(this.defaultCmp)},changeRouteComponent:function(a,b){la(this.node);this.clearComponent();this.setRouteComponent(a,b)},clearComponent:function(){var a=this,b=a.node;a.currentComponent&&t(b,"leave",null,!0).done(function(){a.currentComponent.destroy();for(a.currentComponent=null;b.firstChild;)b.removeChild(b.firstChild)})},setRouteComponent:function(a,b){var c=this,d=c.node,
e=a.params;t(d,"enter",function(){var g=b||[],f={destroyEl:!1,node:d,scope:a.$isolateScope?c.scope.$newIsolated():c.scope.$new()},h,k;a.as&&(f.as=a.as);a.template&&(f.template=a.template);g.shift();if(e)for(h=-1,k=e.length;++h<k;f[e[h]]=g[h]);return P(a.cmp||"MetaphorJs.cmp.Component",f,f.scope,d,null,g).done(function(a){c.currentComponent=a})},!0)},setComponent:function(a){var b=this,c=b.node;t(c,"enter",function(){var d=M(a)?a:{},e=(y(a)?a:null)||"MetaphorJs.cmp.Component",g=d.scope||b.scope.$new();
d.destroyEl=!1;return P(e,d,g,c).done(function(a){b.currentComponent=a})},!0)},destroy:function(){this.clearComponent();this.route&&(L.un("locationchange",this.onLocationChange,this),delete this.route);this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),delete this.watchable);delete this.scope;delete this.currentComponent}});var l=ia.registerAttributeHandler,Q=function(){return!1};l("mjs-app",0,Q);var va=function(a){var b=a.nodeName.toLowerCase();a=a.type;return"input"!=b&&
"textarea"!=b&&"select"!=b||"submit"==a||"reset"==a||"button"==a?!1:!0},D=n("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,initialize:function(a,b,c){c=H(c);this.node=b;this.expr=c;this.scope=a;this.watcher=I(a,c,this.onChange,this,null,B);if(this.watcher.getLastResult())this.onChange();a instanceof x&&a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){this.destroy()},onChange:function(){},destroy:function(){delete this.node;delete this.scope;this.watcher&&
(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)}});l("mjs-bind",1E3,n(null,D,{isInput:!1,recursive:!1,textRenderer:null,initialize:function(a,b,c){this.isInput=va(b);(this.recursive=null!==b.getAttribute("mjs-recursive"))?(this.scope=a,this.node=b,this.textRenderer=new sa(a,"{{"+c+"}}",null,null,!0),this.textRenderer.subscribe(this.onTextRendererChange,this),this.onTextRendererChange(),a instanceof x&&a.$on("destroy",this.onScopeDestroy,this)):this.supr(a,b,c)},onTextRendererChange:function(){this.updateElement(this.textRenderer.getString())},
onChange:function(){var a=this.watcher.getLastResult();this.updateElement(a)},updateElement:function(a){this.isInput?ra(this.node,a):this.node[ga]=a},destroy:function(){this.textRenderer&&(this.textRenderer.destroy(),delete this.textRenderer);this.supr()}}));l("mjs-bind-html",1E3,n(null,"attr.mjs-bind",{updateElement:function(a){this.node.innerHTML=a}}));(function(){var a=function(a,c,d,e){if(null!==d){if(d==ma(a,c))return;d=!d}else d=ma(a,c);d?e?t(a,[c+"-remove"],null,!0).done(function(){V(a,c)}):
V(a,c):e?t(a,[c+"-add"],null,!0).done(function(){na(a,c)}):na(a,c)};l("mjs-class",1E3,n(null,D,{initial:!0,onChange:function(){var b=this.node,c=this.watcher.getLastResult(),d;la(b);if(y(c))a(b,c,null,!this.initial);else if(F(c)){var e;d=-1;for(e=c.length;++d<e;a(b,c[d],!0,!this.initial));}else for(d in c)a(b,d,c[d]?!0:!1,!this.initial);this.initial=!1}}))})();l("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,b,c){a&&(a[c]=b)}]);(function(){var a=function(a,c,d,e){var g,f,h,k,m;c.removeAttribute("mjs-cmp");
d=d.split(" ");h=0;for(k=d.length;h<k;h++)m=d[h],""!=m&&"as"!=m&&(g?f=m:g=m);P(g,{scope:a,node:c,as:f,parentRenderer:e,destroyScope:!0},a,c);return!1};a.$breakScope=!0;l("mjs-cmp",200,a)})();l("mjs-each",100,n(null,D,{model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=
b.parentNode;this.node=b;this.scope=a;try{this.watcher=I(a,this.model,this.onChange,this,null,B)}catch(d){G(d)}this.parentEl.removeChild(b);this.render(C(this.watcher.getValue()))},onScopeDestroy:function(){var a=this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.supr()},doUpdate:function(a,b){for(var c=this.renderers,d=b,e=c.length,g=e-1,f=!(d%2),h,k;d<e;d++)h=c[d],k=h.scope,k.$index=
d,k.$first=0===d,k.$last=d===g,k.$even=f,k.$odd=!f,f=!f,h.renderer?k.$check():(h.renderer=new ja(h.el,h.scope),h.renderer.process())},render:function(a){var b=this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,g=document.createDocumentFragment(),f,h,k;h=0;for(k=a.length;h<k;h++)f=c.cloneNode(!0),g.appendChild(f),b.push(this.createItem(f,a,h));d.insertBefore(g,e);this.doUpdate(a,0)},createItem:function(a,b,c){var d=this.itemName,e=this.scope.$new();e[d]=b[c];return{el:a,scope:e}},onChange:function(a){var b=
this,c=b.renderers;a=a.prescription||[];var d=b.tpl,e=0,g=b.parentEl,f=C(b.watcher.getValue()),h=null,k,m,l,n;m=0;for(l=a.length;m<l;m++)n=a[m],"-"==n?(c[e].scope.$index=e,e++):(null===h&&(h=0<m?m-1:0),"I"!=n&&c[e]&&(k=c[e],k.scope.$destroy(),t(k.el,"leave",null,!0).done(function(a){U(a)&&a.parentNode.removeChild(a)})),"D"==n?c.splice(e,1):(k=d.cloneNode(!0),t(k,"enter",function(a){return function(d){0<a?g.insertBefore(d,c[a-1].el.nextSibling):b.prevEl?g.insertBefore(d,b.prevEl.nextSibling):g.insertBefore(d,
g.firstChild)}}(e),!0),"R"==n?c[e]=b.createItem(k,f,e):"I"==n&&(m<c.length?c.splice(e,0,b.createItem(k,f,e)):c.push(b.createItem(k,f,e))),e++));b.doUpdate(f,h)},parseExpr:function(a){a=a.split(" ");var b,c,d,e,g;b=0;for(c=a.length;b<c;b++)if(g=a[b],""!=g&&"in"!=g)if(e){d=a.slice(b).join(" ");break}else e=g;this.model=d;this.itemName=e||"item"}},{$stopRenderer:!0}));var oa=R.createFunc,da=function(){return!0},W=function(a){if(a instanceof W)return a;if(!(this instanceof W))return new W(a);for(var b in a)if(!this[b])try{this[b]=
a[b]}catch(c){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var d,e=a.button;r(this.pageX)&&null!==a.clientX&&(d=this.target?this.target.ownerDocument||document:document,b=d.documentElement,d=d.body,this.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0),this.pageY=a.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0));this.which||void 0===e||(this.which=e&1?1:e&2?3:e&4?2:0);this.isDefaultPrevented=
a.defaultPrevented||r(a.defaultPrevented)&&!1===a.returnValue?da:Q;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};W.prototype={isDefaultPrevented:Q,isPropagationStopped:Q,isImmediatePropagationStopped:Q,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=da;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=da;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=
this.originalEvent;this.isImmediatePropagationStopped=da;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}};(function(){var a="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste enter".split(" "),b,c;b=0;for(c=a.length;b<c;b++)(function(a){var b=a;"enter"==b&&(b="keyup");l("mjs-"+a,1E3,function(c,f,h){var k=oa(h);ea(f,b,function(b){b=b||window.event;b=new W(b);if("enter"==a&&
13!=b.keyCode)return null;c.$event=b;try{k(c)}catch(e){console.log(e),G(e)}delete c.$event;c instanceof x?c.$root.$check():c.$$watchers&&c.$$watchers.$checkAll();b.preventDefault();return!1})})})(a[b])})();l("mjs-show",500,n(null,D,{initial:!0,initialize:function(a,b,c){this.supr(a,b,c)},runAnimation:function(a){var b=this.node.style,c=function(){b.display=a?"":"none"};this.initial?c():t(this.node,a?"show":"hide",function(){a&&(b.display="")},!0).done(c)},onChange:function(){var a=this.watcher.getLastResult();
this.runAnimation(a);this.initial=!1}}));l("mjs-hide",500,n(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(!a);this.initial=!1}}));l("mjs-if",500,n(null,D,{parentEl:null,prevEl:null,el:null,initial:!0,initialize:function(a,b,c){this.parentEl=b.parentNode;this.prevEl=b.previousSibling;this.supr(a,b,c)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,
d=a.node,e=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},g=function(){c.removeChild(d)};b?U(d)||(a.initial?e():t(d,"enter",e,!0)):U(d)&&(a.initial?g():t(d,"leave",null,!0).done(g));a.initial=!1}}));l("mjs-ignore",0,Q);l("mjs-include",900,function(a,b,c,d){a=new O({scope:a,node:b,url:c,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});l("mjs-init",250,function(a,b,c){b.removeAttribute("mjs-init");oa(c)(a)});l("mjs-model",1E3,n(null,D,{inProg:!1,
input:null,binding:null,initialize:function(a,b,c){this.node=b;this.input=new fa(b,this.onInputChange,this);this.binding=b.getAttribute("mjs-data-binding")||"both";var d=this.input.getValue();this.supr(a,b,c);a=this.watcher.getLastResult();if("scope"!=this.binding&&this.watcher&&(d||a&&this.watcher.hasInputPipes()))this.onInputChange(a||d)},onInputChange:function(a){var b=this.scope;"scope"!=this.binding&&(a&&y(a)&&-1!=a.indexOf("\\{")&&(a=a.replace(/\\{/g,"{")),this.watcher.setValue(a),this.inProg=
!0,b instanceof x?b.$root.$check():this.watcher.checkAll(),this.inProg=!1)},destroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var a=this.watcher.getLastResult();"input"==this.binding||this.inProg||this.input.setValue(a)}}));var wa=navigator.userAgent.toLowerCase(),Ka=function(){var a=parseInt((/msie (\d+)/.exec(wa)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/.exec(wa)||[])[1],10)||!1);return function(){return a}}(),xa=R.createGetter;l("mjs-options",
100,n(null,D,{model:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-options");this.node=b;this.scope=a;for(this.defOption=b.options.length?b.options[0]:null;b.firstChild;)b.removeChild(b.firstChild);this.defOption&&this.defOption.setAttribute("mjs-default-option","");try{this.watcher=I(a,this.model,this.onChange,this,null,B)}catch(d){G(d)}this.render(C(this.watcher.getValue()))},onChange:function(){this.render(C(this.watcher.getValue()))},
renderOption:function(a,b,c){var d=this.groupEl||this.fragment,e=Ka();c.item=a;c.$index=b;a=this.getterFn(c);void 0!=a.group&&(a.group=""+a.group);a.group!==this.prevGroup&&(a.group?(this.groupEl=d=document.createElement("optgroup"),d.setAttribute("label",a.group),a.disabledGroup&&d.setAttribute("disabled","disabled"),this.fragment.appendChild(d)):(d=this.fragment,this.groupEl=null));this.prevGroup=a.group;b=document.createElement("option");b.setAttribute("value",a.value);b.text=a.name;e&&9>e&&(b.innerHTML=
a.name);a.disabled&&b.setAttribute("disabled","disabled");d.appendChild(b)},render:function(a){var b=this.node,c=Ea(b),d=this.defOption,e=this.scope.$new(),g,f;this.fragment=document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;b.firstChild;)b.removeChild(b.firstChild);g=0;for(f=a.length;g<f;g++)this.renderOption(a[g],g,e);d&&b.insertBefore(d,b.firstChild);e.$destroy();b.appendChild(this.fragment);this.fragment=null;ra(b,c)},parseExpr:function(a){var b=a.indexOf(" in "),c;-1==b?(c=
a,a="{name: .item, value: .$index}"):(c=a.substr(b+4),a=a.substr(0,b));this.model=c;this.getterFn=xa(a)}}));(function(){var a="selected checked disabled readonly required open".split(" "),b,c;b=0;for(c=a.length;b<c;b++)(function(a){l("mjs-"+a,1E3,n(null,D,{onChange:function(){this.watcher.getLastResult()?this.node.setAttribute(a,!0):this.node.removeAttribute(a)}}))})(a[b])})();var ya=function(a){var b;a:{for(var c=a,d;c;){d=J(c,"mjs-transclude");if(void 0!=d){b=d;break a}c=c.parentNode}b=void 0}if(b){a.firstChild&&
J(a,"mjs-transclude",K(a.childNodes));c=a.parentNode;d=a.nextSibling;b=ca(b);var e=C(b.childNodes);c.removeChild(a);c.insertBefore(b,d);return e}return null};l("mjs-transclude",1E3,function(a,b){return ya(b)});l("mjs-view",200,function(a,b,c){b.removeAttribute("mjs-view");P(c||"MetaphorJs.cmp.View",{scope:a,node:b},a,b);return!1});A=ia.registerTagHandler;A("mjs-include",900,function(a,b,c,d){return(new O({scope:a,node:b,tpl:b.getAttribute("src"),parentRenderer:d,replace:!0})).initPromise});A("mjs-transclude",
900,function(a,b){return ya(b)});(function(){var a=function(a,b,e){if(""===b||r(b))return!0;if(!r(a)){if(aa(a))return a===b;if(e instanceof RegExp)return b.test(""+a);if("strict"==e)return""+a===""+b;if(!0===e||null===e||r(e))return-1!=""+a.indexOf(b);if(!1===e)return-1==""+a.indexOf(b)}return!1},b=function(b,d,e){if(M(b)){var g,f;for(g in d)if("$"==g)for(f in b){if(a(b[f],d.$,e))return!0}else if(a(b[g],d[g],e))return!0}else return r(d.$)?!0:a(b,d.$,e);return!1};q("filter.filter",function(a,d,e,g){d=
e;M(d)||(d={$:d});e=[];var f,h;f=-1;for(h=a.length;++f<h;)b(a[f],d,g)&&e.push(a[f]);return e})})();q("filter.fromList",function(a,b,c){c=c||", ";return a&&a.length?(F(a)||(a=C(a)),a.join(c)):""});q("filter.l",function(a,b){return b.$app.lang.get(a)});q("filter.limitTo",function(a,b,c){b=y(a);if(!F(a)&&!b)return a;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);if(b)return c?0<=c?a.slice(0,c):a.slice(c,a.length):"";b=[];var d;c>a.length?c=a.length:c<-a.length&&(c=-a.length);0<c?d=0:(d=a.length+
c,c=a.length);for(;d<c;d++)b.push(a[d]);return b});q("filter.linkify",function(a,b,c){return a?a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(c?' target="'+c+'"':"")+">$1</a>"):""});q("filter.lowercase",function(a){return a.toLowerCase()});var La={};q("filter.moment",function(a,b,c){c=La[c]||c;return moment(a).format(c)});var Ma={};q("filter.numeral",function(a,b,c){c=Ma[c]||c;return numeral(a).format(c)});q("filter.p",function(a,b,c){return b.$app.lang.plural(a,
parseInt(c,10)||0)});q("filter.sortBy",function(a,b,c,d){d||(d="asc");a=a.slice();a.sort(function(a,b){var d=typeof a,h=a,k=b;if(d!=typeof b)return 0;"object"==d&&(h=a[c],k=b[c]);if("number"==typeof h)return h-k;h=(""+h).toLowerCase();k=(""+k).toLowerCase();return h===k?0:h>k?1:-1});return"desc"==d?a.reverse():a});q("filter.toArray",function(a){return C(a)});q("filter.toList",function(a,b,c,d){d=d||void 0;c=c||"/\\n|,/";if(!a)return[];a=""+a;"/"==c.substr(0,1)&&"/"==c.substr(c.length-1)&&(c=ka(c.substring(1,
c.length-1)));a=a.split(c,d);b=-1;for(c=a.length;++b<c;a[b]=H(a[b]));return a});q("filter.ucfirst",function(a){return a.substr(0,1).toUpperCase()+a.substr(1)});q("filter.uppercase",function(a){return a.toUpperCase()});var ea=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},za=function(a){var b=!1,c=!0,d=window,e=d.document,g=e.documentElement,f=function(c){if("readystatechange"!=c.type||"complete"==e.readyState){var g="load"==c.type?d:e,h=c.type,k=f;g.detachEvent?
g.detachEvent("on"+h,k):g.removeEventListener(h,k,!1);!b&&(b=!0)&&a.call(d,c.type||c)}},h=function(){try{g.doScroll("left")}catch(a){setTimeout(h,50);return}f("poll")};if("complete"==e.readyState)a.call(d,"lazy");else{if(e.createEventObject&&g.doScroll){try{c=!d.frameElement}catch(k){}c&&h()}ea(e,"DOMContentLoaded",f);ea(e,"readystatechange",f);ea(d,"load",f)}},Aa=function(a,b,c){a.removeAttribute("mjs-app");try{return P(b||"MetaphorJs.cmp.App",!1,c,a,[a,c])}catch(d){return G(d),u.reject(d)}};l("mjs-each-in-store",
100,n(null,"attr.mjs-each",{store:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each-in-store");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.store=a=xa(this.model)(a);this.parentEl.removeChild(b);this.initWatcher();this.render(this.watcher.getValue());this.bindStore(a,"on")},onScopeDestroy:function(){this.bindStore(this.store,"un");delete this.store;
this.supr()},initWatcher:function(){this.watcher=I(this.store,".items",null);this.watcher.subscribe(this.onChange,this)},resetWatcher:function(){this.watcher.setValue(this.store.items)},bindStore:function(a,b){a[b]("load",this.onStoreUpdate,this);a[b]("update",this.onStoreUpdate,this);a[b]("add",this.onStoreUpdate,this);a[b]("remove",this.onStoreUpdate,this);a[b]("replace",this.onStoreUpdate,this);a[b]("filter",this.onStoreFilter,this);a[b]("clearfilter",this.onStoreFilter,this);a[b]("clear",this.onStoreClear,
this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},onStoreFilter:function(){this.resetWatcher();this.onStoreUpdate()},onStoreClear:function(){this.resetWatcher();this.onStoreUpdate()},onStoreDestroy:function(){this.onStoreClear();this.watcher.unsubscribeAndDestroy(this.onChange,this);delete this.watcher}},{$stopRenderer:!0}));n("MetaphorJs.cmp.Dialog","MetaphorJs.cmp.Component",{dialog:null,dialogPreset:null,dialogCfg:null,initComponent:function(){this.supr();
this._createDialog();this._oldShow=this.show;this._oldHide=this.hide},_getDialogCfg:function(){return v({},this.dialogCfg||{},{render:{el:this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=new Da(this.dialogPreset,this._getDialogCfg());this.dialog.on("show",this._oldShow,this);this.dialog.on("hide",this._oldHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},onDialogDestroy:function(){this.destroying||
(delete this.dialog,this.destroy())},onDestroy:function(){this.destroying=!0;this.dialog&&this.dialog.destroy();delete this.dialog;delete this.dialogCfg;delete this.dialogPreset;this.supr();this.destroying=!1}});var Ba=function(a,b,c){var d,e=a.childNodes;if(!1!==b.call(c,a))for(a=-1,d=e.length>>>0;++a!==d;Ba(e[a],b,c));};n("MetaphorJs.view.Validator",{node:null,scope:null,validator:null,scopeState:null,initialize:function(a,b){this.node=a;this.scope=b;this.scopeState={};this.validator=this.createValidator();
this.initScope();this.initScopeState();this.initValidatorEvents()},createValidator:function(){var a=this.node,b={},c;if(c=a.getAttribute("mjs-validator-submit"))b.callback=b.callback||{},b.callback.submit=function(a,b){return function(){try{return a(b)}catch(c){G(c)}}}(oa(c),this.scope);return new Ca(a,b)},initValidatorEvents:function(){var a=this.validator;a.on("fieldstatechange",this.onFieldStateChange,this);a.on("statechange",this.onFormStateChange,this);a.on("displaystatechange",this.onDisplayStateChange,
this);a.on("reset",this.onFormReset,this)},initScope:function(){var a=this.scope,b=this.node,b=b.getAttribute("name")||b.getAttribute("id")||"$form";a[b]=this.scopeState},initScopeState:function(){var a=this.node,b=this.scopeState,c,d,e;a.elements?c=a.elements:(c=[],Ba(a,function(a){va(a)&&c.push(a)}));a=-1;for(e=c.length;++a<e;)d=c[a],(d=d.getAttribute("name")||d.getAttribute("id"))&&!b[d]&&(b[d]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null});b.$invalid=!1;b.$pristine=!0;b.$submit=
w(this.validator.onSubmit,this.validator)},onDisplayStateChange:function(a,b){if(b){b=this.scopeState;var c,d;for(c in b)d=b[c],d.$real&&(b[c]=d.$real);b.$invalid=!a.isValid();b.$pristine=!1;this.scope.$check()}else this.onFormReset(a)},onFormReset:function(a){a=this.scopeState;var b,c;for(b in a)c=a[b],c.$error=null,c.$errorMessage=null,c.$invalid=null,c.$pristine=!0;a.$invalid=!1;a.$pristine=!0;this.scope.$check()},onFormStateChange:function(a,b){var c=this.scopeState;c.$invalid=!1===b&&a.isDisplayStateEnabled();
c.$pristine=!1;this.scope.$check()},onFieldStateChange:function(a,b,c){var d=this.scopeState,e=b.getName();a=a.isDisplayStateEnabled();b={$error:b.getErrorRule(),$errorMessage:b.getError(),$invalid:!1===c,$pristine:null===b.getExactValidState()};a?d[e]=b:d[e].$real=b;this.scope.$check()}});l("mjs-validate",250,function(a,b,c){c=c||"MetaphorJs.view.Validator";var d=N(c);d?new d(b,a):G(Error("Class '"+c+"' not found"))});p.onReady=za;p.initApp=Aa;p.ns=B;p.cs=X;p.resolveComponent=P;p.animate=t;p.stopAnimation=
la;p.ajax=pa;p.select=qa;p.bind=w;p.extend=v;p.trim=H;p.pushUrl=Fa;p.currentUrl=ua;p.history=L;p.run=function(){za(function(){var a=qa("[mjs-app]"),b,c,d,e=function(a){a.run()};b=-1;for(c=a.length;++b<c;)d=a[b],Aa(d,d.getAttribute&&d.getAttribute("mjs-app")).done(e)})};p.lib.Promise=u;p.lib.Observable=E;return p});
