define("metaphorjs","metaphorjs-observable metaphorjs-promise metaphorjs-ajax metaphorjs-animate metaphorjs-input metaphorjs-class metaphorjs-namespace metaphorjs-select metaphorjs-validator metaphorjs-watchable metaphorjs-dialog metaphorjs-history".split(" "),function(J,u,Ea,w,ka,$a,ab,Fa,bb,ta,cb,X){var db=ka.getValue,eb=ka.setValue,fb=X.pushUrl,q={lib:{},cmp:{},view:{}},A=new ab(q,"MetaphorJs"),Ga=new $a(A),p=Ga.define,t=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,
arguments)}},O=Array.prototype.slice,gb=Object.prototype.toString,P=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var c=a[gb.call(b)];return void 0===c?-1:1==c&&isNaN(b)?8:c}}(),ea=function(a){return"object"==typeof a&&3===P(a)&&!a.nodeType},la=function(a){return!0===a||!1===a},v=function(){return function b(){var c=
!1,d=!1,e=O.call(arguments),f=e.shift(),g,h,k;la(e[e.length-1])&&(c=e.pop());la(e[e.length-1])&&(d=c,c=e.pop());for(;e.length;)if(g=e.shift())for(h in g)if(g.hasOwnProperty(h)&&void 0!==(k=g[h]))if(d)if(f[h]&&ea(f[h])&&ea(k))b(f[h],k,c,d);else{if(!0===c||void 0==f[h])ea(k)?(f[h]={},b(f[h],k,c,!0)):f[h]=k}else if(!0===c||void 0==f[h])f[h]=k;return f}}(),H=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]=
"0";else return a[b]=String.fromCharCode(c+1),a.join("")}a.unshift("0");return a.join("")}}(),B=function(){},F=function(a){this.$$observable=new J;this.$$historyWatchers={};v(this,a,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)};F.prototype={$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$historyWatchers:null,$$checking:!1,$$destroyed:!1,$new:function(){return new F({$parent:this,
$root:this.$root,$app:this.$app})},$newIsolated:function(){return new F({$app:this.$app})},$on:function(a,b,c){return this.$$observable.on(a,b,c)},$un:function(a,b,c){return this.$$observable.un(a,b,c)},$watch:function(a,b,c){return ta.create(this,a,b,c,null)},$unwatch:function(a,b,c){return ta.unsubscribeAndDestroy(this,a,b,c)},$watchHistory:function(a,b){this.$$historyWatchers[b]||(this.$$historyWatchers[b]=a,q.history.on("change-"+b,this.$$onHistoryChange,this))},$unwatchHistory:function(a){this.$$historyWatchers[a]||
(delete this.$$historyWatchers[a],q.history.un("change-"+a,this.$$onHistoryChange,this))},$get:function(a){for(var b=this;b;){if(void 0!==b[a])return b[a];b=b.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$$onHistoryChange:function(a,b,c){this.$$historyWatchers[c]&&(b=this.$$historyWatchers[c],this[b]=a,this.$check())},$check:function(){var a;this.$$checking||(this.$$checking=!0,this.$$watchers&&(a=this.$$watchers.$checkAll()),this.$$checking=!1,
this.$$destroyed||this.$$observable.trigger("check",a))},$destroy:function(){var a;this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;delete this.$app;delete this.$root;delete this.$parent;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);for(a in this.$$historyWatchers)this.$unwatchHistory(a);delete this.$$historyWatchers;this.$$destroyed=!0}};var Q=function(a){return"object"==typeof a&&5===P(a)},D=function(a){return"string"==typeof a||
a===""+a},K=function(a){if(a&&void 0!=!a.length&&a!==""+a){for(var b=[],c=-1,d=a.length>>>0;++c!==d;b[c]=a[c]);return b}return a?[a]:[]},R=function(a){return"function"==typeof a},Y=function(a){if(!a||!a.then)return!1;var b,c;return"object"!=(c=typeof a)&&"function"!=c?!1:R(b=a.then)?b:!1},fa=A.get,ua=function(a,b,c,d){setTimeout(function(){a.apply(b,c||[])},d||0)},G=function(a){var b=a.stack||Error().stack;if("undefined"!=typeof console&&console.log)ua(function(){console.log(a);b&&console.log(b)});
else throw a;},Ha=function(){var a=document.createTextNode("");return D(a.textContent)?"textContent":"nodeValue"}(),S=function(){return String.prototype.trim?function(a){return D(a)?a.trim():a}:function(a){return D(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),L=ta.create,Ia=function(){var a=/\\{/g,b=new J,c=function(a,b,c,h,k){return!b||!b.indexOf||-1==b.indexOf("{{")&&-1==b.indexOf("{[")?null:new d(a,b,c,h,k)},d=function(a,b,c,d,k){this.id=H();this.origin=b;this.scope=a;this.parent=c;this.isRoot=
!c;this.data=d;this.lang=a.$app?a.$app.lang:null;if(!0===k||!1===k)this.recursive=k;this.watchers=[];this.children=[];this.dataChangeDelegate=t(this.doDataChange,this);this.processed=this.processText(b);this.render()};d.prototype={id:null,parent:null,isRoot:null,scope:null,origin:"",processed:null,text:null,watchers:null,children:null,data:null,recursive:!1,dataChangeDelegate:null,changeTmt:null,lang:null,subscribe:function(a,c){return b.on(this.id,a,c)},unsubscribe:function(a,c){return b.un(this.id,
a,c)},getString:function(){null===this.text&&this.render();var b=this.text;return-1!=b.indexOf("\\{")?b.replace(a,"{"):b},render:function(){var a=this.processed,b,c,h;this.children.length||this.createChildren();h=this.children;b=-1;for(c=h.length;++b<c;a=a.replace("---"+b+"---",h[b]instanceof d?h[b].getString():h[b]));return this.text=a},processText:function(a){for(var b=0,c=a.length,d,k,l="";b<c;)if(-1!=(d=a.indexOf("{{",b))&&-1!=(k=a.indexOf("}}",d+2))&&"\\"!=a.substr(d-1,1))l+=a.substring(b,d),
k!=d+2&&(l+=this.watcherMatch(a.substring(d+2,k))),b=k+2;else{b!==c&&(l+=a.substring(b));break}b=0;a=l;c=a.length;for(l="";b<c;)if(-1!=(d=a.indexOf("{[",b))&&-1!=(k=a.indexOf("]}",d+2))&&"\\"!=a.substr(d-1,1))l+=a.substring(b,d),k!=d+2&&(l+=this.watcherMatch(a.substring(d+2,k),!0)),b=k+2;else{b!==c&&(l+=a.substring(b));break}return l},watcherMatch:function(a,b){var c=this.watchers;if(b){a=S(a);var d=a.split("|"),k=S(d[0]);"."!=k.substr(0,1)&&(d[0]="'"+k+"'");1==d.length&&d.push("l");a=d.join(" | ")}c.push(L(this.scope,
a,this.onDataChange,this,null,A));return"---"+(c.length-1)+"---"},onDataChange:function(){this.changeTmt||(this.changeTmt=setTimeout(this.dataChangeDelegate,0))},doDataChange:function(){this.destroyChildren();this.triggerChange();this.changeTmt=null},triggerChange:function(){this.text=null;this.isRoot?b.trigger(this.id,this,this.data):this.parent.triggerChange()},createChildren:function(){var a=this.watchers,b=this.children,d=this.scope,h=this.recursive,k,l,n;k=-1;for(l=a.length;++k<l;)n=a[k].getLastResult(),
b.push(h&&c(d,n,this,null,!0)||n)},destroyChildren:function(){var a=this.children,b,c;b=-1;for(c=a.length;++b<c;)a[b]instanceof d&&a[b].destroy();this.children=[]},destroyWatchers:function(){var a=this.watchers,b,c;b=-1;for(c=a.length;++b<c;a[b].unsubscribeAndDestroy(this.onDataChange,this));this.watchers=[]},destroy:function(){this.destroyChildren();this.destroyWatchers();b.destroyEvent(this.id);delete this.watchers;delete this.children;delete this.origin;delete this.processed;delete this.text;delete this.scope;
delete this.data;delete this.dataChangeDelegate;delete this.lang;this.changeTmt&&clearTimeout(this.changeTmt);delete this.changeTmt}};d.create=c;return d}(),hb=function(a){var b={},c,d,e=a.attributes;a=0;for(c=e.length;a<c;a++)d=e[a],b[d.name]=d.value;return b},C=function(){var a={};return function(b,c,d){b=b._mjsid||(b._mjsid=H());var e=a[b];return void 0!==d?(e||(e=a[b]={}),e[c]=d):e?e[c]:void 0}}(),x=A.add,va=function(){var a=[],b=[],c=!1,d=!1,e=function(a,b){return a.priority<b.priority?-1:a.priority>
b.priority?1:0};return{registerAttributeHandler:function(b,d,e){fa("attr."+b,!0)||(a.push({priority:d,name:b,handler:x("attr."+b,e)}),c=!1)},getAttributeHandlers:function(){c||(a.sort(e),c=!0);return a},registerTagHandler:function(a,c,e){fa("tag."+a,!0)||(b.push({priority:c,name:a,handler:x("tag."+a,e)}),d=!1)},getTagHandlers:function(){d||(b.sort(e),d=!0);return b}}}(),ib=va.getAttributeHandlers,Ja=Array.prototype.indexOf;Ja||(Ja=Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');
var d=Object(this),e=d.length>>>0;if(0===e)return-1;c=+b||0;Infinity===Math.abs(c)&&(c=0);if(c>=e)return-1;for(c=Math.max(0<=c?c:e-Math.abs(c),0);c<e;){if(c in d&&d[c]===a)return c;c++}return-1});var wa=function(){var a=null,b=Ia.create,c=function(a,b,c,d,e,g){var h=[];if(a&&!0!==a){if(a.nodeType){g.countdown+=1;f(a,c,d,e,g);return}h=O.call(a)}h.length||(h=K(b.childNodes));b=h.length;g.countdown+=b;for(a=-1;++a<b;f(h[a],c,d,e,g));},d=function(a,b){if(b)if(b.nodeType)a.push(b);else if(Q(b))for(var c=
-1,e=b.length;++c<e;d(a,b[c]));},e={script:!0,template:!0,"mjs-template":!0,style:!0},f=function(a,b,d,f,g){if(a){var h;h=a.nodeName;g||(g={countdown:1});if(!h||!e[h.toLowerCase()])if(h=b.call(d,a),!1!==h){if(Y(h)){h.done(function(e){!1!==e&&c(e,a,b,d,f,g);0==--g.countdown&&f&&f.call(d)});return}c(h,a,b,d,f,g)}0==--g.countdown&&f&&f.call(d)}},g=new J,h=function(a,b,c){this.id=H();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof F&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",
this.destroy,this)};h.prototype={id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,on:function(a,b,c){return g.on(a+"-"+this.id,b,c)},un:function(a,b,c){return g.un(a+"-"+this.id,b,c)},createChild:function(a){return new h(a,this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,c,d){var e=a.$isolateScope?b.$newIsolated():a.$breakScope?b.$new():b,f=b.$app;c=f.inject(a,null,{$scope:e,$node:c,$attrValue:d,$renderer:this},[e,c,d,this]);f&&a.$registerBy&&
c&&(Y(c)?c.done(function(c){f.registerCmp(c,b,a.$registerBy)}):f.registerCmp(c,b,a.$registerBy));return a.$stopRenderer?!1:c},processNode:function(c){var e=c.nodeType,f=this.texts,g=this.scope,h,y;if(3==e){if(h=null!==c.parentNode.getAttribute("mjs-recursive"),e=b(g,c[Ha],null,f.length,h))e.subscribe(this.onTextChange,this),f.push({node:c,tr:e}),this.renderText(f.length-1)}else if(1==e){a||(a=ib());var e=[],m=[],r,s,q;y="tag."+c.tagName.toLowerCase();if(y=fa(y,!0)){s=this.runHandler(y,g,c);if(!1===
s)return!1;Y(s)?e.push(s):d(m,s)}r=hb(c);y=0;for(h=a.length;y<h;y++)if(q=a[y].name,void 0!==(s=r[q])){c.removeAttribute(q);s=this.runHandler(a[y].handler,g,c,s);delete r[q];if(!1===s)return!1;Y(s)?e.push(s):d(m,s)}if(e.length){var t=new u;u.all(e).done(function(a){d(m,a);t.resolve(m)});return t}h=void 0!==r["mjs-recursive"];delete r["mjs-recursive"];for(y in r)if(e=b(g,r[y],null,f.length,h))c.removeAttribute(y),e.subscribe(this.onTextChange,this),f.push({node:c,attr:y,tr:e}),this.renderText(f.length-
1);return m.length?m:!0}return!0},process:function(){f(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){g.trigger("rendered-"+this.id,this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.tr.getString(),c=a.attr;c?("value"==c?a.node.value=b:"class"==c?a.node.className=b:"src"==c&&(a.node.src=b),a.node.setAttribute(c,b)):a.node[Ha]=b},destroy:function(){var a=this.texts,b,c;if(!this.destroyed){this.destroyed=
!0;b=-1;for(c=a.length;++b<c;a[b].tr.destroy());this.parent&&this.parent.un("destroy",this.destroy,this);delete this.texts;delete this.el;delete this.scope;delete this.parent;g.trigger("destroy-"+this.id)}}};return h}(),Ka=function(a){if(null===a||"object"!=typeof a)return!1;a=P(a);return 2<a||-1==a},La=function(){var a,b=function(){this.store={}};b.prototype={store:null,getApi:function(){return{value:t(this.value,this),constant:t(this.constant,this),factory:t(this.factory,this),service:t(this.service,
this),provider:t(this.provider,this),resolve:t(this.resolve,this),inject:t(this.inject,this)}},instantiate:function(a,b,e,f){return a.instantiate?a.instantiate.apply(null,e):f?(b=function(){},b.prototype=a.prototype,b=new b,a=a.apply(b,e),Ka(a)||!1===a?a:b):a.apply(b,e)},inject:function(a,b,e,f,g){e=e||{};f=f||[];var h=this;if(R(a))if(a.inject)f=O.call(a.inject),f.push(a),a=f;else return h.instantiate(a,b,f,g);a=O.call(a);f=[];var k=a.pop(),l,n;l=-1;for(n=a.length;++l<n;f.push(h.resolve(a[l],e)));
return u.all(f).then(function(a){return h.instantiate(k,b,a,g)})},value:function(a,b){this.store[a]={type:1,value:b}},constant:function(a,b){var e=this.store;e[a]||(e[a]={type:2,value:b})},factory:function(a,b,e,f){la(e)&&(f=e,e=null);this.store[a]={type:3,singleton:f,fn:b,context:e}},service:function(a,b,e){this.store[a]={type:4,singleton:e,fn:b}},provider:function(a,b){this.store[a+"Provider"]={name:a,type:5,fn:b,instance:null}},resolve:function(b,d){var e=this.store,f,g,h;if(void 0!==d[b])return d[b];
if(g=e[b]){f=g.type;if(1==f||2==f)return g.value;if(3==f)h=this.inject(g.fn,g.context,d);else if(4==f)h=this.inject(g.fn,null,d,null,!0);else if(5==f)return g.instance||(g.instance=u.resolve(this.inject(g.fn,null,d)).done(function(a){g.instance=a;e[g.name]={type:3,fn:a.$get,context:a}})),g.instance;g.singleton&&(g.type=1,g.value=h,3==f&&Y(h)&&h.done(function(a){g.value=a}));return d[b]=h}if(e[b+"Provider"])return this.resolve(b+"Provider",d),this.resolve(b,d);if(this===a)throw"Could not provide value for "+
b;return a.resolve(b)},destroy:function(){delete this.store;delete this.scope}};b.global=function(){return a};a=new b;return b}(),jb=function(){var a=function(a,b){"pt_BR"==b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1==
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0==a||1==a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1==a?0:2<=a&&4>=a?1:2;case "ga":return 1==a?0:2==a?1:2;case "lt":return 1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1==a%100?0:2==a%100?1:3==a%100||4==a%100?2:3;
case "mk":return 1==a%10?0:1;case "mt":return 1==a?0:0==a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0==a?0:1==a%10&&11!=a%100?1:2;case "pl":return 1==a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1==a?0:2==a?1:8==a||11==a?2:3;case "ro":return 1==a?0:0==a||0<a%100&&20>a%100?1:2;case "ar":return 0==a?0:1==a?1:2==a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},b=function(a){this.store={};a&&(this.locale=a)};b.prototype={store:null,locale:"en",setLocale:function(a){this.locale=
a},set:function(a,b){var c=this.store;void 0===c[a]&&(c[a]=b)},load:function(a){v(this.store,a,!1,!1)},get:function(a){return this.store[a]||(this===c?"-- "+a+" --":c.get(a))},plural:function(b,c){var f=this.get(b),g=a(c,this.locale);return Q(f)?f[g]:ea(f)?f[c]?f[c]:1==c&&void 0!=f.one?f.one:0>c&&void 0!=f.negative?f.negative:f.other:f}};var c=new b;b.global=function(){return c};return b}();p("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(a){a=a||{};this.$$observable=new J;
v(this,this.$$observable.getApi(),!0,!1);if(a.callback){var b=a.callback,c=b.scope||this;delete b.scope;for(var d in b)if(b.hasOwnProperty(d))this.on(d,b[d],c);delete a.callback}v(this,a,!0,!1)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",this);this.$$observable.destroy();delete this.$$observable}},onDestroy:B});p("MetaphorJs.cmp.App","MetaphorJs.cmp.Base",{lang:null,scope:null,renderer:null,cmpListeners:null,
components:null,initialize:function(a,b){var c=b instanceof F?b:new F(b),d,e;c.$app=this;this.supr();d=new La;e=new J;this.lang=new jb;v(this,d.getApi(),!0,!1);this.destroyProvider=t(d.destroy,d);v(this,e.getApi(),!0,!1);this.destroyObservable=t(e.destroy,e);this.scope=c;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",c.$root);this.value("$lang",this.lang);this.renderer=new wa(a,c);d=O.call(arguments);
d[1]=c;this.initApp.apply(this,d)},initApp:B,run:function(){this.renderer.process()},getParentCmp:function(a){a=a.parentNode;for(var b;a;){if(b=a.getAttribute("cmp-id"))return this.getCmp(b);a=a.parentNode}return null},onAvailable:function(a,b,c){var d=this.cmpListeners,e=this.components;d[a]||(d[a]=new u);b&&d[a].done(b,c);e[a]&&d[a].resolve(e[a]);return d[a]},getCmp:function(a){return this.components[a]||null},registerCmp:function(a,b,c){var d=this,e=a[c];c=function(){delete d.cmpListeners[e];delete d.components[e]};
d.components[e]=a;d.cmpListeners[e]&&d.cmpListeners[e].resolve(a);if(a.on)a.on("destroy",c);b.$on("$destroy",c)},destroy:function(){var a;this.destroyObservable();this.destroyProvider();this.renderer.destroy();this.scope.$destroy();for(a in this)this.hasOwnProperty(a)&&delete this[a]}});var I=document.documentElement,ga=function(){var a=function(b){return b===window?!0:3==b.nodeType?b.parentElement?a(b.parentElement):!0:b===I?!0:I.contains(b)};return a}(),T=function(a){var b=document.createDocumentFragment();
if(D(a)){var c=document.createElement("div");c.innerHTML=a;a=c.childNodes}if(a.nodeType)b.appendChild(a);else for(var c=-1,d=a.length>>>0;++c!==d;b.appendChild(a[0]));return b},oa=function(a){var b,c,d;if(Q(a)){d=[];b=0;for(c=a.length;b<c;b++)d.push(oa(a[b]));return d}if(a)switch(a.nodeType){case 1:return a.cloneNode(!0);case 3:return document.createTextNode(a.innerText||a.textContent);case 11:return a.cloneNode(!0)}return null},Z=function(){var a=new J,b={},c=function(a){if(!b[a]){var c=document.getElementById(a),
d;c&&(d=c.tagName.toLowerCase(),"script"==d?(d=document.createElement("div"),d.innerHTML=c.innerHTML,b[a]=T(d.childNodes)):b[a]="content"in c?c.content:T(c.childNodes))}return b[a]},d=function(a){return b[a]?b[a]:b[a]=Ea(a,{dataType:"fragment"}).then(function(c){return b[a]=c})},e=function(a){v(this,a,!0,!1);this.id=H();this.tpl&&(this.tpl=S(this.tpl));this.url&&(this.url=S(this.url));a=this.node;var b=this.tpl||this.url;a&&a.removeAttribute("mjs-include");a||(this.deferRendering=!0);if(b){if(a&&
a.firstChild&&C(a,"mjs-transclude",T(a.childNodes)),"."!=b.substr(0,1)||this.replace||(this.ownRenderer=!0,this._watcher=L(this.scope,b,this.onChange,this,null,A)),this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof
F&&this.scope.$on("destroy",this.onScopeDestroy,this)};e.prototype={_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,doRender:function(){this._renderer||(this._renderer=new wa(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){a.trigger("rendered-"+this.id,this)},on:function(b,c,d){return a.on(b+
"-"+this.id,c,d)},un:function(b,c,d){return a.un(b+"-"+this.id,c,d)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,b=a.url,e=a._watcher?a._watcher.getLastResult():a.tpl||b,k=new u;(new u(function(a){b?a(c(e)||d(b)):a(c(e)||T(e))})).done(function(b){a._fragment=
b;k.resolve(a.ownRenderer?!1:a.node)}).fail(k.reject,k);return k},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=this.node;a.firstChild;)a.removeChild(a.firstChild);this.replace?a.parentNode.replaceChild(oa(this._fragment),a):a.appendChild(oa(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new u;this._initial?(this.doApplyTemplate(),
b.resolve()):(w(a,"leave",null,!0).done(this.doApplyTemplate,this).done(b.resolve,b),w(a,"enter",null,!0));this._initial=!1;return b},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();delete this._renderer},onScopeDestroy:function(){this.destroy();delete this._renderer},destroy:function(){delete this.node;delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),delete this._watcher);delete this.tpl}};e.getTemplate=c;
e.loadTemplate=d;return e}();p("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,initialize:function(a){this.supr(a);this.scope||(this.scope=new F);a.as&&(this.scope[a.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);this.id=this.id||"cmp-"+H();this.node||this._createNode();this.initComponent.apply(this,arguments);
this.scope.$app&&this.scope.$app.registerCmp(this,this.scope,"id");var b=this.template,c=this.templateUrl;b&&b instanceof Z?b instanceof Z&&(this.template.node=this.node):this.template=b=new Z({scope:this.scope,node:this.node,deferRendering:!b,ownRenderer:!0,tpl:b,url:c});if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(b.initPromise?b.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=
document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display="none")},render:function(){this.rendered||(this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},onRenderingFinished:function(){this.renderTo?this.renderTo.appendChild(this.node):ga(this.node)||document.body.appendChild(this.node);this.rendered=!0;this.afterRender();
this.trigger("afterrender",this)},show:function(){if(this.hidden){if(!1===this.trigger("beforeshow",this))return!1;this.node.style.display="block";this.hidden=!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("beforehide",this))return!1;this.node.style.display="none";this.hidden=!0;this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},
getEl:function(){return this.node},initComponent:B,afterRender:B,onShow:B,onHide:B,onParentRendererDestroy:function(){this.destroy()},onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?ga(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.destroyScope&&this.scope&&this.scope.$destroy();delete this.scope;delete this.node;this.supr()}});var xa=function(){var a=
{};return function(b){return a[b]||(a[b]=new RegExp(b))}}(),aa=function(a,b){b&&(a.className=a.className.replace(xa("(?:^|\\s)"+b+"(?!\\S)"),""))},ha=function(a){var b=C(a,"mjsAnimationQueue"),c,d;if(Q(b)&&b.length){if(b=b[0])b.stages&&(c=b.position,d=b.stages,aa(a,d[c]),aa(a,d[c]+"-active")),b.deferred&&b.deferred.reject(b.el)}else R(b)?b(a):"stop"==b&&$(a).stop(!0,!0);C(a,"mjsAnimationQueue",null)},ya=function(a,b){return b?xa("(?:^|\\s)"+b+"(?!\\S)").test(a.className):!1},ia=function(a,b){b&&!ya(a,
b)&&(a.className+=" "+b)},ba=function(a,b,c,d,e){var f=!1!==b;b=b||{};e=e||[];c=c||b.scope;d=d||b.node;b.scope=b.scope||c;b.node=b.node||d;var g=D(a)?fa(a):a;if(!g)throw"Component "+a+" not found";c&&g.$isolateScope&&(b.scope=c=c.$newIsolated());var h,k=[];a=g.template||b.template||null;var l=g.templateUrl||b.templateUrl||null,n=c?c.$app:null,ma=La.global(),na=n?n.inject:ma.inject,y=n?n:ma,m=d?d.getAttribute("mjs-cloak"):null,r={$node:d||null,$scope:c||null,$config:b||null,$args:e||null};if(g.resolve)for(h in g.resolve)(function(a){var f=
new u,l;k.push(f.done(function(c){r[a]=c;b[a]=c;e.push(c)}));l=g.resolve[h];R(l)?f.resolve(l(c,d)):D(l)?f.resolve(na.resolve(l)):f.resolve(na.call(y,l,null,v({},r,b,!1,!1)))})(h);f&&(a||l)&&(b.template=new Z({scope:c,node:d,deferRendering:!0,ownRenderer:!0,tpl:a,url:l}),k.push(b.template.initPromise),d&&d.firstChild&&C(d,"mjs-transclude",T(d.childNodes)));f&&e.unshift(b);var s;k.length?(s=new u,u.all(k).done(function(){s.resolve(na.call(y,g,null,v({},r,b,!1,!1),e))})):s=u.resolve(na.call(y,g,null,
v({},r,b,!1,!1),e));d&&s.isPending()&&null!==m&&(m?ia(d,m):d.style.visibility="hidden",s.then(function(){m?aa(d,m):d.style.visibility=""}));d&&s.then(function(){aa(d,"mjs-cloak")});return s},Ma=X.currentUrl,Na=function(){var a=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,b=Function,c=function(a,b,c,d){for(;c&&!c.$isRoot;)if(c=c.$parent)try{return 4==arguments.length?b.call(null,c,d,B,b):b.call(null,c,B,b)}catch(e){}null!==a&&G(a)},d=function(a,b){return function(){var d=O.call(arguments);d.push(c);d.push(a);d=
a.apply(null,d);return b&&(void 0===d||"number"==typeof d&&isNaN(d))?(d=O.call(arguments),d.unshift(a),d.unshift(null),c.apply(null,d)):d}},e={},f=0,g={},h=0,k={},l=0,n=function(){1E3<=f&&(e={});1E3<=h&&(g={});1E3<=l&&(k={})};return{createGetter:function(c){try{return e[c]?e[c]:(f++,e[c]=d(new b("____","$$interceptor","$$itself","".concat("try {","return ",c.replace(a,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }")),!0))}catch(g){return G(g),B}},createSetter:function(c){try{if(!g[c]){h++;
var e=c.replace(a,"$1____.$3");return g[c]=d(new b("____","$$$$","$$interceptor","$$itself","".concat("try {",e," = $$$$",";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____, $$$$); }")))}return g[c]}catch(f){return G(f),B}},createFunc:function(c){try{return k[c]?k[c]:(l++,k[c]=d(new b("____","$$interceptor","$$itself","".concat("try {",c.replace(a,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }"))))}catch(e){return G(e),B}},resetCache:n,
enableResetCacheInterval:function(){setTimeout(n,1E4)}}}(),za=Na.createGetter,kb=/-./g,lb=function(a){return a.replace(kb,function(a){return a.charAt(1).toUpperCase()})},mb=function(){return document.documentElement.dataset?function(a){return a.dataset}:function(a){var b;if(void 0!==(b=C(a,"data")))return b;b=a.attributes;var c={},d,e;d=0;for(e=b.length;d<e;d++)c[lb(b[d].name)]=b[d].value;b=c;C(a,"data",b);return b}}(),U=function(a,b,c){var d=C(a,"config"),e;if(d)return d;d={};if(c||null!==(c=a.getAttribute("mjs-config")))for(e in a.removeAttribute("mjs-config"),
b=c?za(c)(b||{}):{},b)d[e]=b[e];b=mb(a);for(e in b)c=b[e],d[e]=""===c?!0:c;C(a,"config",d);return d};p("MetaphorJs.cmp.View",{route:null,node:null,scope:null,cmp:null,id:null,currentComponent:null,watchable:null,defaultCmp:null,initialize:function(a){v(this,a,!0,!1);a=this.node;var b=U(a,this.scope);v(this,b,!0,!1);a&&a.firstChild&&C(a,"mjs-transclude",T(a.childNodes));this.id||(this.id=H());this.scope.$app.registerCmp(this,this.scope,"id");this.route?(X.initPushState(),X.on("locationChange",this.onLocationChange,
this),this.onLocationChange()):this.cmp&&(this.watchable=L(this.scope,this.cmp,this.onCmpChange,this,null,A),this.onCmpChange())},onCmpChange:function(){var a=this.watchable.getLastResult()||this.defaultCmp;this.clearComponent();a&&this.setComponent(a)},onLocationChange:function(){var a=Ma(),b=this.route,c,d,e,f,g;d=0;for(e=b.length;d<e;d++){f=b[d];if(f.reg&&(g=a.match(f.reg))){this.changeRouteComponent(f,g);return}f["default"]&&!c&&(c=f)}this.clearComponent();c?this.setRouteComponent(c,[]):this.defaultCmp&&
this.setComponent(this.defaultCmp)},changeRouteComponent:function(a,b){ha(this.node);this.clearComponent();this.setRouteComponent(a,b)},clearComponent:function(){var a=this,b=a.node;a.currentComponent&&w(b,"leave",null,!0).done(function(){a.currentComponent.destroy();for(a.currentComponent=null;b.firstChild;)b.removeChild(b.firstChild)})},setRouteComponent:function(a,b){var c=this,d=c.node,e=a.params;w(d,"enter",function(){var f=b||[],g={destroyEl:!1,node:d,scope:a.$isolateScope?c.scope.$newIsolated():
c.scope.$new()},h,k;a.as&&(g.as=a.as);a.template&&(g.template=a.template);f.shift();if(e)for(h=-1,k=e.length;++h<k;g[e[h]]=f[h]);return ba(a.cmp||"MetaphorJs.cmp.Component",g,g.scope,d,null,f).done(function(a){c.currentComponent=a})},!0)},setComponent:function(a){var b=this,c=b.node;w(c,"enter",function(){var d=Ka(a)?a:{},e=(D(a)?a:null)||"MetaphorJs.cmp.Component",f=d.scope||b.scope.$new();d.destroyEl=!1;return ba(e,d,f,c).done(function(a){b.currentComponent=a})},!0)},destroy:function(){this.clearComponent();
this.route&&(X.un("locationchange",this.onLocationChange,this),delete this.route);this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),delete this.watchable);delete this.scope;delete this.currentComponent}});var m=va.registerAttributeHandler,ca=function(){return!1};m("mjs-app",100,ca);var Oa=function(a){var b=a.nodeName.toLowerCase();a=a.type;return"input"!=b&&"textarea"!=b&&"select"!=b||"submit"==a||"reset"==a||"button"==a?!1:!0},nb=function(){var a=document.createElement("div");
return D(a.textContent)?"textContent":"innerText"}(),M=p("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,autoOnChange:!0,initialize:function(a,b,c){var d;c=S(c);this.node=b;this.expr=c;this.scope=a;this.watcher=L(a,c,this.onChange,this,null,A);if(this.autoOnChange&&void 0!=(d=this.watcher.getLastResult()))this.onChange(d,void 0);a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){this.destroy()},onChange:function(){},destroy:function(){delete this.node;
delete this.scope;this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)}});m("mjs-bind",1E3,p(null,M,{isInput:!1,input:null,lockInput:null,recursive:!1,textRenderer:null,initialize:function(a,b,c){this.isInput=Oa(b);this.recursive=null!==b.getAttribute("mjs-recursive");this.lockInput=null!==b.getAttribute("mjs-lock-input");b.removeAttribute("mjs-recursive");b.removeAttribute("mjs-lock-input");this.isInput&&(this.input=new ka(b,this.onInputChange,this));this.recursive?
(this.scope=a,this.node=b,this.textRenderer=new Ia(a,"{{"+c+"}}",null,null,!0),this.textRenderer.subscribe(this.onTextRendererChange,this),this.onTextRendererChange(),a instanceof F&&a.$on("destroy",this.onScopeDestroy,this)):this.supr(a,b,c)},onInputChange:function(){if(this.lockInput)this.onChange()},onTextRendererChange:function(){this.updateElement(this.textRenderer.getString())},onChange:function(){var a=this.watcher.getLastResult();this.updateElement(a)},updateElement:function(a){this.isInput?
this.input.setValue(a):this.node[nb]=a},destroy:function(){this.textRenderer&&(this.textRenderer.destroy(),delete this.textRenderer);this.input&&(this.input.destroy(),delete this.input);this.supr()}}));m("mjs-bind-html",1E3,p(null,"attr.mjs-bind",{updateElement:function(a){this.node.innerHTML=a}}));(function(){var a=function(a,c,d,e){if(null!==d){if(d==ya(a,c))return;d=!d}else d=ya(a,c);d?e?w(a,[c+"-remove"],null,!0).done(function(){aa(a,c)}):aa(a,c):e?w(a,[c+"-add"],null,!0).done(function(){ia(a,
c)}):ia(a,c)};m("mjs-class",1E3,p(null,M,{initial:!0,onChange:function(){var b=this.node,c=this.watcher.getLastResult(),d=this.watcher.getPrevValue(),e;ha(b);if(D(c))d&&a(b,d,!1,!1),a(b,c,null,!this.initial);else if(Q(c))for(e=-1,d=c.length;++e<d;a(b,c[e],!0,!this.initial));else for(e in c)a(b,e,c[e]?!0:!1,!this.initial);this.initial=!1}}))})();m("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,b,c){a&&(a[c]=b)}]);(function(){var a=function(a,c,d,e){var f,g,h,k,l,n=U(c,a);d=d.split(" ");
h=0;for(k=d.length;h<k;h++)l=d[h],""!=l&&"as"!=l&&(f?g=l:f=l);e=v({scope:a,node:c,as:g,parentRenderer:e,destroyScope:!0},n,!1,!1);ba(f,e,a,c);return!1};a.$breakScope=!0;m("mjs-cmp",200,a)})();m("mjs-config",50,function(a,b,c){U(b,a,c)});var z=function(a){a=a||{};this._queue=[];this._map={};this.id="$$"+H();for(var b in a)this[b]=a[b]};z.REPLACE=1;z.ONCE=2;z.MULTIPLE=3;z.ONCE_EVER=3;z.prototype={_queue:null,_map:null,_nextRequested:!1,_running:!1,length:0,id:null,async:!0,auto:!0,thenable:!1,stack:!1,
context:null,mode:z.MULTIPLE,add:function(a,b,c,d,e,f){var g=this.id,h=a[g]||H();b={id:h,fn:a,context:b,args:c,async:f};d=d||this.mode;a[g]=h;if(d==z.ONCE_EVER&&a[g])return a[g];if(this._map[h])if(d==z.REPLACE)this.remove(h);else if(d==z.ONCE)return h;this._queue[e?"unshift":"push"](b);this._map[h]=b;this.length=this._queue.length;this.auto&&this.next();return h},append:function(a,b,c,d,e){return this.add(a,b,c,d,!1,e)},prepend:function(a,b,c,d,e){return this.add(a,b,c,d,!0,e)},remove:function(a){var b=
this._queue,c,d;c=0;for(d=b.length;c<d;c++)if(b[c].id==a){b.splice(c,1);break}delete this._map[a]},next:function(){var a=this,b;if(a._running)a._nextRequested=!0;else if(a._nextRequested=!1,b=a._queue[a.stack?"pop":"shift"](),a.length=a._queue.length,b)if(a._running=!0,delete a._map[b.id],a.async||b.async){var c=0;1===P(b.async)?c=b.async:1===P(a.async)&&(c=a.async);ua(function(){try{a._processResult(b.fn.apply(b.context||a.context,b.args||[]))}catch(c){throw G(c),a._finish(),c;}},null,null,c)}else try{a._processResult(b.fn.apply(b.context||
a.context,b.args||[]))}catch(d){throw G(d),a._finish(),d;}},_processResult:function(a){var b=this;b.thenable&&Y(a)?a.then(function(){b._finish()},function(){b._finish()}):b._finish();return a},_finish:function(){this._running=!1;(this.auto||this._nextRequested)&&this.next()},destroy:function(){delete this._queue;delete this._map;delete this.context;this._running=this._nextRequested=!1;this.next=B}};var Aa=function(a){a=P(a);return 3>a&&-1<a},da=function(){var a,b;if("undefined"!=typeof window){var c=
window;a=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame;b=c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.webkitCancelRequestAnimationFrame;if(a)return function(c){var e=a(c);return function(){b(e)}}}return function(a){var b=setTimeout(a,0);return function(){clearTimeout(b)}}}(),N=function(){return window.getComputedStyle?function(a,b,c){if(a===window)return b?c?0:null:{};a=getComputedStyle(a,null);b=b?a[b]:a;return c?parseFloat(b)||
0:b}:function(a,b,c){a=a.currentStyle||a.style||{};b=b?a[b]:a;return c?parseFloat(b)||0:b}}(),Ba=function(){var a=/(auto|scroll)/,b,c=function(a){a=N(a);return a.overflow+a.overflowY+a.overflowY};return function(d){b||(b=document.body);for(;d&&d!==b;){if(a.test(c(d)))return d;d=d.parentNode}return window}}(),Pa=function(a){var b,c=a?"pageYOffset":"pageXOffset",d=a?"scrollTop":"scrollLeft";a=document;var e=a.body,f=a.documentElement;b=void 0!==window[c]?function(){return window[c]}:f.clientHeight?
function(){return f[d]}:function(){return e[d]};return function(a){return a&&a!==window?a&&1==a.nodeType&&a!==e&&a!==f?a[d]:b():b()}},pa=Pa(!0),qa=Pa(!1),E=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},V=function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)},ra=function(a){var b={top:0,left:0};if(!ga(a)||a===window)return b;a.getBoundingClientRect&&(b=a.getBoundingClientRect());return{top:b.top+pa()-I.clientTop,left:b.left+qa()-I.clientLeft}},
Qa=function(a,b){var c,d,e={top:0,left:0};if(a===window||a===I)return e;if("fixed"==N(a,"position"))d=a.getBoundingClientRect();else{if(b)return e=ra(a),c=ra(b),e={left:e.left-c.left,top:e.top-c.top},0>e.left&&(e.left=0),0>e.top&&(e.top=0),e;for(c=a.offsetParent||I;c&&c!=I&&"static"==N(c,"position");)c=c.offsetParent;c=c||I;d=ra(a);c!==I&&(e=ra(c));e.top+=N(c,"borderTopWidth",!0);e.left+=N(c,"borderLeftWidth",!0)}return{top:d.top-e.top-N(a,"marginTop",!0),left:d.left-e.left-N(a,"marginLeft",!0)}},
W=function(a,b,c){if(!(this instanceof W))return new W(a,b,c);this.commonInit(a,b,c);this.init(a,b,c);this.queue.add(this.render,this,[K(this.watcher.getLastResult())])};W.prototype={id:null,observable:null,model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,trackBy:null,trackByWatcher:null,animateMove:!1,animate:!1,trackByFn:null,griDelegate:null,queue:null,buffered:!1,itemSize:null,itemsOffsite:1,bufferState:null,scrollOffset:0,horizontal:!1,bufferEventDelegate:null,
topStub:null,botStub:null,commonInit:function(a,b,c){b.removeAttribute("mjs-include");this.parseExpr(c);this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.queue=new z({async:!1,auto:!0,thenable:!0,stack:!1,context:this,mode:z.ONCE});a=U(b,a);this.animateMove=!a.buffered&&a.animateMove&&w.cssAnimations;this.animate=!a.buffered&&(null!==b.getAttribute("mjs-animate")||a.animate);b.removeAttribute("mjs-animate");
this.id=a.id||H();a.observable&&(this.observable=new J,v(this,this.observable.getApi(),!0,!1));this.parentEl.removeChild(b);a.buffered&&this.initBuffering(a)},init:function(a,b){var c=C(b,"config")||{};this.watcher=L(a,this.model,this.onChange,this,null,A);(this.trackBy=c.trackBy)&&"$"!=this.trackBy?this.trackByWatcher=L(a,this.trackBy,this.onChangeTrackBy,this,null,A):"$"==this.trackBy||this.watcher.hasInputPipes()||(this.trackBy="$$"+this.watcher.id);this.griDelegate=t(this.scopeGetRawIndex,this)},
triggerIf:function(){this.observable&&this.trigger.apply(null,arguments)},render:function(a){var b=this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,f=this.buffered,g=document.createDocumentFragment(),h,k,l;k=0;for(l=a.length;k<l;k++)h=c.cloneNode(!0),b.push(this.createItem(h,a,k)),f||(g.appendChild(h),b[k].attached=!0);f?(this.getScrollOffset(),this.updateScrollBuffer()):(this.doUpdate(),d.insertBefore(g,e));this.triggerIf("render",this)},doUpdate:function(a,b,c,d){var e=this.renderers;a=a||
0;var f=e.length;b=b||f-1;var g=this.watcher.getLastResult(),h=this.getTrackByFunction();for(b>f-1&&(b=f-1);a<=b;a++)c&&e[a].action!=c||this.renderItem(a,e,g,h,d)},renderItem:function(a,b,c,d,e){c=c||this.watcher.getLastResult();b=b||this.renderers;d=d||this.getTrackByFunction();var f=b[a],g=f.scope;b=b.length-1;var h=!(a%2);e&&f.rendered||(g.$index=a,g.$first=0===a,g.$last=a===b,g.$even=h,g.$odd=!h,g.$trackId=d(c[a]),g.$getRawIndex=this.griDelegate,f.renderer?g.$check():(f.renderer=new wa(f.el,g),
f.renderer.process(),f.rendered=!0))},createItem:function(a,b,c){var d=this.itemName,e=this.scope.$new();e[d]=this.getListItem(b,c);return{index:c,action:"enter",el:a,scope:e,attached:!1,rendered:!1}},onChange:function(a,b){this.queue.prepend(this.applyChanges,this,[b],z.REPLACE)},applyChanges:function(a){var b=this,c=b.renderers,d=b.tpl,e=0,f=K(b.watcher.getLastResult()),g=null,h=b.animateMove,k=b.animate,l=[],n=b.itemName,ma=c.slice(),m=!1,q,t,r,s,p,v;a=b.watcher.getMovePrescription(a,b.getTrackByFunction(),
f);r=0;for(s=a.length;r<s;r++)q=a[r],1===P(q)?(t=q,q=c[t],t!=e&&null===g&&(g=r),q.action="move",q.scope[n]=b.getListItem(f,r),m=h,l.push(q),c[t]=null,e++):(null===g&&(g=r),p=b.createItem(d.cloneNode(!0),f,r),l.push(p));b.renderers=l;if(k){b.doUpdate(g,null,"enter");m&&(v=b.calculateTranslates(l,ma,c));var d=[],x=new u,z=new u,B=new u,C=u.counter(l.length),e=function(){C.countdown();return x};r=0;for(s=c.length;r<s;r++)if(p=c[r])p.scope.$destroy(),ha(p.el),d.push(w(p.el,"leave",null,!1,A).done(function(a){a.style.visibility=
"hidden"}));r=0;for(s=l.length;r<s;r++)p=l[r],ha(p.el),"enter"==p.action?d.push(w(p.el,"enter",e,!1,A)):d.push(b.moveAnimation(p.el,m?v[r][0]:null,m?v[r][1]:null,e,z));C.done(function(){da(function(){z.resolve();b.applyDomPositions(c);m||b.doUpdate(g,null,"move");da(function(){x.resolve()});b.triggerIf("change",b)})});u.all(d).always(function(){da(function(){b.doUpdate(g||0);b.removeOldElements(c);if(m)for(b.doUpdate(g,null,"move"),r=0,s=l.length;r<s;r++)p=l[r],p.el.style[w.prefixes.transform]=null,
p.el.style[w.prefixes.transform]="";B.resolve()})});return B}b.buffered?(b.getScrollOffset(),b.removeOldElements(c),b.queue.append(b.updateScrollBuffer,b,[!0])):(b.applyDomPositions(),b.doUpdate(g||0),b.removeOldElements(c));b.triggerIf("change",b)},removeOldElements:function(a){var b,c,d,e=this.parentEl;b=0;for(c=a.length;b<c;b++)(d=a[b])&&d.attached&&(d.attached=!1,e.removeChild(d.el))},applyDomPositions:function(a){var b=this.renderers,c=this.parentEl,d=this.prevEl,d=d?d.nextSibling:c.firstChild,
e,f,g,h,k;f=0;for(g=b.length;f<g;f++)k=b[f],h=k.el,(e=a&&a[f]?a[f].el.nextSibling:0<f?b[f-1].el.nextSibling||d:d)&&h.nextSibling!==e?c.insertBefore(h,e):e||c.appendChild(h),k.attached=!0},getListItem:function(a,b){return a[b]},onChangeTrackBy:function(a){this.trackByFn=null;this.trackBy=a},getTrackByFunction:function(){var a;this.trackByFn||((a=this.trackBy)&&"$"!=a?R(a)?this.trackByFn=a:this.trackByFn=function(b){return b&&!Aa(b)?b[a]:void 0}:this.trackByFn=function(a){return Aa(a)?a:void 0});return this.trackByFn},
scopeGetRawIndex:function(a){if(void 0===a)return-1;var b=this.watcher.getUnfilteredValue(),c=this.getTrackByFunction(),d,e;d=0;for(e=b.length;d<e;d++)if(c(b[d])===a)return d;return-1},getNodePositions:function(a,b,c){for(var d=[],e,f,g,h={};a.firstChild;)a.removeChild(a.firstChild);e=0;for(f=b.length;e<f;e++)c&&c[e]&&(g=c[e].el.cloneNode(!0),a.appendChild(g)),g=b[e].el.cloneNode(!0),a.appendChild(g),d.push(g);e=0;for(f=d.length;e<f;e++)a=d[e],(c=b[e].renderer)&&(h[c.id]={left:a.offsetLeft,top:a.offsetTop});
return h},calculateTranslates:function(a,b,c){var d=this.parentEl,e=d.parentNode,f=d.cloneNode(!0),g=d.offsetWidth,h=[],k=0,l=0,n;n=f.style;n.position="absolute";n.left="-10000px";n.visibility="hidden";n.width=g+"px";e.insertBefore(f,d);n.width=g-(f.offsetWidth-g)+"px";b=this.getNodePositions(f,b);c=this.getNodePositions(f,a,c);d=this.getNodePositions(f,a);e.removeChild(f);e=0;for(f=a.length;e<f;e++)g=a[e].el,n=a[e].renderer,n=n.id,0==e&&(k=g.offsetLeft,l=g.offsetTop),h.push([{left:d[n].left-k-(c[n].left-
k),top:d[n].top-l-(c[n].top-l)},b[n]?{left:b[n].left-k-(c[n].left-k),top:b[n].top-l-(c[n].top-l)}:null]);return h},moveAnimation:function(a,b,c,d,e){var f=a.style;e.done(function(){c&&(f[w.prefixes.transform]="translateX("+c.left+"px) translateY("+c.top+"px)")});return w(a,"move",d,!1,A,function(a,c,d){0==c&&"start"!=d&&b&&(f[w.prefixes.transform]="translateX("+b.left+"px) translateY("+b.top+"px)")})},initScrollParent:function(a){this.scrollEl=Ba(this.parentEl)},initScrollStubs:function(a){var b=
this.parentEl,c=this.prevEl,d,e,f={fontSize:0,lineHeight:0,padding:0,paddingTop:0,paddingLeft:0,paddingBottom:0,paddingRight:0,margin:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0};this.topStub=d=document.createElement(a.stub||"div");this.botStub=a=document.createElement(a.stub||"div");ia(d,"mjs-buffer-top");ia(a,"mjs-buffer-bottom");for(e in f)d.style[e]=f[e],a.style[e]=f[e];b.insertBefore(d,c?c.nextSibling:b.firstChild);b.insertBefore(a,this.nextEl);this.prevEl=d;this.nextEl=a},initBuffering:function(a){this.buffered=
!0;this.itemSize=a.itemSize;this.itemsOffsite=a.itemsOffsite||5;this.horizontal=a.horizontal||!1;this.initScrollParent(a);this.initScrollStubs(a);this.bufferEventDelegate=t(this.bufferUpdateEvent,this);E(this.scrollEl,"scroll",this.bufferEventDelegate);E(window,"resize",this.bufferEventDelegate)},getScrollOffset:function(){var a=Qa(this.topStub,this.scrollEl);return this.scrollOffset=this.horizontal?a.left:a.top},getBufferState:function(a){var b=this.scrollEl,c=this.horizontal,d=document.documentElement,
d=b===window?window[c?"innerWidth":"innerHeight"]||d[c?"clientWidth":"clientHeight"]:b[c?"offsetWidth":"offsetHeight"],e=c?qa(b):pa(b),b=this.itemSize,c=this.itemsOffsite,f=a?this.getScrollOffset():this.scrollOffset;a=this.renderers.length;var g,e=Math.max(0,e+f),f=Math.ceil(e/b);0>f&&(f=0);e=f;g=d=f+Math.ceil(d/b);f=f>c?f-c:0;g+=c;g>a-1&&(g=a-1);return f>g?this.bufferState:this.bufferState={first:f,last:g,viewFirst:e,viewLast:d,ot:f*b,ob:(a-g-1)*b}},updateStubs:function(a){var b=this.horizontal;
this.topStub.style[b?"width":"height"]=a.ot+"px";this.botStub.style[b?"width":"height"]=a.ob+"px"},bufferUpdateEvent:function(){this.queue.add(this.updateScrollBuffer,this)},updateScrollBuffer:function(a){var b=this,c=b.bufferState,d=b.parentEl,e=b.renderers,f=b.botStub,g=b.getBufferState(!1),h=new u,k,l,n,m;if(!g)return null;c&&g.first==c.first&&g.last==c.last||b.triggerIf("bufferchange",b,g,c);da(function(){if(a||!c||g.last<c.first||g.first>c.last){if(c)for(l=c.first,n=c.last;l<=n;l++)(m=e[l])&&
m.attached&&(d.removeChild(m.el),m.attached=!1);k=document.createDocumentFragment();l=g.first;for(n=g.last;l<=n;l++)if(m=e[l])m.rendered||b.renderItem(l),k.appendChild(m.el),m.attached=!0;d.insertBefore(k,f)}else{if(c.first<g.first)for(l=c.first,n=g.first;l<n;l++)(m=e[l])&&m.attached&&(d.removeChild(m.el),m.attached=!1);else if(c.first>g.first){k=document.createDocumentFragment();l=g.first;for(n=c.first;l<n;l++)if(m=e[l])m.rendered||b.renderItem(l),k.appendChild(m.el),m.attached=!0;d.insertBefore(k,
e[c.first].el)}if(c.last<g.last){k=document.createDocumentFragment();l=c.last+1;for(n=g.last;l<=n;l++)if(m=e[l])m.rendered||b.renderItem(l),k.appendChild(m.el),m.attached=!0;d.insertBefore(k,f)}else if(c.last>g.last)for(l=g.last+1,n=c.last;l<=n;l++)(m=e[l])&&m.attached&&(d.removeChild(m.el),m.attached=!1)}b.updateStubs(g);b.triggerIf("bufferupdate",b);b.onBufferStateChange(g,c);h.resolve()});return h},scrollTo:function(a){var b=this.itemSize,c=this.scrollEl||Ba(this.parentEl),d=this.horizontal,e=
d?"scrollLeft":"scrollTop",f=new u,g;this.buffered&&this.queue.append(function(){da(function(){g=b*a;c===window?window.scrollTo(d?g:qa(),d?pa():g):c[e]=g;f.resolve()});return f});return f},onBufferStateChange:function(a,b){},parseExpr:function(a){a=a.split(" ");var b,c,d,e,f;b=0;for(c=a.length;b<c;b++)if(f=a[b],""!=f&&"in"!=f)if(e){d=a.slice(b).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"},destroy:function(){var a=this.renderers,b=this.parentEl,c,d;c=0;for(d=a.length;c<d;c++)a[c].renderer.destroy();
delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.trackByWatcher&&(this.trackByWatcher.unsubscribeAndDestroy(),delete this.trackByWatcher);this.buffered&&(b.removeChild(this.topStub),b.removeChild(this.botStub),V(this.scrollEl,"scroll",this.bufferEventDelegate),V(window,"resize",this.bufferEventDelegate),delete this.bufferEventDelegate);delete this.topStub;delete this.botStub;this.queue.destroy();delete this.queue;this.watcher.unsubscribeAndDestroy(this.onChange,
this);delete this.watcher;this.observable&&(this.trigger("destroy",this),this.observable.destroy(),delete this.observable)}};W.$stopRenderer=!0;W.$registerBy="id";m("mjs-each",100,W);var Ca=Na.createFunc,sa=function(){return!0},ja=function(a){if(a instanceof ja)return a;if(!(this instanceof ja))return new ja(a);for(var b in a)if(!this[b])try{this[b]=a[b]}catch(c){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var d,e=a.button;void 0===this.pageX&&null!==
a.clientX&&(d=this.target?this.target.ownerDocument||document:document,b=d.documentElement,d=d.body,this.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0),this.pageY=a.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0));this.which||void 0===e||(this.which=e&1?1:e&2?3:e&4?2:0);this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?sa:ca;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};ja.prototype=
{isDefaultPrevented:ca,isPropagationStopped:ca,isImmediatePropagationStopped:ca,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=sa;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=sa;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=sa;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}};
(function(){var a="click dblclick mousedown mouseup mouseover mouseout mousemove keydown keyup keypress submit focus blur copy cut paste enter".split(" "),b,c;b=0;for(c=a.length;b<c;b++)(function(a){var b=a;"enter"==b&&(b="keyup");m("mjs-"+a,1E3,function(c,g,h){var k=Ca(h);g.removeAttribute("mjs-"+a);E(g,b,function(b){b=new ja(b||window.event);if("enter"==a&&13!=b.keyCode)return null;c.$event=b;k(c);delete c.$event;c.$root.$check();b.preventDefault();return!1})})})(a[b])})();m("mjs-show",500,p(null,
M,{initial:!0,initialize:function(a,b,c){this.supr(a,b,c)},runAnimation:function(a){var b=this.node.style,c=function(){b.display=a?"":"none"};this.initial?c():w(this.node,a?"show":"hide",function(){a&&(b.display="")},!0).done(c)},onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));m("mjs-hide",500,p(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(!a);this.initial=!1}}));m("mjs-if",500,p(null,M,{parentEl:null,
prevEl:null,el:null,initial:!0,initialize:function(a,b,c){this.parentEl=b.parentNode;this.prevEl=b.previousSibling;this.supr(a,b,c)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,d=a.node,e=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},f=function(){c.removeChild(d)};b?ga(d)||(a.initial?e():w(d,"enter",e,!0)):ga(d)&&(a.initial?f():w(d,"leave",null,!0).done(f));
a.initial=!1}}));m("mjs-ignore",0,ca);m("mjs-include",900,function(a,b,c,d){a=new Z({scope:a,node:b,url:c,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});m("mjs-init",250,function(a,b,c){b.removeAttribute("mjs-init");Ca(c)(a)});var Ra=navigator.userAgent.toLowerCase(),Sa=function(){var a=parseInt((/msie (\d+)/.exec(Ra)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/.exec(Ra)||[])[1],10)||!1);return function(){return a}}();m("mjs-model",1E3,p(null,M,{inProg:!1,input:null,binding:null,
autoOnChange:!1,initialize:function(a,b,c){var d=U(b,a);this.node=b;this.input=new ka(b,this.onInputChange,this);this.binding=d.binding||"both";this.supr(a,b,c);a=this.input.getValue();b=this.watcher.getLastResult();if(b!=a)if("input"!=this.binding&&void 0!=b)this.onChange(b);else if("scope"!=this.binding&&void 0!=a)this.onInputChange(a)},onInputChange:function(a){var b=this.scope;"scope"!=this.binding&&(a&&D(a)&&-1!=a.indexOf("\\{")&&(a=a.replace(/\\{/g,"{")),this.watcher.getLastResult()!=a&&(this.watcher.setValue(a),
this.inProg=!0,b instanceof F?b.$root.$check():this.watcher.checkAll(),this.inProg=!1))},destroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var a=this.watcher.getLastResult(),b;"input"==this.binding||this.inProg||((b=Sa())&&8>b?ua(this.input.setValue,this.input,[a]):this.input.setValue(a))}}));m("mjs-options",100,p(null,M,{model:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,initialize:function(a,b,c){this.parseExpr(c);this.node=
b;this.scope=a;for(this.defOption=b.options.length?b.options[0]:null;b.firstChild;)b.removeChild(b.firstChild);this.defOption&&this.defOption.setAttribute("mjs-default-option","");try{this.watcher=L(a,this.model,this.onChange,this,null,A)}catch(d){G(d)}this.render(K(this.watcher.getValue()))},onChange:function(){this.render(K(this.watcher.getValue()))},renderOption:function(a,b,c){var d=this.groupEl||this.fragment,e=Sa();c.item=a;c.$index=b;a=this.getterFn(c);void 0!=a.group&&(a.group=""+a.group);
a.group!==this.prevGroup&&(a.group?(this.groupEl=d=document.createElement("optgroup"),d.setAttribute("label",a.group),a.disabledGroup&&d.setAttribute("disabled","disabled"),this.fragment.appendChild(d)):(d=this.fragment,this.groupEl=null));this.prevGroup=a.group;b=document.createElement("option");b.setAttribute("value",a.value);b.text=a.name;e&&9>e&&(b.innerHTML=a.name);a.disabled&&b.setAttribute("disabled","disabled");d.appendChild(b)},render:function(a){var b=this.node,c=db(b),d=this.defOption,
e=this.scope.$new(),f,g;this.fragment=document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;b.firstChild;)b.removeChild(b.firstChild);f=0;for(g=a.length;f<g;f++)this.renderOption(a[f],f,e);d&&b.insertBefore(d,b.firstChild);e.$destroy();b.appendChild(this.fragment);this.fragment=null;eb(b,c)},parseExpr:function(a){var b=a.indexOf(" in "),c;-1==b?(c=a,a="{name: .item, value: .$index}"):(c=a.substr(b+4),a=a.substr(0,b));this.model=c;this.getterFn=za(a)}}));(function(){var a="selected checked disabled readonly open required".split(" "),
b,c;b=0;for(c=a.length;b<c;b++)(function(a){m("mjs-"+a,1E3,p(null,M,{onChange:function(b){b?this.node.setAttribute(a,a):this.node.removeAttribute(a)}}))})(a[b])})();var ob=function(){var a={},b=0;return function(c){if(a[c])return u.resolve(c);1E3<b&&(a={},b=0);var d=document.createElement("img"),e=d.style,f=new u;E(d,"load",function(){a[c]=!0;b++;document.body.removeChild(d);f.resolve(c)});e.position="absolute";e.visibility="hidden";e.left="-10000px";e.top="0";d.src=c;document.body.appendChild(d);
return f}}(),Ta=document.body,pb=function(){var a;return function(){if(void 0===a){var b=document.createElement("div"),c=document.createElement("div");c.style&&window.getComputedStyle?(b.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",b.appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",c.innerHTML="",Ta.appendChild(b),
c="4px"===window.getComputedStyle(c,null).width,Ta.removeChild(b),a=c):a=!1}return a}}(),Ua=function(a,b){var c=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,d=["Top","Right","Bottom","Left"],e=a?"inner"==a?"padding":"":"content";return function(a,g){if(a===window)return a.document.documentElement["client"+b];if(9===a.nodeType){var h=a.documentElement;return Math.max(a.body["scroll"+b],h["scroll"+b],a.body["offset"+b],h["offset"+b],h["client"+b])}a:{var k=b.toLowerCase(),l=e||(!0===g?"margin":
"border"),h=N(a),m=!0,q="width"===k?a.offsetWidth:a.offsetHeight,p="border-box"===h.boxSizing;if(0>=q||null==q){q=a.style[k];if(c.test(q)){h=q;break a}m=p&&(pb()||q===a.style[k]);q=parseFloat(q)||0}l=l||(p?"border":"content");k=l===(m?"border":"content")?4:"width"===k?1:0;for(p=0;4>k;k+=2)"margin"===l&&(p+=parseFloat(h[l+d[k]])),m?("content"===l&&(p-=parseFloat(h["padding"+d[k]])),"margin"!==l&&(p-=parseFloat(h["border"+d[k]+"Width"]))):(p+=parseFloat(h["padding"+d[k]]),"padding"!==l&&(p+=parseFloat(h["border"+
d[k]+"Width"])));h=q+p}return h}},qb=Ua("","Width"),rb=Ua("","Height");m("mjs-src",1E3,p(null,M,{scrollEl:null,scrollDelegate:null,resizeDelegate:null,position:null,sw:null,sh:null,queue:null,checkVisibility:!0,usePreload:!0,initialize:function(a,b,c){var d=U(b,a);d.deferred?(this.scrollEl=Ba(b),this.scrollDelegate=t(this.onScroll,this),this.resizeDelegate=t(this.onResize,this),E(this.scrollEl,"scroll",this.scrollDelegate),E(window,"resize",this.resizeDelegate)):this.checkVisibility=!1;d.noPreload&&
(this.usePreload=!1);this.queue=new z({auto:!0,async:!0,mode:z.ONCE});this.supr(a,b,c)},isVisible:function(){if(!this.checkVisibility)return!0;var a=this.scrollEl,b=pa(a),c=qa(a),d=this.sw,e=this.sh,f;this.position||(this.position=Qa(this.node,a));d||(d=this.sw=qb(a),e=this.sh=rb(a));a=this.position.top;f=this.position.left;return a>b&&a<b+e&&f>c&&f<c+d},onScroll:function(){this.queue.add(this.changeIfVisible,this)},onResize:function(){this.sw=this.position=null;this.queue.add(this.changeIfVisible,
this)},onChange:function(){this.queue.add(this.changeIfVisible,this)},changeIfVisible:function(){var a=this;if(a.isVisible()){var b=a.watcher.getLastResult();a.stopWatching();a.usePreload?ob(b).done(function(){a&&a.node&&da(function(){a.node.src=b;a.node.setAttribute("src",b)})}):(a.node.src=b,a.node.setAttribute("src",b))}},stopWatching:function(){this.scrollEl&&(V(this.scrollEl,"scroll",this.scrollDelegate),V(window,"resize",this.resizeDelegate),delete this.scrollDelegate,delete this.resizeDelegate,
delete this.scrollEl,this.queue.destroy(),delete this.queue,this.checkVisibility=!1)},destroy:function(){this.stopWatching();this.supr()}}));var Va=function(a){var b;a:{for(var c=a,d;c;){d=C(c,"mjs-transclude");if(void 0!==d){b=d;break a}c=c.parentNode}b=void 0}if(b){a.firstChild&&C(a,"mjs-transclude",T(a.childNodes));c=a.parentNode;d=a.nextSibling;b=oa(b);var e=K(b.childNodes);c.removeChild(a);c.insertBefore(b,d);return e}return null};m("mjs-transclude",1E3,function(a,b){return Va(b)});m("mjs-view",
200,function(a,b,c){b.removeAttribute("mjs-view");ba(c||"MetaphorJs.cmp.View",{scope:a,node:b},a,b);return!1});var Wa=va.registerTagHandler;Wa("mjs-include",900,function(a,b,c,d){return(new Z({scope:a,node:b,tpl:b.getAttribute("src"),parentRenderer:d,replace:!0})).initPromise});Wa("mjs-transclude",900,function(a,b){return Va(b)});var sb=function(){var a=function(a,b,c){if(R(b))return b(a,c);if(""===b||void 0===b)return!0;if(void 0!==a){if(la(a))return a===b;if(b instanceof RegExp)return b.test(""+
a);if("strict"==c)return""+a===""+b;if(!0===c||null===c||void 0===c)return-1!=""+a.indexOf(b);if(!1===c)return-1==""+a.indexOf(b)}return!1},b=function(b,c,f){if(Aa(b))return void 0===c.$?!0:a(b,c.$,f);var g,h;for(g in c)if("$"==g)for(h in b){if(a(b[h],c.$,f))return!0}else if(a(b[g],c[g],f))return!0;return!1},c=function(a,c,f){ea(c)||(c={$:c});var g=[],h,k;h=-1;for(k=a.length;++h<k;)b(a[h],c,f)&&g.push(a[h]);return g};c.compare=b;return c}();x("filter.filter",function(a,b,c,d){return sb(a,c,d)});x("filter.join",
function(a,b,c){c=c||", ";return a&&a.length?(Q(a)||(a=K(a)),a.join(c)):""});x("filter.l",function(a,b){return b.$app.lang.get(a)});x("filter.limitTo",function(a,b,c){b=D(a);if(!Q(a)&&!b)return a;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);if(b)return c?0<=c?a.slice(0,c):a.slice(c,a.length):"";b=[];var d;c>a.length?c=a.length:c<-a.length&&(c=-a.length);0<c?d=0:(d=a.length+c,c=a.length);for(;d<c;d++)b.push(a[d]);return b});x("filter.linkify",function(a,b,c){return a?a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,
'<a href="$1"'+(c?' target="'+c+'"':"")+">$1</a>"):""});x("filter.lowercase",function(a){return a.toLowerCase()});var tb={};x("filter.moment",function(a,b,c){c=tb[c]||c;return moment(a).format(c)});var ub={};x("filter.numeral",function(a,b,c){c=ub[c]||c;return numeral(a).format(c)});x("filter.p",function(a,b,c){return b.$app.lang.plural(a,parseInt(c,10)||0)});var vb=function(a,b,c){c||(c="asc");a=a.slice();a.sort(function(a,c){var f=typeof a,g=a,h=c;if(f!=typeof c)return 0;"object"==f&&(R(b)?(g=b(a),
h=b(c)):(g=a[b],h=c[b]));if("number"==typeof g)return g-h;g=(""+g).toLowerCase();h=(""+h).toLowerCase();return g===h?0:g>h?1:-1});return"desc"==c?a.reverse():a};x("filter.sortBy",function(a,b,c,d){return vb(a,c,d)});x("filter.split",function(a,b,c,d){d=d||void 0;c=c||"/\\n|,/";if(!a)return[];a=""+a;"/"==c.substr(0,1)&&"/"==c.substr(c.length-1)&&(c=xa(c.substring(1,c.length-1)));a=a.split(c,d);b=-1;for(c=a.length;++b<c;a[b]=S(a[b]));return a});x("filter.toArray",function(a){return K(a)});x("filter.ucfirst",
function(a){return a.substr(0,1).toUpperCase()+a.substr(1)});x("filter.uppercase",function(a){return a.toUpperCase()});var Xa=function(a){var b=!1,c=!0,d=window,e=d.document,f=e.documentElement,g=function(c){if("readystatechange"!=c.type||"complete"==e.readyState)V("load"==c.type?d:e,c.type,g),!b&&(b=!0)&&a.call(d,c.type||c)},h=function(){try{f.doScroll("left")}catch(a){setTimeout(h,50);return}g("poll")};if("complete"==e.readyState)a.call(d,"lazy");else{if(e.createEventObject&&f.doScroll){try{c=!d.frameElement}catch(k){}c&&
h()}E(e,"DOMContentLoaded",g);E(e,"readystatechange",g);E(d,"load",g)}},Ya=function(a,b,c,d){a.removeAttribute("mjs-app");try{var e=ba(b||"MetaphorJs.cmp.App",!1,c,a,[a,c]);return!1!==d?e.done(function(a){a.run();return a}):e}catch(f){return G(f),u.reject(f)}},Da=p(null,W,function(a,b,c){if(!(this instanceof Da))return new Da(a,b,c);this.supr(a,b,c)},{store:null,pullNext:!1,pullNextDelegate:null,init:function(a,b,c){this.store=c=za(this.model)(a);this.watcher=L(c,".current",this.onChange,this,null,
A);this.trackByFn=t(c.getRecordId,c);this.griDelegate=t(c.indexOfId,c);this.bindStore(c,"on");a=U(b,a);!a.buffered&&a.pullNext&&this.initPullNext(a)},bindStore:function(a,b){a[b]("update",this.onStoreUpdate,this);a[b]("clear",this.onStoreUpdate,this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},getListItem:function(a,b){return this.store.getRecordData(a[b])},onStoreDestroy:function(){this.onStoreUpdate();this.watcher.unsubscribeAndDestroy(this.onChange,
this);delete this.watcher},initBuffering:function(a){this.supr(a);this.pullNext=a.pullNext||!1},initPullNext:function(a){this.pullNext=!0;this.itemSize=a.itemSize;this.initScrollParent();this.getScrollOffset();this.pullNextDelegate=t(this.pullNextEvent,this);E(this.scrollEl,"scroll",this.pullNextDelegate);E(window,"resize",this.pullNextDelegate)},pullNextEvent:function(){this.queue.append(this.updateStoreOnScroll,this)},updateStoreOnScroll:function(){var a=this.bufferState,b=this.getBufferState(),
c=this.store.getLength();a&&b.first==a.first&&b.last==a.last||this.triggerIf("bufferchange",this,b,a);c-b.last<(b.last-b.first)/3&&!this.store.loading&&(this.store.addNextPage(),this.triggerIf("pull",this))},onBufferStateChange:function(a,b){var c=this.store.getLength();this.supr(a,b);this.pullNext&&c-a.last<(a.last-a.first)/3&&!this.store.loading&&(this.store.addNextPage(),this.triggerIf("pull",this))},destroy:function(){this.bindStore(this.store,"un");delete this.store;this.pullNext&&!this.buffered&&
(V(this.scrollEl,"scroll",this.pullNextDelegate),V(window,"resize",this.pullNextDelegate));this.supr()}},{$stopRenderer:!0,$registerBy:"id"});m("mjs-each-in-store",100,Da);p("MetaphorJs.cmp.Dialog","MetaphorJs.cmp.Component",{dialog:null,dialogPreset:null,dialogCfg:null,initComponent:function(){this.supr();this._createDialog();this._oldShow=this.show;this._oldHide=this.hide},_getDialogCfg:function(){return v({},this.dialogCfg,{render:{el:this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=
new cb(this.dialogPreset,this._getDialogCfg());this.dialog.on("show",this._oldShow,this);this.dialog.on("hide",this._oldHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},onDialogDestroy:function(){this.destroying||(delete this.dialog,this.destroy())},onDestroy:function(){this.destroying=!0;this.dialog&&this.dialog.destroy();delete this.dialog;delete this.dialogCfg;delete this.dialogPreset;this.supr();this.destroying=
!1}});var Za=function(a,b,c){var d,e=a.childNodes;if(!1!==b.call(c,a))for(a=-1,d=e.length>>>0;++a!==d;Za(e[a],b,c));};p("MetaphorJs.view.Validator",{node:null,scope:null,validator:null,scopeState:null,initialize:function(a,b){this.node=a;this.scope=b;this.scopeState={};this.validator=this.createValidator();this.initScope();this.initScopeState();this.initValidatorEvents();this.validator.check()},createValidator:function(){var a=this.node,b={},c;if(c=a.getAttribute("mjs-validator-submit"))b.callback=
b.callback||{},b.callback.submit=function(a,b){return function(){try{return a(b)}catch(c){G(c)}}}(Ca(c),this.scope),a.removeAttribute("mjs-validator-submit");return new bb(a,b)},initValidatorEvents:function(){var a=this.validator;a.on("fieldstatechange",this.onFieldStateChange,this);a.on("statechange",this.onFormStateChange,this);a.on("displaystatechange",this.onDisplayStateChange,this);a.on("reset",this.onFormReset,this)},initScope:function(){var a=this.scope,b=this.node,b=b.getAttribute("name")||
b.getAttribute("id")||"$form";a[b]=this.scopeState},initScopeState:function(){var a=this.node,b=this.scopeState,c,d,e;a.elements?c=a.elements:(c=[],Za(a,function(a){Oa(a)&&c.push(a)}));a=-1;for(e=c.length;++a<e;)d=c[a],(d=d.getAttribute("name")||d.getAttribute("id"))&&!b[d]&&(b[d]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null});b.$invalid=!1;b.$pristine=!0;b.$submit=t(this.validator.onSubmit,this.validator);b.$reset=t(this.validator.reset,this.validator)},onDisplayStateChange:function(a,
b){if(b){b=this.scopeState;var c,d;for(c in b)d=b[c],d.$real&&(b[c]=d.$real);b.$invalid=!a.isValid();b.$pristine=!1;this.scope.$check()}else this.onFormReset(a)},onFormReset:function(a){a=this.scopeState;var b,c;for(b in a)c=a[b],c.$error=null,c.$errorMessage=null,c.$invalid=null,c.$pristine=!0;a.$invalid=!1;a.$pristine=!0;this.scope.$check()},onFormStateChange:function(a,b){var c=this.scopeState;c.$invalid=!1===b&&a.isDisplayStateEnabled();c.$pristine=!1;this.scope.$check()},onFieldStateChange:function(a,
b,c){var d=this.scopeState,e=b.getName();a=a.isDisplayStateEnabled();b={$error:b.getErrorRule(),$errorMessage:b.getError(),$invalid:!1===c,$pristine:null===b.getExactValidState()};a?d[e]=b:d[e].$real=b;this.scope.$check()}});m("mjs-validate",250,function(a,b,c){c=c||"MetaphorJs.view.Validator";var d=fa(c);d?new d(b,a):G(Error("Class '"+c+"' not found"))});q.onReady=Xa;q.initApp=Ya;q.ns=A;q.cs=Ga;q.resolveComponent=ba;q.animate=w;q.stopAnimation=ha;q.ajax=Ea;q.select=Fa;q.bind=t;q.extend=v;q.trim=
S;q.pushUrl=fb;q.currentUrl=Ma;q.history=X;q.run=function(){Xa(function(){var a=Fa("[mjs-app]"),b,c,d;b=-1;for(c=a.length;++b<c;)d=a[b],Ya(d,d.getAttribute("mjs-app"),null,!0)})};q.lib.Promise=u;q.lib.Observable=J;return q});
