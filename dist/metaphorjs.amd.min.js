'use strict';define("metaphorjs","metaphorjs-observable metaphorjs-promise metaphorjs-ajax metaphorjs-animate metaphorjs-input metaphorjs-class metaphorjs-namespace metaphorjs-select metaphorjs-validator metaphorjs-watchable metaphorjs-dialog metaphorjs-history".split(" "),function(Y,w,Ha,y,ca,F,Q,ma,Ia,na,Ja,da){function Z(d){return"object"==typeof d&&3===M(d)&&!d.nodeType&&d.constructor===Object}function ea(d){return!0===d||!1===d}function D(){}function N(d){return"object"==typeof d&&5===M(d)}function z(d){return"string"==
typeof d||d===""+d}function I(d){if(d&&void 0!=!d.length&&d!==""+d){for(var a=[],b=-1,c=d.length>>>0;++b!==c;a[b]=d[b]);return a}return d?[d]:[]}function O(d){return"function"==typeof d}function R(d){if(!d||!d.then)return!1;var a,b;return"object"!=(b=typeof d)&&"function"!=b?!1:O(a=d.then)?a:!1}function oa(d,a,b,c){setTimeout(function(){d.apply(a,b||[])},c||0)}function J(d){var a=d.stack||Error().stack;if("undefined"!=typeof console&&console.log)oa(function(){console.log(d);a&&console.log(a)});else throw d;
}function Ka(d){var a={},b,c,e=d.attributes;d=0;for(b=e.length;d<b;d++)c=e[d],a[c.name]=c.value;return a}function wa(d){if(null===d||"object"!=typeof d)return!1;d=M(d);return 2<d||-1==d}function P(d){var a=document.createDocumentFragment();if(z(d)){var b=document.createElement("div");b.innerHTML=d;d=b.childNodes}if(d.nodeType)a.appendChild(d);else for(var b=-1,c=d.length>>>0;++b!==c;a.appendChild(d[0]));return a}function S(d,a){a&&(d.className=d.className.replace(pa("(?:^|\\s)"+a+"(?!\\S)"),""))}
function qa(d){d=M(d);return 3>d&&-1<d}function La(d){return d.replace(Ma,function(a){return a.charAt(1).toUpperCase()})}function B(d,a,b){var c=C(d,"config"),e;if(c)return c;c={};if(b||null!==(b=d.getAttribute("mjs-config")))for(e in d.removeAttribute("mjs-config"),a=b?ra(b)(a||{}):{},a)c[e]=a[e];a=Na(d);for(e in a)b=a[e],c[e]=""===b?!0:b;C(d,"config",c);return c}function sa(d,a){return a?pa("(?:^|\\s)"+a+"(?!\\S)").test(d.className):!1}function ta(d,a){a&&!sa(d,a)&&(d.className+=" "+a)}function fa(d,
a,b,c,e){var f=!1!==a;a=a||{};e=e||[];b=b||a.scope;c=c||a.node;a.scope=a.scope||b;a.node=a.node||c;var g=z(d)?aa(d):d;if(!g)throw"Component "+d+" not found";b&&g.$isolateScope&&(a.scope=b=b.$newIsolated());var h,k=[];d=g.template||a.template||null;var n=g.templateUrl||a.templateUrl||null,q=b?b.$app:null,G=xa.global(),v=q?q.inject:G.inject,x=q?q:G,l=c?c.getAttribute("mjs-cloak"):null,u={$node:c||null,$scope:b||null,$config:a||null,$args:e||null};if(g.resolve)for(h in g.resolve)(function(f){var d=new w,
n;k.push(d.done(function(b){u[f]=b;a[f]=b;e.push(b)}));n=g.resolve[h];O(n)?d.resolve(n(b,c)):z(n)?d.resolve(v.resolve(n)):d.resolve(v.call(x,n,null,t({},u,a,!1,!1)))})(h);f&&(d||n)&&(a.template=new T({scope:b,node:c,deferRendering:!0,ownRenderer:!0,tpl:d,url:n}),k.push(a.template.initPromise),c&&c.firstChild&&C(c,"mjs-transclude",P(c.childNodes)));f&&e.unshift(a);var m;k.length?(m=new w,w.all(k).done(function(){m.resolve(v.call(x,g,null,t({},u,a,!1,!1),e))})):m=w.resolve(v.call(x,g,null,t({},u,a,
!1,!1),e));c&&m.isPending()&&null!==l&&(l?ta(c,l):c.style.visibility="hidden",m.then(function(){l?S(c,l):c.style.visibility=""}));c&&m.then(function(){S(c,"mjs-cloak")});return m}function U(){return!1}function ya(d){var a=d.nodeName.toLowerCase();d=d.type;return"input"!=a&&"textarea"!=a&&"select"!=a||"submit"==d||"reset"==d||"button"==d?!1:!0}function ga(){return!0}function za(d,a,b){d.attachEvent?d.attachEvent("on"+a,b):d.addEventListener(a,b,!1)}function Aa(d){var a;a:{for(var b=d,c;b;){c=C(b,"mjs-transclude");
if(void 0!==c){a=c;break a}b=b.parentNode}a=void 0}if(a){d.firstChild&&C(d,"mjs-transclude",P(d.childNodes));b=d.parentNode;c=d.nextSibling;a=ua(a);var e=I(a.childNodes);b.removeChild(d);b.insertBefore(a,c);return e}return null}function Oa(d,a,b){b||(b="asc");d=d.slice();d.sort(function(b,e){var f=typeof b,d=b,h=e;if(f!=typeof e)return 0;"object"==f&&(O(a)?(d=a(b),h=a(e)):(d=b[a],h=e[a]));if("number"==typeof d)return d-h;d=(""+d).toLowerCase();h=(""+h).toLowerCase();return d===h?0:d>h?1:-1});return"desc"==
b?d.reverse():d}function Ba(d,a,b){var c,e=d.childNodes;if(!1!==a.call(b,d))for(d=-1,c=e.length>>>0;++d!==c;Ba(e[d],a,b));}var Pa=ca.getValue,Qa=ca.setValue,ha={},A=new Q(ha,"MetaphorJs"),r=(new F(A)).define,V=Function.prototype.bind?function(d,a){return d.bind(a)}:function(d,a){return function(){return d.apply(a,arguments)}},W=Array.prototype.slice,Ra=Object.prototype.toString,M=function(){var d={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,
"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(a){if(!a){if(null===a)return 6;if(void 0===a)return 7}var b=d[Ra.call(a)];return void 0===b?-1:1==b&&isNaN(a)?8:b}}(),t=function(){return function a(){var b=!1,c=!1,e=W.call(arguments),f=e.shift(),g,h,k;ea(e[e.length-1])&&(b=e.pop());ea(e[e.length-1])&&(c=b,b=e.pop());for(;e.length;)if(g=e.shift())for(h in g)if(g.hasOwnProperty(h)&&void 0!==(k=g[h]))if(c)if(f[h]&&Z(f[h])&&Z(k))a(f[h],k,b,c);else{if(!0===b||void 0==f[h])Z(k)?
(f[h]={},a(f[h],k,b,!0)):f[h]=k}else if(!0===b||void 0==f[h])f[h]=k;return f}}(),H=function(){var d=["0","0","0"];return function(){for(var a=d.length,b;a;){a--;b=d[a].charCodeAt(0);if(57==b)return d[a]="A",d.join("");if(90==b)d[a]="0";else return d[a]=String.fromCharCode(b+1),d.join("")}d.unshift("0");return d.join("")}}(),E=function(d){this.$$observable=new Y;this.$$historyWatchers={};t(this,d,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,
this)):(this.$root=this,this.$isRoot=!0)};t(E.prototype,{$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$historyWatchers:null,$$checking:!1,$$destroyed:!1,$new:function(){return new E({$parent:this,$root:this.$root,$app:this.$app})},$newIsolated:function(){return new E({$app:this.$app})},$on:function(d,a,b){return this.$$observable.on(d,a,b)},$un:function(d,a,b){return this.$$observable.un(d,a,b)},$watch:function(d,a,b){return na.create(this,d,a,b,null)},$unwatch:function(d,
a,b){return na.unsubscribeAndDestroy(this,d,a,b)},$watchHistory:function(d,a){this.$$historyWatchers[a]||(this.$$historyWatchers[a]=d,ha.history.on("change-"+a,this.$$onHistoryChange,this))},$unwatchHistory:function(d){this.$$historyWatchers[d]||(delete this.$$historyWatchers[d],ha.history.un("change-"+d,this.$$onHistoryChange,this))},$get:function(d){for(var a=this;a;){if(void 0!==a[d])return a[d];a=a.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},
$$onHistoryChange:function(d,a,b){this.$$historyWatchers[b]&&(a=this.$$historyWatchers[b],this[a]=d,this.$check())},$check:function(){var d;this.$$checking||(this.$$checking=!0,this.$$watchers&&(d=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",d),0<d&&this.$check())},$destroy:function(){var d,a;this.$$observable.trigger("destroy");this.$$observable.destroy();this.$$watchers&&this.$$watchers.$destroyAll();for(d in this.$$historyWatchers)this.$unwatchHistory(d);
for(a in this)this.hasOwnProperty(a)&&(this[a]=null);this.$$destroyed=!0}},!0,!1);var aa=A.get,Ca=function(){var d=document.createTextNode("");return z(d.textContent)?"textContent":"nodeValue"}(),X=function(){return String.prototype.trim?function(d){return z(d)?d.trim():d}:function(d){return z(d)?d.replace(/^\s\s*/,"").replace(/\s\s*$/,""):d}}(),L=na.create,s=A.add,l=function(){var d=[],a=[],b=!1,c=function(a,b){return a.priority<b.priority?-1:a.priority>b.priority?1:0};return r({$class:"Directive",
watcher:null,scope:null,node:null,expr:null,autoOnChange:!0,$init:function(a,b,c){var d;c=X(c);this.node=b;this.expr=c;this.scope=a;this.watcher=L(a,c,this.onChange,this,null,A);if(this.autoOnChange&&void 0!=(d=this.watcher.getLastResult()))this.onChange(d,void 0);a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){this.$destroy()},onChange:function(){},destroy:function(){this.watcher&&this.watcher.unsubscribeAndDestroy(this.onChange,this);this.$super()}},{registerAttribute:function(a,
c,g){aa("attr."+a,!0)||(d.push({priority:c,name:a,handler:s("attr."+a,g)}),b=!1)},getAttributes:function(){b||(d.sort(c),b=!0);return d},registerTag:function(b,c){aa("tag."+b,!0)||a.push({priority:priority,name:b,handler:s("tag."+b,c)})},getTags:function(){return a}})}(),Da=function(){var d=/\\{/g,a=new Y,b=function(a,b,d,h,k){return!b||!b.indexOf||-1==b.indexOf("{{")&&-1==b.indexOf("{[")?null:new c(a,b,d,h,k)},c=r({$class:"TextRenderer",id:null,parent:null,isRoot:null,scope:null,origin:"",processed:null,
text:null,watchers:null,children:null,data:null,recursive:!1,dataChangeDelegate:null,changeTmt:null,lang:null,$init:function(a,b,c,d,k){this.id=H();this.origin=b;this.scope=a;this.parent=c;this.isRoot=!c;this.data=d;this.lang=a.$app?a.$app.lang:null;if(!0===k||!1===k)this.recursive=k;this.watchers=[];this.children=[];this.dataChangeDelegate=V(this.doDataChange,this);this.processed=this.processText(b);this.render()},subscribe:function(b,c){return a.on(this.id,b,c)},unsubscribe:function(b,c){return a.un(this.id,
b,c)},getString:function(){null===this.text&&this.render();var a=this.text;return-1!=a.indexOf("\\{")?a.replace(d,"{"):a},render:function(){var a=this.processed,b,d,h;this.children.length||this.createChildren();h=this.children;b=-1;for(d=h.length;++b<d;a=a.replace("---"+b+"---",h[b]instanceof c?h[b].getString():h[b]));return this.text=a},processText:function(a){for(var b=0,c=a.length,d,k,n="";b<c;)if(-1!=(d=a.indexOf("{{",b))&&-1!=(k=a.indexOf("}}",d+2))&&"\\"!=a.substr(d-1,1))n+=a.substring(b,d),
k!=d+2&&(n+=this.watcherMatch(a.substring(d+2,k))),b=k+2;else{b!==c&&(n+=a.substring(b));break}b=0;a=n;c=a.length;for(n="";b<c;)if(-1!=(d=a.indexOf("{[",b))&&-1!=(k=a.indexOf("]}",d+2))&&"\\"!=a.substr(d-1,1))n+=a.substring(b,d),k!=d+2&&(n+=this.watcherMatch(a.substring(d+2,k),!0)),b=k+2;else{b!==c&&(n+=a.substring(b));break}return n},watcherMatch:function(a,b){var c=this.watchers;if(b){a=X(a);var d=a.split("|"),k=X(d[0]);"."!=k.substr(0,1)&&(d[0]="'"+k+"'");1==d.length&&d.push("l");a=d.join(" | ")}c.push(L(this.scope,
a,this.onDataChange,this,null,A));return"---"+(c.length-1)+"---"},onDataChange:function(){this.changeTmt||(this.changeTmt=setTimeout(this.dataChangeDelegate,0))},doDataChange:function(){this.destroyChildren();this.triggerChange();this.changeTmt=null},triggerChange:function(){this.text=null;this.isRoot?a.trigger(this.id,this,this.data):this.parent.triggerChange()},createChildren:function(){var a=this.watchers,c=this.children,d=this.scope,h=this.recursive,k,n,q;k=-1;for(n=a.length;++k<n;)q=a[k].getLastResult(),
c.push(h&&b(d,q,this,null,!0)||q)},destroyChildren:function(){var a=this.children,b,d;b=-1;for(d=a.length;++b<d;)a[b]instanceof c&&a[b].$destroy();this.children=[]},destroyWatchers:function(){var a=this.watchers,b,c;b=-1;for(c=a.length;++b<c;a[b].unsubscribeAndDestroy(this.onDataChange,this));this.watchers=[]},destroy:function(){this.destroyChildren();this.destroyWatchers();a.destroyEvent(this.id);this.changeTmt&&clearTimeout(this.changeTmt)}},{create:b});return c}(),C=function(){var d={};return function(a,
b,c){a=a._mjsid||(a._mjsid=H());var e=d[a];return void 0!==c?(e||(e=d[a]={}),e[b]=c):e?e[b]:void 0}}();F=Array.prototype.indexOf;F||(F=Array.prototype.indexOf=function(d,a){var b;if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),e=c.length>>>0;if(0===e)return-1;b=+a||0;Infinity===Math.abs(b)&&(b=0);if(b>=e)return-1;for(b=Math.max(0<=b?b:e-Math.abs(b),0);b<e;){if(b in c&&c[b]===d)return b;b++}return-1});var ia=function(){var d=null,a=Da.create,b=function(a,b,c,e,
d,g){var l=[];if(a&&!0!==a){if(a.nodeType){g.countdown+=1;f(a,c,e,d,g);return}l=W.call(a)}l.length||(l=I(b.childNodes));b=l.length;g.countdown+=b;for(a=-1;++a<b;f(l[a],c,e,d,g));},c=function(a,b){if(b)if(b.nodeType)a.push(b);else if(N(b))for(var e=-1,d=b.length;++e<d;c(a,b[e]));},e={script:!0,template:!0,"mjs-template":!0,style:!0},f=function(a,c,d,f,g){if(a){var l;l=a.nodeName;g||(g={countdown:1});if(!l||!e[l.toLowerCase()])if(l=c.call(d,a),!1!==l){if(R(l)){l.done(function(e){!1!==e&&b(e,a,c,d,f,
g);0==--g.countdown&&f&&f.call(d)});return}b(l,a,c,d,f,g)}0==--g.countdown&&f&&f.call(d)}},g=new Y;return r({$class:"Renderer",id:null,el:null,scope:null,texts:null,parent:null,$init:function(a,b,c){this.id=H();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof E&&b.$on("destroy",this.$destroy,this);if(c)c.on("destroy",this.$destroy,this)},on:function(a,b,c){return g.on(a+"-"+this.id,b,c)},once:function(a,b,c){return g.once(a+"-"+this.id,b,c)},un:function(a,b,c){return g.un(a+"-"+this.id,
b,c)},createChild:function(a){return new ia(a,this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,c,e){var d=a.$isolateScope?b.$newIsolated():a.$breakScope?b.$new():b,f=b.$app;c=f.inject(a,null,{$scope:d,$node:c,$attrValue:e,$renderer:this},[d,c,e,this]);f&&a.$registerBy&&c&&(R(c)?c.done(function(c){f.registerCmp(c,b,a.$registerBy)}):f.registerCmp(c,b,a.$registerBy));return a.$stopRenderer?!1:c},processNode:function(b){var e=b.nodeType,f=this.texts,g=this.scope,G,v;if(3==e){if(G=
null!==b.parentNode.getAttribute("mjs-recursive"),e=a(g,b[Ca],null,f.length,G))e.subscribe(this.onTextChange,this),f.push({node:b,tr:e}),this.renderText(f.length-1)}else if(1==e){d||(d=l.getAttributes());var e=[],x=[],K,u,m;v="tag."+b.tagName.toLowerCase();if(v=aa(v,!0)){u=this.runHandler(v,g,b);if(!1===u)return!1;R(u)?e.push(u):c(x,u)}K=Ka(b);v=0;for(G=d.length;v<G;v++)if(m=d[v].name,void 0!==(u=K[m])){b.removeAttribute(m);u=this.runHandler(d[v].handler,g,b,u);K[m]=null;if(!1===u)return!1;R(u)?e.push(u):
c(x,u)}if(e.length){var r=new w;w.all(e).done(function(a){c(x,a);r.resolve(x)});return r}G=void 0!==K["mjs-recursive"];delete K["mjs-recursive"];for(v in K)null!==K[v]&&(e=a(g,K[v],null,f.length,G))&&(b.removeAttribute(v),e.subscribe(this.onTextChange,this),f.push({node:b,attr:v,tr:e}),this.renderText(f.length-1));return x.length?x:!0}return!0},process:function(){f(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){g.trigger("rendered-"+this.id,
this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.tr.getString(),c=a.attr;c?("value"==c?a.node.value=b:"class"==c?a.node.className=b:"src"==c&&(a.node.src=b),a.node.setAttribute(c,b)):a.node[Ca]=b},destroy:function(){var a=this.texts,b,c;b=-1;for(c=a.length;++b<c;a[b].tr.$destroy());this.parent&&this.parent.un("destroy",this.$destroy,this);g.trigger("destroy-"+this.id)}})}(),Sa=function(d,a){var b=function(){},c;b.prototype=d.prototype;b=new b;c=
d.apply(b,a);return wa(c)||!1===c?c:b},xa=function(){var d,a=function(){this.store={}};t(a.prototype,{store:null,instantiate:function(a,c,e,d){return a.$instantiate?a.$instantiate.apply(a,e):d?Sa(a,e):a.apply(c,e)},inject:function(a,c,e,d,g){e=e||{};d=d||[];var h=this;if(O(a))if(a.inject)d=W.call(a.inject),d.push(a),a=d;else return h.instantiate(a,c,d,g);a=W.call(a);d=[];var k=a.pop(),n,l;n=-1;for(l=a.length;++n<l;d.push(h.resolve(a[n],e)));return w.all(d).then(function(a){return h.instantiate(k,
c,a,g)})},value:function(a,c){this.store[a]={type:1,value:c}},constant:function(a,c){var e=this.store;e[a]||(e[a]={type:2,value:c})},factory:function(a,c,e,d){ea(e)&&(d=e,e=null);this.store[a]={type:3,singleton:d,fn:c,context:e}},service:function(a,c,e){this.store[a]={type:4,singleton:e,fn:c}},provider:function(a,c){this.store[a+"Provider"]={name:a,type:5,fn:c,instance:null}},resolve:function(a,c){var e=this.store,f,g,h;if(void 0!==c[a])return c[a];if(g=e[a]){f=g.type;if(1==f||2==f)return g.value;
if(3==f)h=this.inject(g.fn,g.context,c);else if(4==f)h=this.inject(g.fn,null,c,null,!0);else if(5==f)return g.instance||(g.instance=w.resolve(this.inject(g.fn,null,c)).done(function(a){g.instance=a;e[g.name]={type:3,fn:a.$get,context:a}})),g.instance;g.singleton&&(g.type=1,g.value=h,3==f&&R(h)&&h.done(function(a){g.value=a}));return c[a]=h}if(e[a+"Provider"])return this.resolve(a+"Provider",c),this.resolve(a,c);if(this===d)throw"Could not provide value for "+a;return d.resolve(a)},destroy:function(){this.scope=
this.store=null}},!0,!1);a.global=function(){return d};d=new a;return a}(),Ta=function(){var d=function(a,b){"pt_BR"==b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1==
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0==a||1==a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1==a?0:2<=a&&4>=a?1:2;case "ga":return 1==a?0:2==a?1:2;case "lt":return 1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1==a%100?0:2==a%100?1:3==a%100||4==a%100?2:3;
case "mk":return 1==a%10?0:1;case "mt":return 1==a?0:0==a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0==a?0:1==a%10&&11!=a%100?1:2;case "pl":return 1==a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1==a?0:2==a?1:8==a||11==a?2:3;case "ro":return 1==a?0:0==a||0<a%100&&20>a%100?1:2;case "ar":return 0==a?0:1==a?1:2==a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},a=function(a){this.store={};a&&(this.locale=a)};t(a.prototype,{store:null,locale:"en",setLocale:function(a){this.locale=
a},set:function(a,b){var d=this.store;void 0===d[a]&&(d[a]=b)},load:function(a){t(this.store,a,!1,!1)},get:function(a){return this.store[a]||(this===b?"-- "+a+" --":b.get(a))},plural:function(a,b){var f=this.get(a),g=d(b,this.locale);return N(f)?f[g]:Z(f)?f[b]?f[b]:1==b&&void 0!=f.one?f.one:0>b&&void 0!=f.negative?f.negative:f.other:f},destroy:function(){this.store=null}},!0,!1);var b=new a;a.global=function(){return b};return a}();F=A.add("mixin.Observable",{$$observable:null,$beforeInit:function(d){this.$$observable=
new Y;if(d&&d.callback){var a=d.callback,b=a.context,c;a.context=null;for(c in a)if(a[c])this.$$observable.on(c,a[c],b||this);d.callback=null}},on:function(){var d=this.$$observable;return d.on.apply(d,arguments)},un:function(){var d=this.$$observable;return d.un.apply(d,arguments)},once:function(){var d=this.$$observable;return d.once.apply(d,arguments)},trigger:function(){var d=this.$$observable;return d.trigger.apply(d,arguments)},$beforeDestroy:function(){this.$$observable.trigger("beforedestroy",
this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.destroy();this.$$observable=null}});r({$class:"App",$mixins:[F,{$$provider:null,$beforeInit:function(){this.$$provider=new xa},value:function(){var d=this.$$provider;return d.value.apply(d,arguments)},constant:function(){var d=this.$$provider;return d.constant.apply(d,arguments)},factory:function(){var d=this.$$provider;return d.factory.apply(d,arguments)},service:function(){var d=this.$$provider;return d.service.apply(d,
arguments)},provider:function(){var d=this.$$provider;return d.provider.apply(d,arguments)},resolve:function(){var d=this.$$provider;return d.resolve.apply(d,arguments)},inject:function(){var d=this.$$provider;return d.inject.apply(d,arguments)},$afterDestroy:function(){this.$$provider.destroy();this.$$provider=null}}],lang:null,scope:null,renderer:null,cmpListeners:null,components:null,$init:function(d,a){var b=a instanceof E?a:new E(a),c;d.removeAttribute("mjs-app");b.$app=this;this.$super();this.lang=
new Ta;this.scope=b;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",b.$root);this.value("$lang",this.lang);this.renderer=new ia(d,b);c=W.call(arguments);c[1]=b;this.initApp.apply(this,c)},initApp:D,run:function(){this.renderer.process()},getParentCmp:function(d){d=d.parentNode;for(var a;d;){if(a=d.getAttribute("cmp-id"))return this.getCmp(a);d=d.parentNode}return null},onAvailable:function(d,a,b){var c=
this.cmpListeners,e=this.components;c[d]||(c[d]=new w);a&&c[d].done(a,b);e[d]&&c[d].resolve(e[d]);return c[d]},getCmp:function(d){return this.components[d]||null},registerCmp:function(d,a,b){var c=this,e=d[b];b=function(){delete c.cmpListeners[e];delete c.components[e]};c.components[e]=d;c.cmpListeners[e]&&c.cmpListeners[e].resolve(d);if(d.on)d.on("destroy",b);a.$on("$destroy",b)},destroy:function(){this.renderer.$destroy();this.scope.$destroy();this.lang.destroy();this.$super()}});var Ea=document.documentElement,
ja=function(){return function a(b){return b===window?!0:3==b.nodeType?b.parentElement?a(b.parentElement):!0:b===Ea?!0:Ea.contains(b)}}(),ua=function a(b){var c,e,f;if(N(b)){f=[];c=0;for(e=b.length;c<e;c++)f.push(a(b[c]));return f}if(b)switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0)}return null},T=function(){var a=new Y,b={},c=function(a){if(!b[a]){var c=document.getElementById(a),e;c&&(e=c.tagName.toLowerCase(),
"script"==e?(e=document.createElement("div"),e.innerHTML=c.innerHTML,b[a]=P(e.childNodes)):b[a]="content"in c?c.content:P(c.childNodes))}return b[a]},e=function(a){return b[a]?b[a]:b[a]=Ha(a,{dataType:"fragment"}).then(function(c){return b[a]=c})};return r({$class:"Template",_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,$init:function(a){t(this,a,!0,
!1);this.id=H();this.tpl&&(this.tpl=X(this.tpl));this.url&&(this.url=X(this.url));a=this.node;var b=this.tpl||this.url;a&&a.removeAttribute("mjs-include");a||(this.deferRendering=!0);if(b){if(a&&a.firstChild&&C(a,"mjs-transclude",P(a.childNodes)),"."!=b.substr(0,1)||this.replace||(this.ownRenderer=!0,this._watcher=L(this.scope,b,this.onChange,this,null,A)),this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,
this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof E&&this.scope.$on("destroy",this.onScopeDestroy,this)},doRender:function(){this._renderer||(this._renderer=new ia(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){a.trigger("rendered-"+this.id,this)},on:function(b,c,e){return a.on(b+"-"+
this.id,c,e)},un:function(b,c,e){return a.un(b+"-"+this.id,c,e)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,b=a.url,h=a._watcher?a._watcher.getLastResult():a.tpl||b,k=new w;(new w(function(a){b?a(c(h)||e(b)):a(c(h)||P(h))})).done(function(b){a._fragment=
b;k.resolve(a.ownRenderer?!1:a.node)}).fail(k.reject,k);return k},onChange:function(){this._renderer&&(this._renderer.$destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=this.node;a.firstChild;)a.removeChild(a.firstChild);this.replace?a.parentNode.replaceChild(ua(this._fragment),a):a.appendChild(ua(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new w;this._initial?(this.doApplyTemplate(),
b.resolve()):(y(a,"leave",null,!0).done(this.doApplyTemplate,this).done(b.resolve,b),y(a,"enter",null,!0));this._initial=!1;return b},onParentRendererDestroy:function(){this._renderer.$destroy();this.$destroy()},onScopeDestroy:function(){this.$destroy()},destroy:function(){this._watcher&&this._watcher.unsubscribeAndDestroy(this.onChange,this)}},{getTemplate:c,loadTemplate:e})}();F=r({$class:"MetaphorJs.Component",$mixins:[F],id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,
hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,$init:function(a){this.$super(a);t(this,a,!0,!1);this.scope||(this.scope=new E);a.as&&(this.scope[a.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);this.id=this.id||"cmp-"+H();this.node||this._createNode();this.initComponent.apply(this,arguments);this.scope.$app&&this.scope.$app.registerCmp(this,this.scope,"id");var b=this.template,c=this.templateUrl;b&&b instanceof T?b instanceof
T&&(this.template.node=this.node):this.template=b=new T({scope:this.scope,node:this.node,deferRendering:!b,ownRenderer:!0,tpl:b,url:c});if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(b.initPromise?b.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);
this.hidden&&(a.style.display="none")},render:function(){this.rendered||(this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},onRenderingFinished:function(){this.renderTo?this.renderTo.appendChild(this.node):ja(this.node)||document.body.appendChild(this.node);this.rendered=!0;this.afterRender();this.trigger("afterrender",this)},show:function(){if(this.hidden){if(!1===this.trigger("beforeshow",this))return!1;this.node.style.display=
"block";this.hidden=!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("beforehide",this))return!1;this.node.style.display="none";this.hidden=!0;this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:D,afterRender:D,onShow:D,onHide:D,onParentRendererDestroy:function(){this.$destroy()},destroy:function(){this.template&&
this.template.$destroy();this.destroyEl?ja(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.destroyScope&&this.scope&&this.scope.$destroy();this.$super()}});var pa=function(){var a={};return function(b){return a[b]||(a[b]=new RegExp(b))}}(),ka=function(a){var b=C(a,"mjsAnimationQueue"),c,e;if(N(b)&&b.length){if(b=b[0])b.stages&&(c=b.position,e=b.stages,S(a,e[c]),S(a,e[c]+"-active")),b.deferred&&b.deferred.reject(b.el)}else O(b)?
b(a):"stop"==b&&$(a).stop(!0,!0);C(a,"mjsAnimationQueue",null)},p=function(a){a=a||{};this._queue=[];this._map={};this.id="$$"+H();for(var b in a)this[b]=a[b]};p.REPLACE=1;p.ONCE=2;p.MULTIPLE=3;p.ONCE_EVER=3;t(p.prototype,{_queue:null,_map:null,_nextRequested:!1,_running:!1,length:0,id:null,async:!0,auto:!0,thenable:!1,stack:!1,context:null,mode:p.MULTIPLE,add:function(a,b,c,e,f,g){var h=this.id,k=a[h]||H();b={id:k,fn:a,context:b,args:c,async:g};e=e||this.mode;if(e==p.ONCE_EVER&&a[h])return a[h];
a[h]=k;if(this._map[k])if(e==p.REPLACE)this.remove(k);else if(e==p.ONCE)return k;this._queue[f?"unshift":"push"](b);this._map[k]=b;this.length=this._queue.length;this.auto&&this.next();return k},append:function(a,b,c,e,f){return this.add(a,b,c,e,!1,f)},prepend:function(a,b,c,e,f){return this.add(a,b,c,e,!0,f)},remove:function(a){var b=this._queue,c,e;c=0;for(e=b.length;c<e;c++)if(b[c].id==a){b.splice(c,1);break}delete this._map[a]},next:function(){var a=this,b;if(a._running)a._nextRequested=!0;else if(a._nextRequested=
!1,b=a._queue[a.stack?"pop":"shift"](),a.length=a._queue.length,b)if(a._running=!0,delete a._map[b.id],a.async||b.async){var c=0;1===M(b.async)?c=b.async:1===M(a.async)&&(c=a.async);oa(function(){try{a._processResult(b.fn.apply(b.context||a.context,b.args||[]))}catch(c){throw J(c),a._finish(),c;}},null,null,c)}else try{a._processResult(b.fn.apply(b.context||a.context,b.args||[]))}catch(e){throw J(e),a._finish(),e;}},_processResult:function(a){var b=this;b.thenable&&R(a)?a.then(function(){b._finish()},
function(){b._finish()}):b._finish();return a},_finish:function(){this._running=!1;(this.auto||this._nextRequested)&&this.next()},destroy:function(){this.context=this._map=this._queue=null;this._running=this._nextRequested=!1;this.next=D}},!0,!1);var la=function(){var a,b;if("undefined"!=typeof window){var c=window;a=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame;b=c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.webkitCancelRequestAnimationFrame;
if(a)return function(c){var f=a(c);return function(){b(f)}}}return function(a){var b=setTimeout(a,0);return function(){clearTimeout(b)}}}();Q=function(){var a=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,b=Function,c=function(a,b){return function(c){var e=W.call(arguments),f;e.push(null);e.push(a);if(b){for(f=a.apply(null,e);(void 0===f||"number"==typeof f&&isNaN(f))&&!c.$isRoot;)c=c.$parent,e[0]=c,f=a.apply(null,e);return f}return a.apply(null,e)}},e={},f=0,g={},h=0,k={},l=0,q=function(){1E3<=f&&(e={});1E3<=
h&&(g={});1E3<=l&&(k={})};return{createGetter:function(g){try{return e[g]?e[g]:(f++,e[g]=c(new b("____","$$interceptor","$$itself","".concat("try {","return ",g.replace(a,"$1____.$3"),";} catch (thrownError) { return undefined; }")),!0))}catch(h){return J(h),D}},createSetter:function(e){try{if(!g[e]){h++;var f=e.replace(a,"$1____.$3");return g[e]=c(new b("____","$$$$","$$interceptor","$$itself","".concat("try {",f," = $$$$",";} catch (thrownError) { return undefined; }")))}return g[e]}catch(k){return J(k),
D}},createFunc:function(e){try{return k[e]?k[e]:(l++,k[e]=c(new b("____","$$interceptor","$$itself","".concat("try {",e.replace(a,"$1____.$3"),";} catch (thrownError) { return undefined; }"))))}catch(f){return J(f),D}},resetCache:q,enableResetCacheInterval:function(){setTimeout(q,1E4)}}}();var ra=Q.createGetter,Ma=/-./g,Na=function(){return document.documentElement.dataset?function(a){return a.dataset}:function(a){var b;if(void 0!==(b=C(a,"data")))return b;b=a.attributes;var c={},e,f,g;e=0;for(f=
b.length;e<f;e++)g=b[e].name,0===g.indexOf("data-")&&(c[La(g.substr(5))]=b[e].value);b=c;C(a,"data",b);return b}}();ma=r({$class:"ListRenderer",id:null,model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,trackBy:null,trackByWatcher:null,animateMove:!1,animate:!1,trackByFn:null,griDelegate:null,queue:null,buffered:!1,bufferPlugin:null,$constructor:function(a,b,c){a=B(b,a);this.animateMove=!a.buffered&&a.animateMove&&y.cssAnimations;this.animate=!a.buffered&&(null!==
b.getAttribute("mjs-animate")||a.animate);this.id=a.id||H();b.removeAttribute("mjs-animate");this.animate&&this.animateMove&&this.$plugins.push("ListAnimatedMove");a.observable&&this.$plugins.push("Observable");a.buffered&&(this.buffered=!0,this.$plugins.push("ListBuffered"))},$init:function(a,b,c){b.removeAttribute("mjs-include");this.parseExpr(c);this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.queue=new p({async:!1,
auto:!0,thenable:!0,stack:!1,context:this,mode:p.ONCE});this.parentEl.removeChild(b);this.afterInit(a,b);this.queue.add(this.render,this,[I(this.watcher.getLastResult())])},afterInit:function(a,b){var c=B(b,a);this.watcher=L(a,this.model,this.onChange,this,null,A);(this.trackBy=c.trackBy)&&"$"!=this.trackBy?this.trackByWatcher=L(a,this.trackBy,this.onChangeTrackBy,this,null,A):"$"==this.trackBy||this.watcher.hasInputPipes()||(this.trackBy="$$"+this.watcher.id);this.griDelegate=V(this.scopeGetRawIndex,
this)},trigger:D,render:function(a){var b=this.renderers,c=this.tpl,e=this.parentEl,f=this.nextEl,g=this.buffered,h=document.createDocumentFragment(),k,l,q;l=0;for(q=a.length;l<q;l++)k=c.cloneNode(!0),b.push(this.createItem(k,a,l)),g||(h.appendChild(k),b[l].attached=!0);g?(this.bufferPlugin.getScrollOffset(),this.bufferPlugin.updateScrollBuffer()):(this.doUpdate(),e.insertBefore(h,f));this.trigger("render",this)},doUpdate:function(a,b,c,e){var f=this.renderers;a=a||0;var g=f.length;b=b||g-1;var h=
this.watcher.getLastResult(),k=this.getTrackByFunction();for(b>g-1&&(b=g-1);a<=b;a++)c&&f[a].action!=c||this.renderItem(a,f,h,k,e)},renderItem:function(a,b,c,e,f){c=c||this.watcher.getLastResult();b=b||this.renderers;e=e||this.getTrackByFunction();var g=b[a],h=g.scope;b=b.length-1;var k=!(a%2);f&&g.rendered||(h.$index=a,h.$first=0===a,h.$last=a===b,h.$even=k,h.$odd=!k,h.$trackId=e(c[a]),h.$getRawIndex=this.griDelegate,g.renderer?h.$check():(g.renderer=new ia(g.el,h),g.renderer.process(),g.rendered=
!0))},createItem:function(a,b,c){var e=this.itemName,f=this.scope.$new();f[e]=this.getListItem(b,c);return{index:c,action:"enter",el:a,scope:f,attached:!1,rendered:!1}},onChange:function(a,b){this.queue.prepend(this.applyChanges,this,[b],p.REPLACE)},applyChanges:function(a){var b=this,c=b.renderers,e=b.tpl,f=0,g=I(b.watcher.getLastResult()),h=null,k=b.animateMove,l=b.animate,q=[],r=b.itemName,v=c.slice(),x=!1,t,u,m,s,p,z;a=b.watcher.getMovePrescription(a,b.getTrackByFunction(),g);m=0;for(s=a.length;m<
s;m++)t=a[m],1===M(t)?(u=t,t=c[u],u!=f&&null===h&&(h=m),t.action="move",t.scope[r]=b.getListItem(g,m),x=k,q.push(t),c[u]=null,f++):(null===h&&(h=m),p=b.createItem(e.cloneNode(!0),g,m),q.push(p));b.renderers=q;if(l){b.doUpdate(h,null,"enter");x&&(z=b.calculateTranslates(q,v,c));var e=[],B=new w,C=new w,D=new w,E=w.counter(q.length),f=function(){E.countdown();return B};m=0;for(s=c.length;m<s;m++)if(p=c[m])p.scope.$destroy(),ka(p.el),e.push(y(p.el,"leave",null,!1,A).done(function(a){a.style.visibility=
"hidden"}));m=0;for(s=q.length;m<s;m++)p=q[m],ka(p.el),"enter"==p.action?e.push(y(p.el,"enter",f,!1,A)):e.push(b.moveAnimation(p.el,x?z[m][0]:null,x?z[m][1]:null,f,C));E.done(function(){la(function(){C.resolve();b.applyDomPositions(c);x||b.doUpdate(h,null,"move");la(function(){B.resolve()});b.trigger("change",b)})});w.all(e).always(function(){la(function(){b.doUpdate(h||0);b.removeOldElements(c);if(x)for(b.doUpdate(h,null,"move"),m=0,s=q.length;m<s;m++)p=q[m],p.el.style[y.prefixes.transform]=null,
p.el.style[y.prefixes.transform]="";D.resolve()})});return D}b.buffered?(b.bufferPlugin.getScrollOffset(),b.removeOldElements(c),b.queue.append(b.bufferPlugin.updateScrollBuffer,b.bufferPlugin,[!0])):(b.applyDomPositions(),b.doUpdate(h||0),b.removeOldElements(c));b.trigger("change",b)},removeOldElements:function(a){var b,c,e,f=this.parentEl;b=0;for(c=a.length;b<c;b++)(e=a[b])&&e.attached&&(e.attached=!1,f.removeChild(e.el))},applyDomPositions:function(a){var b=this.renderers,c=this.parentEl,e=this.prevEl,
e=e?e.nextSibling:c.firstChild,f,g,h,k,l;g=0;for(h=b.length;g<h;g++)l=b[g],k=l.el,(f=a&&a[g]?a[g].el.nextSibling:0<g?b[g-1].el.nextSibling||e:e)&&k.nextSibling!==f?c.insertBefore(k,f):f||c.appendChild(k),l.attached=!0},getListItem:function(a,b){return a[b]},onChangeTrackBy:function(a){this.trackByFn=null;this.trackBy=a},getTrackByFunction:function(){var a;this.trackByFn||((a=this.trackBy)&&"$"!=a?O(a)?this.trackByFn=a:this.trackByFn=function(b){return b&&!qa(b)?b[a]:void 0}:this.trackByFn=function(a){return qa(a)?
a:void 0});return this.trackByFn},scopeGetRawIndex:function(a){if(void 0===a)return-1;var b=this.watcher.getUnfilteredValue(),c=this.getTrackByFunction(),e,f;e=0;for(f=b.length;e<f;e++)if(c(b[e])===a)return e;return-1},getNodePositions:function(a,b,c){return{}},calculateTranslates:function(a,b,c){return[]},moveAnimation:function(a,b,c,e,f){return y(a,"move",e,!1,A)},scrollTo:function(){},parseExpr:function(a){a=a.split(" ");var b,c,e,f,g;b=0;for(c=a.length;b<c;b++)if(g=a[b],""!=g&&"in"!=g)if(f){e=
a.slice(b).join(" ");break}else f=g;this.model=e;this.itemName=f||"item"},destroy:function(){var a=this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.$destroy();this.trackByWatcher&&this.trackByWatcher.unsubscribeAndDestroy();this.queue.destroy();this.watcher.unsubscribeAndDestroy(this.onChange,this)}},{$stopRenderer:!0,$registerBy:"id"});var Ua=da.currentUrl;r({$class:"View",route:null,node:null,scope:null,cmp:null,id:null,currentComponent:null,watchable:null,defaultCmp:null,$init:function(a){t(this,
a,!0,!1);a=this.node;var b=B(a,this.scope);t(this,b,!0,!1);a&&a.firstChild&&C(a,"mjs-transclude",P(a.childNodes));this.id||(this.id=H());this.scope.$app.registerCmp(this,this.scope,"id");this.route?(da.initPushState(),da.on("locationChange",this.onLocationChange,this),this.onLocationChange()):this.cmp&&(this.watchable=L(this.scope,this.cmp,this.onCmpChange,this,null,A),this.onCmpChange())},onCmpChange:function(){var a=this.watchable.getLastResult()||this.defaultCmp;this.clearComponent();a&&this.setComponent(a)},
onLocationChange:function(){var a=Ua(),b=this.route,c,e,f,g,h;e=0;for(f=b.length;e<f;e++){g=b[e];if(g.reg&&(h=a.match(g.reg))){this.changeRouteComponent(g,h);return}g["default"]&&!c&&(c=g)}this.clearComponent();c?this.setRouteComponent(c,[]):this.defaultCmp&&this.setComponent(this.defaultCmp)},changeRouteComponent:function(a,b){ka(this.node);this.clearComponent();this.setRouteComponent(a,b)},clearComponent:function(){var a=this,b=a.node;a.currentComponent&&y(b,"leave",null,!0).done(function(){a.currentComponent.destroy();
for(a.currentComponent=null;b.firstChild;)b.removeChild(b.firstChild)})},setRouteComponent:function(a,b){var c=this,e=c.node,f=a.params;y(e,"enter",function(){var g=b||[],h={destroyEl:!1,node:e,scope:a.$isolateScope?c.scope.$newIsolated():c.scope.$new()},k,l;a.as&&(h.as=a.as);a.template&&(h.template=a.template);g.shift();if(f)for(k=-1,l=f.length;++k<l;h[f[k]]=g[k]);return fa(a.cmp||"MetaphorJs.Component",h,h.scope,e,null,g).done(function(a){c.currentComponent=a})},!0)},setComponent:function(a){var b=
this,c=b.node;y(c,"enter",function(){var e=wa(a)?a:{},f=(z(a)?a:null)||"MetaphorJs.Component",g=e.scope||b.scope.$new();e.destroyEl=!1;return fa(f,e,g,c).done(function(a){b.currentComponent=a})},!0)},destroy:function(){this.clearComponent();this.route&&(da.un("locationchange",this.onLocationChange,this),this.route=null);this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),this.watchable=null);this.currentComponent=this.scope=null;this.$super()}});l.registerAttribute("mjs-app",
100,U);var Va=function(){var a=document.createElement("div");return z(a.textContent)?"textContent":"innerText"}();l.registerAttribute("mjs-bind",1E3,r({$extends:l,isInput:!1,input:null,lockInput:null,recursive:!1,textRenderer:null,$init:function(a,b,c){this.isInput=ya(b);this.recursive=null!==b.getAttribute("mjs-recursive");this.lockInput=null!==b.getAttribute("mjs-lock-input");b.removeAttribute("mjs-recursive");b.removeAttribute("mjs-lock-input");this.isInput&&(this.input=new ca(b,this.onInputChange,
this));this.recursive?(this.scope=a,this.node=b,this.textRenderer=new Da(a,"{{"+c+"}}",null,null,!0),this.textRenderer.subscribe(this.onTextRendererChange,this),this.onTextRendererChange(),a instanceof E&&a.$on("destroy",this.onScopeDestroy,this)):this.$super(a,b,c)},onInputChange:function(){if(this.lockInput)this.onChange()},onTextRendererChange:function(){this.updateElement(this.textRenderer.getString())},onChange:function(){var a=this.watcher.getLastResult();this.updateElement(a)},updateElement:function(a){this.isInput?
this.input.setValue(a):this.node[Va]=a},destroy:function(){this.textRenderer&&(this.textRenderer.$destroy(),this.textRenderer=null);this.input&&(this.input.destroy(),this.input=null);this.$super()}}));l.registerAttribute("mjs-bind-html",1E3,r({$extends:"attr.mjs-bind",updateElement:function(a){this.node.innerHTML=a}}));(function(){var a=function(a,c,e,f){if(null!==e){if(e==sa(a,c))return;e=!e}else e=sa(a,c);e?f?y(a,[c+"-remove"],null,!0).done(function(){S(a,c)}):S(a,c):f?y(a,[c+"-add"],null,!0).done(function(){ta(a,
c)}):ta(a,c)};l.registerAttribute("mjs-class",1E3,r({$extends:l,initial:!0,onChange:function(){var b=this.node,c=this.watcher.getLastResult(),e=this.watcher.getPrevValue(),f;ka(b);if(z(c))e&&a(b,e,!1,!1),a(b,c,null,!this.initial);else if(N(c))for(f=-1,e=c.length;++f<e;a(b,c[f],!0,!this.initial));else for(f in c)a(b,f,c[f]?!0:!1,!this.initial);this.initial=!1}}))})();l.registerAttribute("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,b,c){a&&(a[c]=b)}]);(function(){var a=function(a,
c,e,f){var g,h,k,l,q,p=B(c,a);e=e.split(" ");k=0;for(l=e.length;k<l;k++)q=e[k],""!=q&&"as"!=q&&(g?h=q:g=q);f=t({scope:a,node:c,as:h,parentRenderer:f,destroyScope:!0},p,!1,!1);fa(g,f,a,c);return!1};a.$breakScope=!0;l.registerAttribute("mjs-cmp",200,a)})();l.registerAttribute("mjs-config",50,function(a,b,c){B(b,a,c)});l.registerAttribute("mjs-each",100,ma);var va=Q.createFunc,ba=function(a){if(a instanceof ba)return a;if(!(this instanceof ba))return new ba(a);for(var b in a)if(!this[b])try{this[b]=
a[b]}catch(c){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var e,f=a.button;void 0===this.pageX&&null!==a.clientX&&(e=this.target?this.target.ownerDocument||document:document,b=e.documentElement,e=e.body,this.pageX=a.clientX+(b&&b.scrollLeft||e&&e.scrollLeft||0)-(b&&b.clientLeft||e&&e.clientLeft||0),this.pageY=a.clientY+(b&&b.scrollTop||e&&e.scrollTop||0)-(b&&b.clientTop||e&&e.clientTop||0));this.which||void 0===f||(this.which=f&1?1:f&2?3:f&4?2:0);
this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?ga:U;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};t(ba.prototype,{isDefaultPrevented:U,isPropagationStopped:U,isImmediatePropagationStopped:U,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ga;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ga;a&&a.stopPropagation&&a.stopPropagation()},
stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ga;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}},!0,!1);(function(){var a="click dblclick mousedown mouseup mouseover mouseout mousemove keydown keyup keypress submit focus blur copy cut paste enter".split(" "),b,c;b=0;for(c=a.length;b<c;b++)(function(a){var b=a;"enter"==b&&(b="keyup");l.registerAttribute("mjs-"+a,1E3,function(c,h,k){var l=va(k);za(h,b,function(b){b=
new ba(b||window.event);if("enter"==a&&13!=b.keyCode)return null;c.$event=b;l(c);c.$event=null;c.$root.$check();b.preventDefault();return!1})})})(a[b])})();l.registerAttribute("mjs-show",500,r({$extends:l,initial:!0,display:"",$init:function(a,b,c){this.display=B(b,a).display||"";this.$super(a,b,c)},runAnimation:function(a){var b=this,c=b.node.style,e=function(){c.display=a?b.display:"none"};b.initial?e():y(b.node,a?"show":"hide",function(){a&&(c.display=b.display)},!0).done(e)},onChange:function(){var a=
this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));l.registerAttribute("mjs-hide",500,r({$extends:"attr.mjs-show",onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(!a);this.initial=!1}}));l.registerAttribute("mjs-if",500,r({$extends:l,parentEl:null,prevEl:null,el:null,initial:!0,$init:function(a,b,c){this.parentEl=b.parentNode;this.prevEl=b.previousSibling;this.$super(a,b,c)},onScopeDestroy:function(){this.parentEl=this.prevEl=null;this.$super()},onChange:function(){var a=
this,b=a.watcher.getLastResult(),c=a.parentEl,e=a.node,f=function(){a.prevEl?c.insertBefore(e,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(e)},g=function(){c.removeChild(e)};b?ja(e)||(a.initial?f():y(e,"enter",f,!0)):ja(e)&&(a.initial?g():y(e,"leave",null,!0).done(g));a.initial=!1}}));l.registerAttribute("mjs-ignore",0,U);l.registerAttribute("mjs-include",900,function(a,b,c,e){a=new T({scope:a,node:b,url:c,parentRenderer:e});return a.ownRenderer?!1:a.initPromise});l.registerAttribute("mjs-init",
250,function(a,b,c){va(c)(a)});var Fa=navigator.userAgent.toLowerCase(),Ga=function(){var a=parseInt((/msie (\d+)/.exec(Fa)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/.exec(Fa)||[])[1],10)||!1);return function(){return a}}();l.registerAttribute("mjs-model",1E3,r({$extends:l,inProg:!1,input:null,binding:null,autoOnChange:!1,$init:function(a,b,c){var e=B(b,a);this.node=b;this.input=new ca(b,this.onInputChange,this);this.binding=e.binding||"both";this.$super(a,b,c);a=this.input.getValue();
b=this.watcher.getLastResult();if(b!=a)if("input"!=this.binding&&void 0!=b)this.onChange(b);else if("scope"!=this.binding&&void 0!=a)this.onInputChange(a)},onInputChange:function(a){var b=this.scope;"scope"!=this.binding&&(a&&z(a)&&-1!=a.indexOf("\\{")&&(a=a.replace(/\\{/g,"{")),this.watcher.getLastResult()!=a&&(this.watcher.setValue(a),this.inProg=!0,b instanceof E?b.$root.$check():this.watcher.checkAll(),this.inProg=!1))},destroy:function(){this.input.destroy();this.$super()},onChange:function(){var a=
this.watcher.getLastResult(),b;"input"==this.binding||this.inProg||((b=Ga())&&8>b?oa(this.input.setValue,this.input,[a]):this.input.setValue(a))}}));l.registerAttribute("mjs-options",100,r({$extends:l,model:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,$init:function(a,b,c){this.parseExpr(c);this.node=b;this.scope=a;for(this.defOption=b.options.length?b.options[0]:null;b.firstChild;)b.removeChild(b.firstChild);this.defOption&&this.defOption.setAttribute("mjs-default-option",
"");try{this.watcher=L(a,this.model,this.onChange,this,null,A)}catch(e){J(e)}this.render(I(this.watcher.getValue()))},onChange:function(){this.render(I(this.watcher.getValue()))},renderOption:function(a,b,c){var e=this.groupEl||this.fragment,f=Ga();c.item=a;c.$index=b;a=this.getterFn(c);void 0!=a.group&&(a.group=""+a.group);a.group!==this.prevGroup&&(a.group?(this.groupEl=e=document.createElement("optgroup"),e.setAttribute("label",a.group),a.disabledGroup&&e.setAttribute("disabled","disabled"),this.fragment.appendChild(e)):
(e=this.fragment,this.groupEl=null));this.prevGroup=a.group;b=document.createElement("option");b.setAttribute("value",a.value);b.text=a.name;f&&9>f&&(b.innerHTML=a.name);a.disabled&&b.setAttribute("disabled","disabled");e.appendChild(b)},render:function(a){var b=this.node,c=Pa(b),e=this.defOption,f=this.scope.$new(),g,h;this.fragment=document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;b.firstChild;)b.removeChild(b.firstChild);g=0;for(h=a.length;g<h;g++)this.renderOption(a[g],g,
f);e&&b.insertBefore(e,b.firstChild);f.$destroy();b.appendChild(this.fragment);this.fragment=null;Qa(b,c)},parseExpr:function(a){var b=a.indexOf(" in "),c;-1==b?(c=a,a="{name: .item, value: .$index}"):(c=a.substr(b+4),a=a.substr(0,b));this.model=c;this.getterFn=ra(a)}}));(function(){var a="selected checked disabled readonly open required".split(" "),b,c,e=r({$extends:l,propName:null,$init:function(a,b,c,e){this.propName=e;this.$super(a,b,c)},onChange:function(a){var b=this.propName;a?this.node.setAttribute(b,
b):this.node.removeAttribute(b)}});b=0;for(c=a.length;b<c;b++)(function(a){l.registerAttribute("mjs-"+a,1E3,function(b,c,k){return new e(b,c,k,a)})})(a[b])})();var Wa=function(){var a={},b=0;return function(c){if(a[c])return w.resolve(c);1E3<b&&(a={},b=0);var e=document.createElement("img"),f=e.style,g=new w;za(e,"load",function(){a[c]=!0;b++;document.body.removeChild(e);g.resolve(c)});f.position="absolute";f.visibility="hidden";f.left="-10000px";f.top="0";e.src=c;document.body.appendChild(e);return g}}();
l.registerAttribute("mjs-src",1E3,r({$extends:l,queue:null,usePreload:!0,$constructor:function(a,b,c){B(b,a).deferred&&this.$plugins.push("SrcDeferred");this.$super(a,b,c)},$init:function(a,b,c){B(b,a).noPreload&&(this.usePreload=!1);this.queue=new p({auto:!0,async:!0,mode:p.ONCE,thenable:!0});this.$super(a,b,c)},onChange:function(){this.queue.add(this.doChange,this)},doChange:function(){var a=this,b=a.watcher.getLastResult();if(a.usePreload)return Wa(b).done(function(){a&&a.node&&la(function(){a.node.src=
b;a.node.setAttribute("src",b)})});a.node.src=b;a.node.setAttribute("src",b)},destroy:function(){this.queue.destroy();this.$super()}}));l.registerAttribute("mjs-transclude",1E3,function(a,b){return Aa(b)});l.registerAttribute("mjs-view",200,function(a,b,c){fa(c||"MetaphorJs.View",{scope:a,node:b},a,b);return!1});l.registerAttribute("mjs-include",900,function(a,b,c,e){return(new T({scope:a,node:b,tpl:b.getAttribute("src"),parentRenderer:e,replace:!0})).initPromise});l.registerAttribute("mjs-transclude",
900,function(a,b){return Aa(b)});var Xa=function(){var a=function(a,b,c){if(O(b))return b(a,c);if(""===b||void 0===b)return!0;if(void 0!==a){if(ea(a))return a===b;if(b instanceof RegExp)return b.test(""+a);if("strict"==c)return""+a===""+b;if(!0===c||null===c||void 0===c)return-1!=""+a.indexOf(b);if(!1===c)return-1==""+a.indexOf(b)}return!1},b=function(b,c,g){if(qa(b))return void 0===c.$?!0:a(b,c.$,g);var h,k;for(h in c)if("$"==h)for(k in b){if(a(b[k],c.$,g))return!0}else if(a(b[h],c[h],g))return!0;
return!1},c=function(a,c,g){Z(c)||(c={$:c});var h=[],k,l;k=-1;for(l=a.length;++k<l;)b(a[k],c,g)&&h.push(a[k]);return h};c.compare=b;return c}();s("filter.filter",function(a,b,c,e){return Xa(a,c,e)});s("filter.join",function(a,b,c){c=c||", ";return a&&a.length?(N(a)||(a=I(a)),a.join(c)):""});s("filter.l",function(a,b){return b.$app.lang.get(a)});s("filter.limitTo",function(a,b,c){b=z(a);if(!N(a)&&!b)return a;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);if(b)return c?0<=c?a.slice(0,c):
a.slice(c,a.length):"";b=[];var e;c>a.length?c=a.length:c<-a.length&&(c=-a.length);0<c?e=0:(e=a.length+c,c=a.length);for(;e<c;e++)b.push(a[e]);return b});s("filter.linkify",function(a,b,c){return a?a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(c?' target="'+c+'"':"")+">$1</a>"):""});s("filter.lowercase",function(a){return a.toLowerCase()});var Ya={};s("filter.moment",function(a,b,c){c=Ya[c]||c;return moment(a).format(c)});var Za={};s("filter.numeral",
function(a,b,c){c=Za[c]||c;return numeral(a).format(c)});s("filter.p",function(a,b,c){return b.$app.lang.plural(a,parseInt(c,10)||0)});s("filter.sortBy",function(a,b,c,e){return Oa(a,c,e)});s("filter.split",function(a,b,c,e){e=e||void 0;c=c||"/\\n|,/";if(!a)return[];a=""+a;"/"==c.substr(0,1)&&"/"==c.substr(c.length-1)&&(c=pa(c.substring(1,c.length-1)));a=a.split(c,e);b=-1;for(c=a.length;++b<c;a[b]=X(a[b]));return a});s("filter.toArray",function(a){return I(a)});s("filter.ucfirst",function(a){return a.substr(0,
1).toUpperCase()+a.substr(1)});s("filter.uppercase",function(a){return a.toUpperCase()});Q=ma.$extend({store:null,$constructor:function(a,b,c){var e=B(b,a);e.pullNext&&(e.buffered&&(e.bufferedPullNext=!0,e.buffered=!1),this.$plugins.push("ListPullNext"));this.$super(a,b,c)},afterInit:function(a,b,c){this.store=a=ra(this.model)(a);this.watcher=L(a,".current",this.onChange,this,null,A);this.trackByFn=V(a.getRecordId,a);this.griDelegate=V(a.indexOfId,a);this.bindStore(a,"on")},bindStore:function(a,b){a[b]("update",
this.onStoreUpdate,this);a[b]("clear",this.onStoreUpdate,this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},getListItem:function(a,b){return this.store.getRecordData(a[b])},onStoreDestroy:function(){this.onStoreUpdate();this.watcher.unsubscribeAndDestroy(this.onChange,this);this.watcher=null},destroy:function(){this.bindStore(this.store,"un");this.$super()}},{$stopRenderer:!0,$registerBy:"id"});l.registerAttribute("mjs-each-in-store",100,Q);r({$class:"DialogComponent",
$extends:F,dialog:null,dialogPreset:null,dialogCfg:null,initComponent:function(){this.$super();this._createDialog();this._oldShow=this.show;this._oldHide=this.hide},_getDialogCfg:function(){return t({},this.dialogCfg,{render:{el:this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=new Ja(this.dialogPreset,this._getDialogCfg());this.dialog.on("show",this._oldShow,this);this.dialog.on("hide",this._oldHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},show:function(){this.dialog.show()},
hide:function(){this.dialog.hide()},onDialogDestroy:function(){this.destroying||(this.dialog=null,this.$destroy())},destroy:function(){this.destroying=!0;this.dialog&&this.dialog.destroy();this.$super()}});r({$class:"MetaphorJs.ValidatorComponent",node:null,scope:null,validator:null,scopeState:null,$init:function(a,b,c){this.node=a;this.scope=b;this.scopeState={};this.validator=this.createValidator();this.initScope();this.initScopeState();this.initValidatorEvents();c.once("rendered",this.validator.check,
this.validator)},createValidator:function(){var a=this.node,b={},c;if(c=B(a).submit)b.callback=b.callback||{},b.callback.submit=function(a,b){return function(){try{return a(b)}catch(c){J(c)}}}(va(c),this.scope);return new Ia(a,b)},initValidatorEvents:function(){var a=this.validator;a.on("fieldstatechange",this.onFieldStateChange,this);a.on("statechange",this.onFormStateChange,this);a.on("displaystatechange",this.onDisplayStateChange,this);a.on("reset",this.onFormReset,this)},initScope:function(){var a=
this.scope,b=this.node,b=b.getAttribute("name")||b.getAttribute("id")||"$form";a[b]=this.scopeState},initScopeState:function(){var a=this.node,b=this.scopeState,c,e,f;a.elements?c=a.elements:(c=[],Ba(a,function(a){ya(a)&&c.push(a)}));a=-1;for(f=c.length;++a<f;)e=c[a],(e=e.getAttribute("name")||e.getAttribute("id"))&&!b[e]&&(b[e]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null});b.$invalid=!1;b.$pristine=!0;b.$submit=V(this.validator.onSubmit,this.validator);b.$reset=V(this.validator.reset,
this.validator);window.formState=b},onDisplayStateChange:function(a,b){if(b){b=this.scopeState;var c,e;for(c in b)e=b[c],e.$real&&(b[c]=e.$real);b.$invalid=!a.isValid();b.$pristine=!1;this.scope.$check()}else this.onFormReset(a)},onFormReset:function(a){a=this.scopeState;var b,c;for(b in a)c=a[b],c.$error=null,c.$errorMessage=null,c.$invalid=null,c.$pristine=!0;a.$invalid=!1;a.$pristine=!0;this.scope.$check()},onFormStateChange:function(a,b){var c=this.scopeState;c.$invalid=!1===b&&a.isDisplayStateEnabled();
c.$pristine=!1;this.scope.$check()},onFieldStateChange:function(a,b,c){var e=this.scopeState,f=b.getName();a=a.isDisplayStateEnabled();b={$error:b.getErrorRule(),$errorMessage:b.getError(),$invalid:!1===c,$pristine:null===b.getExactValidState()};a?e[f]=b:e[f].$real=b;this.scope.$check()}});l.registerAttribute("mjs-validate",250,["$scope","$node","$attrValue","$renderer",function(a,b,c,e){c=c||"MetaphorJs.ValidatorComponent";var f=aa(c);f?new f(b,a,e):J(Error("Class '"+c+"' not found"))}]);return ha});
