(function(){var h=Array.prototype.slice,n=Function.prototype.bind?function(a,c){return a.bind(c)}:function(a,c){return function(){a.apply(c,arguments)}},k=function(){var a=!1,c=h.call(arguments),f=c.shift(),b,d;for("boolean"==typeof c[c.length-1]&&(a=c.pop());b=c.shift();)for(d in b)if(b.hasOwnProperty(d))if(f[d]&&"object"==typeof f[d]&&"object"==typeof b[d])k(f[d],b[d],a);else if(!0===a||"undefined"==typeof f[d]||null===f[d])f[d]=b[d];return f},g=function(){return String.prototype.trim?function(a){return"string"==
typeof a?a.trim():a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),l={},s=function(a){return l[a]||(l[a]=new RegExp("(?:^|\\s)"+a+"(?!\\S)",""))},p=function(a,c){return s(c).test(a.className)},c=["0","0","0"];"undefined"!=typeof window?window.MetaphorJs||(window.MetaphorJs={}):global.MetaphorJs||(global.MetaphorJs={});MetaphorJs.bind=n;MetaphorJs.addListener=function(a,c,f){a.attachEvent?a.attachEvent("on"+c,f):a.addEventListener(c,f,!1)};MetaphorJs.removeListener=
function(a,c,f){a.detachEvent?a.detachEvent("on"+c,f):a.removeEventListener(c,f,!1)};MetaphorJs.extend=k;MetaphorJs.trim=g;MetaphorJs.inArray=function(a,c){return c?aIndexOf.call(c,a):-1};MetaphorJs.isArray=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"==toString.call(a)||!1};MetaphorJs.toArray=function(a){for(var c=[],f=-1,b=a.length>>>0;++f!==b;c[f]=a[f]);return c};MetaphorJs.addClass=function(a,c){p(a,c)||(a.className+=" "+c)};MetaphorJs.removeClass=function(a,
c){var f=s(c);a.className=a.className.replace(f,"")};MetaphorJs.hasClass=p;MetaphorJs.nextUid=function(){for(var a=c.length,e;a;){a--;e=c[a].charCodeAt(0);if(57==e)return c[a]="A",c.join("");if(90==e)c[a]="0";else return c[a]=String.fromCharCode(e+1),c.join("")}c.unshift("0");return c.join("")}})();
(function(){var h={}.undefined,n=MetaphorJs.extend,k=MetaphorJs.nextUid,g=MetaphorJs.addListener,l=MetaphorJs.removeListener,s=MetaphorJs.isArray,p={},c=function(b){return b._mjsId||(b._mjsId=k())},a=[],e=[],f=!1,b=!1,d=function(b,d){return b.priority<d.priority?-1:b.priority>d.priority?1:0},m,u=function(b){var d,a,m;if(s(b)){m=[];d=0;for(a=b.length;d<a;d++)m.push(u(b[d]));return m}switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0);
default:return null}},w=function(b,d,a){setTimeout(function(){b.apply(d,a||[])},0)};n(MetaphorJs,{VERSION:"0.1",registerAttributeHandler:function(b,d,c){m||(m=MetaphorJs.add);a.push({priority:d,name:b,handler:m("attr."+b,c)});f=!1},registerTagHandler:function(d,a,c){m||(m=MetaphorJs.add);e.push({priority:a,name:d,handler:m("tag."+d,c)});b=!1},getAttributeHandlers:function(){f||(a.sort(d),f=!0);return a},getTagHandlers:function(){b||(e.sort(d),b=!0);return e},numberFormats:{},dateFormats:{},getNodeId:c,
data:function(b,d,a){b=c(b);var m=p[b];return"undefined"!=typeof a?(m||(m=p[b]={}),m[d]=a):m?m[d]:h},emptyFn:function(){},clone:u,isVisible:function(b){return!(0>=b.offsetWidth||0>=b.offsetHeight)},isThenable:function(b){var d;return b&&"function"==typeof(d=b.then)?d:!1},isInjectable:function(b){return b.length&&"function"==typeof b[b.length-1]},async:w,asyncError:function(b){w(function(){throw b;})},onReady:function(b){var d=!1,a=!0,m=window,c=m.document,u=c.documentElement,e=function(a){if("readystatechange"!=
a.type||"complete"==c.readyState)l("load"==a.type?m:c,a.type,e),!d&&(d=!0)&&b.call(m,a.type||a)},f=function(){try{u.doScroll("left")}catch(b){setTimeout(f,50);return}e("poll")};if("complete"==c.readyState)b.call(m,"lazy");else{if(c.createEventObject&&u.doScroll){try{a=!m.frameElement}catch(w){}a&&f()}g(c,"DOMContentLoaded",e);g(c,"readystatechange",e);g(m,"load",e)}},toFragment:function(b){var d=document.createDocumentFragment();if("string"==typeof b){var a=document.createElement("div");a.innerHTML=
b;b=a.childNodes}if(b.nodeType)d.appendChild(b);else for(var a=-1,m=b.length>>>0;++a!==m;d.appendChild(b[0]));return d},app:function(b,d,a){try{return MetaphorJs.create(d||"MetaphorJs.cmp.App",b,a)}catch(m){MetaphorJs.error(m)}},error:function(b){var d=b.stack||Error().stack;setTimeout(function(){"undefined"!=typeof console&&console.log&&(console.log(b),d&&console.log(d))},0)}})})();
(function(){var h=/\r/g,n=MetaphorJs.trim,k=MetaphorJs.toArray,g=MetaphorJs.inArray,l=MetaphorJs.isArray,s=function(c){var a,e;if((a=p[c.type]||p[c.nodeName.toLowerCase()])&&"get"in a&&void 0!==(e=a.get(c,"value")))return e;e=c.value;return"string"===typeof e?e.replace(h,""):null==e?"":e},p={option:{get:function(c){var a=c.getAttribute("value");return null!=a?a:n(c.innerText||c.textContent)}},select:{get:function(c){for(var a,e=c.options,f=c.selectedIndex,b=(c="select-one"===c.type||0>f)?null:[],
d=c?f+1:e.length,m,u=0>f?d:c?f:0;u<d;u++)if(a=e[u],m=a.disabled||null!==a.getAttribute("disabled")||e.parentNode.disabled,(a.selected||u===f)&&!m){a=s(a);if(c)return a;b.push(a)}return b},set:function(c,a){for(var e,f,b=c.options,d=k(a),m=b.length;m--;)if(f=b[m],f.selected=g(f.value,d))e=!0;e||(c.selectedIndex=-1);return d}}};p.radio=p.checkbox={set:function(c,a){if(l(a))return c.checked=0<=g(s(c),a)},get:function(c){return null===c.getAttribute("value")?"on":c.value}};MetaphorJs.getValue=s;MetaphorJs.setValue=
function(c,a){if(1===c.nodeType){null==a?a="":"number"===typeof a&&(a+="");var e=p[c.type]||p[c.nodeName.toLowerCase()];e&&"set"in e&&void 0!==e.set(this,a,"value")||(c.value=a)}}})();
(function(){var h=function(){return!1},n=function(){return!0},k=function(g){if(!(this instanceof k))return new k(g);for(var l in g)g.hasOwnProperty&&g.hasOwnProperty(l)||this[l]||(this[l]=g[l]);this.originalEvent=g;this.type=g.type;!this.target&&g.srcElement&&(this.target=g.srcElement);this.isDefaultPrevented=g.defaultPrevented||void 0===g.defaultPrevented&&!1===g.returnValue?n:h;this.timeStamp=g&&g.timeStamp||(new Date).getTime()};k.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,
preventDefault:function(){var g=this.originalEvent;this.isDefaultPrevented=n;g&&g.preventDefault&&g.preventDefault()},stopPropagation:function(){var g=this.originalEvent;this.isPropagationStopped=n;g&&g.stopPropagation&&g.stopPropagation()},stopImmediatePropagation:function(){var g=this.originalEvent;this.isImmediatePropagationStopped=n;g&&g.stopImmediatePropagation&&g.stopImmediatePropagation();this.stopPropagation()}};window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.normalizeEvent=function(g){return new k(g)}})();
(function(){var h=MetaphorJs.extend,n=MetaphorJs.bind,k=MetaphorJs.addListener,g=MetaphorJs.removeListener,l=MetaphorJs.getValue,s=MetaphorJs.setValue,p=function(c,a,e,f){this.el=c;this.cb=a;this.scb=f;this.cbContext=e;this.inputType=a=c.getAttribute("mjs-input-type")||c.type.toLowerCase();this.listeners=[];e=c.type?c.type.toLowerCase():"";this.submittable="input"==c.nodeName.toLowerCase()&&"radio"!=e&&"checkbox"!=e;"radio"==a?this.initRadioInput():"checkbox"==a?this.initCheckboxInput():this.initTextInput()};
h(p.prototype,{el:null,inputType:null,cb:null,scb:null,cbContext:null,listeners:[],radio:null,submittable:!1,destroy:function(){var c=this.inputType,a=this.listeners,e=this.radio,f=this.el,b,d,m,u;b=0;for(d=a.length;b<d;b++)if("radio"==c)for(m=0,u=e.length;m<u;m++)g(e[m],a[b][0],a[b][1]);else g(f,a[b][0],a[b][1]);delete this.radio;delete this.el;delete this.cb;delete this.cbContext},initRadioInput:function(){var c=this.el,a=c.type,c=c.name,e,f,b;this.onRadioInputChangeDelegate=n(this.onRadioInputChange,
this);if(document.querySelectorAll)e=document.querySelectorAll("input[name="+c+"]");else{var d=document.getElementsByTagName("input"),m;e=[];f=0;for(b=d.length;f<b;f++)m=d[f],m.type==a&&m.name==c&&e.push(m)}this.radio=e;this.listeners.push(["click",this.onRadioInputChangeDelegate]);f=0;for(b=e.length;f<b;f++)k(e[f],"click",this.onRadioInputChangeDelegate)},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=n(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate]);
k(this.el,"click",this.onCheckboxInputChangeDelegate)},initTextInput:function(){var c=MetaphorJs.browser,a=!1,e=this,f=e.el,b=e.listeners,d;if(!c.android){var m=function(){a=!0},u=function(){a=!1;w()};b.push(["compositionstart",m]);b.push(["compositionend",u]);k(f,"compositionstart",m);k(f,"compositionend",u)}var w=e.onTextInputChangeDelegate=function(){if(!a)e.onTextInputChange()};if(c.hasEvent("input"))b.push(["input",w]),k(f,"input",w);else{var q=function(b){d||(d=window.setTimeout(function(){w(b);
d=null},0))},m=function(b){b=b||window.event;var d=b.keyCode;if(13==d&&e.submittable&&e.scb)return e.scb.call(e.callbackContext,b);91===d||15<d&&19>d||37<=d&&40>=d||q(b)};b.push(["keydown",m]);k(f,"keydown",m);c.hasEvent("paste")&&(b.push(["paste",q]),b.push(["cut",q]),k(f,"paste",q),k(f,"cut",q))}b.push(["change",w]);k(f,"change",w)},onTextInputChange:function(){var c=this.el.value;switch(this.inputType){case "number":c=parseInt(c,10)}this.cb.call(this.cbContext,c)},onCheckboxInputChange:function(){var c=
this.el;this.cb.call(this.cbContext,c.checked?c.getAttribute("value")||!0:!1)},onRadioInputChange:function(c){c=c||window.event;this.cb.call(this.cbContext,(c.target||c.srcElement).value)},setValue:function(c){var a=this.inputType,e,f;if("radio"==a)for(a=this.radio,e=0,f=a.length;e<f;e++){if(a[e].value==c){a[e].checked=!0;break}}else"checkbox"==a?(a=this.el,a.checked=!0===c||c==a.value):s(this.el,c)},getValue:function(){var c=this.inputType,a,e;if("radio"==c){c=this.radio;a=0;for(e=c.length;a<e;a++)if(c[a].checked)return c[a].value;
return null}return"checkbox"==c?this.el.checked?this.el.getAttribute("value")||!0:!1:l(this.el)}});window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.lib||(MetaphorJs.lib={});MetaphorJs.lib.Input=p})();
(function(){var h="undefined"!=typeof window?window:global,n={},k=function(g,l){if(n[g]||l)return n[g];var c=g.split("."),a,e=c.length,f,b=h;for(a=0;a<e;a++){f=c[a];if(!b[f])return null;b=b[f]}return b},g=function(g,l){var c;c=g.split(".");var a,e=c.pop();a=c.join(".");var f=c.length,b,d=h;if(n[a])c=[n[a],e];else{for(a=0;a<f;a++)b=c[a],d[b]||(d[b]={}),d=d[b];c=[d,e]}c[0][c[1]]=l;return n[g]=l},l=function(g,l){return n[g]=l};g("MetaphorJs.ns",{register:g,exists:function(g){return n[g]?!0:!1},get:k,
add:l,remove:function(g){delete n[g]}});MetaphorJs.r=g;MetaphorJs.g=k;MetaphorJs.add=l;"undefined"!=typeof module&&(module.exports=MetaphorJs.ns)})();
(function(){var h;if("undefined"!=typeof global)try{h=require("metaphorjs-namespace")}catch(n){h=global.MetaphorJs.ns}else h=window.MetaphorJs.ns;var k={}.undefined,g=Array.prototype.slice,l=function(b,d){return c(function(){},b,d)},s=function(b,d,a){return function(){var c=k,e=this.supr;this.supr=b.prototype[d]||function(){};try{c=a.apply(this,arguments)}catch(f){}this.supr=e;return c}},p=function(b,d,a){for(var c in d)d.hasOwnProperty(c)&&(b[c]="function"===typeof d[c]&&a.prototype&&"function"===
typeof a.prototype[c]?s(a,c,d[c]):d[c])},c=function(b,d,a){var c=function(){};c.prototype=b.prototype;c=new c;a=a||function(){this.initialize&&this.initialize.apply(this,arguments)};p(c,d,b);a.prototype=c;a.prototype.constructor=a;a.prototype.getClass=function(){return this.__proto__.constructor.__class};a.prototype.getParentClass=function(){return this.__proto__.constructor.__parentClass};a.__instantiate=function(b){return function(){var d=function(){},a;d.prototype=b.prototype;d=new d;a=b.prototype.constructor.apply(d,
arguments);return"object"==typeof a?a:d}}(a);return a},a=function(b,d,a,e,f,g){null===b&&(b="");"function"==typeof b?(f=a,"string"==typeof d?(f=e,e=a):(e=d,a=b,d=null),b=null):"string"!=typeof b&&(f=d,e=b,b=a=d=null);"string"!=typeof d&&"function"!=typeof d&&(f=e,e=a,a=d,d=null);"function"!=typeof a&&(f=e,e=a,a=null);e=e||{};var A=d&&"string"==typeof d?h.get(d):d;if(d&&!A)throw Error(d+" not found");d=A?c(A,e,a):l(e,a);d.__isMetaphorClass=!0;d.__parent=A;d.__parentClass=A?A.__class:null;d.__class=
b;if(f)for(var C in f)f.hasOwnProperty(C)&&(d[C]=f[C]);b&&(g?h.add(b,d):h.register(b,d));f&&f.alias&&h.add(f.alias,d);return d},e=function(b,d,c,e,f){return a(b,d,c,e,f,!0)},f=function(b){var d=h.get(b),a=g.call(arguments,1);if(!d)throw Error(b+" not found");return d.__instantiate.apply(this,a)},b=function(b,d){var a="string"==typeof d?h.get(d):d;return a?b instanceof a:!1},d=function(b,d){var a=b,c=h.get;"string"!=typeof d&&(d=d.getClass?d.getClass():d.prototype.constructor.__class);for("string"==
typeof b&&(a=c(b));a;){if(a.prototype.constructor.__class==d)return!0;a&&(a=a.getParentClass?c(a.getParentClass()):a.__parent)}return!1};"undefined"!=typeof global?module.exports={define:a,d:a,defineCache:e,dc:e,create:f,c:f,is:b,isSubclass:d}:(MetaphorJs.define=MetaphorJs.d=a,MetaphorJs.defineCache=MetaphorJs.dc=e,MetaphorJs.create=MetaphorJs.c=f,MetaphorJs.is=b,MetaphorJs.isSubclass=MetaphorJs.iss=d)})();
(function(){var h="undefined"!=typeof window?window.setTimeout:global.setTimeout,n=function(b){var d;return!b||"object"!=typeof b&&"function"!=typeof b||"function"!=typeof(d=b.then)?!1:d},k=Function.prototype.bind?function(b,d){return b.bind(d)}:function(b,d){return function(){b.apply(d,arguments)}},g=[],l=!1,s="undefined"!=typeof process?process.nextTick:function(b){h(b,0)},p=function(){l=!0;var b=g.shift();s(function(){b[0].apply(b[1],b[2]);g.length?p():l=!1},0)},c=function(b,d,a){a=a||[];g.push([b,
d,a]);l||p()},a=function(b,d){for(var a in d)d.hasOwnProperty(a)&&(b[a]=d[a])},e=function(b,d){return function(a){try{d.resolve(b(a))}catch(c){d.reject(c)}}},f=function(b,d){if(b instanceof f)return b;if(!(this instanceof f))return new f(b,d);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if("undefined"!=typeof b)if(n(b)||"function"!=typeof b)this.resolve(b);else try{b.call(d,k(this.resolve,this),k(this.reject,this))}catch(a){this.reject(a)}};a(f.prototype,{_state:0,_fulfills:null,
_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(b,d){var a;if(0==this._state)if(b===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(a=n(b)){b instanceof f?b.then(k(this._processResolveValue,
this),k(this._processRejectReason,this)):(new f(a,b)).then(k(this._processResolveValue,this),k(this._processRejectReason,this));return}}catch(c){0==this._state&&this._doReject(c);return}d.call(this,b)}},_callResolveHandlers:function(){this._done();for(var b=this._fulfills,d;d=b.shift();)c(d[0],d[1],[this._value]);this._cleanup()},_doResolve:function(b){this._value=b;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(b){this._processValue(b,this._doResolve)},resolve:function(b){if(this._triggered)return this;
this._triggered=!0;this._processResolveValue(b);return this},_callRejectHandlers:function(){this._fail();for(var b=this._rejects,d;d=b.shift();)c(d[0],d[1],[this._reason]);this._cleanup()},_doReject:function(b){this._state=2;this._reason=b;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(b){this._processValue(b,this._doReject)},reject:function(b){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(b);return this},then:function(b,d){var a=new f,u=this._state;
0==u||0!=this._wait?(b&&"function"==typeof b?this._fulfills.push([e(b,a),null]):this._fulfills.push([a.resolve,a]),d&&"function"==typeof d?this._rejects.push([e(d,a),null]):this._rejects.push([a.reject,a])):1==u?b&&"function"==typeof b?c(e(b,a),null,[this._value]):a.resolve(this._value):2==u&&(d&&"function"==typeof d?c(e(d,a),null,[this._reason]):a.reject(this._reason));return a},"catch":function(b){return this.then(null,b)},_done:function(){for(var b=this._dones,d;d=b.shift();)d[0].call(d[1]||null,
this._value)},done:function(b,d){var a=this._state;1==a&&0==this._wait?b.call(d||null,this._value):0==a&&this._dones.push([b,d]);return this},_fail:function(){for(var b=this._fails,d;d=b.shift();)d[0].call(d[1]||null,this._reason)},fail:function(b,d){var a=this._state;2==a&&0==this._wait?b.call(d||null,this._reason):0==a&&this._fails.push([b,d]);return this},always:function(b,d){this.done(b,d);this.fail(b,d);return this},promise:function(){return{then:k(this.then,this),done:k(this.done,this),fail:k(this.fail,
this),always:k(this.always,this)}},after:function(b){var d=this;if(n(b)){d._wait++;var a=function(){d._wait--;0==d._wait&&0!=d._state&&(1==d._state?d._callResolveHandlers():d._callRejectHandlers())};"function"==typeof b.done?b.done(a):b.then(a)}return d}});a(f,{resolve:function(b){return new f(b)},reject:function(b){var a=new f;a.reject(b);return a},all:function(b){if(!b.length)return f.resolve(null);var a=new f,c=b.length,e=Array(c),g=c,q,r,l=function(b,c){e[c]=b;g--;0==g&&a.resolve(e)};for(q=0;q<
c;q++)(function(c){r=b[q];r instanceof f?r.done(function(b){l(b,c)}).fail(a.reject,a):n(r)||"function"==typeof r?(new f(r)).done(function(b){l(b,c)}).fail(a.reject,a):l(r,c)})(q);return a},when:function(){return f.all(arguments)},allResolved:function(b){if(!b.length)return f.resolve(null);var a=new f,c=b.length,e=[],g=c,q,r,l=function(b){e.push(b);A()},A=function(){g--;0==g&&a.resolve(e)};for(q=0;q<c;q++)r=b[q],r instanceof f?r.done(l).fail(A):n(r)||"function"==typeof r?(new f(r)).done(l).fail(A):
l(r);return a},race:function(b){if(!b.length)return f.resolve(null);var a=new f,c=b.length,e,g;for(e=0;e<c&&(g=b[e],g instanceof f?g.done(a.resolve,a).fail(a.reject,a):n(g)||"function"==typeof g?(new f(g)).done(a.resolve,a).fail(a.reject,a):a.resolve(g),a.isPending());e++);return a}});"undefined"==typeof global?(window.Promise||(window.Promise=f),window.MetaphorJs&&window.MetaphorJs.r("MetaphorJs.lib.Promise",f)):"undefined"!=typeof module&&(module.exports=f)})();
(function(){"undefined"==typeof window&&(global.window=global);if(window.Promise)h=window.Promise;else{var h;if("undefined"!=typeof global)try{h=require("metaphorjs-promise")}catch(n){global.Promise&&(h=global.Promise)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Promise&&(h=MetaphorJs.lib.Promise)}var k=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){return Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10)},g=function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])},l=Array.prototype.slice,s="undefined"!=typeof process?process.nextTick:function(b){window.setTimeout(b,0)},p=Function.prototype.bind?function(b,a){return b.bind(a)}:function(b,a){return function(){b.apply(a,arguments)}},c=function(){this.events={}};g(c.prototype,{createEvent:function(b,d){b=b.toLowerCase();var c=this.events;c[b]||(c[b]=new a(b,d));return c[b]},getEvent:function(b){b=b.toLowerCase();return this.events[b]},on:function(b,d,c,e){b=b.toLowerCase();var f=this.events;f[b]||
(f[b]=new a(b));return f[b].on(d,c,e)},once:function(b,a,c,e){e=e||{};e.limit=1;return this.on(b,a,c,e)},un:function(b,a,c){b=b.toLowerCase();var e=this.events;e[b]&&e[b].un(a,c)},hasListener:function(b,a,c){b=b.toLowerCase();var e=this.events;return e[b]?e[b].hasListener(a,c):!1},removeAllListeners:function(b){var a=this.events;a[b]&&a[b].removeAllListeners()},triggerAsync:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return[];b=a[b];return b.triggerAsync.apply(b,l.call(arguments,
1))},trigger:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return null;b=a[b];return b.trigger.apply(b,l.call(arguments,1))},suspendEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].suspend()},suspendAllEvents:function(){var b=this.events,a;for(a in b)b[a].suspend()},resumeEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].resume()},resumeAllEvents:function(){var b=this.events,a;for(a in b)b[a].resume()},destroyEvent:function(b){var a=this.events;
a[b]&&(a[b].removeAllListeners(),a[b].destroy(),delete a[b])},destroy:function(b){var a=this.events;if(b)b=b.toLowerCase(),a[b]&&(a[b].destroy(),delete a[b]);else{for(var c in a)a[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var b="createEvent getEvent on un once hasListener removeAllListeners triggerAsync trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),a={},c,e=-1,f=b.length;++e<f;c=b[e],a[c]=p(this[c],this));this.api=a}return this.api}});
var a=function(b,a){this.name=b;this.listeners=[];this.map={};this.hash=k();this.uni="$$"+b+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=a||!1};g(a.prototype,{getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(b,a,c){if(!b)return null;a=a||null;c=c||{};var e=this.uni,f=a||b;if(f[e]&&!c.allowDupes)return null;var g=++this.lid,r=c.first||!1;f[e]=g;b={fn:b,scope:a,uniScope:f,id:g,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,
prepend:c.prepend};r?this.listeners.unshift(b):this.listeners.push(b);this.map[g]=b;return g},once:function(b,a,c){c=c||{};c.once=!0;return this.on(b,a,c)},un:function(b,a){var c=-1,e=this.uni,f=this.listeners,g;g=b==parseInt(b)?b:(a||b)[e];if(!g)return!1;for(var r=0,l=f.length;r<l;r++)if(f[r].id==g){c=r;delete f[r].uniScope[e];break}if(-1==c)return!1;f.splice(c,1);delete this.map[g];return!0},hasListener:function(b,a){var c=this.listeners,e;if(b){a=a||b;e=b==parseInt(b)?b:a[this.uni];if(!e)return!1;
for(var f=0,g=c.length;f<g;f++)if(c[f].id==e)return!0;return!1}return 0<c.length},removeAllListeners:function(){var b=this.listeners,a=this.uni,c,e;c=0;for(e=b.length;c<e;c++)delete b[c].uniScope[a];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(b,a){var c;b.append||b.prepend?(c=l.call(a),b.prepend&&(c=b.prepend.concat(c)),b.append&&(c=c.concat(b.append))):c=a;return c},triggerAsync:function(){if("undefined"==typeof h)throw Error("Promises are not defined");
var b=this,a=b.listeners,c=b.returnResult,e=l.call(arguments),f=[],g=[],r,y,A;if(b.suspended||0==a.length)return h.resolve(null);y=0;for(A=a.length;y<A;y++)f.push(a[y]);for(y=function(a){r=b._prepareArgs(a,e);return new h(function(c,d){s(function(){try{c(a.fn.apply(a.scope,r))}catch(e){d(e)}a.called++;a.called==a.limit&&b.un(a.id)},0)})};(a=f.shift())&&(!a||!b.map[a.id]||(a.count++,a.count<a.start||(g.push(y(a)),"first"!=c))););return"last"==c?[g.pop()]:g},trigger:function(){var b=this.listeners,
a=this.returnResult;if(this.suspended||0==b.length)return null;var c="all"==a?[]:null,e=[],f,g;if("first"==a)e.push(b[0]);else for(f=0,g=b.length;f<g;f++)e.push(b[f]);for(;b=e.shift();)if(b&&this.map[b.id]&&(b.count++,!(b.count<b.start))){f=b.fn.apply(b.scope,this._prepareArgs(b,arguments));b.called++;b.called==b.limit&&this.un(b.id);"all"==a&&c.push(f);if("first"==a)return f;"last"==a&&(c=f);if(!1==a&&!1===f)break}if(a)return c}});var e=window.MetaphorJs;if(e&&e.VERSION){var f=new c;g(MetaphorJs,
f.getApi())}e&&e.r?e.r("MetaphorJs.lib.Observable",c):(window.MetaphorJs=window.MetaphorJs||{},MetaphorJs.lib=MetaphorJs.lib||{},MetaphorJs.lib.Observable=c);"undefined"!=typeof global&&(module.exports=c)})();
(function(){"undefined"==typeof window&&(global.window=global);var h;if("undefined"!=typeof global)try{h=require("metaphorjs-observable")}catch(n){global.Observable&&(h=global.Observable)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Observable&&(h=MetaphorJs.lib.Observable);var k=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,g={},l=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){var a;a=Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10);return g[a]?
l():g[a]=a},s=Object.prototype.toString,p=function(a){return"[object Array]"===s.call(a)},c=function(a){return"[object Date]"===s.call(a)},a=function(a){return"[object RegExp]"===s.call(a)},e=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},f=function(b,d){if(e(b))throw Error("Cannot copy window object");if(d){if(b===d)throw Error("Objects are identical");if(p(b))for(var v=d.length=0;v<b.length;v++)d.push(f(b[v]));else{for(v in d)delete d[v];for(v in b)d[v]=f(b[v])}}else(d=b)&&
(p(b)?d=f(b,[]):c(b)?d=new Date(b.getTime()):a(b)?d=new RegExp(b.source):null!=b&&"object"===typeof b&&(d=f(b,{})));return d},b=function(d,f){if(d===f)return!0;if(null===d||null===f)return!1;if(d!==d&&f!==f)return!0;var v=typeof d,z;if(v==typeof f&&"object"==v)if(p(d)){if(!p(f))return!1;if((v=d.length)==f.length){for(z=0;z<v;z++)if(!b(d[z],f[z]))return!1;return!0}}else{if(c(d))return c(f)&&d.getTime()==f.getTime();if(a(d)&&a(f))return d.toString()==f.toString();if(e(d)||e(f)||p(f))return!1;v={};for(z in d)if(("$"!==
z.charAt(0)||"object"!=typeof d[z])&&"function"!==typeof d[z]){if(!b(d[z],f[z]))return!1;v[z]=!0}for(z in f)if(!v.hasOwnProperty(z)&&"$"!==z.charAt(0)&&void 0!==f[z]&&"function"!==typeof f[z])return!1;return!0}return!1},d=function(a,c){var d=a.length,e=c.length,f=Array(d+1),g=Array(d+1),t,x,D,r,m=0;if(d==e&&0==d)return{changes:0,distance:0,prescription:[]};for(t=0;t<=d;t++)f[t]=Array(e+1),g[t]=Array(e+1),f[t][0]=t,g[t][0]="D";for(t=0;t<=e;t++)f[0][t]=t,g[0][t]="I";for(t=1;t<=d;t++)for(x=1;x<=e;x++)D=
b(a[t-1],c[x-1])?0:1,f[t][x-1]<f[t-1][x]&&f[t][x-1]<f[t-1][x-1]+D?(f[t][x]=f[t][x-1]+1,g[t][x]="I"):f[t-1][x]<f[t-1][x-1]+D?(f[t][x]=f[t-1][x]+1,g[t][x]="D"):(f[t][x]=f[t-1][x-1]+D,g[t][x]=1==D?"R":"-");r=[];t=d;x=e;do D=g[t][x],r.push(D),"-"!=D&&m++,"R"==D||"-"==D?(t--,x--):"D"==D?t--:x--;while(0!=t||0!=x);return{changes:m/r.length,distance:f[d][e],prescription:r.reverse()}},m=window.MetaphorJs?MetaphorJs.trim:function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():
a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),u,w=window.MetaphorJs?MetaphorJs.ns.get:null,q=function(a,b,c,d,e){u||(u=new h);var f=l(),t;p(a)&&null===b?t="array":("string"!=typeof b&&(d=c,c=b,b=null,t="object"),"string"==typeof a&&(d=c,c=b,b=a,a=null),b&&a&&(t=a.hasOwnProperty(b)?"attr":"expr"),b&&!a&&(t="expr"));if(c)u.on(f,c,d||this,{append:[e],allowDupes:!0});this.code=b=this._processPipes(b,a);this.getterFn="expr"==t?B(b):null;this.id=f;this.type=t;
this.obj=a;this.itv=null;this.curr=this._getValue()};(function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(q.prototype,{code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,arraySlice:!1,pipes:null,_addPipe:function(a,b,c){var d=b.shift(),e=null,f=[],t;w&&(e=w("filter."+d,!0));e||(e=window[d]||c[d]);if("function"==typeof e){d=-1;for(t=b.length;++d<t;f.push(r(c,b[d],self.check,self)));a.push([e,b,f])}},_processPipes:function(a,b){for(var c=0,d=a.length,e=[],
f,t,x,g=!1,r=a;c<d;)if(-1!=(f=a.indexOf("|",c)))t=a.charAt(f-1),x=a.charAt(f+1),"|"!=t&&"'"!=t&&'"'!=t&&"|"!=x&&"'"!=x&&'"'!=x&&(g?(c=m(a.substring(c,f)).split(":"),this._addPipe(e,c,b)):(g=!0,r=m(a.substring(0,f)))),c=f+1;else{g&&(c=m(a.substr(c)).split(":"),this._addPipe(e,c,b));break}e.length&&(this.pipes=e);return r},_checkCode:function(){var a=this._getValue(),b=!1,c=this.curr;if(p(c)&&p(a))return b=d(c,a),b.changes?(this.curr=a.slice(),u.trigger(this.id,b,a,c),!0):!1;a!==c&&(this.curr=a,u.trigger(this.id,
a,c),b=!0);return b},_checkObject:function(){var a=this.obj,c=this.curr;return b(c,a)?!1:(this.curr=f(a),u.trigger(this.id,a,c),!0)},_checkArray:function(){var a=this.curr,b=this.obj,c=d(a,b);return c.changes?(this.curr=b.slice(),u.trigger(this.id,c,b,a),!0):!1},_getValue:function(){var a;switch(this.type){case "attr":a=this.obj[this.code];break;case "expr":try{a=this.getterFn(this.obj)}catch(b){if(window.MetaphorJs)MetaphorJs.asyncError(b);else throw b;}"undefined"==typeof a&&(a="");break;case "object":a=
f(this.obj);break;case "array":a=this.obj}p(a)&&(a=a.slice());var c=this.pipes;if(c){var d,e,g,t=c.length,x=this.obj,r,m;for(d=0;d<t;d++){g=c[d][1];e=[];r=-1;for(m=g.length;++r<m;e.push(F(g[r],x)));e.unshift(a);e.push(x);a=c[d][0].apply(null,e)}}return a},addListener:function(a,b,c){return u.on(this.id,a,b,c)},removeListener:function(a,b){return u.un(this.id,a,b)},getValue:function(){return this._getValue()},setValue:function(a){var b=this.type;if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||
(this.setterFn=E(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";},check:function(){switch(this.type){case "expr":case "attr":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&
(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,b){var c=this.id;u.un(c,a,b);return u.hasListener(c)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b,c,d,e,f;this.itv&&this.clearInterval();if(a)for(b=-1,c=a.length;++b<c;)for(f=a[b][2],d=-1,e=f.length;++d<e;)f[d].unsubscribeAndDestroy(this.check,this);this.pipes=this.obj=this.curr=null;u.destroyEvent(this.id);this.obj&&delete this.obj.$$watchers[this.code]}});var r=function(a,b,c,d,e){b=y(a,m(b));return a?(a.$$watchers||
(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof q&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof q)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].addListener(c,d,{append:[e],allowDupes:!0}):a.$$watchers[b]=new q(a,b,c,d,e),a.$$watchers[b]):new q(a,b,c,d,e)},y=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==
b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},A=Function,C=function(a){var b=a.stack||Error().stack;"undefined"!=typeof console&&console.log&&(console.log(a),b&&console.log(b))};"undefined"!=typeof window&&(window.watchableError=C);"undefined"!=typeof global&&(global.watchableError=C);var H={},B=function(a){return H[a]?H[a]:H[a]=new A("____","".concat("try {","return ",a.replace(k,"$1____.$3"),";} catch (e) { watchableError(e); }"))},J={},E=function(a){if(!J[a]){var b=a.replace(k,
"$1____.$3");return J[a]=new A("____","$$$$","".concat("try {",b," = $$$$",";} catch (e) { watchableError(e); }"))}return J[a]},I={},F=function(a,b){return B(a)(b)};q.create=r;q.unsubscribeAndDestroy=function(a,b,c,d){b=m(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,d)&&delete a[b]};q.normalizeExpr=y;q.prepareCode=function(a){return a.replace(k,"$1____.$3")};q.createGetter=B;q.createSetter=E;q.createFunc=function(a){return I[a]?I[a]:I[a]=new A("____","".concat("try {",a.replace(k,"$1____.$3"),
";} catch (e) { watchableError(e); }"))};q.eval=F;window.MetaphorJs&&MetaphorJs.r&&MetaphorJs.r("MetaphorJs.lib.Watchable",q);"undefined"!=typeof global&&(module.exports=q)})();
(function(){var h,n;if("undefined"!=typeof global)try{h=require("metaphorjs-promise"),n=require("metaphorjs-observable")}catch(k){h=global.MetaphorJs.lib.Promise,n=global.MetaphorJs.lib.Observable}else h=window.MetaphorJs.lib.Promise,n=window.MetaphorJs.lib.Observable;var g=MetaphorJs.extend,l=MetaphorJs.bind,s=MetaphorJs.addListener,p=MetaphorJs.trim,c=MetaphorJs.isArray,a;"undefined"!=typeof window&&(a=document.querySelectorAll||function(a){var b=document,c=b.documentElement.firstChild,d=b.createElement("STYLE");
c.appendChild(d);b.__qsaels=[];d.sheet?d.sheet.insertRule(a+"{x:expression(document.__qsaels.push(this))}",0):d.styleSheet&&(d.styleSheet.cssText=a+"{x:expression(document.__qsaels.push(this))}");window.scrollBy(0,0);return b.__qsaels});var e=/#.*$/,f=/([?&])_=[^&]*/,b=/\?/,d=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,m=/^(?:GET|HEAD)$/i,u=0,w=function(a,b){setTimeout(function(){a.call(b)},0)},q=function(a,b){var c,d;if(!a||"string"!==typeof a)return null;try{d=new DOMParser,c=d.parseFromString(a,
b||"text/xml")}catch(e){c=void 0}if(!c||c.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return c},r=function(a,b,d){var e,f;if("string"==typeof a&&d)b.push(encodeURIComponent(d)+"="+encodeURIComponent(a));else if(c(a)&&d)for(e=0,f=a.length;e<f;e++)r(a[e],b,d+"["+e+"]");else if("object"==typeof a)for(e in a)a.hasOwnProperty(e)&&r(a[e],b,d?d+"["+e+"]":e)},y=function(a,c){a.replace(e,"");if(!1===c.cache){var d=(new Date).getTime();return f.test(a)?a.replace(f,"$1_="+d):a+(b.test(a)?
"&":"?")+"_="+d}!c.data||window.FormData&&c.data instanceof window.FormData||("string"!=typeof c.data?(d=[],r(c.data,d,null),d=d.join("&").replace(/%20/g,"+")):d=c.data,c.data=d,m.test(c.method)&&(a+=(b.test(a)?"&":"?")+c.data,c.data=null));return a},A={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},C={url:null,data:null,method:"GET",headers:null,username:null,password:null,
cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},H={},B=new n,J=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},E=function(a,b,d){var e,f;if("object"!=
typeof a&&"function"!=typeof a&&d)e=document.createElement("input"),e.setAttribute("type","hidden"),e.setAttribute("name",d),e.setAttribute("value",a),b.appendChild(e);else if(c(a)&&d)for(e=0,f=a.length;e<f;e++)E(a[e],b,d+"["+e+"]");else if("object"==typeof a)for(e in a)a.hasOwnProperty(e)&&E(a[e],b,d?d+"["+e+"]":e)},I=function(a){for(var b,c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],b.hasAttribute("name"))if(c="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT",
"FILE"===c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},F=function(){},L=function(b,c,d){var e=c?c.dataType:null;c=c?c.selector:null;if("string"!=typeof b)return b;d=d||"";if("xml"===e||!e&&0<=d.indexOf("xml"))return b=q(p(b)),c?a.call(b,c):b;if("html"===e)return b=q(b,"text/html"),c?a.call(b,c):b;if("fragment"==e){d=document.createDocumentFragment();
e=document.createElement("div");for(e.innerHTML=b;e.firstChild;)d.appendChild(e.firstChild);return d}if("json"===e||!e&&0<=d.indexOf("json"))return b=p(b),JSON.parse(b);("script"===e||!e&&0<=d.indexOf("javascript"))&&J(b);return b+""},G=function(a){var b=d.exec(("undefined"!=typeof window?window.location.href:"").toLowerCase())||[],c=d.exec(a.url.toLowerCase());this._opt=a;a.crossDomain=!(!c||c[1]===b[1]&&c[2]===b[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(b[3]||("http:"===b[1]?"80":"443")));b=new h;
"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||"undefined"!=typeof window&&window.FormData||"iframe"==a.transport||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):I(a.form));a.url=y(a.url,a);c=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new M(a,b,this):new z(a,b,this):new K(a,b,this);this._deferred=b;this._transport=c;b.done(function(a){B.trigger("success",
a)});b.fail(function(a){B.trigger("error",a)});b.always(function(){B.trigger("end")});B.trigger("start");a.timeout&&(this._timeout=setTimeout(l(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===B.trigger("beforeSend",a,c)&&(this._promise=h.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,c)&&(this._promise=h.reject());this._promise||(w(c.send,c),a=b.promise(),a.abort=l(this.abort,this),b.always(this.destroy,this),this._promise=a)};g(G.prototype,{_jsonpName:null,_transport:null,
_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);E(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,c=a.jsonpParam||
"callback",d=a.jsonpCallback||"jsonp_"+ ++u;a.url+=(b.test(a.url)?"&":"?")+c+"="+d;this._jsonpName=d;"undefined"!=typeof window&&(window[d]=l(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=l(this.jsonpCallback,this));return d},jsonpCallback:function(a){try{this._deferred.resolve(this.processResponseData(a))}catch(b){this._deferred.reject(b)}},processResponseData:function(a,b){var c=this._opt;a=L(a,c,b);B.hasListener("processResponse")&&(a=B.trigger("processResponse",a,this._deferred));
c.processResponse&&(a=c.processResponse.call(c.callbackScope,a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred;if(this._opt.jsonp)if(a){try{J(a)}catch(d){c.reject(d)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else try{c.resolve(this.processResponseData(a,b))}catch(e){c.reject(e)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);
this._transport.destroy();delete this._transport;delete this._opt;delete this._deferred;delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},!0);var v=function(a,b){b=b||{};a&&"string"!=typeof a?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),!b.url))throw"Must provide url";g(b,H,!1);g(b,C,!1);b.method=b.method?b.method.toUpperCase():
b.form?b.form.getAttribute("method").toUpperCase()||"GET":"GET";return(new G(b)).promise()};v.setup=function(a){g(H,a,!0)};v.on=function(){B.on.apply(B,arguments)};v.un=function(){B.un.apply(B,arguments)};v.get=function(a,b){b=b||{};b.method="GET";return v(a,b)};v.post=function(a,b){b=b||{};b.method="POST";return v(a,b)};v.load=function(a,b,c){c=c||{};"string"!=typeof b&&(c=b);c.dataType="fragment";return v(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};
v.loadScript=function(a){return v(a,{transport:"script"})};v.submit=function(a,b){b=b||{};b.form=a;return v(null,b)};var z=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&s(d,"progress",l(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&s(d.upload,"progress",l(a.uploadProgress,a.callbackScope));
try{var e;if(a.xhrFields)for(e in a.xhrFields)d[e]=a.xhrFields[e];a.data&&a.contentType&&d.setRequestHeader("Content-Type",a.contentType);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Accept",a.dataType&&A[a.dataType]?A[a.dataType]+", */*; q=0.01":A._default);for(e in a.headers)d.setRequestHeader(e,a.headers[e])}catch(f){}d.onreadystatechange=l(this.onReadyStateChange,this)};g(z.prototype,{_xhr:null,_deferred:null,_ajax:null,onReadyStateChange:function(){var a=this._xhr,
b=this._deferred;if(0===a.readyState)a.onreadystatechange=F,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=F;var c;a:{try{c=!a.status&&"undefined"!=typeof location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse("string"==typeof a.responseText?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=F;this._xhr.abort()},send:function(){var a=
this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}},!0);var K=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};g(K.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);
s(a,"load",l(this.onLoad,this));s(a,"error",l(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);var M=function(a,b,c){this._opt=a;this._ajax=
c;this._deferred=b};g(M.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+ ++u,c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);s(a,"load",l(this.onLoad,this));s(a,"error",l(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},onLoad:function(){var a=this._el;this._opt&&
!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);"undefined"!=typeof global?module.exports=v:window.MetaphorJs?MetaphorJs.ajax=v:window.MetaphorJs=
{ajax:v}})();
(function(){var h=[],n=!1,k=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/,g=function(a,c,b){a.attachEvent?a.attachEvent("on"+c,b):a.addEventListener(c,b,!1)},l=!!history.pushState,s="onhashchange"in window,p=function(a){var c=location.protocol+"//"+location.hostname;location.port&&(c+=":"+location.port);a=a.replace(c,"");l||(a=encodeURIComponent(a));return a},c=function(){var a;l?a=location.pathname+location.search:(a=location.hash.substr(1))?("!"==
a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a)):a=location.pathname+location.search;return a},a=function(){var a=c();if(h.length)for(var f=-1,b=h.length;++f<b;h[f].call(null,a));window.MetaphorJs&&MetaphorJs.triggerAsync("locationchange",a)};g(window,"load",function(){n=!0});history.initPushState=function(){if(l)history.origPushState=history.pushState,history.origReplaceState=history.replaceState,g(window,"popstate",a),history.pushState=function(b,c,d){history.origPushState(b,c,p(d));a()},
history.replaceState=function(b,c,d){history.origReplaceState(b,c,p(d));a()};else if(s)history.replaceState=history.pushState=function(a,b,c){a=p(c);location.hash=a?"!"+a:""},g(window,"hashchange",a);else{var c=null,f=!1;window.onIframeHistoryChange=function(b){f||(location.hash=b?"!"+b:"",a())};var b=function(a){var b=c.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');
b.close()};history.pushState=function(a,c,d){b(p(d))};history.replaceState=function(a,b,d){a=p(d);c.contentWindow.hashValue=a};var d=function(){c=document.createElement("iframe");c.src="about:blank";c.style.display="none";document.body.appendChild(c);f=!0;b(p(location.hash.substr(1)));f=!1};n?d():g(window,"load",d)}g(document.documentElement,"click",function(a){a=a||window.event;for(var b=a.target||a.srcElement,c;b&&"a"!=b.nodeName.toLowerCase();)b=b.parentNode;if(b){c=b.getAttribute("href");var d;
if(d=c&&"#"!=c.substr(0,1))c=c.match(k),d=c[1]&&location.protocol!=c[1]||c[2]&&location.hostname!=c[2]?!1:c[2]||c[3]?location.port!=c[3]?!1:!0:!0;if(d&&!b.getAttribute("target"))return history.pushState(null,null,b.getAttribute("href")),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1}});history.initPushState=function(){}};window.MetaphorJs?(MetaphorJs.pushUrl=function(a){history.pushState(null,null,a)},MetaphorJs.replaceUrl=function(a){history.replaceState(null,null,
a)},MetaphorJs.currentUrl=function(){return c()}):history.onchange=function(a){h.push(a)}})();
(function(){var h=MetaphorJs.lib.Observable,n=MetaphorJs.extend;MetaphorJs.d("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(k){k=k||{};this._observable=new h;n(this,this._observable.getApi());if(k.callback){var g=k.callback,l=g.scope||this;delete g.scope;for(var s in g)if(g.hasOwnProperty(s))this.on(s,g[s],l);delete k.callback}n(this,k,!0)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",
this);this._observable.destroy();delete this._observable}},onDestroy:MetaphorJs.emptyFn})})();
(function(){var h={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},n=["Moz","Webkit","ms","O","Khtml"],k="animationDelay",g="animationDuration",l="transitionDelay",s="transitionDuration",p=0,c=function(){var a=document.createElement("div"),b=!1,c,d,e;if(void 0!==a.style.animationName)b=!0;else for(d=0,e=n.length;d<e;d++)if(c=n[d],void 0!==a.style[c+"AnimationName"]){b=!0;k=c+"AnimationDelay";g=c+"AnimationDuration";l=c+"TransitionDelay";s=c+"TransitionDuration";
break}return b}(),a=window.requestAnimationFrame?window.requestAnimationFrame:function(a){window.setTimeout(a,0)},e=MetaphorJs.g,f=MetaphorJs.lib.Promise,b=MetaphorJs.data,d=MetaphorJs.isThenable,m=function(b,c,d){var e=function(){(new Date).getTime()-c>=d?b():a(e)};a(e)},u=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},w=function(a,b,c){var d,e,f=b.length;for(d=0;d<f;d++)e=u(b[d])+u(c[d]),a=Math.max(e,a);return a},q=function C(c,e,f,h,p,n,u){var G=function(){var a=
b(c,"mjsAnimationQueue");return a&&a.length&&a[0].id==u?!1:(p.reject(c),!0)},v=function(){if(!G()){var a=f;f++;if(f==e.length){p.resolve(c);b(c,"mjsAnimationQueue").shift();var d=b(c,"mjsAnimationQueue");d.length?(d=d[0],q(d.el,d.stages,0,d.start,d.deferred,!1,d.id)):b(c,"mjsAnimationQueue",null)}else b(c,"mjsAnimationQueue")[0].position=f,C(c,e,f,null,p);y(c,e[a]);y(c,e[a]+"-active")}},z=function(){if(!G()){r(c,e[f]+"-active");var a,b=window.getComputedStyle?window.getComputedStyle(c):c.style;a=
0;var d=(b[g]||"").split(","),z=(b[k]||"").split(","),K=(b[s]||"").split(","),b=(b[l]||"").split(",");a=Math.max(a,w(a,d,z));(a=Math.max(a,w(a,K,b)))?m(v,(new Date).getTime(),a):v()}},K=function(){if(!G()){r(c,e[f]);var b;h&&(b=h(c),h=null);d(b)?b.done(z):a(z)}};n?a(K):K()},r=MetaphorJs.addClass,y=MetaphorJs.removeClass;MetaphorJs.stopAnimation=function(a){var c=b(a,"mjsAnimationQueue"),d;c&&c.length&&(d=c[0])&&d.stages&&(c=d.position,d=d.stages,y(a,d[c]),y(a,d[c]+"-active"));b(a,"mjsAnimationQueue",
null)};MetaphorJs.animate=function(a,g,r){var l=a.getAttribute("mjs-animate"),m=a.getAttribute("mjs-animate-js"),y=new f,k=b(a,"mjsAnimationQueue")||[],s=++p,n,v;g&&"string"==typeof g&&(g=h[g]);"string"==typeof l&&l&&"["==l.substr(0,1)&&(g=(new Function("","return "+l))(),l=null);k.push({el:a,stages:g,start:r,deferred:y,position:0,id:s});b(a,"mjsAnimationQueue",k);void 0!=l&&c&&g?1==k.length&&q(a,g,0,r,y,!0,s):(n=m||l)&&(v=e("animate."+n,!0))?v(a,r,y):r?(g=r(a),d(g)?g.done(function(){y.resolve(a)}):
y.resolve(a)):y.resolve(a);return y.promise()}})();
(function(){var h=MetaphorJs.lib.Observable,n=MetaphorJs.lib.Watchable,k=MetaphorJs.extend,g;g=MetaphorJs.d("MetaphorJs.view.Scope",{$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$checking:!1,$$destroyed:!1,initialize:function(g){this.$$observable=new h;k(this,g,!0);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)},$new:function(){return new g({$parent:this,
$root:this.$root,$app:this.$app})},$on:function(g,h,k){return this.$$observable.on(g,h,k)},$un:function(g,h,k){return this.$$observable.un(g,h,k)},$watch:function(g,h,k){n.create(this,g,h,k,null)},$unwatch:function(g,h,k){n.unsubscribeAndDestroy(this,g,h,k)},$get:function(g){for(var h=this;h;){if(void 0!=h[g])return h[g];h=h.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$check:function(){var g;this.$$checking||(this.$$checking=!0,this.$$watchers&&
(g=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",g))},$destroy:function(){this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;delete this.$app;delete this.$root;delete this.$parent;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);this.$$destroyed=!0}})})();
(function(){var h=navigator.userAgent.toLowerCase(),n=parseInt((/msie (\d+)/.exec(h)||[])[1],10),k=parseInt((/android (\d+)/.exec(h)||[])[1],10),g={};isNaN(n)&&(n=parseInt((/trident\/.*; rv:(\d+)/.exec(h)||[])[1],10));window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.browser={android:k,hasEvent:function(h){if("input"==h&&9==n)return!1;if(void 0===g[h]){var k=document.createElement("div");g[h]="on"+h in k}return g[h]}}})();
(function(){var h=MetaphorJs.nextUid,n=MetaphorJs.view.Scope,k=MetaphorJs.lib.Watchable,g=MetaphorJs.lib.Observable,l=MetaphorJs.isThenable,s=MetaphorJs.toArray,p=MetaphorJs.getAttributeHandlers,c=null,a=MetaphorJs.g,e=k.create,f=k.unsubscribeAndDestroy,b,d="string"==typeof document.createTextNode("").textContent?"textContent":"nodeValue",m=function(a,b,c,d,e,f,g){var h=[];if(a&&!0!==a){if(a.nodeType){g.countdown+=1;w(a,c,d,e,f,g);return}h=s(a)}h.length||(h=s(b.childNodes));b=h.length;g.countdown+=
b;for(a=-1;++a<b;w(h[a],c,d,e,f,g));},u=/^(script|template|mjs-template|style)$/i,w=function(a,b,c,d,e,f){var g;if(!a.nodeName.match(u)){try{g=b.call(c,a,d)}catch(h){MetaphorJs.error(h)}if(!1!==g){if(l(g)){g.done(function(g){!1!==g&&m(g,a,b,c,d,e,f);0==--f.countdown&&e&&e.call(c)});return}m(g,a,b,c,d,e,f)}}0==--f.countdown&&e&&e.call(c)},q=new g;b=MetaphorJs.d("MetaphorJs.view.Renderer",{id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,initialize:function(a,b,c){this.id=
h();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof n&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",this.destroy,this)},on:function(a,b,c){return q.on(a+"-"+this.id,b,c)},un:function(a,b,c){return q.un(a+"-"+this.id,b,c)},createChild:function(a){return new b(a,this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,c,d){var e=a.$isolateScope?new n({$app:b.$app}):a.$breakScope?b.$new():b;b=b.$app;var f={$scope:e,$node:c,$attrValue:d,$renderer:this};c=[e,
c,d,this];return a.__isMetaphorClass?(c=b.inject(a,null,!0,f,c),a.$stopRenderer?!1:l(c)?c.then(function(a){return a.$returnToRenderer}):c.$returnToRenderer):b.inject(a,null,!1,f,c)},processNode:function(b,e){var f=b.nodeType,g=this.texts,h=this.scope,k;if(3==f)h={watchers:[],node:b,text:"",inx:k=g.length},this.processText(h,b[d]),0<h.watchers.length&&(g.push(h),e&&this.renderText(k));else if(1==f){c||(c=p());var l=b.attributes,q,m,n,f="tag."+b.tagName.toLowerCase();if(q=a(f,!0))if((n=this.runHandler(q,
h,b))||!1===n)return n;q=0;for(m=c.length;q<m;q++)if(k=c[q].name,null!==(n=b.getAttribute(k))&&(n=this.runHandler(c[q].handler,h,b,n),b.removeAttribute(k),n||!1===n))return n;q=0;for(m=l.length;q<m;q++)a(f,!0)||(h={watchers:[],node:b,attr:l[q].name,text:"",inx:k=g.length},this.processText(h,l[q].value),0<h.watchers.length&&(g.push(h),e&&this.renderText(k)))}return!0},process:function(){w(this.el,this.processNode,this,!1,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){this.render();
q.trigger("rendered-"+this.id,this)},processText:function(a,b){for(var c=0,d=b.length,e,f,g=[];c<d;)if(-1!=(e=b.indexOf("{{",c))&&-1!=(f=b.indexOf("}}",e+2)))g.push(b.substring(c,e)),g.push(this.watcherMatch(a,b.substring(e+2,f))),c=f+2;else{c!==d&&g.push(b.substring(c));break}return a.text=g.join("")},watcherMatch:function(a,b){var c=a.watchers;c.push({watcher:e(this.scope,b,this.onDataChange,this,a.inx)});return"---"+(c.length-1)+"---"},onDataChange:function(a,b,c){this.renderText(c)},render:function(){var a=
this.texts.length,b;for(b=0;b<a;b++)this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.text,c=a.watchers,e=c.length,f=a.attr,g,h;for(g=0;g<e;g++)h=c[g].watcher.getLastResult(),b=b.replace("---"+g+"---",h);f?(a.node.setAttribute(f,b),"value"==f&&(a.node.value=b),"class"==f&&(a.node.className=b)):a.node[d]=b},destroy:function(){var a=this.texts,b,c,d,e,g;if(!this.destroyed){this.destroyed=!0;c=0;for(d=a.length;c<d;c++)for(b=a[c].watchers,e=0,g=b.length;e<g;e++)f(this.scope,b[e].watcher.code,
this.onDataChange,this);this.parent&&this.parent.un("destroy",this.destroy,this);q.trigger("destroy-"+this.id);this.parent=this.scope=this.el=this.texts=null}}},{eachNode:w});MetaphorJs.onReady(function(){var a=MetaphorJs.app,b;if(document.querySelectorAll)for(var c=document.querySelectorAll("[mjs-app]"),d=-1,e=c.length;++d<e;a(c[d]).run());else w(document.documentElement,function(c){b=c.getAttribute("mjs-app");if(null!==b)return a(c,b),!1})})})();
(function(){var h=window.MetaphorJs,n=h.data,k=h.toFragment,g=h.lib.Watchable.create,l=h.view.Renderer,s=h.clone,p=h.view.Scope,c=h.animate,a=h.lib.Promise,e=h.extend,f=h.nextUid,b=h.trim,d=new h.lib.Observable,m={},u=function(a){if(!m[a]){var b=document.getElementById(a),c;b&&(c=b.tagName.toLowerCase(),"script"==c?(c=document.createElement("div"),c.innerHTML=b.innerHTML,m[a]=k(c.childNodes)):m[a]="content"in b?b.content:k(b.childNodes))}return m[a]},w=function(a){return m[a]?m[a]:m[a]=MetaphorJs.ajax(a,
{dataType:"fragment"}).then(function(b){return m[a]=b})};h.define("MetaphorJs.view.Template",{_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,initialize:function(a){e(this,a,!0);this.id=f();this.tpl&&(this.tpl=b(this.tpl));this.url&&(this.url=b(this.url));a=this.node;var c=this.tpl||this.url;a.removeAttribute("mjs-include");if(c){if(a.firstChild&&n(a,"mjs-transclude",
k(a.childNodes)),"."!=c.substr(0,1)||this.replace||(this.ownRenderer=!0,this._watcher=g(this.scope,c,this.onChange,this)),this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof p&&this.scope.$on("destroy",this.onScopeDestroy,
this)},doRender:function(){this._renderer||(this._renderer=new l(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){d.trigger("rendered-"+this.id,this)},on:function(a,b,c){return d.on(a+"-"+this.id,b,c)},un:function(a,b,c){return d.un(a+"-"+this.id,b,c)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?this.applyTemplate:this.doRender,
this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var b=this,c=b.url,d=b._watcher?b._watcher.getLastResult():b.tpl||c,e=new a;(new a(function(a){c?a(u(d)||w(c)):a(u(d)||k(d))})).done(function(a){b._fragment=a;e.resolve(!b.ownRenderer)}).fail(e.reject,e);return e},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=this.node;a.firstChild;)a.removeChild(a.firstChild);
this.replace?a.parentNode.replaceChild(s(this._fragment),a):a.appendChild(s(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var b=this.node,d=new a;this._initial?(this.doApplyTemplate(),d.resolve()):(c(b,"leave").done(this.doApplyTemplate,this).done(d.resolve,d),c(b,"enter"));this._initial=!1;return d},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();delete this._renderer},onScopeDestroy:function(){this.destroy();delete this._renderer},destroy:function(){delete this.node;
delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),delete this._watcher);delete this.tpl}},{getTemplate:u,loadTemplate:w})})();
(function(){var h=MetaphorJs.extend,n=MetaphorJs.nextUid,k=MetaphorJs.emptyFn,g=MetaphorJs.ns.get,l=MetaphorJs.lib.Promise,s=MetaphorJs.view.Template;MetaphorJs.define("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,scope:null,template:null,templateUrl:null,tag:null,initialize:function(g){this.supr(g);g.as&&(this.scope[g.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);
this.id=this.id||"cmp-"+n();this.initComponent.apply(this,arguments);this.scope.$app.registerCmp(this);this.node||this._createNode();var c=this.template,a=this.templateUrl;c&&c instanceof s||(this.template=c=new s({scope:this.scope,node:this.node,deferRendering:!0,ownRenderer:!0,tpl:c,url:a}));if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(c.initPromise?c.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=
document.createElement(this.tag||"div")},_initElement:function(){var g=this.node;g.setAttribute("id",this.id);g.setAttribute("cmp-id",this.id);this.hidden&&(g.style.display="none")},render:function(){this.rendered||(this.renderTo&&this.renderTo.appendChild(this.node),this.hidden=!MetaphorJs.isVisible(this.node),this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},onRenderingFinished:function(){this.rendered=!0;this.afterRender();this.trigger("afterrender",
this)},show:function(){this.hidden&&!1!==this.trigger("beforeshow",this)&&(this.node.style.display="block",this.hidden=!1,this.onShow(),this.trigger("show",this))},hide:function(){this.hidden||!1===this.trigger("beforehide",this)||(this.node.style.display="none",this.hidden=!0,this.onHide(),this.trigger("hide",this))},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:k,
afterRender:k,onShow:k,onHide:k,onParentRendererDestroy:function(){this.destroy()},onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?this.node.parentNode&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.scope.$destroy();delete this.scope;delete this.node;this.supr()}});MetaphorJs.resolveComponent=function(k,c,a,e,f){var b="string"==typeof k?g(k):k,d,m=[];k=b.template||
c.template||null;var n=b.templateUrl||c.templateUrl||null,w=a.$app,q={$node:e,$scope:a,$app:w};f=f||[];if(b.resolve)for(d in b.resolve)(function(f){var g=new l,k;m.push(g.done(function(a){c[f]=a}));k=b.resolve[d];"function"==typeof k?g.resolve(k(a,e)):g.resolve(w.inject(k,null,!1,h({},q,c)))})(d);if(k||n)c.template=new s({scope:a,node:e,deferRendering:!0,ownRenderer:!0,tpl:k,url:n}),m.push(c.template.initPromise);var r=m.length;r&&(e.style.visibility="hidden");f.unshift(c);return l.all(m).then(function(){r&&
(e.style.visibility="visible");c.$config=c;return w.inject(b,null,!0,c,f)})}})();
(function(){var h=MetaphorJs.data,n=MetaphorJs.currentUrl,k=MetaphorJs.toFragment,g=MetaphorJs.animate,l=MetaphorJs.lib.Scope,s=MetaphorJs.extend,p=MetaphorJs.stopAnimation,c=MetaphorJs.resolveComponent;MetaphorJs.define("MetaphorJs.cmp.View",{route:null,node:null,scope:null,currentComponent:null,initialize:function(a){history.initPushState();s(this,a,!0);MetaphorJs.on("locationchange",this.onLocationChange,this);a=this.node;a.firstChild&&h(a,"mjs-transclude",k(a.childNodes));a.removeAttribute("mjs-view");
this.onLocationChange()},onLocationChange:function(){var a=n(),c=this.route,f,b,d,g,h;b=0;for(d=c.length;b<d;b++){g=c[b];if(h=a.match(g.reg)){this.changeComponent(g,h);return}g["default"]&&!f&&(f=g)}f?this.changeComponent(f,[]):this.clearComponent()},changeComponent:function(a,c){p(this.node);this.clearComponent();this.setComponent(a,c)},clearComponent:function(){var a=this,c=a.node;a.currentComponent&&g(c,"leave").done(function(){a.currentComponent.destroy();for(a.currentComponent=null;c.firstChild;)c.removeChild(c.firstChild)})},
setComponent:function(a,e){var f=this,b=f.node,d=a.params;g(b,"enter",function(){var g=e||[],h={destroyEl:!1,node:b,scope:a.isolateScope?new l({$app:f.scope.$app}):f.scope.$new()},k,n;a.as&&(h.as=a.as);a.template&&(h.template=a.template);g.shift();if(d)for(k=-1,n=d.length;++k<n;h[d[k]]=g[k]);return c(a.cmp||"MetaphorJs.cmp.Component",h,h.scope,b,null,g).done(function(a){f.currentComponent=a})})}})})();
(function(){var h=MetaphorJs.view.Scope,n=MetaphorJs.trim,k=MetaphorJs.define,g=MetaphorJs.ns.get,l=MetaphorJs.lib.Watchable,s=MetaphorJs.view.Renderer,p=MetaphorJs.data,c=MetaphorJs.toArray,a=MetaphorJs.toFragment,e=MetaphorJs.addListener,f=MetaphorJs.normalizeEvent,b=MetaphorJs.registerAttributeHandler,d=MetaphorJs.registerTagHandler,m=MetaphorJs.async,u=l.create,w=l.createGetter,q=MetaphorJs.animate,r=MetaphorJs.addClass,y=MetaphorJs.removeClass,A=MetaphorJs.hasClass,C=MetaphorJs.stopAnimation,
H=MetaphorJs.isArray,B=MetaphorJs.view.Template,J=MetaphorJs.lib.Input,E,I=function(a,b){for(var c;a;){c=p(a,b);if(void 0!=c)return c;a=a.parentNode}};MetaphorJs.d("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,initialize:function(a,b,c){c=n(c);this.node=b;this.expr=c;this.scope=a;this.watcher=u(a,c);this.watcher.addListener(this.onChange,this);this.onChange();a instanceof h&&a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){delete this.node;delete this.scope;
this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)},onChange:function(){}});b("mjs-bind",1E3,k(null,"MetaphorJs.view.AttributeHandler",{isInput:!1,initialize:function(a,b,c){var d=b.tagName.toLowerCase();this.isInput="input"==d||"textarea"==d;this.supr(a,b,c)},onChange:function(){var a=this.watcher.getLastResult();this.isInput?this.node.value=a:this.node.textContent=a}}));b("mjs-bind-html",1E3,k(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.node.innerHTML=
this.watcher.getLastResult()}}));b("mjs-model",1E3,k(null,"MetaphorJs.view.AttributeHandler",{inProg:!1,input:null,initialize:function(a,b,c){this.node=b;this.input=new J(b,this.onInputChange,this);this.supr(a,b,c)},onInputChange:function(a){var b=this.scope;this.watcher.setValue(a);this.inProg=!0;b instanceof h?b.$root.$check():this.watcher.checkAll();this.inProg=!1},onScopeDestroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var a=this.watcher.getLastResult();
this.inProg||this.input.setValue(a)}}));b("mjs-show",500,k(null,"MetaphorJs.view.AttributeHandler",{initial:!0,initialize:function(a,b,c){this.supr(a,b,c)},runAnimation:function(a){var b=this.node.style,c=function(){b.display=a?"":"none"};this.initial?c():q(this.node,a?"show":"hide",function(){a&&(b.display="")}).done(c)},onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));b("mjs-hide",500,k(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();
this.runAnimation(!a);this.initial=!1}}));b("mjs-if",500,k(null,"MetaphorJs.view.AttributeHandler",{parentEl:null,prevEl:null,el:null,initial:!0,initialize:function(a,b,c){this.parentEl=b.parentNode;this.prevEl=b.previousSibling;this.supr(a,b,c)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,d=a.node,e=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},f=
function(){c.removeChild(d)};b?d.parentNode||(a.initial?e():q(d,"enter",e)):d.parentNode&&(a.initial?f():q(d,"leave").done(f));a.initial=!1}}));b("mjs-each",100,k(null,"MetaphorJs.view.AttributeHandler",{model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;
this.node=b;this.scope=a;try{this.watcher=u(a,this.model,this.onChange,this)}catch(d){MetaphorJs.error(d)}this.parentEl.removeChild(b);this.render(this.watcher.getValue())},onScopeDestroy:function(){var a=this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.supr()},doUpdate:function(a,b){for(var c=this.renderers,d=b,e=c.length,f=e-1,g=!(d%2),h,k;d<e;d++)h=c[d],k=h.scope,k.$index=
d,k.$first=0===d,k.$last=d===f,k.$even=g,k.$odd=!g,g=!g,h.renderer?k.$check():(h.renderer=new s(h.el,h.scope),h.renderer.process())},render:function(a){var b=this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,f=document.createDocumentFragment(),g,h,k;h=0;for(k=a.length;h<k;h++)g=c.cloneNode(!0),f.appendChild(g),b.push(this.createItem(g,a,h));d.insertBefore(f,e);this.doUpdate(a,0)},createItem:function(a,b,c){var d=this.itemName,e=this.scope.$new();e[d]=b[c];return{el:a,scope:e}},onChange:function(a){var b=
this,c=b.renderers;a=a.prescription;var d=b.tpl,e=0,f=b.parentEl,g=b.watcher.getValue(),k=null,l,m,n,p;m=0;for(n=a.length;m<n;m++)p=a[m],"-"==p?(c[e].scope.$index=e,e++):(null===k&&(k=0<m?m-1:0),"I"!=p&&c[e]&&(l=c[e],l.scope instanceof h&&l.scope.$destroy(),l.renderer.destroy(),q(l.el,"leave").done(function(a){a.parentNode&&a.parentNode.removeChild(a)})),"D"==p?c.splice(e,1):(l=d.cloneNode(!0),q(l,"enter",function(a){return function(d){0<a?f.insertBefore(d,c[a-1].el.nextSibling):b.prevEl?f.insertBefore(d,
b.prevEl.nextSibling):f.appendChild(d)}}(e)),"R"==p?c[m]=b.createItem(l,g,e):"I"==p&&(m<c.length?c.splice(m,0,b.createItem(l,g,e)):c.push(b.createItem(l,g,e))),e++));b.doUpdate(g,k)},parseExpr:function(a){a=a.split(" ");var b,c,d,e,f;b=0;for(c=a.length;b<c;b++)if(f=a[b],""!=f&&"in"!=f)if(e){d=a.slice(b).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"}},{$stopRenderer:!0}));b("mjs-each-in-store",100,k(null,"attr.mjs-each",{store:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each-in-store");
b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.store=a=w(this.model)(a);this.parentEl.removeChild(b);this.initWatcher();this.render(this.watcher.getValue());m(this.bindStore,this,[a,"on"])},onScopeDestroy:function(){this.bindStore(this.store,"un");delete this.store;this.supr()},initWatcher:function(){this.watcher=u(this.store,".items",null);this.watcher.addListener(this.onChange,
this)},resetWatcher:function(){this.watcher.setValue(this.store.items)},bindStore:function(a,b){a[b]("load",this.onStoreUpdate,this);a[b]("update",this.onStoreUpdate,this);a[b]("add",this.onStoreUpdate,this);a[b]("remove",this.onStoreUpdate,this);a[b]("replace",this.onStoreUpdate,this);a[b]("filter",this.onStoreFilter,this);a[b]("clearfilter",this.onStoreFilter,this);a[b]("clear",this.onStoreClear,this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},onStoreFilter:function(){this.resetWatcher();
this.onStoreUpdate()},onStoreClear:function(){this.resetWatcher();this.onStoreUpdate()},onStoreDestroy:function(){this.onStoreClear();this.watcher.unsubscribeAndDestroy(this.onChange,this);delete this.watcher}},{$stopRenderer:!0}));b("mjs-include",900,function(a,b,c,d){a=new B({scope:a,node:b,url:c,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});d("mjs-include",900,function(a,b,c,d){return(new B({scope:a,node:b,tpl:b.getAttribute("src"),parentRenderer:d,replace:!0})).initPromise});b("mjs-transclude",
1E3,function(b,d){var e=I(d,"mjs-transclude");if(e){d.firstChild&&p(d,"mjs-transclude",a(d.childNodes));var f=d.parentNode,g=d.nextSibling,e=MetaphorJs.clone(e),h=c(e.childNodes);f.removeChild(d);f.insertBefore(e,g);return h}});d("mjs-transclude",900,function(b,d){var e=I(d,"mjs-transclude");if(e){d.firstChild&&p(d,"mjs-transclude",a(d.childNodes));var f=d.parentNode,g=d.nextSibling,e=MetaphorJs.clone(e),h=c(e.childNodes);f.removeChild(d);f.insertBefore(e,g);return h}});var F=function(a,b,c,d){if(null!==
c){if(c==A(a,b))return;c=!c}else c=A(a,b);c?d?q(a,[b+"-remove"]).done(function(){y(a,b)}):y(a,b):d?q(a,[b+"-add"]).done(function(){r(a,b)}):r(a,b)};b("mjs-class",1E3,k(null,"MetaphorJs.view.AttributeHandler",{initial:!0,onChange:function(){var a=this.node,b=this.watcher.getLastResult(),c;C(a);if("string"==typeof b)F(a,b,null,!this.initial);else if(H(b)){var d;c=-1;for(d=b.length;++c<d;F(a,b[c],!0,!this.initial));}else for(c in b)F(a,c,b[c]?!0:!1,!this.initial);this.initial=!1}}));var d="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste enter".split(" "),
L,G=l.createFunc,l=0;for(L=d.length;l<L;l++)(function(a){var c=a;"enter"==c&&(c="keyup");b("mjs-"+a,1E3,function(b,d,g){var k=G(g);e(d,c,function(c){c=c||window.event;c=f(c);if("enter"==a&&13!=c.keyCode)return null;b.$event=c;try{k(b)}catch(d){MetaphorJs.error(d)}delete b.$event;b instanceof h?b.$root.$check():b.$$watchers&&b.$$watchers.$checkAll();c.preventDefault();return!1})})})(d[l]);d="selected checked disabled readonly required open".split(" ");l=0;for(L=d.length;l<L;l++)(function(a){b("mjs-"+
a,1E3,k(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.watcher.getLastResult()?this.node.setAttribute(a,!0):this.node.removeAttribute(a)}}))})(d[l]);d=function(a,b,c,d){E||(E=MetaphorJs.resolveComponent);var e,f,g,h,k;b.removeAttribute("mjs-cmp");c=c.split(" ");g=0;for(h=c.length;g<h;g++)k=c[g],""!=k&&"as"!=k&&(e?f=k:e=k);E(e,{scope:a,node:b,as:f,parentRenderer:d},a,b);return!1};d.$breakScope=!0;b("mjs-cmp",200,d);b("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,
b,c){a&&(a[c]=b)}]);b("mjs-view",200,function(a,b,c){b.removeAttribute("mjs-view");var d=g(c);if(d)a.$app.inject(d,null,!0,{$scope:a,$node:b,$app:a.$app},[{scope:a,node:b}]);else throw"View '"+c+"' not found";return!1});b("mjs-init",150,function(a,b,c){b.removeAttribute("mjs-init");G(c)(a)});b("mjs-app",0,function(){return!1})})();
(function(){var h=MetaphorJs.add,n=MetaphorJs.numberFormats,k=MetaphorJs.dateFormats;h("filter.toUpper",function(c){return c.toUpperCase()});h("filter.toLower",function(c){return c.toLowerCase()});h("filter.limitTo",function(c,a){var e=typeof c;if(!MetaphorJs.isArray(c)&&"string"!=e)return c;a=Infinity===Math.abs(Number(a))?Number(a):parseInt(a,10);if("string"==e)return a?0<=a?c.slice(0,a):c.slice(a,c.length):"";var e=[],f,b;a>c.length?a=c.length:a<-c.length&&(a=-c.length);0<a?(f=0,b=a):(f=c.length+
a,b=c.length);for(;f<b;f++)e.push(c[f]);return e});h("filter.ucfirst",function(c){return c.substr(0,1).toUpperCase()+c.substr(1)});var g=MetaphorJs.numberFormats;h("filter.numeral",function(c,a){a=g[a]||a;a=n[a]||a;return numeral(c).format(a)});var l=MetaphorJs.dateFormats;h("filter.moment",function(c,a){a=l[a]||a;a=k[a]||a;return moment(c).format(a)});var s=function(c,a,e){if(""===a||"undefined"==typeof a)return!0;if("undefined"!=typeof c){if("boolean"==typeof c)return c===a;if(e instanceof RegExp)return a.test(""+
c);if("strict"==e)return""+c===""+a;if(!0===e||null===e||"undefined"==typeof e)return-1!=""+c.indexOf(a);if(!1===e)return-1==""+c.indexOf(a)}return!1},p=function(c,a,e){if("object"!=typeof c)return"undefined"==typeof a.$?!0:s(c,a.$,e);var f,b;for(f in a)if("$"==f)for(b in c){if(s(c[b],a.$,e))return!0}else if(s(c[f],a[f],e))return!0;return!1};h("filter.filter",function(c,a,e,f){e&&!f&&(e=null);"object"!=typeof a&&(a={$:a});f=[];var b,d;b=-1;for(d=c.length;++b<d;)p(c[b],a,e)&&f.push(c[b]);return f});
h("filter.sortBy",function(c,a,e,f){e&&!f&&(e="asc");c=c.slice();c.sort(function(b,c){var e=typeof b;return e!=typeof c?0:"object"==e?b[a]>c[a]?1:b[a]<c[a]?-1:0:b>c?1:b<c?-1:0});return"desc"==e?c.reverse():c})})();
