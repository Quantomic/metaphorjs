(function(){"undefined"==typeof window&&(global.window=global);window.document&&!document.querySelectorAll&&(document.querySelectorAll=function(b){var p=document,r=p.documentElement.firstChild,a=p.createElement("STYLE");r.appendChild(a);p.__qsaels=[];a.sheet?a.sheet.insertRule(b+"{x:expression(document.__qsaels.push(this))}",0):a.styleSheet&&(a.styleSheet.cssText=b+"{x:expression(document.__qsaels.push(this))}");window.scrollBy(0,0);return p.__qsaels});var l={}.undefined,m=Function.prototype.bind?
function(b,p){return b.bind(p)}:function(b,p){return function(){b.apply(p,arguments)}},q={},f=Array.prototype.slice,e=function(){var b=!1,p=f.call(arguments),r=p.shift(),a,c;for("boolean"==typeof p[p.length-1]&&(b=p.pop());a=p.shift();)for(c in a)if(a.hasOwnProperty(c))if(r[c]&&"object"==typeof r[c]&&"object"==typeof a[c])e(r[c],a[c],b);else if(!0===b||"undefined"==typeof r[c]||null===r[c])r[c]=a[c];return r},d=["0","0","0"],g=function(){for(var b=d.length,p;b;){b--;p=d[b].charCodeAt(0);if(57==p)return d[b]=
"A",d.join("");if(90==p)d[b]="0";else return d[b]=String.fromCharCode(p+1),d.join("")}d.unshift("0");return d.join("")},k=function(b){var p=document.createDocumentFragment();if(b.nodeType)p.appendChild(b);else for(var r=-1,a=b.length>>>0;++r!==a;p.appendChild(b[0]));return p},h={},a=function(b){return b._mjsId||(b._mjsId=g())},c=[],b=[],n=!1,u=!1,s=function(b,p){return b.priority<p.priority?-1:b.priority>p.priority?1:0},t,v=function(){return String.prototype.trim?function(b){return"string"==typeof b?
b.trim():b}:function(b){return"string"==typeof b?b.replace(/^\s\s*/,"").replace(/\s\s*$/,""):b}}(),A=Array.prototype.indexOf,w=Object.prototype.toString,y=Object.prototype.hasOwnProperty,D=function(b){return b&&"object"==typeof b&&"number"==typeof b.length&&"[object Array]"==w.call(b)||!1},z=function(b){var p,r,a;if(D(b)){a=[];p=0;for(r=b.length;p<r;p++)a.push(z(b[p]));return a}switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0);
default:return null}},C=function(b,p,a){b.attachEvent?b.attachEvent("on"+p,a):b.addEventListener(p,a,!1)},I=function(b,p,a){b.detachEvent?b.detachEvent("on"+p,a):b.removeEventListener(p,a,!1)},E={},J=function(b){return E[b]||(E[b]=new RegExp("(?:^|\\s)"+b+"(?!\\S)",""))},K=function(b,p){return J(p).test(b.className)},L=function(b,p,a){setTimeout(function(){b.apply(p,a||[])},0)},B,x,F=function(b,p,a){if(""===p||"undefined"==typeof p)return!0;if("undefined"!=typeof b){if("boolean"==typeof b)return b===
p;if(a instanceof RegExp)return p.test(""+b);if("strict"==a)return""+b===""+p;if(!0===a||null===a||"undefined"==typeof a)return-1!=""+b.indexOf(p);if(!1===a)return-1==""+b.indexOf(p)}return!1},H=function(b,a,r){if("object"!=typeof b)return"undefined"==typeof a.$?!0:F(b,a.$,r);var c,n;for(c in a)if("$"==c)for(n in b){if(F(b[n],a.$,r))return!0}else if(F(b[c],a[c],r))return!0;return!1},m={VERSION:"0.2",registerAttributeHandler:function(b,a,r){t||(t=MetaphorJs.add);c.push({priority:a,name:b,handler:t("attr."+
b,r)});n=!1},registerTagHandler:function(a,p,r){t||(t=MetaphorJs.add);b.push({priority:p,name:a,handler:t("tag."+a,r)});u=!1},getAttributeHandlers:function(){n||(c.sort(s),n=!0);return c},getTagHandlers:function(){u||(b.sort(s),u=!0);return b},apply:e,nextUid:g,getTemplate:function(b){if(!h[b]){var a=document.getElementById(b);if(!a)return null;if("script"==a.tagName.toLowerCase()){var r=document.createElement("div");r.innerHTML=a.innerHTML;h[b]=k(r.childNodes)}else h[b]="content"in a?a.content:k(a.childNodes)}return h[b]},
numberFormats:{},dateFormats:{},getNodeId:a,data:function(b,p,r){b=a(b);var c=q[b];return"undefined"!=typeof r?(c||(c=q[b]={}),c[p]=r):c?c[p]:l},emptyFn:function(){},trim:v,bind:m,inArray:function(b,a){return a?A.call(a,b):-1},isArray:D,isPlainObject:function(b){if("[object Object]"!==w.call(b)||b.nodeType)return!1;try{if(b.constructor&&!y.call(b.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}return!0},clone:z,addListener:C,removeListener:I,hasClass:K,addClass:function(b,a){K(b,
a)||(b.className+=" "+a)},removeClass:function(b,a){var r=J(a);b.className=b.className.replace(r,"")},isVisible:function(b){return!(0>=b.offsetWidth||0>=b.offsetHeight)},isThenable:function(b){var a;return b&&"function"==typeof(a=b.then)?a:!1},async:L,asyncError:function(b){L(function(){throw b;})},onReady:function(b){var a=!1,r=!0,c=window,n=c.document,u=n.documentElement,d=function(r){if("readystatechange"!=r.type||"complete"==n.readyState)I("load"==r.type?c:n,r.type,d),!a&&(a=!0)&&b.call(c,r.type||
r)},g=function(){try{u.doScroll("left")}catch(b){setTimeout(g,50);return}d("poll")};if("complete"==n.readyState)b.call(c,"lazy");else{if(n.createEventObject&&u.doScroll){try{r=!c.frameElement}catch(K){}r&&g()}C(n,"DOMContentLoaded",d);C(n,"readystatechange",d);C(c,"load",d)}},toFragment:k,toArray:function(b){for(var a=[],r=-1,c=b.length>>>0;++r!==c;a[r]=b[r]);return a},app:function(b,a){B||(B=MetaphorJs.view.Scope,x=MetaphorJs.view.Renderer);a?a instanceof B||(a=new B(a)):a=new B;var r=new x(b,a);
r.render();return r},filterArray:function(b,a,r){"object"!=typeof a&&(a={$:a});var c=[],n,u;n=-1;for(u=b.length;++n<u;)H(b[n],a,r)&&c.push(b[n]);return c}};window.MetaphorJs?e(window.MetaphorJs,m,!0):window.MetaphorJs=m})();
(function(){var l="undefined"!=typeof window?window:global,m={},q=function(d,g){if(m[d]||g)return m[d];var e=d.split("."),f,a=e.length,c,b=l;for(f=0;f<a;f++){c=e[f];if(!b[c])return null;b=b[c]}return b},f=function(d,g){var e;e=d.split(".");var f,a=e.pop();f=e.join(".");var c=e.length,b,n=l;if(m[f])e=[m[f],a];else{for(f=0;f<c;f++)b=e[f],n[b]||(n[b]={}),n=n[b];e=[n,a]}e[0][e[1]]=g;return m[d]=g},e=function(d,g){return m[d]=g};f("MetaphorJs.ns",{register:f,exists:function(d){return m[d]?!0:!1},get:q,
add:e,remove:function(d){delete m[d]}});MetaphorJs.r=f;MetaphorJs.g=q;MetaphorJs.add=e;"undefined"!=typeof module&&(module.exports=MetaphorJs.ns)})();
(function(){var l;if("undefined"!=typeof global)try{l=require("metaphorjs-namespace")}catch(m){l=global.MetaphorJs.ns}else l=window.MetaphorJs.ns;var q={}.undefined,f=Array.prototype.slice,e=function(b,a){return k(function(){},b,a)},d=function(b,a,c){return function(){var n=q,d=this.supr;this.supr=b.prototype[a]||function(){};try{n=c.apply(this,arguments)}catch(g){}this.supr=d;return n}},g=function(b,a,c){for(var n in a)a.hasOwnProperty(n)&&(b[n]="function"===typeof a[n]&&c.prototype&&"function"===
typeof c.prototype[n]?d(c,n,a[n]):a[n])},k=function(b,a,c){var n=function(){};n.prototype=b.prototype;n=new n;c=c||function(){this.initialize&&this.initialize.apply(this,arguments)};g(n,a,b);c.prototype=n;c.prototype.constructor=c;c.prototype.getClass=function(){return this.__proto__.constructor.__class};c.prototype.getParentClass=function(){return this.__proto__.constructor.__parentClass};c.__instantiate=function(b){return function(){var a=function(){},c;a.prototype=b.prototype;a=new a;c=b.prototype.constructor.apply(a,
arguments);return"object"==typeof c?c:a}}(c);return c},h=function(b,a,c,n,d,g){null===b&&(b="");"function"==typeof b?(d=c,"string"==typeof a?(d=n,n=c):(n=a,c=b,a=null),b=null):"string"!=typeof b&&(d=a,n=b,b=c=a=null);"string"!=typeof a&&"function"!=typeof a&&(d=n,n=c,c=a,a=null);"function"!=typeof c&&(d=n,n=c,c=null);n=n||{};var f=a&&"string"==typeof a?l.get(a):a;if(a&&!f)throw Error(a+" not found");a=f?k(f,n,c):e(n,c);a.__isMetaphorClass=!0;a.__parent=f;a.__parentClass=f?f.__class:null;a.__class=
b;if(d)for(var h in d)d.hasOwnProperty(h)&&(a[h]=d[h]);b&&(g?l.add(b,a):l.register(b,a));d&&d.alias&&l.add(d.alias,a);return a},a=function(b,a,c,n,d){return h(b,a,c,n,d,!0)},c=function(b){var a=l.get(b),c=f.call(arguments,1);if(!a)throw Error(b+" not found");return a.__instantiate.apply(this,c)},b=function(b,a){var c="string"==typeof a?l.get(a):a;return c?b instanceof c:!1},n=function(b,a){var c=b,n=l.get;"string"!=typeof a&&(a=a.getClass?a.getClass():a.prototype.constructor.__class);for("string"==
typeof b&&(c=n(b));c;){if(c.prototype.constructor.__class==a)return!0;c&&(c=c.getParentClass?n(c.getParentClass()):c.__parent)}return!1};"undefined"!=typeof global?module.exports={define:h,d:h,defineCache:a,dc:a,create:c,c:c,is:b,isSubclass:n}:(MetaphorJs.define=MetaphorJs.d=h,MetaphorJs.defineCache=MetaphorJs.dc=a,MetaphorJs.create=MetaphorJs.c=c,MetaphorJs.is=b,MetaphorJs.isSubclass=MetaphorJs.iss=n)})();
(function(){"undefined"==typeof window&&(global.window=global);if(window.Promise)l=window.Promise;else{var l;if("undefined"!=typeof global)try{l=require("metaphorjs-promise")}catch(m){global.Promise&&(l=global.Promise)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Promise&&(l=MetaphorJs.lib.Promise)}var q=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){return Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10)},f=function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])},e=Array.prototype.slice,d="undefined"!=typeof process?process.nextTick:function(b){window.setTimeout(b,0)},g=Function.prototype.bind?function(b,a){return b.bind(a)}:function(b,a){return function(){b.apply(a,arguments)}},k=function(){this.events={}};f(k.prototype,{createEvent:function(b,a){b=b.toLowerCase();var c=this.events;c[b]||(c[b]=new h(b,a));return c[b]},getEvent:function(b){b=b.toLowerCase();return this.events[b]},on:function(b,a,c,d){b=b.toLowerCase();var g=this.events;g[b]||
(g[b]=new h(b));return g[b].on(a,c,d)},once:function(b,a,c,d){d=d||{};d.limit=1;return this.on(b,a,c,d)},un:function(b,a,c){b=b.toLowerCase();var d=this.events;d[b]&&d[b].un(a,c)},hasListener:function(b,a,c){b=b.toLowerCase();var d=this.events;return d[b]?d[b].hasListener(a,c):!1},removeAllListeners:function(b){var a=this.events;a[b]&&a[b].removeAllListeners()},triggerAsync:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return[];b=a[b];return b.triggerAsync.apply(b,e.call(arguments,
1))},trigger:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return null;b=a[b];return b.trigger.apply(b,e.call(arguments,1))},suspendEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].suspend()},suspendAllEvents:function(){var b=this.events,a;for(a in b)b[a].suspend()},resumeEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].resume()},resumeAllEvents:function(){var b=this.events,a;for(a in b)b[a].resume()},destroyEvent:function(b){var a=this.events;
a[b]&&(a[b].removeAllListeners(),a[b].destroy(),delete a[b])},destroy:function(b){var a=this.events;if(b)b=b.toLowerCase(),a[b]&&(a[b].destroy(),delete a[b]);else{for(var c in a)a[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var b="createEvent getEvent on un once hasListener removeAllListeners triggerAsync trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),a={},c,d=-1,e=b.length;++d<e;c=b[d],a[c]=g(this[c],this));this.api=a}return this.api}});
var h=function(b,a){this.name=b;this.listeners=[];this.map={};this.hash=q();this.uni="$$"+b+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=a||!1};f(h.prototype,{getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(b,a,c){if(!b)return null;a=a||null;c=c||{};var d=this.uni,g=a||b;if(g[d]&&!c.allowDupes)return null;var e=++this.lid,k=c.first||!1;g[d]=e;b={fn:b,scope:a,uniScope:g,id:e,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,
prepend:c.prepend};k?this.listeners.unshift(b):this.listeners.push(b);this.map[e]=b;return e},once:function(b,a,c){c=c||{};c.once=!0;return this.on(b,a,c)},un:function(b,a){var c=-1,d=this.uni,g=this.listeners,e;e=b==parseInt(b)?b:(a||b)[d];if(!e)return!1;for(var k=0,f=g.length;k<f;k++)if(g[k].id==e){c=k;delete g[k].uniScope[d];break}if(-1==c)return!1;g.splice(c,1);delete this.map[e];return!0},hasListener:function(b,a){var c=this.listeners,d;if(b){a=a||b;d=b==parseInt(b)?b:a[this.uni];if(!d)return!1;
for(var g=0,e=c.length;g<e;g++)if(c[g].id==d)return!0;return!1}return 0<c.length},removeAllListeners:function(){var b=this.listeners,a=this.uni,c,d;c=0;for(d=b.length;c<d;c++)delete b[c].uniScope[a];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(b,a){var c;b.append||b.prepend?(c=e.call(a),b.prepend&&(c=b.prepend.concat(c)),b.append&&(c=c.concat(b.append))):c=a;return c},triggerAsync:function(){if("undefined"==typeof l)throw Error("Promises are not defined");
var b=this,a=b.listeners,c=b.returnResult,g=e.call(arguments),k=[],f=[],h,w,y;if(b.suspended||0==a.length)return l.resolve(null);w=0;for(y=a.length;w<y;w++)k.push(a[w]);for(w=function(a){h=b._prepareArgs(a,g);return new l(function(c,n){d(function(){try{c(a.fn.apply(a.scope,h))}catch(d){n(d)}a.called++;a.called==a.limit&&b.un(a.id)},0)})};(a=k.shift())&&(!a||!b.map[a.id]||(a.count++,a.count<a.start||(f.push(w(a)),"first"!=c))););return"last"==c?[f.pop()]:f},trigger:function(){var b=this.listeners,
a=this.returnResult;if(this.suspended||0==b.length)return null;var c="all"==a?[]:null,d=[],g,e;if("first"==a)d.push(b[0]);else for(g=0,e=b.length;g<e;g++)d.push(b[g]);for(;b=d.shift();)if(b&&this.map[b.id]&&(b.count++,!(b.count<b.start))){g=b.fn.apply(b.scope,this._prepareArgs(b,arguments));b.called++;b.called==b.limit&&this.un(b.id);"all"==a&&c.push(g);if("first"==a)return g;"last"==a&&(c=g);if(!1==a&&!1===g)break}if(a)return c}});var a=window.MetaphorJs;if(a&&a.VERSION){var c=new k;f(MetaphorJs,
c.getApi())}a&&a.r?a.r("MetaphorJs.lib.Observable",k):(window.MetaphorJs=window.MetaphorJs||{},MetaphorJs.lib=MetaphorJs.lib||{},MetaphorJs.lib.Observable=k);"undefined"!=typeof global&&(module.exports=k)})();
(function(){var l="undefined"!=typeof window?window.setTimeout:global.setTimeout,m=function(b){var a;return!b||"object"!=typeof b&&"function"!=typeof b||"function"!=typeof(a=b.then)?!1:a},q=Function.prototype.bind?function(b,a){return b.bind(a)}:function(b,a){return function(){b.apply(a,arguments)}},f=[],e=!1,d="undefined"!=typeof process?process.nextTick:function(a){l(a,0)},g=function(){e=!0;var a=f.shift();d(function(){a[0].apply(a[1],a[2]);f.length?g():e=!1},0)},k=function(a,c,d){d=d||[];f.push([a,
c,d]);e||g()},h=function(a,c){for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])},a=function(a,c){return function(d){try{c.resolve(a(d))}catch(g){c.reject(g)}}},c=function(a,d){if(a instanceof c)return a;if(!(this instanceof c))return new c(a,d);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(a)if(m(a))this.resolve(a);else if("function"==typeof a)try{a.call(d,q(this.resolve,this),q(this.reject,this))}catch(g){this.reject(g)}else throw"Cannot construct Promise with given value";};
h(c.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(a,d){var g;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(g=m(a)){a instanceof
c?a.then(q(this._processResolveValue,this),q(this._processRejectReason,this)):(new c(g,a)).then(q(this._processResolveValue,this),q(this._processRejectReason,this));return}}catch(e){0==this._state&&this._doReject(e);return}d.call(this,a)}},_doResolve:function(a){this._value=a;this._state=1;a=this._fulfills;for(var c;c=a.shift();)k(c[0],c[1],[this._value]);this._done();this._cleanup()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){this._triggered||(this._triggered=
!0,this._processResolveValue(a))},_doReject:function(a){this._state=2;this._reason=a;for(var c=this._rejects,d;d=c.shift();)k(d[0],d[1],[a]);this._fail();this._cleanup()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){this._triggered||(this._triggered=!0,this._processRejectReason(a))},then:function(b,d){var g=new c,e=this._state;0==e?(b&&"function"==typeof b?this._fulfills.push([a(b,g),null]):this._fulfills.push([g.resolve,g]),d&&"function"==typeof d?this._rejects.push([a(d,
g),null]):this._rejects.push([g.reject,g])):1==e?b&&"function"==typeof b?k(a(b,g),null,[this._value]):g.resolve(this._value):2==e&&(d&&"function"==typeof d?k(a(d,g),null,[this._reason]):g.reject(this._reason));return g},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,c;c=a.shift();)c[0].call(c[1]||null,this._value)},done:function(a,c){0==this._state?this._dones.push([a,c]):a.call(c||null,this._value);return this},_fail:function(){for(var a=this._fails,c;c=a.shift();)c[0].call(c[1]||
null,this._reason)},fail:function(a,c){0==this._state?this._fails.push([a,c]):a.call(c||null,this._reason);return this},always:function(a,c){this.done(a,c);this.fail(a,c);return this},promise:function(){return{then:q(this.then,this),done:q(this.done,this),fail:q(this.fail,this),always:q(this.always,this)}}});h(c,{resolve:function(a){if(m(a)||"function"==typeof a)return new c(a);var d=new c;d.resolve(a);return d},reject:function(a){var d=new c;d.reject(a);return d},all:function(a){if(!a.length)return c.resolve(null);
var d=new c,g=a.length,e=[],k=g,f,h,w=function(a){e.push(a);k--;0==k&&d.resolve(e)};for(f=0;f<g;f++)h=a[f],h instanceof c?h.done(w).fail(d.reject,d):m(h)||"function"==typeof h?(new c(h)).done(w).fail(d.reject,d):w(h);return d},when:function(){return c.all(arguments)},allResolved:function(a){if(!a.length)return c.resolve(null);var d=new c,g=a.length,e=[],k=g,f,h,w=function(a){e.push(a);y()},y=function(){k--;0==k&&d.resolve(e)};for(f=0;f<g;f++)h=a[f],h instanceof c?h.done(w).fail(y):m(h)||"function"==
typeof h?(new c(h)).done(w).fail(y):w(h);return d},race:function(a){if(!a.length)return c.resolve(null);var d=new c,g=a.length,e,k;for(e=0;e<g&&(k=a[e],k instanceof c?k.done(d.resolve,d).fail(d.reject,d):m(k)||"function"==typeof k?(new c(k)).done(d.resolve,d).fail(d.reject,d):d.resolve(k),d.isPending());e++);return d}});"undefined"==typeof global?(window.Promise||(window.Promise=c),window.MetaphorJs&&window.MetaphorJs.r("MetaphorJs.lib.Promise",c)):"undefined"!=typeof module&&(module.exports=c)})();
(function(){"undefined"==typeof window&&(global.window=global);var l;if("undefined"!=typeof global)try{l=require("metaphorjs-observable")}catch(m){global.Observable&&(l=global.Observable)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Observable&&(l=MetaphorJs.lib.Observable);var q=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,f={},e=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){var a;a=Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10);return f[a]?
e():f[a]=a},d=Object.prototype.toString,g=function(a){return"[object Array]"===d.call(a)},k=function(a){return"[object Date]"===d.call(a)},h=function(a){return"[object RegExp]"===d.call(a)},a=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},c=function(b,d){if(a(b))throw Error("Cannot copy window object");if(d){if(b===d)throw Error("Objects are identical");if(g(b))for(var e=d.length=0;e<b.length;e++)d.push(c(b[e]));else{for(e in d)delete d[e];for(e in b)d[e]=c(b[e])}}else(d=b)&&
(g(b)?d=c(b,[]):k(b)?d=new Date(b.getTime()):h(b)?d=new RegExp(b.source):null!=b&&"object"===typeof b&&(d=c(b,{})));return d},b=function(c,d){if(c===d)return!0;if(null===c||null===d)return!1;if(c!==c&&d!==d)return!0;var e=typeof c,f;if(e==typeof d&&"object"==e)if(g(c)){if(!g(d))return!1;if((e=c.length)==d.length){for(f=0;f<e;f++)if(!b(c[f],d[f]))return!1;return!0}}else{if(k(c))return k(d)&&c.getTime()==d.getTime();if(h(c)&&h(d))return c.toString()==d.toString();if(a(c)||a(d)||g(d))return!1;e={};for(f in c)if(("$"!==
f.charAt(0)||"object"!=typeof c[f])&&"function"!==typeof c[f]){if(!b(c[f],d[f]))return!1;e[f]=!0}for(f in d)if(!e.hasOwnProperty(f)&&"$"!==f.charAt(0)&&void 0!==d[f]&&"function"!==typeof d[f])return!1;return!0}return!1},n=function(a,c){var d=a.length,g=c.length,e=Array(d+1),k=Array(d+1),f,p,r,G,N=0;if(d==g&&0==d)return{changes:0,distance:0,prescription:[]};for(f=0;f<=d;f++)e[f]=Array(g+1),k[f]=Array(g+1),e[f][0]=f,k[f][0]="D";for(f=0;f<=g;f++)e[0][f]=f,k[0][f]="I";for(f=1;f<=d;f++)for(p=1;p<=g;p++)r=
b(a[f-1],c[p-1])?0:1,e[f][p-1]<e[f-1][p]&&e[f][p-1]<e[f-1][p-1]+r?(e[f][p]=e[f][p-1]+1,k[f][p]="I"):e[f-1][p]<e[f-1][p-1]+r?(e[f][p]=e[f-1][p]+1,k[f][p]="D"):(e[f][p]=e[f-1][p-1]+r,k[f][p]=1==r?"R":"-");G=[];f=d;p=g;do r=k[f][p],G.push(r),"-"!=r&&N++,"R"==r||"-"==r?(f--,p--):"D"==r?f--:p--;while(0!=f||0!=p);return{changes:N/G.length,distance:e[d][g],prescription:G.reverse()}},u=window.MetaphorJs?MetaphorJs.trim:function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():
a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),s,t=window.MetaphorJs?MetaphorJs.ns.get:null,v=function(a,b,c,d,f){s||(s=new l);var k=e(),n;g(a)&&null===b?n="array":("string"!=typeof b&&(d=c,c=b,b=null,n="object"),"string"==typeof a&&(d=c,c=b,b=a,a=null),b&&a&&(n=a.hasOwnProperty(b)?"attr":"expr"),b&&!a&&(n="expr"));if(c)s.on(k,c,d||this,{append:[f],allowDupes:!0});this.code=b=this._processPipes(b,a);this.getterFn="expr"==n?z(b):null;this.id=k;this.type=n;
this.obj=a;this.itv=null;this.curr=this._getValue()};(function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(v.prototype,{code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,arraySlice:!1,pipes:null,_addPipe:function(a,b,c){var d=b.shift(),g=null,e=[],f;t&&(g=t("filter."+d,!0));g||(g=window[d]||c[d]);if("function"==typeof g){d=-1;for(f=b.length;++d<f;e.push(A(c,b[d],self.check,self)));a.push([g,b,e])}},_processPipes:function(a,b){for(var c=0,d=a.length,g=[],
e,f,p,r=!1,G=a;c<d;)if(-1!=(e=a.indexOf("|",c)))f=a.charAt(e-1),p=a.charAt(e+1),"|"!=f&&"'"!=f&&'"'!=f&&"|"!=p&&"'"!=p&&'"'!=p&&(r?(c=u(a.substring(c,e)).split(":"),this._addPipe(g,c,b)):(r=!0,G=u(a.substring(0,e)))),c=e+1;else{r&&(c=u(a.substr(c)).split(":"),this._addPipe(g,c,b));break}g.length&&(this.pipes=g);return G},_checkCode:function(){var a=this._getValue(),b=!1,c=this.curr;if(g(c)&&g(a))return b=n(c,a),b.changes?(this.curr=a.slice(),s.trigger(this.id,b,a,c),!0):!1;a!==c&&(this.curr=a,s.trigger(this.id,
a,c),b=!0);return b},_checkObject:function(){var a=this.obj,d=this.curr;return b(d,a)?!1:(this.curr=c(a),s.trigger(this.id,a,d),!0)},_checkArray:function(){var a=this.curr,b=this.obj,c=n(a,b);return c.changes?(this.curr=b.slice(),s.trigger(this.id,c,b,a),!0):!1},_getValue:function(){var a;switch(this.type){case "attr":a=this.obj[this.code];break;case "expr":try{a=this.getterFn(this.obj)}catch(b){if(window.MetaphorJs)MetaphorJs.asyncError(b);else throw b;}"undefined"==typeof a&&(a="");break;case "object":a=
c(this.obj);break;case "array":a=this.obj}g(a)&&(a=a.slice());var d=this.pipes;if(d){var e,f,k,n=d.length,p=this.obj,r,G;for(e=0;e<n;e++){k=d[e][1];f=[];r=-1;for(G=k.length;++r<G;f.push(J(k[r],p)));f.unshift(a);f.push(p);a=d[e][0].apply(null,f)}}return a},addListener:function(a,b,c){return s.on(this.id,a,b,c)},removeListener:function(a,b){return s.un(this.id,a,b)},getValue:function(){return this._getValue()},setValue:function(a){var b=this.type;if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||
(this.setterFn=I(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";},check:function(){switch(this.type){case "expr":case "attr":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&
(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,b){var c=this.id;s.un(c,a,b);return s.hasListener(c)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b,c,d,g,e;this.itv&&this.clearInterval();if(a)for(b=-1,c=a.length;++b<c;)for(e=a[b][2],d=-1,g=e.length;++d<g;)e[d].unsubscribeAndDestroy(this.check,this);this.pipes=this.obj=this.curr=null;s.destroyEvent(this.id);this.obj&&delete this.obj.$$watchers[this.code]}});var A=function(a,b,c,d,e){b=w(a,u(b));return a?(a.$$watchers||
(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof v&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof v)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].addListener(c,d,{append:[e],allowDupes:!0}):a.$$watchers[b]=new v(a,b,c,d,e),a.$$watchers[b]):new v(a,b,c,d,e)},w=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==
b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},y=Function,D={},z=function(a){return D[a]?D[a]:D[a]=new y("____","return ".concat(a.replace(q,"$1____.$3")))},C={},I=function(a){if(!C[a]){var b=a.replace(q,"$1____.$3");return C[a]=new y("____","$$$$",b.concat(" = $$$$"))}return C[a]},E={},J=function(a,b){return z(a)(b)};v.create=A;v.unsubscribeAndDestroy=function(a,b,c,d){b=u(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,d)&&delete a[b]};v.normalizeExpr=w;v.prepareCode=
function(a){return a.replace(q,"$1____.$3")};v.createGetter=z;v.createSetter=I;v.createFunc=function(a){return E[a]?E[a]:E[a]=new y("____",a.replace(q,"$1____.$3"))};v.eval=J;v.isExpression=function(a){var b=a.substr(0,1);return('"'==b||"'"==b)&&a.substr(a.length-1)==b||""+parseInt(a,10)===a?!1:!0};window.MetaphorJs&&MetaphorJs.r&&MetaphorJs.r("MetaphorJs.lib.Watchable",v);"undefined"!=typeof global&&(module.exports=v)})();
(function(){var l,m;if("undefined"!=typeof global)try{l=require("metaphorjs-promise"),m=require("metaphorjs-observable")}catch(q){l=global.MetaphorJs.lib.Promise,m=global.MetaphorJs.lib.Observable}else l=window.MetaphorJs.lib.Promise,m=window.MetaphorJs.lib.Observable;var f=function(a,b,c){for(var d in b)!b.hasOwnProperty(d)||void 0!=typeof a[d]&&!1===c||(a[d]=b[d])},e=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){a.apply(b,arguments)}},d;"undefined"!=typeof window&&
(d=document.querySelectorAll||function(a){var b=document,c=b.documentElement.firstChild,d=b.createElement("STYLE");c.appendChild(d);b.__qsaels=[];d.sheet?d.sheet.insertRule(a+"{x:expression(document.__qsaels.push(this))}",0):d.styleSheet&&(d.styleSheet.cssText=a+"{x:expression(document.__qsaels.push(this))}");window.scrollBy(0,0);return b.__qsaels});var g=/#.*$/,k=/([?&])_=[^&]*/,h=/\?/,a=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,c=/^(?:GET|HEAD)$/i,b=0,n=function(a,b){setTimeout(function(){a.call(b)},
0)},u=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},s=function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),t=function(a,b){var c,d;if(!a||"string"!==typeof a)return null;try{d=new DOMParser,c=d.parseFromString(a,b||"text/xml")}catch(e){c=void 0}if(!c||c.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return c},v=function(a,
b,c){var d,e;if("string"==typeof a&&c)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a));else if(I(a)&&c)for(d=0,e=a.length;d<e;d++)v(a[d],b,c+"["+d+"]");else if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&v(a[d],b,c?c+"["+d+"]":d)},A=function(a,b){a.replace(g,"");if(!1===b.cache){var d=(new Date).getTime();return k.test(a)?a.replace(k,"$1_="+d):a+(h.test(a)?"&":"?")+"_="+d}!b.data||window.FormData&&b.data instanceof window.FormData||("string"!=typeof b.data?(d=[],v(b.data,d,null),d=d.join("&").replace(/%20/g,
"+")):d=b.data,b.data=d,c.test(b.method)&&(a+=(h.test(a)?"&":"?")+b.data,b.data=null));return a},w={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},y={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,
replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},D={},z=new m,C=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},I=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"==Object.prototype.toString.call(a)||!1},E=function(a,b,c){var d,e;if("object"!=typeof a&&"function"!=typeof a&&
c)d=document.createElement("input"),d.setAttribute("type","hidden"),d.setAttribute("name",c),d.setAttribute("value",a),b.appendChild(d);else if(I(a)&&c)for(d=0,e=a.length;d<e;d++)E(a[d],b,c+"["+d+"]");else if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&E(a[d],b,c?c+"["+d+"]":d)},J=function(a){for(var b,c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],b.hasAttribute("name"))if(c="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT","FILE"===c)for(c=0;c<b.files.length;d+=
"&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},K=function(){},L=function(a,b,c){var e=b?b.dataType:null;b=b?b.selector:null;if("string"!=typeof a)return a;c=c||"";if("xml"===e||!e&&0<=c.indexOf("xml"))return a=t(s(a)),b?d.call(a,b):a;if("html"===e)return a=t(a,"text/html"),b?d.call(a,b):a;if("fragment"==e){c=document.createDocumentFragment();e=document.createElement("div");
for(e.innerHTML=a;e.firstChild;)c.appendChild(e.firstChild);return c}if("json"===e||!e&&0<=c.indexOf("json"))return a=s(a),JSON.parse(a);("script"===e||!e&&0<=c.indexOf("javascript"))&&C(a);return a+""},B=function(b){var c=a.exec(("undefined"!=typeof window?window.location.href:"").toLowerCase())||[],d=a.exec(b.url.toLowerCase());this._opt=b;b.crossDomain=!(!d||d[1]===c[1]&&d[2]===c[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(c[3]||("http:"===c[1]?"80":"443")));c=new l;"iframe"!=b.transport||b.form?
b.form&&(this._form=b.form,"POST"!=b.method||"undefined"!=typeof window&&window.FormData||"iframe"==b.transport||(b.transport="iframe")):(this.createForm(),b.form=this._form);b.form&&"iframe"!=b.transport&&(b.data="POST"==b.method?new FormData(b.form):J(b.form));b.url=A(b.url,b);d=!b.crossDomain&&"script"!=b.transport||b.form?"iframe"==b.transport?new M(b,c,this):new F(b,c,this):new H(b,c,this);this._deferred=c;this._transport=d;c.done(function(a){z.trigger("success",a)});c.fail(function(a){z.trigger("error",
a)});c.always(function(){z.trigger("end")});z.trigger("start");b.timeout&&(this._timeout=setTimeout(e(this.onTimeout,this),b.timeout));b.jsonp&&this.createJsonp();!1===z.trigger("beforeSend",b,d)&&(this._promise=l.reject());b.beforeSend&&!1===b.beforeSend.call(b.callbackScope,b,d)&&(this._promise=l.reject());this._promise||(n(d.send,d),b=c.promise(),b.abort=e(this.abort,this),c.always(this.destroy,this),this._promise=b)};f(B.prototype,{_jsonpName:null,_transport:null,_opt:null,_deferred:null,_promise:null,
_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);E(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,c=a.jsonpParam||"callback",d=a.jsonpCallback||"jsonp_"+
++b;a.url+=(h.test(a.url)?"&":"?")+c+"="+d;this._jsonpName=d;"undefined"!=typeof window&&(window[d]=e(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=e(this.jsonpCallback,this));return d},jsonpCallback:function(a){try{this._deferred.resolve(this.processResponseData(a))}catch(b){this._deferred.reject(b)}},processResponseData:function(a,b){var c=this._opt;a=L(a,c,b);z.hasListener("processResponse")&&(a=z.trigger("processResponse",a,this._deferred));c.processResponse&&(a=c.processResponse.call(c.callbackScope,
a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred;if(this._opt.jsonp)if(a){try{C(a)}catch(d){c.reject(d)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else try{c.resolve(this.processResponseData(a,b))}catch(e){c.reject(e)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.destroy();delete this._transport;
delete this._opt;delete this._deferred;delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},!0);var x=function(a,b){b=b||{};a&&"string"!=typeof a?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),!b.url))throw"Must provide url";f(b,D,!1);f(b,y,!1);b.method=b.method?b.method.toUpperCase():b.form?b.form.getAttribute("method").toUpperCase()||
"GET":"GET";return(new B(b)).promise()};x.setup=function(a){f(D,a,!0)};x.on=function(){z.on.apply(z,arguments)};x.un=function(){z.un.apply(z,arguments)};x.get=function(a,b){b=b||{};b.method="GET";return x(a,b)};x.post=function(a,b){b=b||{};b.method="POST";return x(a,b)};x.load=function(a,b,c){c=c||{};"string"!=typeof b&&(c=b);c.dataType="fragment";return x(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};x.loadScript=function(a){return x(a,{transport:"script"})};
x.submit=function(a,b){b=b||{};b.form=a;return x(null,b)};var F=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&u(d,"progress",e(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&u(d.upload,"progress",e(a.uploadProgress,a.callbackScope));try{var g;if(a.xhrFields)for(g in a.xhrFields)d[g]=
a.xhrFields[g];a.data&&a.contentType&&d.setRequestHeader("Content-Type",a.contentType);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Accept",a.dataType&&w[a.dataType]?w[a.dataType]+", */*; q=0.01":w._default);for(g in a.headers)d.setRequestHeader(g,a.headers[g])}catch(f){}d.onreadystatechange=e(this.onReadyStateChange,this)};f(F.prototype,{_xhr:null,_deferred:null,_ajax:null,onReadyStateChange:function(){var a=this._xhr,b=this._deferred;if(0===a.readyState)a.onreadystatechange=
K,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=K;var c;a:{try{c=!a.status&&"undefined"!=typeof location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse("string"==typeof a.responseText?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=K;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,
!0,a.username,a.password),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}},!0);var H=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};f(H.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);u(a,"load",e(this.onLoad,this));u(a,
"error",e(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);var M=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};f(M.prototype,{_opt:null,
_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),c="frame-"+ ++b,d=this._opt.form;a.setAttribute("id",c);a.setAttribute("name",c);a.style.display="none";document.body.appendChild(a);d.setAttribute("action",this._opt.url);d.setAttribute("target",c);u(a,"load",e(this.onLoad,this));u(a,"error",e(this.onError,this));this._el=a;try{d.submit()}catch(g){this._deferred.reject(g)}},onLoad:function(){var a=this._el;this._opt&&!this._opt.jsonp&&(a=a.contentDocument||
a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);"undefined"!=typeof global?module.exports=x:window.MetaphorJs?MetaphorJs.ajax=x:window.MetaphorJs={ajax:x}})();
(function(){var l=[],m=!1,q=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/,f=function(a,c,b){a.attachEvent?a.attachEvent("on"+c,b):a.addEventListener(c,b,!1)},e=!!history.pushState,d="onhashchange"in window,g=function(a){var c=location.protocol+"//"+location.hostname;location.port&&(c+=":"+location.port);a=a.replace(c,"");e||(a=encodeURIComponent(a));return a},k=function(){var a;e?a=location.pathname+location.search:(a=location.hash.substr(1))?("!"==
a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a)):a=location.pathname+location.search;return a},h=function(){var a=k();if(l.length)for(var c=-1,b=l.length;++c<b;l[c].call(null,a));window.MetaphorJs&&MetaphorJs.triggerAsync("locationchange",a)};f(window,"load",function(){m=!0});history.initPushState=function(){if(e)history.origPushState=history.pushState,history.origReplaceState=history.replaceState,f(window,"popstate",h),history.pushState=function(a,b,c){history.origPushState(a,b,g(c));h()},
history.replaceState=function(a,b,c){history.origReplaceState(a,b,g(c));h()};else if(d)history.replaceState=history.pushState=function(a,b,c){a=g(c);location.hash=a?"!"+a:""},f(window,"hashchange",h);else{var a=null,c=!1;window.onIframeHistoryChange=function(a){c||(location.hash=a?"!"+a:"",h())};var b=function(b){var c=a.contentWindow.document;c.open();c.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+b+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');
c.close()};history.pushState=function(a,c,d){b(g(d))};history.replaceState=function(b,c,d){b=g(d);a.contentWindow.hashValue=b};var k=function(){a=document.createElement("iframe");a.src="about:blank";a.style.display="none";document.body.appendChild(a);c=!0;b(g(location.hash.substr(1)));c=!1};m?k():f(window,"load",k)}f(document.documentElement,"click",function(a){a=a||window.event;for(var b=a.target||a.srcElement,c;b&&"a"!=b.nodeName.toLowerCase();)b=b.parentNode;if(b){c=b.getAttribute("href");var d;
if(d=c&&"#"!=c.substr(0,1))c=c.match(q),d=c[1]&&location.protocol!=c[1]||c[2]&&location.hostname!=c[2]?!1:c[2]||c[3]?location.port!=c[3]?!1:!0:!0;if(d&&!b.getAttribute("target"))return history.pushState(null,null,b.getAttribute("href")),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1}});history.initPushState=function(){}};window.MetaphorJs?(MetaphorJs.pushUrl=function(a){history.pushState(null,null,a)},MetaphorJs.replaceUrl=function(a){history.replaceState(null,null,
a)},MetaphorJs.currentUrl=function(){return k()}):history.onchange=function(a){l.push(a)}})();
(function(){var l=/\r/g,m=function(f){var e,d;if((e=q[f.type]||q[f.nodeName.toLowerCase()])&&"get"in e&&void 0!==(d=e.get(f,"value")))return d;d=f.value;return"string"===typeof d?d.replace(l,""):null==d?"":d},q={option:{get:function(f){var e=f.getAttribute("value");return null!=e?e:MetaphorJs.trim(f.innerText||f.textContent)}},select:{get:function(f){for(var e,d=f.options,g=f.selectedIndex,k=(f="select-one"===f.type||0>g)?null:[],h=f?g+1:d.length,a,c=0>g?h:f?g:0;c<h;c++)if(e=d[c],a=e.disabled||null!==
e.getAttribute("disabled")||d.parentNode.disabled,(e.selected||c===g)&&!a){e=m(e);if(f)return e;k.push(e)}return k},set:function(f,e){for(var d,g,k=f.options,h=MetaphorJs.toArray(e),a=k.length;a--;)if(g=k[a],g.selected=MetaphorJs.inArray(g.value,h))d=!0;d||(f.selectedIndex=-1);return h}}};q.radio=q.checkbox={set:function(f,e){if(MetaphorJs.isArray(e))return f.checked=0<=MetaphorJs.inArray(m(f),e)},get:function(f){return null===f.getAttribute("value")?"on":f.value}};MetaphorJs.getValue=m;MetaphorJs.setValue=
function(f,e){if(1===f.nodeType){null==e?e="":"number"===typeof e&&(e+="");var d=q[f.type]||q[f.nodeName.toLowerCase()];d&&"set"in d&&void 0!==d.set(this,e,"value")||(f.value=e)}}})();
(function(){var l=function(){return!1},m=function(){return!0},q=function(f){if(!(this instanceof q))return new q(f);for(var e in f)f.hasOwnProperty&&f.hasOwnProperty(e)||this[e]||(this[e]=f[e]);this.originalEvent=f;this.type=f.type;!this.target&&f.srcElement&&(this.target=f.srcElement);this.isDefaultPrevented=f.defaultPrevented||void 0===f.defaultPrevented&&!1===f.returnValue?m:l;this.timeStamp=f&&f.timeStamp||(new Date).getTime()};q.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,
preventDefault:function(){var f=this.originalEvent;this.isDefaultPrevented=m;f&&f.preventDefault&&f.preventDefault()},stopPropagation:function(){var f=this.originalEvent;this.isPropagationStopped=m;f&&f.stopPropagation&&f.stopPropagation()},stopImmediatePropagation:function(){var f=this.originalEvent;this.isImmediatePropagationStopped=m;f&&f.stopImmediatePropagation&&f.stopImmediatePropagation();this.stopPropagation()}};MetaphorJs.normalizeEvent=function(f){return new q(f)}})();
(function(){var l=MetaphorJs.lib.Observable,m=MetaphorJs.apply;MetaphorJs.d("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(q){q=q||{};this._observable=new l;m(this,this._observable.getApi());if(q.callback){var f=q.callback,e=f.scope||this;delete f.scope;for(var d in f)if(f.hasOwnProperty(d))this.on(d,f[d],e);delete q.callback}m(this,q,!0)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",
this);this._observable.destroy();delete this._observable}},onDestroy:MetaphorJs.emptyFn})})();
(function(){var l={},m={},q=MetaphorJs.apply,f=MetaphorJs.ajax,e=MetaphorJs.create;MetaphorJs.define("MetaphorJs.data.Model",{type:null,fields:null,record:null,store:null,plain:!1,initialize:function(d){this.fields={};q(this,{record:{load:null,save:null,"delete":null,id:null,data:null,success:null,extra:{}},store:{load:null,save:null,"delete":null,id:null,data:null,total:null,start:null,limit:null,success:null,extra:{}}},!1);q(this,d,!0);this.plain=!this.type},isPlain:function(){return this.plain},
getRecordProp:function(d,e){return this.getProp("record",d,e)},setRecordProp:function(d,e){this.record[d]=e},getStoreProp:function(d,e){return this.getProp("store",d,e)},setStoreProp:function(d,e){this.store[d]=e},getProp:function(d,e,f){d=this[d];return d[e]&&d[e][f]||d[f]||this[f]||null},setProp:function(d,e){return this[d]=e},_createAjaxCfg:function(d,e,f,h){var a=this,c=a[d],b=q({},"string"==typeof c[e]?{url:c[e]}:c[e]),n=a.getProp(d,e,"id"),l=a.getProp(d,e,"data"),m=a.getProp(d,e,"url"),t=a.getProp(d,
e,"json");if(!b)if(m)b={url:m};else throw d+"."+e+" not defined";"string"==typeof b&&(b={url:b});if(!b.url){if(!m)throw d+"."+e+" url not defined";b.url=m}b.data=q({},b.data,a.extra,c.extra,c[e]?c[e].extra:{});b.method||(b.method="load"==e?"GET":"POST");f&&(b.data[n]=f);h&&(l?b.data[l]=h:b.data=h);t&&b.data&&"GET"!=b.method&&(b.data=JSON.stringify(b.data));b.callbackScope=a;"record"==d?b.processResponse=function(b,c){a._processRecordResponse(e,b,c)}:"store"==d&&(b.processResponse=function(b,c){a._processStoreResponse(e,
b,c)});return b},_processRecordResponse:function(d,e,f){var h=this.getRecordProp(d,"id"),a=this.getRecordProp(d,"data"),h=(a=a?e[a]:e)&&a[h]||e[h];this._getSuccess("record",d,e)?f.resolve({id:h,data:a}):f.reject(e)},_processStoreResponse:function(d,e,f){var h=this.getStoreProp(d,"data"),a=this.getStoreProp(d,"total"),h=h?e[h]:e,a=a?e[a]:null;this._getSuccess("store",d,e)?f.resolve({data:h,total:a}):f.reject(e)},_getSuccess:function(d,e,f){return(d=this.getProp(d,e,"success"))&&void 0!=f[d]?f[d]:!0},
loadRecord:function(d){return f(this._createAjaxCfg("record","load",d))},saveRecord:function(d,e,k){return f(this._createAjaxCfg("record",d.getId()?"save":"create",d.getId(),q({},d.storeData(d.getData(e)),k)))},deleteRecord:function(d){return f(this._createAjaxCfg("record","delete",d.getId()))},loadStore:function(d,e){return f(q(this._createAjaxCfg("store","load"),e,!0))},saveStore:function(d,e){return f(this._createAjaxCfg("store","save",null,e))},deleteRecords:function(d,e){return f(this._createAjaxCfg("store",
"delete",e))},getFields:function(){return this.fields},restoreField:function(d,e,f){var h=this.fields[e];if(h){switch("string"==typeof h?h:h.type){case "int":f=parseInt(f);break;case "bool":case "boolean":"string"==typeof f?(f=f.toLowerCase(),f=!("off"===f||"no"===f||"0"===f||"false"==f||"null"==f)):f=f?!0:!1;break;case "double":case "float":f=parseFloat(f);break;case "date":h.parseFn?f=h.parseFn(f,h.format):Date.parse?f=Date.parse(f,h.format):("timestamp"==h.format&&(f=1E3*parseInt(f)),f=new Date(f))}h.restore&&
(f=h.restore.call(d,f,e))}return this.onRestoreField(d,e,f)},onRestoreField:function(d,e,f){return f},storeField:function(d,e,f){var h=this.fields[e];if(h){switch("string"==typeof h?h:h.type){case "bool":case "boolean":f=f?"1":"0";break;case "date":f=h.formatFn?h.formatFn(f,h.format):Date.format?Date.format(f,h.format):"timestamp"==h.format?f.getTime()/1E3:f.format?f.format(h.format):f.toString();break;default:f=f.toString()}h.store&&(f=h.store.call(d,f,e))}return this.onStoreField(d,e,f)},onStoreField:function(d,
e,f){return f}},{create:function(d,f){return"MetaphorJs.data.Model"==d?e(d,f):f?e(d,f):l[d]?l[d]:l[d]=e(d)},addToCache:function(d){var e=d.getClass(),f=d.getId();"MetaphorJs.data.Record"!=e&&(m[e]||(m[e]={}),m[e][f]=d)},getFromCache:function(d,e){return m[d]&&m[d][e]?m[d][e]:null},removeFromCache:function(d,e){m[d]&&m[d][e]&&delete m[d][e]}})})();
(function(){var l=MetaphorJs.data.Model,m=MetaphorJs.create,q=MetaphorJs.is,f=MetaphorJs.apply;MetaphorJs.define("MetaphorJs.data.Record","MetaphorJs.cmp.Base",{id:null,data:null,orig:null,modified:null,loaded:!1,dirty:!1,destroyed:!1,model:null,standalone:!0,stores:null,initialize:function(e,d,f){var k=arguments.length;1==k?(f=e,d=e=null):2==k&&(f=d,d=null);this.data={};this.orig={};this.stores=[];this.modified={};f=f||{};this.supr(f);"string"==typeof this.model?this.model=m(this.model):q(this.model,
"MetaphorJs.data.Model")||(this.model=m("MetaphorJs.data.Model",this.model));this.id=e;d?this.importData(d):!1!==f.autoLoad&&e&&this.load();"MetaphorJs.data.Record"!=this.getClass()&&l.addToCache(this)},isLoaded:function(){return this.loaded},isStandalone:function(){return this.standalone},isDirty:function(){return this.dirty},getModel:function(){return this.model},attachStore:function(e){e=e.getId();-1==this.stores.indexOf(e)&&this.stores.push(e)},detachStore:function(e){e=e.getId();var d;this.destroyed||
-1==(d=this.stores.indexOf(e))||(this.stores.splice(d,1),0!=this.stores.length||this.standalone||this.destroy())},setDirty:function(e){this.dirty!=e&&(this.dirty=!!e,this.trigger("dirtychange",this,e))},importData:function(e){var d={},g;if(e){for(g in e)d[g]=this.model.restoreField(this,g,e[g]);this.data=d}this.orig=f({},this.data);this.modified={};this.loaded=!0;this.setDirty(!1)},storeData:function(e){var d={},f;for(f in e)d[f]=this.model.storeField(this,f,e[f]);return d},getId:function(){return this.id},
getData:function(e){if(e){var d={},g,k;e="string"==typeof e?[e]:e;g=0;for(k=e.length;g<k;g++)d[e[g]]=this.data[e[g]];return d}return f({},this.data)},getChanged:function(){return f({},this.modified)},isChanged:function(e){return this.modified[e]||!1},get:function(e){return this.data[e]},setId:function(e){!this.id&&e&&(this.id=e)},set:function(e,d){var f=this.data[e];d=this.model.restoreField(this,e,d);this.data[e]=d;f!=d&&(this.modified[e]=!0,this.setDirty(!0),this.trigger("change",this,e,d,f),this.trigger("change-"+
e,this,e,d,f))},revert:function(){this.dirty&&(this.data=f({},this.orig),this.modified={},this.setDirty(!1))},load:function(){var e=this;e.trigger("beforeload",e);return e.model.loadRecord(e.id).done(function(d){e.setId(d.id);e.importData(d.data);e.trigger("load",e)}).fail(function(){e.trigger("failedload",e)})},save:function(e,d){var f=this;f.trigger("beforesave",f);return f.model.saveRecord(f,e,d).done(function(d){f.setId(d.id);f.importData(d.data);f.trigger("save",f)}).fail(function(d){f.trigger("failedsave",
f)})},"delete":function(){var e=this;e.trigger("beforedelete",e);return e.model.deleteRecord(e).done(function(){e.trigger("delete",e);e.destroy()}).fail(function(){e.trigger("faileddelete",e)})},reset:function(){this.id=null;this.data={};this.orig={};this.modified={};this.dirty=this.loaded=!1;this.trigger("reset",this)},destroy:function(){this.destroyed||(this.destroyed=!0,this.trigger("destroy",this),this.stores=this.model=this.modified=this.orig=this.data=null,l.removeFromCache(this.getClass(),
this.id),this.supr())}})})();
(function(){var l=0,m={},q=MetaphorJs.create,f=MetaphorJs.isArray,e=MetaphorJs.data.Record,d=MetaphorJs.data.Model,g=MetaphorJs.is,k=MetaphorJs.emptyFn,h=MetaphorJs.apply;MetaphorJs.d("MetaphorJs.data.Store","MetaphorJs.cmp.Base",{id:null,autoLoad:!1,clearOnLoad:!0,model:null,extraParams:null,loaded:!1,loading:!1,local:!1,items:null,map:null,keys:null,length:0,totalLength:0,start:0,pageSize:null,pages:null,filtered:!1,filterBackup:null,filterFn:null,filterScope:null,filterParams:null,initialize:function(a,
c,b){this.items=[];this.map={};this.keys=[];this.loaded=!1;this.extraParams=this.extraParams||{};a&&"string"!=typeof a&&(b=c,c=a,a=null);c=c||{};this.supr(c);this.id=this.id||++l;m[this.id]=this;"string"==typeof this.model?this.model=q(this.model):g(this.model,d)||(this.model=q("MetaphorJs.data.Model",this.model));if(a||c.url)this.model.store.load=a||c.url;!this.local&&this.autoLoad?this.load():b&&(f(b)?this.loadArray(b):this.loadAjaxData(b));this.local&&(this.loaded=!0)},getId:function(){return this.id},
isLoaded:function(){return this.loaded},isLocal:function(){return this.local},setLocal:function(a){this.local=!!a},isLoading:function(){return this.loading},isFiltered:function(){return this.filtered},getLength:function(){return this.length},getTotalLength:function(){return this.filtered?this.length:this.totalLength||this.length},getPagesCount:function(){return null!==this.pageSize?parseInt(this.totalLength/this.pageSize):1},setParam:function(a,c){this.extraParams[a]=c},getParam:function(a){return this.extraParams[a]},
setStart:function(a){this.start=a},setPageSize:function(a){this.pageSize=a},getAjaxData:function(){return this.ajaxData},hasDirty:function(){if(this.model.isPlain())return!1;var a=!1;this.each(function(c){return c.isDirty()?(a=!0,!1):!0});return a},getDirty:function(){var a=[];if(this.model.isPlain())return a;this.each(function(c){c.isDirty()&&a.push(c)});return a},getModel:function(){return this.model},importData:function(a){this.suspendAllEvents();for(var c=0;c<a.length;c++)this.add(a[c]);this.resumeAllEvents();
this.loaded=!0;this.loading=!1;this.onLoad();this.trigger("load",this)},load:function(a){var c=this,b=c.model.store,d=b.start,b=b.limit;if(c.local)return null;a=h({},c.extraParams,a||{});null===c.pageSize||a[d]||a[b]||(a[d]=c.start,a[b]=c.pageSize);return!1===c.trigger("beforeload",c)?null:c.model.loadStore(c,a).done(function(a){c.totalLength=parseInt(a.total);c.importData(a.data);c.totalLength=parseInt(a.total)}).fail(function(){c.onFailedLoad();c.trigger("failedload",c)})},onLoad:k,onFailedLoad:k,
save:function(){var a=this,c={},b=0;if(a.local)return null;if(a.model.isPlain())throw Error("Cannot save plain store");a.each(function(a){a.isDirty()&&(c[a.getId()]=a.storeData(a.getData()),b++)});if(!b)throw Error("Nothing to save");return!1===a.trigger("beforesave",a,c)?null:a.model.saveStore(a,c).done(function(b){var c,d,e=b.data;if(e&&e.length)for(b=0,c=e.length;b<c;b++)d=a.getRecordId(e[b]),(d=a.getById(d))&&d.importData(e[b]);a.onSave();a.trigger("save",a)}).fail(function(){a.onFailedSave();
a.trigger("failedsave",a)})},onSave:k,onFailedSave:k,deleteById:function(a){var c=this,b,d,g;if(c.local)return null;if(!a||f(a)&&!a.length)throw Error("Record id required");f(a)||(a=[a]);b=0;for(d=a.length;b<d;b++)g=c.getById(a[b]),g instanceof e?g.destroy():c.removeId(a[b]);return!1===c.trigger("beforedelete",c,a)?null:c.model.deleteRecords(c,a).done(function(){c.onDelete();c.trigger("delete",c,a)}).fail(function(){c.onFailedDelete();c.trigger("faileddelete",c,a)})},onDelete:k,onFailedDelete:k,deleteAt:function(a){var c=
this.getAt(a);if(!c)throw Error("Record not found at "+a);return this.deleteRecord(c)},"delete":function(a){return this.deleteById(this.getRecordId(a))},deleteRecords:function(a){var c=[],b,d;b=0;for(d=a.length;b<d;b++)c.push(this.getRecordId(a[b]));return this.deleteById(c)},loadAjaxData:function(a){var c=this;!1!==c.trigger("beforeload",c)&&c.model._processStoreResponse("load",a,{resolve:function(a,d){c.importData(a);c.totalLength=parseInt(d)},reject:function(){}})},loadArray:function(a,c){!1!==
this.trigger("beforeload",this)&&(!c&&this.clearOnLoad&&0<this.length&&this.clear(),f(a)&&(this.importData(a),this.totalLength=this.length))},loadOr:function(a,c){this.local||this.isLoading()||(this.isLoaded()?a&&a.call(c||this):this.load())},addNextPage:function(){!this.local&&this.length<this.totalLength&&this.load({start:this.length,limit:this.pageSize},!0)},loadNextPage:function(){this.local||(this.start+=this.pageSize,this.load())},loadPrevPage:function(){this.local||(this.start-=this.pageSize,
this.load())},getRecordId:function(a){return a instanceof e?a.getId():a[this.model.getStoreProp("load","id")]||null},processRawDataItem:function(a){if(a instanceof e||this.model.isPlain())return a;var c=this.model.type,b=this.getRecordId(a),f;b&&(f=d.getFromCache(c,b));f||(f=q(c,b,a,{model:this.model,standalone:!1}));return f},bindRecord:function(a,c){c[a]("change",this.onRecordChange,this);c[a]("destroy",this.onRecordDestroy,this);c[a]("dirtychange",this.onRecordDirtyChange,this);return c},onRecordDirtyChange:function(a){this.trigger("update",
this,a)},onRecordChange:function(a,c,b,d){this.trigger("update",this,a)},onRecordDestroy:function(a){this.remove(a)},add:function(a,c,b){if(this.filtered)throw"Cannot add to filtered store";if("string"!=typeof a&&"number"!=typeof a){c=a;if(f(c)){if(!c.length)return;a=this.length;for(var d=0,g=c.length;d<g;d++)c[d]=this.processRawDataItem(c[d]),this.add(this.getRecordId(c[d]),c[d],!0);this.onAdd(a,c);b||this.trigger("add",a,c);return}c=this.processRawDataItem(c);a=this.getRecordId(c)}if("undefined"!=
typeof a&&null!==a){if("undefined"!=typeof this.map[a]){this.replace(a,c);return}this.map[a]=c}this.length++;this.items.push(c);this.keys.push(a);c instanceof e&&(c.attachStore(this),this.bindRecord("on",c));this.onAdd(this.length-1,[c]);b||this.trigger("add",this.length-1,[c])},onAdd:k,removeAt:function(a){if(a<this.length&&0<=a){this.length--;this.totalLength--;var c=this.items[a];this.items.splice(a,1);var b=this.keys[a];"undefined"!=typeof b&&delete this.map[b];this.keys.splice(a,1);this.onRemove(c,
b);this.trigger("remove",c,b);return c instanceof e?(this.bindRecord("un",c),c.detachStore(this),null):c}return!1},onRemove:k,insert:function(a,c,b,d){if(this.filtered)throw Error("Cannot insert into filtered store");2==arguments.length&&(b=arguments[1],c=this.getRecordId(b));b=this.processRawDataItem(b);this.containsId(c)&&(this.suspendAllEvents(),this.removeId(c),this.resumeAllEvents());if(a>=this.length)return this.add(c,b,d);this.length++;this.items.splice(a,0,b);"undefined"!=typeof c&&null!==
c&&(this.map[c]=b);this.keys.splice(a,0,c);b instanceof e&&(b.attachStore(this),this.bindRecord("on",b));this.onAdd(a,[b]);d||this.trigger("add",a,[b]);return b},replace:function(a,c){var b,d;1==arguments.length&&(c=arguments[0],a=this.getRecordId(c));c=this.processRawDataItem(c);b=this.map[a];if("undefined"==typeof a||null===a||"undefined"==typeof b)return this.add(a,c);b instanceof e&&(this.bindRecord("un",b),b.detachStore(this));d=this.indexOfId(a);this.items[d]=c;this.map[a]=c;c instanceof e&&
(this.bindRecord("on",c),c.attachStore(this));this.onReplace(a,b,c);this.trigger("replace",a,b,c);return c},onReplace:k,remove:function(a){return this.removeAt(this.indexOf(a))},removeId:function(a){return this.removeAt(this.indexOfId(a))},contains:function(a){return-1!=this.indexOf(a)},containsId:function(a){return"undefined"!=typeof this.map[a]},clear:function(){var a=this.getRange();this.clearFilter(!0);this._reset();this.onClear();this.trigger("clear",a)},onClear:k,reset:function(){this._reset()},
_reset:function(a){var c,b;if(!a)for(a=0,c=this.items.length;a<c;a++)b=this.items[a],b instanceof e&&(this.bindRecord("un",b),b.detachStore(this));this.totalLength=this.length=this.start=0;this.items=[];this.keys=[];this.map={};this.loaded=this.local},filter:function(a,c,b){this.filtered&&this.clearFilter(!0);this.filtered=!0;this.filterFn=a;this.filterScope=c;this.filterParams=b;this.trigger("beforefilter",this);this.suspendAllEvents();this.filterBackup={length:this.length,items:this.items,keys:this.keys,
map:this.map};this._reset(!0);a=this.filterBackup.keys;c=this.filterBackup.items;b=0;for(var d=c.length;b<d;b++)this._filterRecord(c[b],a[b])&&(this.items.push(c[b]),this.keys.push(a[b]),this.length++,this.map[a[b]]=c[b]);this.resumeAllEvents();this.onFilter();this.trigger("filter",this)},onFilter:k,_filterRecord:function(a,c){return this.filtered&&this.filterFn.call(this.filterScope,a,c,this.filterParams)},clearFilter:function(a){this.filtered&&(a||this.trigger("beforeclearfilter",this),this.suspendAllEvents(),
this.filtered=!1,this._reset(!0),this.length=this.filterBackup.length,this.items=this.filterBackup.items,this.keys=this.filterBackup.keys,this.map=this.filterBackup.map,this.filterBackup=null,this.resumeAllEvents(),this.onClearFilter(),a||this.trigger("clearfilter",this))},onClearFilter:k,getAt:function(a){return this.items[a]||null},getById:function(a){return this.map[a]||null},indexOf:function(a){return this.items.indexOf(a)},indexOfId:function(a){return this.keys.indexOf(a)},each:function(a,c){var b=
[].concat(this.items);c=c||window;for(var d=0,e=b.length;d<e&&!1!==a.call(c,b[d],d,e);d++);},eachId:function(a,c){c=c||window;for(var b=0,d=this.keys.length;b<d;b++)a.call(c,this.keys[b],this.items[b],b,d)},collect:function(a){var c=[],b=!this.model.isPlain();this.each(function(d){(d=b?d.get(a):d[a])&&c.push(d)});return c},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},getRange:function(a,c){var b=this.items;if(1>b.length)return[];a=a||0;c=Math.min("undefined"==
typeof c||null===c?this.length-1:c,this.length-1);var d,e=[];if(a<=c)for(d=a;d<=c;d++)e[e.length]=b[d];else for(d=a;d>=c;d--)e[e.length]=b[d];return e},findBy:function(a,c,b){a=this.findIndexBy(a,c,b);return-1==a?null:this.getAt(a)},findIndexBy:function(a,c,b){c=c||this;var d=this.keys,e=this.items;b=b||0;for(var f=e.length;b<f;b++)if(a.call(c,e[b],d[b]))return b;return-1},find:function(a,c,b){var d=!this.model.isPlain(),e;return this.findIndexBy(function(f){e=d?f.get(a):f[a];return b?e===c:e==c},
this)},findExact:function(a,c){return this.find(a,c,!0)},findBySet:function(a){var c=null,b,d;this.each(function(e){b=!0;for(d in a)if(a[d]!=e[d]){b=!1;break}return b?(c=e,!1):!0});return c},onDestroy:function(){delete m[this.id];this.clear();this.supr()}},{createFromSelect:function(a){var c=[];a=a.options;for(var b=0,d=a.length;b<d;b++){var e=a[b],f=(e.hasAttribute?e.hasAttribute("value"):e.getAttributeNode("value").specified)?e.value:e.text;c.push([f,e.text])}a=q("MetaphorJs.data.Store",{server:{load:{id:0}}});
a.loadArray(c);return a},lookupStore:function(a){return m[a]||null},eachStore:function(a,c){for(var b in m)if(!1===a.call(c||window,m[b]))break}})})();
(function(){var l={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},m=["Moz","Webkit","ms","O","Khtml"],q="animationDelay",f="animationDuration",e="transitionDelay",d="transitionDuration",g=0,k=function(){var a=document.createElement("div"),b=!1,c,g,k;if(void 0!==a.style.animationName)b=!0;else for(g=0,k=m.length;g<k;g++)if(c=m[g],void 0!==a.style[c+"AnimationName"]){b=!0;q=c+"AnimationDelay";f=c+"AnimationDuration";e=c+"TransitionDelay";d=c+"TransitionDuration";
break}return b}(),h=window.requestAnimationFrame?window.requestAnimationFrame:function(a){window.setTimeout(a,0)},a=MetaphorJs.g,c=MetaphorJs.lib.Promise,b=MetaphorJs.data,n=MetaphorJs.isThenable,u=function(a,b,c){var d=function(){(new Date).getTime()-b>=c?a():h(d)};h(d)},s=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},t=function(a,b,c){var d,e,f=b.length;for(d=0;d<f;d++)e=s(b[d])+s(c[d]),a=Math.max(e,a);return a},v=function D(a,c,g,k,l,m,s){var B=function(){var c=
b(a,"mjsAnimationQueue");return c&&c.length&&c[0].id==s?!1:(l.reject(a),!0)},x=function(){if(!B()){var d=g;g++;if(g==c.length){l.resolve(a);b(a,"mjsAnimationQueue").shift();var e=b(a,"mjsAnimationQueue");e.length?(e=e[0],v(e.el,e.stages,0,e.start,e.deferred,!1,e.id)):b(a,"mjsAnimationQueue",null)}else b(a,"mjsAnimationQueue")[0].position=g,D(a,c,g,null,l);w(a,c[d]);w(a,c[d]+"-active")}},F=function(){if(!B()){A(a,c[g]+"-active");var b,k=window.getComputedStyle?window.getComputedStyle(a):a.style;b=
0;var r=(k[f]||"").split(","),G=(k[q]||"").split(","),h=(k[d]||"").split(","),k=(k[e]||"").split(",");b=Math.max(b,t(b,r,G));(b=Math.max(b,t(b,h,k)))?u(x,(new Date).getTime(),b):x()}},H=function(){if(!B()){A(a,c[g]);var b;k&&(b=k(a),k=null);n(b)?b.done(F):h(F)}};m?h(H):H()},A=MetaphorJs.addClass,w=MetaphorJs.removeClass;MetaphorJs.stopAnimation=function(a){var c=b(a,"mjsAnimationQueue"),d;c&&c.length&&(d=c[0])&&d.stages&&(c=d.position,d=d.stages,w(a,d[c]),w(a,d[c]+"-active"));b(a,"mjsAnimationQueue",
null)};MetaphorJs.animate=function(d,e,f){var h=d.getAttribute("mjs-animate"),w=d.getAttribute("mjs-animate-js"),m=new c,q=b(d,"mjsAnimationQueue")||[],s=++g,u,t;e&&"string"==typeof e&&(e=l[e]);"string"==typeof h&&h&&"["==h.substr(0,1)&&(e=(new Function("","return "+h))(),h=null);q.push({el:d,stages:e,start:f,deferred:m,position:0,id:s});b(d,"mjsAnimationQueue",q);void 0!=h&&k&&e?1==q.length&&v(d,e,0,f,m,!0,s):(u=w||h)&&(t=a("animate."+u,!0))?t(d,f,m):f?(e=f(d),n(e)?e.done(function(){m.resolve(d)}):
m.resolve(d)):m.resolve(d);return m.promise()}})();
(function(){var l=MetaphorJs.lib.Observable,m=MetaphorJs.lib.Watchable,q=MetaphorJs.apply,f;f=MetaphorJs.d("MetaphorJs.view.Scope",{$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$checking:!1,$$destroyed:!1,initialize:function(e){this.$$observable=new l;q(this,e);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)},$new:function(){return new f({$parent:this,$root:this.$root})},
$on:function(e,d,f){return this.$$observable.on(e,d,f)},$un:function(e,d,f){return this.$$observable.un(e,d,f)},$watch:function(e,d,f){m.create(this,e,d,f,null)},$unwatch:function(e,d,f){m.unsubscribeAndDestroy(this,e,d,f)},$get:function(e){for(var d=this;d;){if(void 0!=d[e])return d[e];d=d.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$check:function(){var e;this.$$checking||(this.$$checking=!0,this.$$watchers&&(e=this.$$watchers.$checkAll()),this.$$checking=
!1,this.$$destroyed||this.$$observable.trigger("check",e))},$destroy:function(){this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);this.$$destroyed=!0}})})();
(function(){var l=navigator.userAgent.toLowerCase(),m=parseInt((/msie (\d+)/.exec(l)||[])[1],10),q=parseInt((/android (\d+)/.exec(l)||[])[1],10),f={};isNaN(m)&&(m=parseInt((/trident\/.*; rv:(\d+)/.exec(l)||[])[1],10));MetaphorJs.browser={android:q,hasEvent:function(e){if("input"==e&&9==m)return!1;if(void 0===f[e]){var d=document.createElement("div");f[e]="on"+e in d}return f[e]}}})();
(function(){var l=MetaphorJs.nextUid,m=MetaphorJs.view.Scope,q=MetaphorJs.lib.Watchable,f=MetaphorJs.lib.Observable,e=MetaphorJs.isThenable,d=MetaphorJs.toArray,g=MetaphorJs.getAttributeHandlers,k=null,h=MetaphorJs.g,a=MetaphorJs.trim,c=q.create,b=q.unsubscribeAndDestroy,n,u="string"==typeof document.createTextNode("").textContent?"textContent":"nodeValue",s=function(a,b,c,e,f){var g=[];if(a&&!0!==a){if(a.nodeType){v(a,c,e,f);return}g=d(a)}g.length||(g=d(b.childNodes));a=-1;for(b=g.length>>>0;++a!==
b;v(g[a],c,e,f));},t=/^(script|template|mjs-template|style)$/i,v=function(a,b,c,d){var f;a.nodeName.match(t)||!1!==(f=b.call(c,a,d))&&(e(f)?f.done(function(e){s(e,a,b,c,d)}):s(f,a,b,c,d))},A=new f;n=MetaphorJs.d("MetaphorJs.view.Renderer",{id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,initialize:function(a,b,c){this.id=l();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof m&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",this.destroy,this);this.process()},
on:function(a,b,c){return A.on(a+"-"+this.id,b,c)},un:function(a,b,c){return A.un(a+"-"+this.id,b,c)},createChild:function(a){return new n(a,this.scope,this)},reset:function(){},getEl:function(){return this.el},runHandler:function(a,b,c,d){var e;if(a.$breakRenderer)return this.createChild(c).render(),!1;a.$isolateScope?e=new m:a.$breakScope?b instanceof m?e=b.$new():(e={},e.$parent=b,e.$root=b.$root):e=b;return a.__isMetaphorClass?(b=new a(e,c,d,this),a.$stopRenderer||b.$stopRenderer?!1:b.$returnToRenderer):
a(e,c,d,this)},processNode:function(a,b){var c=a.nodeType,d=this.texts,e=this.scope,f;if(3==c)e={watchers:[],node:a,text:"",inx:f=d.length},this.processText(e,a[u]),0<e.watchers.length&&(d.push(e),b&&this.renderText(f));else if(1==c){k||(k=g());var n=a.attributes,l,m,q,s,c="tag."+a.tagName.toLowerCase();if(l=h(c,!0))if((s=this.runHandler(l,e,a))||!1===s)return s;l=0;for(m=k.length;l<m;l++)if(q=k[l].name,null!==(f=a.getAttribute(q))&&"undefined"!=typeof f&&(s=this.runHandler(k[l].handler,e,a,f),a.removeAttribute(q),
s||!1===s))return s;l=0;for(m=n.length;l<m;l++)h(c,!0)||(e={watchers:[],node:a,attr:n[l].name,text:"",inx:f=d.length},this.processText(e,n[l].value),0<e.watchers.length&&(d.push(e),b&&this.renderText(f)))}return!0},process:function(){v(this.el,this.processNode,this)},processText:function(a,b){for(var c=0,d=b.length,e,f,g=[];c<d;)if(-1!=(e=b.indexOf("{{",c))&&-1!=(f=b.indexOf("}}",e+2)))g.push(b.substring(c,e)),g.push(this.watcherMatch(a,b.substring(e+2,f))),c=f+2;else{c!==d&&g.push(b.substring(c));
break}return a.text=g.join("")},processPipes:function(b,c){for(var d=0,e=b.length,f,g,k,h=!1,l=b;d<e;)if(-1!=(f=b.indexOf("|",d)))g=b.charAt(f-1),k=b.charAt(f+1),"|"!=g&&"'"!=g&&'"'!=g&&"|"!=k&&"'"!=k&&'"'!=k&&(h?(d=a(b.substring(d,f)).split(":"),c.push([d[0],d.slice(1)])):(h=!0,l=a(b.substring(0,f)))),d=f+1;else{h&&(d=a(b.substr(d)).split(":"),c.push([d[0],d.slice(1)]));break}return l},watcherMatch:function(a,b){var d=a.watchers;d.push({watcher:c(this.scope,b,this.onDataChange,this,a.inx)});return"---"+
(d.length-1)+"---"},onDataChange:function(a,b,c){this.renderText(c)},render:function(){var a=this.texts.length,b;for(b=0;b<a;b++)this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.text,c=a.watchers,d=c.length,e=a.attr,f,g;for(f=0;f<d;f++)g=c[f].watcher.getLastResult(),b=b.replace("---"+f+"---",g);e?(a.node.setAttribute(e,b),"value"==e&&(a.node.value=b),"class"==e&&(a.node.className=b)):a.node[u]=b},destroy:function(){var a=this.texts,c,d,e,f,g;if(!this.destroyed){this.destroyed=!0;
d=0;for(e=a.length;d<e;d++)for(c=a[d].watchers,f=0,g=c.length;f<g;f++)b(this.scope,c[f].watcher.code,this.onDataChange,this);this.parent&&this.parent.un("destroy",this.destroy,this);A.trigger("destroy-"+this.id);this.parent=this.scope=this.el=this.texts=null}}},{eachNode:v});MetaphorJs.onReady(function(){var a=MetaphorJs.app;if(document.querySelectorAll)for(var b=document.querySelectorAll("[mjs-app]"),c=-1,d=b.length;++c<d;a(b[c]));else v(document.documentElement,function(b){if(b.hasAttribute("mjs-app"))return a(b),
!1})})})();
(function(){var l={},m=MetaphorJs.nextUid,q=MetaphorJs.getTemplate,f=MetaphorJs.view.Renderer,e=MetaphorJs.data,d=MetaphorJs.toFragment,g=MetaphorJs.isThenable,k=MetaphorJs.emptyFn,h=function(a){return l[a]||null};MetaphorJs.define("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,rendered:!1,hidden:!1,destroyEl:!0,renderer:null,scope:null,template:null,tag:null,initPromise:null,initialize:function(a){this.supr(a);a.as&&(this.scope[a.as]=this);this.node&&
(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);this.id=this.id||"cmp-"+m();l[this.id]=this;var c=this.initComponent.apply(this,arguments);g(c)?(this.initPromise=c,this.node&&(this.node.style.visibility="hidden"),c.done(this.finishInitialize,this)):this.finishInitialize()},finishInitialize:function(){this.initPromise=null;this.node&&(this.node.style.visibility="");this.node?this.template&&this._applyTemplate():this._createNode();this._initElement();!this.node.parentNode&&this.renderTo?
this.render(this.renderTo):this.node&&this.render()},_createNode:function(){var a,c;this.tag?this.node=document.createElement(this.tag):(c=q(this.template)||this.template,"string"==typeof c&&(a=document.createElement("div"),a.innerHTML=c,c=d(a.childNodes)),1==c.childNodes.length?this.node=c.firstChild.cloneNode(!0):(this.node=document.createElement("div"),this.node.appendChild(c.cloneNode(!0))))},_applyTemplate:function(){var a=this.node,c=q(this.template)||this.template,b;"string"==typeof c?(b=document.createElement("div"),
b.innerHTML=c,c=d(b.childNodes)):c=MetaphorJs.clone(c);a.firstChild&&e(this.node,"mjs-transclude",d(a.childNodes));a.appendChild(c)},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display="none");this.renderer=new f(this.node,this.scope);this.renderer.render()},render:function(a){this.rendered||(a&&a.appendChild(this.node),this.hidden=!MetaphorJs.isVisible(this.node),this.rendered=!0,this.trigger("render",this),this.afterRender(),
this.trigger("afterrender",this))},show:function(){this.hidden&&!1!==this.trigger("beforeshow",this)&&(this.node.style.display="block",this.hidden=!1,this.onShow(),this.trigger("show",this))},hide:function(){this.hidden||!1===this.trigger("beforehide",this)||(this.node.style.display="none",this.hidden=!0,this.onHide(),this.trigger("hide",this))},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},
initComponent:k,afterRender:k,onShow:k,onHide:k,onDestroy:function(){this.destroyEl?(console.log("destroy"),this.node.parentNode&&this.node.parentNode.removeChild(this.node)):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.rendered&&(this.renderer.destroy(),delete this.renderer);this.scope.$destroy();delete this.scope;delete this.node;this.supr();delete l[this.id]}});MetaphorJs.getCmp=h;window.jQuery&&(jQuery.fn.createCmp=function(a,c){var b=null;a&&"string"!=
typeof a&&(c=a,a=null);a=a||"MetaphorJs.cmp.Component";c=c||{};this.each(function(){var d=$(this).attr("cmp-id");if(d)return b=h(d),!1;c.node=this;b=MetaphorJs.create(a,c);return!1});return b},jQuery.fn.getCmp=function(){return h(this.attr("cmp-id"))},jQuery.fn.getParentCmp=function(){if(this.attr("cmp-id"))return MetaphorJs.getCmp(this.attr("cmp-id"));var a=this.parents("[cmp-id]").eq(0);return a.length?MetaphorJs.getCmp(a.attr("cmp-id")):null})})();
(function(){var l=MetaphorJs.data,m=MetaphorJs.currentUrl,q=MetaphorJs.toFragment,f=MetaphorJs.ns.get,e=MetaphorJs.animate,d=MetaphorJs.lib.Scope,g=MetaphorJs.apply,k=MetaphorJs.stopAnimation;MetaphorJs.define("MetaphorJs.cmp.View",{route:null,node:null,scope:null,currentComponent:null,initialize:function(d){g(this,d,!0);MetaphorJs.on("locationchange",this.onLocationChange,this);d=this.node;d.firstChild&&l(d,"mjs-transclude",q(d.childNodes));this.onLocationChange()},onLocationChange:function(){var d=
m(),a=this.route,c,b,e,f;c=0;for(b=a.length;c<b;c++)if(e=a[c],f=d.match(e.reg)){this.changeComponent(e,f);return}this.clearComponent()},changeComponent:function(d,a){k(this.node);this.clearComponent();this.setComponent(d,a)},clearComponent:function(){var d=this,a=d.node;d.currentComponent&&e(a,"leave").done(function(){d.currentComponent.destroy();for(d.currentComponent=null;a.firstChild;)a.removeChild(a.firstChild)})},setComponent:function(g,a){var c=this,b=c.node;e(b,"enter",function(){var e=f(g.cmp||
"MetaphorJs.cmp.Component"),k={destroyEl:!1,node:b,scope:g.isolateScope?new d:c.scope.$new()};g.template&&(k.template=g.template);a.shift();a.unshift(k);c.currentComponent=e.__instantiate.apply(null,a);return c.currentComponent.initPromise})}})})();
(function(){var l=MetaphorJs.view.Scope,m=MetaphorJs.trim,q=MetaphorJs.bind,f=MetaphorJs.define,e=MetaphorJs.ns.get,d=MetaphorJs.lib.Watchable,g=MetaphorJs.view.Renderer,k=MetaphorJs.lib.Promise,h=MetaphorJs.data,a=MetaphorJs.toArray,c=MetaphorJs.toFragment,b=MetaphorJs.addListener,n=MetaphorJs.removeListener,u=MetaphorJs.normalizeEvent,s=MetaphorJs.registerAttributeHandler,t=MetaphorJs.registerTagHandler,v=MetaphorJs.async,A=d.create,w=d.createGetter,y=MetaphorJs.animate,D=d.isExpression,z=MetaphorJs.ajax,
C=d.eval,I=MetaphorJs.addClass,E=MetaphorJs.removeClass,J=MetaphorJs.hasClass,K=MetaphorJs.stopAnimation,L=MetaphorJs.isArray,B=function(a,b){for(var c;a;){c=h(a,b);if(void 0!=c)return c;a=a.parentNode}};MetaphorJs.d("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,initialize:function(a,b,c){c=m(c);this.node=b;this.expr=c;this.scope=a;this.watcher=A(a,c);this.watcher.addListener(this.onChange,this);this.onChange();a instanceof l&&a.$on("destroy",this.onScopeDestroy,
this)},onScopeDestroy:function(){delete this.node;delete this.scope;this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)},onChange:function(){}});s("mjs-bind",1E3,f(null,"MetaphorJs.view.AttributeHandler",{isInput:!1,initialize:function(a,b,c){var d=b.tagName.toLowerCase();this.isInput="input"==d||"textarea"==d;this.supr(a,b,c)},onChange:function(){var a=this.watcher.getLastResult();this.isInput?this.node.value=a:this.node.textContent=a}}));s("mjs-bind-html",
1E3,f(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.node.innerHTML=this.watcher.getLastResult()}}));s("mjs-model",1E3,f(null,"MetaphorJs.view.AttributeHandler",{inProg:!1,type:null,inputType:null,radio:null,listeners:null,initialize:function(a,b,c){var d;this.node=b;this.inputType=d=b.getAttribute("mjs-input-type")||b.type.toLowerCase();this.listeners=[];this.onRadioInputChangeDelegate=q(this.onRadioInputChange,this);this.onCheckboxInputChangeDelegate=q(this.onCheckboxInputChange,
this);"radio"==d?this.initRadioInput():"checkbox"==d?this.initCheckboxInput():this.initTextInput();this.supr(a,b,c)},onScopeDestroy:function(){var a=this.type,b=this.listeners,c=this.radio,d,e,f,g;d=0;for(e=b.length;d<e;d++)if("radio"==a)for(f=0,g=c.length;f<g;f++)n(c[f],b[d][0],b[d][1]);else n(this.node,b[d][0],b[d][1]);delete this.radio;this.supr()},initRadioInput:function(){var c,d,e;this.radio=c=a(document.querySelectorAll("input[name="+this.node.name+"]"));this.listeners.push(["click",this.onRadioInputChangeDelegate]);
d=0;for(e=c.length;d<e;d++)b(c[d],"click",this.onRadioInputChangeDelegate)},initCheckboxInput:function(){this.listeners.push(["click",this.onCheckboxInputChangeDelegate]);b(this.node,"click",this.onCheckboxInputChangeDelegate)},initTextInput:function(){var a=MetaphorJs.browser,c=!1,d=this,e=d.node,f=d.listeners,g;if(!a.android){var k=function(){c=!0},h=function(){c=!1;l()};f.push(["compositionstart",k]);f.push(["compositionend",h]);b(e,"compositionstart",k);b(e,"compositionend",h)}var l=d.onTextInputChangeDelegate=
function(){if(!c)d.onTextInputChange()};if(a.hasEvent("input"))f.push(["input",l]),b(e,"input",l);else{var m=function(a){g||(g=window.setTimeout(function(){l(a);g=null},0))},k=function(a){a=a||window.event;var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||m(a)};f.push(["keydown",k]);b(e,"keydown",k);a.hasEvent("paste")&&(f.push(["paste",m]),f.push(["cut",m]),b(e,"paste",m),b(e,"cut",m))}f.push(["change",l]);b(e,"change",l)},onTextInputChange:function(){var a=this.node.value,b=this.scope;switch(this.inputType){case "number":a=
parseInt(a,10)}this.watcher.setValue(a);this.inProg=!0;b instanceof l?b.$root.$check():this.watcher.checkAll();this.inProg=!1},onCheckboxInputChange:function(){var a=this.node,b=this.scope;this.watcher.setValue(a.checked?a.getAttribute("value")||!0:!1);this.inProg=!0;b instanceof l?b.$root.$check():this.watcher.checkAll();this.inProg=!1},onRadioInputChange:function(a){a=a||window.event;a=u(a);var b=this.scope;this.watcher.setValue(a.target.value);this.inProg=!0;b instanceof l?b.$root.$check():this.watcher.checkAll();
this.inProg=!1},onChange:function(){var a=this.watcher.getLastResult(),b=this.inputType,c,d;if(!this.inProg)if("radio"==b)for(d=this.radio,b=0,c=d.length;b<c;b++){if(d[b].value==a){d[b].checked=!0;break}}else"checkbox"==b?(b=this.node,b.checked=!0===a||a==b.value):MetaphorJs.setValue(this.node,a)}}));s("mjs-show",500,f(null,"MetaphorJs.view.AttributeHandler",{display:null,initial:!0,initialize:function(a,b,c){this.display=b.style.display||"block";"none"==this.display&&(this.display="block");this.supr(a,
b,c)},runAnimation:function(a){var b=this.node.style,c=this.display,d=function(){b.display=a?c:"none"};this.initial?d():y(this.node,a?"show":"hide",function(){a&&(b.display=c)}).done(d)},onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));s("mjs-hide",500,f(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(!a);this.initial=!1}}));s("mjs-if",500,f(null,"MetaphorJs.view.AttributeHandler",{parentEl:null,prevEl:null,
el:null,initial:!0,initialize:function(a,b,c){this.parentEl=b.parentNode;this.prevEl=b.previousSibling;this.supr(a,b,c)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,d=a.node,e=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},f=function(){c.removeChild(d)};b?d.parentNode||(a.initial?e():y(d,"enter",e)):d.parentNode&&(a.initial?f():y(d,"leave").done(f));
a.initial=!1}}));s("mjs-each",100,f(null,"MetaphorJs.view.AttributeHandler",{model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.watcher=A(a,this.model);this.watcher.addListener(this.onChange,this);this.parentEl.removeChild(b);
this.render(this.watcher.getValue())},onScopeDestroy:function(){var a=this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.supr()},doUpdate:function(a,b){for(var c=this.renderers,d=b,e=c.length,f=e-1,k=!(d%2),h,l;d<e;d++)h=c[d],l=h.scope,l.$index=d,l.$first=0===d,l.$last=d===f,l.$even=k,l.$odd=!k,k=!k,h.renderer?l.$check():(h.renderer=new g(h.el,h.scope),h.renderer.render())},render:function(a){var b=
this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,f=document.createDocumentFragment(),g,k,h;k=0;for(h=a.length;k<h;k++)g=c.cloneNode(!0),f.appendChild(g),b.push(this.createItem(g,a,k));d.insertBefore(f,e);this.doUpdate(a,0)},createItem:function(a,b,c){var d=this.itemName,e=this.scope,e=e instanceof l?e.$new():{$parent:e,$root:e.$root};e[d]=b[c];return{el:a,scope:e}},onChange:function(a){var b=this,c=b.renderers;a=a.prescription;var d=b.tpl,e=0,f=b.parentEl,g=b.watcher.getValue(),k=null,h,m,
n,p;m=0;for(n=a.length;m<n;m++)p=a[m],"-"==p?(c[e].scope.$index=e,e++):(null===k&&(k=0<m?m-1:0),"I"!=p&&c[e]&&(h=c[e],h.scope instanceof l&&h.scope.$destroy(),h.renderer.destroy(),y(h.el,"leave").done(function(a){a.parentNode&&a.parentNode.removeChild(a)})),"D"==p?c.splice(e,1):(h=d.cloneNode(!0),y(h,"enter",function(a){return function(d){0<a?f.insertBefore(d,c[a-1].el.nextSibling):b.prevEl?f.insertBefore(d,b.prevEl.nextSibling):f.appendChild(d)}}(e)),"R"==p?c[m]=b.createItem(h,g,e):"I"==p&&(m<c.length?
c.splice(m,0,b.createItem(h,g,e)):c.push(b.createItem(h,g,e))),e++));b.doUpdate(g,k)},parseExpr:function(a){a=a.split(" ");var b,c,d,e,f;b=0;for(c=a.length;b<c;b++)if(f=a[b],""!=f&&"in"!=f)if(e){d=a.slice(b).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"}},{$stopRenderer:!0}));s("mjs-each-in-store",100,f(null,"attr.mjs-each",{store:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each-in-store");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=
b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.store=a=w(this.model)(a);this.parentEl.removeChild(b);this.initWatcher();this.render(this.watcher.getValue());v(this.bindStore,this,[a,"on"])},onScopeDestroy:function(){this.bindStore(this.store,"un");delete this.store;this.supr()},initWatcher:function(){this.watcher=A(this.store,".items",null);this.watcher.addListener(this.onChange,this)},resetWatcher:function(){this.watcher.setValue(this.store.items)},
bindStore:function(a,b){a[b]("load",this.onStoreUpdate,this);a[b]("update",this.onStoreUpdate,this);a[b]("add",this.onStoreUpdate,this);a[b]("remove",this.onStoreUpdate,this);a[b]("replace",this.onStoreUpdate,this);a[b]("filter",this.onStoreFilter,this);a[b]("clearfilter",this.onStoreFilter,this);a[b]("clear",this.onStoreClear,this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},onStoreFilter:function(){this.resetWatcher();this.onStoreUpdate()},onStoreClear:function(){this.resetWatcher();
this.onStoreUpdate()},onStoreDestroy:function(){this.onStoreClear();this.watcher.unsubscribeAndDestroy(this.onChange,this);delete this.watcher}},{$stopRenderer:!0}));var x=MetaphorJs.getTemplate;s("mjs-include",900,f(null,{watcher:null,scope:null,node:null,expr:null,tpl:null,renderer:null,$stopRenderer:!1,initial:!0,initialize:function(a,b,d,e){var f=this;f.node=b;f.scope=a;b.firstChild&&h(b,"mjs-transclude",c(b.childNodes));b.removeAttribute("mjs-include");D(d)?(f.watcher=A(a,d,f.onChange,f),f.$stopRenderer=
!0,f.$returnToRenderer=f.onChange(),e.on("destroy",f.onParentRendererDestroy,f)):(d=C(d),e=x(d),f.$returnToRenderer=e?f.applyTemplate(b,e):z(d,{dataType:"fragment"}).then(function(a){return f.applyTemplate(b,a)}));a instanceof l&&a.$on("destroy",f.onScopeDestroy,f)},onChange:function(){var a=this,b=a.watcher.getLastResult();a.renderer&&a.renderer.destroy();return a.applyTemplate(a.node,x(b)).done(function(){a.renderer=new g(a.node,a.scope);a.renderer.render()})},applyTemplate:function(a,b){var c=
new k,d=function(){for(;a.firstChild;)a.removeChild(a.firstChild);b&&a.appendChild(MetaphorJs.clone(b));c.resolve()};this.initial?d():(y(a,"leave").done(d),y(a,"enter"));this.initial=!1;return c.promise()},onParentRendererDestroy:function(){this.renderer.destroy();this.destroy();delete this.renderer},onScopeDestroy:function(){this.destroy();delete this.renderer},destroy:function(){delete this.node;delete this.scope;this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher);
delete this.tpl}}));t("mjs-include",900,function(b,d){var e=d.getAttribute("src"),e=C(e,b),f=x(e);d.firstChild&&h(d,"mjs-transclude",c(d.childNodes));var g=function(){var b=d.parentNode,c=d.nextSibling,e=MetaphorJs.clone(f),g=a(e.childNodes),h=new k;b.removeChild(d);b.insertBefore(e,c);y(d,"enter").done(function(){h.resolve(g)});return h.promise()};return f?g():z(e,{dataType:"fragment"}).then(function(a){f=a;return g()})});s("mjs-transclude",1E3,function(b,d){var e=B(d,"mjs-transclude");if(e){d.firstChild&&
h(d,"mjs-transclude",c(d.childNodes));var f=d.parentNode,g=d.nextSibling,e=MetaphorJs.clone(e),k=a(e.childNodes);f.removeChild(d);f.insertBefore(e,g);return k}});t("mjs-transclude",900,function(b,d){var e=B(d,"mjs-transclude");if(e){d.firstChild&&h(d,"mjs-transclude",c(d.childNodes));var f=d.parentNode,g=d.nextSibling,e=MetaphorJs.clone(e),k=a(e.childNodes);f.removeChild(d);f.insertBefore(e,g);return k}});var F=function(a,b,c,d){if(null!==c){if(c==J(a,b))return;c=!c}else c=J(a,b);c?d?y(a,[b+"-remove"]).done(function(){E(a,
b)}):E(a,b):d?y(a,[b+"-add"]).done(function(){I(a,b)}):I(a,b)};s("mjs-class",1E3,f(null,"MetaphorJs.view.AttributeHandler",{initial:!0,onChange:function(){var a=this.node,b=this.watcher.getLastResult(),c;K(a);if("string"==typeof b)F(a,b,null,!this.initial);else if(L(b)){var d;c=-1;for(d=b.length;++c<d;F(a,b[c],!0,!this.initial));}else for(c in b)F(a,c,b[c]?!0:!1,!this.initial);this.initial=!1}}));var t="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste enter".split(" "),
H,M=d.createFunc,d=0;for(H=t.length;d<H;d++)(function(a){var c=a;"enter"==c&&(c="keyup");s("mjs-"+a,1E3,function(d,e,f){var g=M(f);b(e,c,function(b){b=b||window.event;b=u(b);if("enter"==a&&13!=b.keyCode)return null;d.$event=b;g(d);delete d.$event;d instanceof l?d.$root.$check():d.$$watchers&&d.$$watchers.$checkAll();b.preventDefault();return!1})})})(t[d]);t="selected checked disabled readonly required open".split(" ");d=0;for(H=t.length;d<H;d++)(function(a){s("mjs-"+a,1E3,f(null,"MetaphorJs.view.AttributeHandler",
{onChange:function(){this.watcher.getLastResult()?this.node.setAttribute(a,!0):this.node.removeAttribute(a)}}))})(t[d]);t=function(a,b,c){var d,f,g,k,h;b.removeAttribute("mjs-cmp");c=c.split(" ");g=0;for(k=c.length;g<k;g++)h=c[g],""!=h&&"as"!=h&&(d?f=h:d=h);return(new (e(d))({scope:a,node:b,as:f})).$returnToRenderer||!1};t.$breakScope=!0;s("mjs-cmp",200,t);var p=MetaphorJs.getCmp;s("mjs-cmp-prop",200,function(a,b,c){a=b.parentNode;for(var d;a;){if(d=a.getAttribute("cmp-id")){(a=p(d))&&(a[c]=b);break}a=
a.parentNode}});s("mjs-view",200,function(a,b,c){b.removeAttribute("mjs-view");var d=e(c);if(d)new d({scope:a,node:b});else throw"View '"+c+"' not found";return!1});s("mjs-init",150,function(a,b,c){b.removeAttribute("mjs-init");M(c)(a)})})();
(function(){var l=MetaphorJs.add,m=MetaphorJs.numberFormats,q=MetaphorJs.dateFormats;l("filter.toUpper",function(d){return d.toUpperCase()});l("filter.toLower",function(d){return d.toLowerCase()});l("filter.limitTo",function(d,e){var f=typeof d;if(!MetaphorJs.isArray(d)&&"string"!=f)return d;e=Infinity===Math.abs(Number(e))?Number(e):parseInt(e,10);if("string"==f)return e?0<=e?d.slice(0,e):d.slice(e,d.length):"";var f=[],a,c;e>d.length?e=d.length:e<-d.length&&(e=-d.length);0<e?(a=0,c=e):(a=d.length+
e,c=d.length);for(;a<c;a++)f.push(d[a]);return f});l("filter.ucfirst",function(d){return d.substr(0,1).toUpperCase()+d.substr(1)});var f=MetaphorJs.numberFormats;l("filter.numeral",function(d,e){e=f[e]||e;e=m[e]||e;return numeral(d).format(e)});var e=MetaphorJs.dateFormats;l("filter.moment",function(d,f){f=e[f]||f;f=q[f]||f;return moment(d).format(f)});var d=MetaphorJs.filterArray;l("filter.filter",function(e,f,h,a){h&&!a&&(h=null);return d(e,f,h)});l("filter.sortBy",function(d,e,f,a){f&&!a&&(f="asc");
d=d.slice();d.sort(function(a,b){var d=typeof a;return d!=typeof b?0:"object"==d?a[e]>b[e]?1:a[e]<b[e]?-1:0:a>b?1:a<b?-1:0});return"desc"==f?d.reverse():d})})();
