(function(){var k=Array.prototype.slice,p=Function.prototype.bind?function(a,c){return a.bind(c)}:function(a,c){return function(){a.apply(c,arguments)}},l=function(){var a=!1,c=k.call(arguments),e=c.shift(),b,d;for("boolean"==typeof c[c.length-1]&&(a=c.pop());b=c.shift();)for(d in b)if(b.hasOwnProperty(d))if(e[d]&&"object"==typeof e[d]&&"object"==typeof b[d])l(e[d],b[d],a);else if(!0===a||"undefined"==typeof e[d]||null===e[d])e[d]=b[d];return e},f=function(){return String.prototype.trim?function(a){return"string"==
typeof a?a.trim():a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),h={},s=function(a){return h[a]||(h[a]=new RegExp("(?:^|\\s)"+a+"(?!\\S)",""))},r=function(a,c){return s(c).test(a.className)},e=["0","0","0"];"undefined"!=typeof window?window.MetaphorJs||(window.MetaphorJs={}):global.MetaphorJs||(global.MetaphorJs={});MetaphorJs.bind=p;MetaphorJs.addListener=function(a,c,e){a.attachEvent?a.attachEvent("on"+c,e):a.addEventListener(c,e,!1)};MetaphorJs.removeListener=
function(a,c,e){a.detachEvent?a.detachEvent("on"+c,e):a.removeEventListener(c,e,!1)};MetaphorJs.extend=l;MetaphorJs.trim=f;MetaphorJs.inArray=function(a,c){return c?aIndexOf.call(c,a):-1};MetaphorJs.isArray=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"==toString.call(a)||!1};MetaphorJs.toArray=function(a){for(var c=[],e=-1,b=a.length>>>0;++e!==b;c[e]=a[e]);return c};MetaphorJs.addClass=function(a,c){r(a,c)||(a.className+=" "+c)};MetaphorJs.removeClass=function(a,
c){var e=s(c);a.className=a.className.replace(e,"")};MetaphorJs.hasClass=r;MetaphorJs.nextUid=function(){for(var a=e.length,c;a;){a--;c=e[a].charCodeAt(0);if(57==c)return e[a]="A",e.join("");if(90==c)e[a]="0";else return e[a]=String.fromCharCode(c+1),e.join("")}e.unshift("0");return e.join("")}})();
(function(){var k={}.undefined,p=MetaphorJs.extend,l=MetaphorJs.nextUid,f=MetaphorJs.addListener,h=MetaphorJs.removeListener,s=MetaphorJs.isArray,r={},e=function(b){return b._mjsId||(b._mjsId=l())},a=[],c=[],g=!1,b=!1,d=function(b,d){return b.priority<d.priority?-1:b.priority>d.priority?1:0},n,q=function(b){var d,a,n;if(s(b)){n=[];d=0;for(a=b.length;d<a;d++)n.push(q(b[d]));return n}switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0);
default:return null}},x=function(b,d,a){setTimeout(function(){b.apply(d,a||[])},0)};p(MetaphorJs,{VERSION:"0.1",registerAttributeHandler:function(b,d,c){n||(n=MetaphorJs.add);a.push({priority:d,name:b,handler:n("attr."+b,c)});g=!1},registerTagHandler:function(d,a,e){n||(n=MetaphorJs.add);c.push({priority:a,name:d,handler:n("tag."+d,e)});b=!1},getAttributeHandlers:function(){g||(a.sort(d),g=!0);return a},getTagHandlers:function(){b||(c.sort(d),b=!0);return c},numberFormats:{},dateFormats:{},getNodeId:e,
data:function(b,d,a){b=e(b);var n=r[b];return"undefined"!=typeof a?(n||(n=r[b]={}),n[d]=a):n?n[d]:k},emptyFn:function(){},clone:q,isVisible:function(b){return!(0>=b.offsetWidth||0>=b.offsetHeight)},isThenable:function(b){var d;return b&&"function"==typeof(d=b.then)?d:!1},isInjectable:function(b){return b.length&&"function"==typeof b[b.length-1]},async:x,asyncError:function(b){x(function(){throw b;})},onReady:function(b){var d=!1,a=!0,n=window,c=n.document,e=c.documentElement,q=function(a){if("readystatechange"!=
a.type||"complete"==c.readyState)h("load"==a.type?n:c,a.type,q),!d&&(d=!0)&&b.call(n,a.type||a)},x=function(){try{e.doScroll("left")}catch(b){setTimeout(x,50);return}q("poll")};if("complete"==c.readyState)b.call(n,"lazy");else{if(c.createEventObject&&e.doScroll){try{a=!n.frameElement}catch(g){}a&&x()}f(c,"DOMContentLoaded",q);f(c,"readystatechange",q);f(n,"load",q)}},toFragment:function(b){var d=document.createDocumentFragment();if(b.nodeType)d.appendChild(b);else for(var a=-1,n=b.length>>>0;++a!==
n;d.appendChild(b[0]));return d},app:function(b,d,a){try{return MetaphorJs.create(d||"MetaphorJs.cmp.App",b,a)}catch(n){MetaphorJs.error(n)}},error:function(b){var d=b.stack||Error().stack;setTimeout(function(){"undefined"!=typeof console&&console.log&&(console.log(b),d&&console.log(d))},0)}})})();
(function(){var k=/\r/g,p=MetaphorJs.trim,l=MetaphorJs.toArray,f=MetaphorJs.inArray,h=MetaphorJs.isArray,s=function(e){var a,c;if((a=r[e.type]||r[e.nodeName.toLowerCase()])&&"get"in a&&void 0!==(c=a.get(e,"value")))return c;c=e.value;return"string"===typeof c?c.replace(k,""):null==c?"":c},r={option:{get:function(e){var a=e.getAttribute("value");return null!=a?a:p(e.innerText||e.textContent)}},select:{get:function(e){for(var a,c=e.options,g=e.selectedIndex,b=(e="select-one"===e.type||0>g)?null:[],
d=e?g+1:c.length,n,q=0>g?d:e?g:0;q<d;q++)if(a=c[q],n=a.disabled||null!==a.getAttribute("disabled")||c.parentNode.disabled,(a.selected||q===g)&&!n){a=s(a);if(e)return a;b.push(a)}return b},set:function(e,a){for(var c,g,b=e.options,d=l(a),n=b.length;n--;)if(g=b[n],g.selected=f(g.value,d))c=!0;c||(e.selectedIndex=-1);return d}}};r.radio=r.checkbox={set:function(e,a){if(h(a))return e.checked=0<=f(s(e),a)},get:function(e){return null===e.getAttribute("value")?"on":e.value}};MetaphorJs.getValue=s;MetaphorJs.setValue=
function(e,a){if(1===e.nodeType){null==a?a="":"number"===typeof a&&(a+="");var c=r[e.type]||r[e.nodeName.toLowerCase()];c&&"set"in c&&void 0!==c.set(this,a,"value")||(e.value=a)}}})();
(function(){var k=function(){return!1},p=function(){return!0},l=function(f){if(!(this instanceof l))return new l(f);for(var h in f)f.hasOwnProperty&&f.hasOwnProperty(h)||this[h]||(this[h]=f[h]);this.originalEvent=f;this.type=f.type;!this.target&&f.srcElement&&(this.target=f.srcElement);this.isDefaultPrevented=f.defaultPrevented||void 0===f.defaultPrevented&&!1===f.returnValue?p:k;this.timeStamp=f&&f.timeStamp||(new Date).getTime()};l.prototype={isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k,
preventDefault:function(){var f=this.originalEvent;this.isDefaultPrevented=p;f&&f.preventDefault&&f.preventDefault()},stopPropagation:function(){var f=this.originalEvent;this.isPropagationStopped=p;f&&f.stopPropagation&&f.stopPropagation()},stopImmediatePropagation:function(){var f=this.originalEvent;this.isImmediatePropagationStopped=p;f&&f.stopImmediatePropagation&&f.stopImmediatePropagation();this.stopPropagation()}};window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.normalizeEvent=function(f){return new l(f)}})();
(function(){var k=MetaphorJs.extend,p=MetaphorJs.bind,l=MetaphorJs.addListener,f=MetaphorJs.removeListener,h=MetaphorJs.getValue,s=MetaphorJs.setValue,r=function(e,a,c,g){this.el=e;this.cb=a;this.scb=g;this.cbContext=c;this.inputType=a=e.getAttribute("mjs-input-type")||e.type.toLowerCase();this.listeners=[];c=e.type?e.type.toLowerCase():"";this.submittable="input"==e.nodeName.toLowerCase()&&"radio"!=c&&"checkbox"!=c;"radio"==a?this.initRadioInput():"checkbox"==a?this.initCheckboxInput():this.initTextInput()};
k(r.prototype,{el:null,inputType:null,cb:null,scb:null,cbContext:null,listeners:[],radio:null,submittable:!1,destroy:function(){var e=this.inputType,a=this.listeners,c=this.radio,g=this.el,b,d,n,q;b=0;for(d=a.length;b<d;b++)if("radio"==e)for(n=0,q=c.length;n<q;n++)f(c[n],a[b][0],a[b][1]);else f(g,a[b][0],a[b][1]);delete this.radio;delete this.el;delete this.cb;delete this.cbContext},initRadioInput:function(){var e=this.el,a=e.type,e=e.name,c,g,b;this.onRadioInputChangeDelegate=p(this.onRadioInputChange,
this);if(document.querySelectorAll)c=document.querySelectorAll("input[name="+e+"]");else{var d=document.getElementsByTagName("input"),n;c=[];g=0;for(b=d.length;g<b;g++)n=d[g],n.type==a&&n.name==e&&c.push(n)}this.radio=c;this.listeners.push(["click",this.onRadioInputChangeDelegate]);g=0;for(b=c.length;g<b;g++)l(c[g],"click",this.onRadioInputChangeDelegate)},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=p(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate]);
l(this.el,"click",this.onCheckboxInputChangeDelegate)},initTextInput:function(){var e=MetaphorJs.browser,a=!1,c=this,g=c.el,b=c.listeners,d;if(!e.android){var n=function(){a=!0},q=function(){a=!1;x()};b.push(["compositionstart",n]);b.push(["compositionend",q]);l(g,"compositionstart",n);l(g,"compositionend",q)}var x=c.onTextInputChangeDelegate=function(){if(!a)c.onTextInputChange()};if(e.hasEvent("input"))b.push(["input",x]),l(g,"input",x);else{var v=function(b){d||(d=window.setTimeout(function(){x(b);
d=null},0))},n=function(b){b=b||window.event;var d=b.keyCode;if(13==d&&c.submittable&&c.scb)return c.scb.call(c.callbackContext,b);91===d||15<d&&19>d||37<=d&&40>=d||v(b)};b.push(["keydown",n]);l(g,"keydown",n);e.hasEvent("paste")&&(b.push(["paste",v]),b.push(["cut",v]),l(g,"paste",v),l(g,"cut",v))}b.push(["change",x]);l(g,"change",x)},onTextInputChange:function(){var e=this.el.value;switch(this.inputType){case "number":e=parseInt(e,10)}this.cb.call(this.cbContext,e)},onCheckboxInputChange:function(){var e=
this.el;this.cb.call(this.cbContext,e.checked?e.getAttribute("value")||!0:!1)},onRadioInputChange:function(e){e=e||window.event;this.cb.call(this.cbContext,(e.target||e.srcElement).value)},setValue:function(e){var a=this.inputType,c,g;if("radio"==a)for(a=this.radio,c=0,g=a.length;c<g;c++){if(a[c].value==e){a[c].checked=!0;break}}else"checkbox"==a?(a=this.el,a.checked=!0===e||e==a.value):s(this.el,e)},getValue:function(){var e=this.inputType,a,c;if("radio"==e){e=this.radio;a=0;for(c=e.length;a<c;a++)if(e[a].checked)return e[a].value;
return null}return"checkbox"==e?this.el.checked?this.el.getAttribute("value")||!0:!1:h(this.el)}});window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.lib||(MetaphorJs.lib={});MetaphorJs.lib.Input=r})();
(function(){var k="undefined"!=typeof window?window:global,p={},l=function(f,h){if(p[f]||h)return p[f];var e=f.split("."),a,c=e.length,g,b=k;for(a=0;a<c;a++){g=e[a];if(!b[g])return null;b=b[g]}return b},f=function(f,h){var e;e=f.split(".");var a,c=e.pop();a=e.join(".");var g=e.length,b,d=k;if(p[a])e=[p[a],c];else{for(a=0;a<g;a++)b=e[a],d[b]||(d[b]={}),d=d[b];e=[d,c]}e[0][e[1]]=h;return p[f]=h},h=function(f,h){return p[f]=h};f("MetaphorJs.ns",{register:f,exists:function(f){return p[f]?!0:!1},get:l,
add:h,remove:function(f){delete p[f]}});MetaphorJs.r=f;MetaphorJs.g=l;MetaphorJs.add=h;"undefined"!=typeof module&&(module.exports=MetaphorJs.ns)})();
(function(){var k;if("undefined"!=typeof global)try{k=require("metaphorjs-namespace")}catch(p){k=global.MetaphorJs.ns}else k=window.MetaphorJs.ns;var l={}.undefined,f=Array.prototype.slice,h=function(b,d){return e(function(){},b,d)},s=function(b,d,a){return function(){var c=l,e=this.supr;this.supr=b.prototype[d]||function(){};try{c=a.apply(this,arguments)}catch(g){}this.supr=e;return c}},r=function(b,d,a){for(var c in d)d.hasOwnProperty(c)&&(b[c]="function"===typeof d[c]&&a.prototype&&"function"===
typeof a.prototype[c]?s(a,c,d[c]):d[c])},e=function(b,d,a){var c=function(){};c.prototype=b.prototype;c=new c;a=a||function(){this.initialize&&this.initialize.apply(this,arguments)};r(c,d,b);a.prototype=c;a.prototype.constructor=a;a.prototype.getClass=function(){return this.__proto__.constructor.__class};a.prototype.getParentClass=function(){return this.__proto__.constructor.__parentClass};a.__instantiate=function(b){return function(){var d=function(){},a;d.prototype=b.prototype;d=new d;a=b.prototype.constructor.apply(d,
arguments);return"object"==typeof a?a:d}}(a);return a},a=function(b,d,a,c,m,g){null===b&&(b="");"function"==typeof b?(m=a,"string"==typeof d?(m=c,c=a):(c=d,a=b,d=null),b=null):"string"!=typeof b&&(m=d,c=b,b=a=d=null);"string"!=typeof d&&"function"!=typeof d&&(m=c,c=a,a=d,d=null);"function"!=typeof a&&(m=c,c=a,a=null);c=c||{};var z=d&&"string"==typeof d?k.get(d):d;if(d&&!z)throw Error(d+" not found");d=z?e(z,c,a):h(c,a);d.__isMetaphorClass=!0;d.__parent=z;d.__parentClass=z?z.__class:null;d.__class=
b;if(m)for(var f in m)m.hasOwnProperty(f)&&(d[f]=m[f]);b&&(g?k.add(b,d):k.register(b,d));m&&m.alias&&k.add(m.alias,d);return d},c=function(b,d,c,e,m){return a(b,d,c,e,m,!0)},g=function(b){var d=k.get(b),a=f.call(arguments,1);if(!d)throw Error(b+" not found");return d.__instantiate.apply(this,a)},b=function(b,d){var a="string"==typeof d?k.get(d):d;return a?b instanceof a:!1},d=function(b,d){var a=b,c=k.get;"string"!=typeof d&&(d=d.getClass?d.getClass():d.prototype.constructor.__class);for("string"==
typeof b&&(a=c(b));a;){if(a.prototype.constructor.__class==d)return!0;a&&(a=a.getParentClass?c(a.getParentClass()):a.__parent)}return!1};"undefined"!=typeof global?module.exports={define:a,d:a,defineCache:c,dc:c,create:g,c:g,is:b,isSubclass:d}:(MetaphorJs.define=MetaphorJs.d=a,MetaphorJs.defineCache=MetaphorJs.dc=c,MetaphorJs.create=MetaphorJs.c=g,MetaphorJs.is=b,MetaphorJs.isSubclass=MetaphorJs.iss=d)})();
(function(){var k="undefined"!=typeof window?window.setTimeout:global.setTimeout,p=function(b){var d;return!b||"object"!=typeof b&&"function"!=typeof b||"function"!=typeof(d=b.then)?!1:d},l=Function.prototype.bind?function(b,d){return b.bind(d)}:function(b,d){return function(){b.apply(d,arguments)}},f=[],h=!1,s="undefined"!=typeof process?process.nextTick:function(b){k(b,0)},r=function(){h=!0;var b=f.shift();s(function(){b[0].apply(b[1],b[2]);f.length?r():h=!1},0)},e=function(b,d,a){a=a||[];f.push([b,
d,a]);h||r()},a=function(b,d){for(var a in d)d.hasOwnProperty(a)&&(b[a]=d[a])},c=function(b,d){return function(a){try{d.resolve(b(a))}catch(c){d.reject(c)}}},g=function(b,d){if(b instanceof g)return b;if(!(this instanceof g))return new g(b,d);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if("undefined"!=typeof b)if(p(b)||"function"!=typeof b)this.resolve(b);else try{b.call(d,l(this.resolve,this),l(this.reject,this))}catch(a){this.reject(a)}};a(g.prototype,{_state:0,_fulfills:null,
_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(b,d){var a;if(0==this._state)if(b===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(a=p(b)){b instanceof g?b.then(l(this._processResolveValue,
this),l(this._processRejectReason,this)):(new g(a,b)).then(l(this._processResolveValue,this),l(this._processRejectReason,this));return}}catch(c){0==this._state&&this._doReject(c);return}d.call(this,b)}},_callResolveHandlers:function(){this._done();for(var b=this._fulfills,d;d=b.shift();)e(d[0],d[1],[this._value]);this._cleanup()},_doResolve:function(b){this._value=b;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(b){this._processValue(b,this._doResolve)},resolve:function(b){if(this._triggered)return this;
this._triggered=!0;this._processResolveValue(b);return this},_callRejectHandlers:function(){this._fail();for(var b=this._rejects,d;d=b.shift();)e(d[0],d[1],[this._reason]);this._cleanup()},_doReject:function(b){this._state=2;this._reason=b;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(b){this._processValue(b,this._doReject)},reject:function(b){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(b);return this},then:function(b,d){var a=new g,q=this._state;
0==q||0!=this._wait?(b&&"function"==typeof b?this._fulfills.push([c(b,a),null]):this._fulfills.push([a.resolve,a]),d&&"function"==typeof d?this._rejects.push([c(d,a),null]):this._rejects.push([a.reject,a])):1==q?b&&"function"==typeof b?e(c(b,a),null,[this._value]):a.resolve(this._value):2==q&&(d&&"function"==typeof d?e(c(d,a),null,[this._reason]):a.reject(this._reason));return a},"catch":function(b){return this.then(null,b)},_done:function(){for(var b=this._dones,d;d=b.shift();)d[0].call(d[1]||null,
this._value)},done:function(b,d){var a=this._state;1==a&&0==this._wait?b.call(d||null,this._value):0==a&&this._dones.push([b,d]);return this},_fail:function(){for(var b=this._fails,d;d=b.shift();)d[0].call(d[1]||null,this._reason)},fail:function(b,d){var a=this._state;2==a&&0==this._wait?b.call(d||null,this._reason):0==a&&this._fails.push([b,d]);return this},always:function(b,a){this.done(b,a);this.fail(b,a);return this},promise:function(){return{then:l(this.then,this),done:l(this.done,this),fail:l(this.fail,
this),always:l(this.always,this)}},after:function(b){var a=this;if(p(b)){a._wait++;var c=function(){a._wait--;0==a._wait&&0!=a._state&&(1==a._state?a._callResolveHandlers():a._callRejectHandlers())};"function"==typeof b.done?b.done(c):b.then(c)}return a}});a(g,{resolve:function(b){return new g(b)},reject:function(b){var a=new g;a.reject(b);return a},all:function(b){if(!b.length)return g.resolve(null);var a=new g,c=b.length,e=Array(c),f=c,h,m,w=function(b,c){e[c]=b;f--;0==f&&a.resolve(e)};for(h=0;h<
c;h++)(function(c){m=b[h];m instanceof g?m.done(function(b){w(b,c)}).fail(a.reject,a):p(m)||"function"==typeof m?(new g(m)).done(function(b){w(b,c)}).fail(a.reject,a):w(m,c)})(h);return a},when:function(){return g.all(arguments)},allResolved:function(b){if(!b.length)return g.resolve(null);var a=new g,c=b.length,e=[],f=c,h,m,w=function(b){e.push(b);z()},z=function(){f--;0==f&&a.resolve(e)};for(h=0;h<c;h++)m=b[h],m instanceof g?m.done(w).fail(z):p(m)||"function"==typeof m?(new g(m)).done(w).fail(z):
w(m);return a},race:function(b){if(!b.length)return g.resolve(null);var a=new g,c=b.length,e,f;for(e=0;e<c&&(f=b[e],f instanceof g?f.done(a.resolve,a).fail(a.reject,a):p(f)||"function"==typeof f?(new g(f)).done(a.resolve,a).fail(a.reject,a):a.resolve(f),a.isPending());e++);return a}});"undefined"==typeof global?(window.Promise||(window.Promise=g),window.MetaphorJs&&window.MetaphorJs.r("MetaphorJs.lib.Promise",g)):"undefined"!=typeof module&&(module.exports=g)})();
(function(){"undefined"==typeof window&&(global.window=global);if(window.Promise)k=window.Promise;else{var k;if("undefined"!=typeof global)try{k=require("metaphorjs-promise")}catch(p){global.Promise&&(k=global.Promise)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Promise&&(k=MetaphorJs.lib.Promise)}var l=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){return Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10)},f=function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])},h=Array.prototype.slice,s="undefined"!=typeof process?process.nextTick:function(b){window.setTimeout(b,0)},r=Function.prototype.bind?function(b,a){return b.bind(a)}:function(b,a){return function(){b.apply(a,arguments)}},e=function(){this.events={}};f(e.prototype,{createEvent:function(b,d){b=b.toLowerCase();var c=this.events;c[b]||(c[b]=new a(b,d));return c[b]},getEvent:function(b){b=b.toLowerCase();return this.events[b]},on:function(b,d,c,e){b=b.toLowerCase();var g=this.events;g[b]||
(g[b]=new a(b));return g[b].on(d,c,e)},once:function(b,a,c,e){e=e||{};e.limit=1;return this.on(b,a,c,e)},un:function(b,a,c){b=b.toLowerCase();var e=this.events;e[b]&&e[b].un(a,c)},hasListener:function(b,a,c){b=b.toLowerCase();var e=this.events;return e[b]?e[b].hasListener(a,c):!1},removeAllListeners:function(b){var a=this.events;a[b]&&a[b].removeAllListeners()},triggerAsync:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return[];b=a[b];return b.triggerAsync.apply(b,h.call(arguments,
1))},trigger:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return null;b=a[b];return b.trigger.apply(b,h.call(arguments,1))},suspendEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].suspend()},suspendAllEvents:function(){var b=this.events,a;for(a in b)b[a].suspend()},resumeEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].resume()},resumeAllEvents:function(){var b=this.events,a;for(a in b)b[a].resume()},destroyEvent:function(b){var a=this.events;
a[b]&&(a[b].removeAllListeners(),a[b].destroy(),delete a[b])},destroy:function(b){var a=this.events;if(b)b=b.toLowerCase(),a[b]&&(a[b].destroy(),delete a[b]);else{for(var c in a)a[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var b="createEvent getEvent on un once hasListener removeAllListeners triggerAsync trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),a={},c,e=-1,g=b.length;++e<g;c=b[e],a[c]=r(this[c],this));this.api=a}return this.api}});
var a=function(b,a){this.name=b;this.listeners=[];this.map={};this.hash=l();this.uni="$$"+b+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=a||!1};f(a.prototype,{getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(b,a,c){if(!b)return null;a=a||null;c=c||{};var e=this.uni,g=a||b;if(g[e]&&!c.allowDupes)return null;var f=++this.lid,m=c.first||!1;g[e]=f;b={fn:b,scope:a,uniScope:g,id:f,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,
prepend:c.prepend};m?this.listeners.unshift(b):this.listeners.push(b);this.map[f]=b;return f},once:function(b,a,c){c=c||{};c.once=!0;return this.on(b,a,c)},un:function(b,a){var c=-1,e=this.uni,g=this.listeners,f;f=b==parseInt(b)?b:(a||b)[e];if(!f)return!1;for(var m=0,h=g.length;m<h;m++)if(g[m].id==f){c=m;delete g[m].uniScope[e];break}if(-1==c)return!1;g.splice(c,1);delete this.map[f];return!0},hasListener:function(b,a){var c=this.listeners,e;if(b){a=a||b;e=b==parseInt(b)?b:a[this.uni];if(!e)return!1;
for(var g=0,f=c.length;g<f;g++)if(c[g].id==e)return!0;return!1}return 0<c.length},removeAllListeners:function(){var b=this.listeners,a=this.uni,c,e;c=0;for(e=b.length;c<e;c++)delete b[c].uniScope[a];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(b,a){var c;b.append||b.prepend?(c=h.call(a),b.prepend&&(c=b.prepend.concat(c)),b.append&&(c=c.concat(b.append))):c=a;return c},triggerAsync:function(){if("undefined"==typeof k)throw Error("Promises are not defined");
var b=this,a=b.listeners,c=b.returnResult,e=h.call(arguments),g=[],f=[],m,w,z;if(b.suspended||0==a.length)return k.resolve(null);w=0;for(z=a.length;w<z;w++)g.push(a[w]);for(w=function(a){m=b._prepareArgs(a,e);return new k(function(c,e){s(function(){try{c(a.fn.apply(a.scope,m))}catch(d){e(d)}a.called++;a.called==a.limit&&b.un(a.id)},0)})};(a=g.shift())&&(!a||!b.map[a.id]||(a.count++,a.count<a.start||(f.push(w(a)),"first"!=c))););return"last"==c?[f.pop()]:f},trigger:function(){var a=this.listeners,
c=this.returnResult;if(this.suspended||0==a.length)return null;var e="all"==c?[]:null,g=[],f,h;if("first"==c)g.push(a[0]);else for(f=0,h=a.length;f<h;f++)g.push(a[f]);for(;a=g.shift();)if(a&&this.map[a.id]&&(a.count++,!(a.count<a.start))){f=a.fn.apply(a.scope,this._prepareArgs(a,arguments));a.called++;a.called==a.limit&&this.un(a.id);"all"==c&&e.push(f);if("first"==c)return f;"last"==c&&(e=f);if(!1==c&&!1===f)break}if(c)return e}});var c=window.MetaphorJs;if(c&&c.VERSION){var g=new e;f(MetaphorJs,
g.getApi())}c&&c.r?c.r("MetaphorJs.lib.Observable",e):(window.MetaphorJs=window.MetaphorJs||{},MetaphorJs.lib=MetaphorJs.lib||{},MetaphorJs.lib.Observable=e);"undefined"!=typeof global&&(module.exports=e)})();
(function(){"undefined"==typeof window&&(global.window=global);var k;if("undefined"!=typeof global)try{k=require("metaphorjs-observable")}catch(p){global.Observable&&(k=global.Observable)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Observable&&(k=MetaphorJs.lib.Observable);var l=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,f={},h=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){var a;a=Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10);return f[a]?
h():f[a]=a},s=Object.prototype.toString,r=function(a){return"[object Array]"===s.call(a)},e=function(a){return"[object Date]"===s.call(a)},a=function(a){return"[object RegExp]"===s.call(a)},c=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},g=function(b,t){if(c(b))throw Error("Cannot copy window object");if(t){if(b===t)throw Error("Objects are identical");if(r(b))for(var d=t.length=0;d<b.length;d++)t.push(g(b[d]));else{for(d in t)delete t[d];for(d in b)t[d]=g(b[d])}}else(t=b)&&
(r(b)?t=g(b,[]):e(b)?t=new Date(b.getTime()):a(b)?t=new RegExp(b.source):null!=b&&"object"===typeof b&&(t=g(b,{})));return t},b=function(d,t){if(d===t)return!0;if(null===d||null===t)return!1;if(d!==d&&t!==t)return!0;var B=typeof d,g;if(B==typeof t&&"object"==B)if(r(d)){if(!r(t))return!1;if((B=d.length)==t.length){for(g=0;g<B;g++)if(!b(d[g],t[g]))return!1;return!0}}else{if(e(d))return e(t)&&d.getTime()==t.getTime();if(a(d)&&a(t))return d.toString()==t.toString();if(c(d)||c(t)||r(t))return!1;B={};for(g in d)if(("$"!==
g.charAt(0)||"object"!=typeof d[g])&&"function"!==typeof d[g]){if(!b(d[g],t[g]))return!1;B[g]=!0}for(g in t)if(!B.hasOwnProperty(g)&&"$"!==g.charAt(0)&&void 0!==t[g]&&"function"!==typeof t[g])return!1;return!0}return!1},d=function(a,c){var d=a.length,e=c.length,g=Array(d+1),y=Array(d+1),u,m,f,h,z=0;if(d==e&&0==d)return{changes:0,distance:0,prescription:[]};for(u=0;u<=d;u++)g[u]=Array(e+1),y[u]=Array(e+1),g[u][0]=u,y[u][0]="D";for(u=0;u<=e;u++)g[0][u]=u,y[0][u]="I";for(u=1;u<=d;u++)for(m=1;m<=e;m++)f=
b(a[u-1],c[m-1])?0:1,g[u][m-1]<g[u-1][m]&&g[u][m-1]<g[u-1][m-1]+f?(g[u][m]=g[u][m-1]+1,y[u][m]="I"):g[u-1][m]<g[u-1][m-1]+f?(g[u][m]=g[u-1][m]+1,y[u][m]="D"):(g[u][m]=g[u-1][m-1]+f,y[u][m]=1==f?"R":"-");h=[];u=d;m=e;do f=y[u][m],h.push(f),"-"!=f&&z++,"R"==f||"-"==f?(u--,m--):"D"==f?u--:m--;while(0!=u||0!=m);return{changes:z/h.length,distance:g[d][e],prescription:h.reverse()}},n=window.MetaphorJs?MetaphorJs.trim:function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():
a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),q,x=window.MetaphorJs?MetaphorJs.ns.get:null,v=function(a,b,c,d,e){q||(q=new k);var y=h(),u;r(a)&&null===b?u="array":("string"!=typeof b&&(d=c,c=b,b=null,u="object"),"string"==typeof a&&(d=c,c=b,b=a,a=null),b&&a&&(u=a.hasOwnProperty(b)?"attr":"expr"),b&&!a&&(u="expr"));if(c)q.on(y,c,d||this,{append:[e],allowDupes:!0});this.code=b=this._processPipes(b,a);this.getterFn="expr"==u?A(b):null;this.id=y;this.type=u;
this.obj=a;this.itv=null;this.curr=this._getValue()};(function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(v.prototype,{code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,arraySlice:!1,pipes:null,_addPipe:function(a,b,c){var d=b.shift(),e=null,y=[],u;x&&(e=x("filter."+d,!0));e||(e=window[d]||c[d]);if("function"==typeof e){d=-1;for(u=b.length;++d<u;y.push(m(c,b[d],self.check,self)));a.push([e,b,y])}},_processPipes:function(a,b){for(var c=0,d=a.length,e=[],
y,u,g,m=!1,f=a;c<d;)if(-1!=(y=a.indexOf("|",c)))u=a.charAt(y-1),g=a.charAt(y+1),"|"!=u&&"'"!=u&&'"'!=u&&"|"!=g&&"'"!=g&&'"'!=g&&(m?(c=n(a.substring(c,y)).split(":"),this._addPipe(e,c,b)):(m=!0,f=n(a.substring(0,y)))),c=y+1;else{m&&(c=n(a.substr(c)).split(":"),this._addPipe(e,c,b));break}e.length&&(this.pipes=e);return f},_checkCode:function(){var a=this._getValue(),b=!1,c=this.curr;if(r(c)&&r(a))return b=d(c,a),b.changes?(this.curr=a.slice(),q.trigger(this.id,b,a,c),!0):!1;a!==c&&(this.curr=a,q.trigger(this.id,
a,c),b=!0);return b},_checkObject:function(){var a=this.obj,c=this.curr;return b(c,a)?!1:(this.curr=g(a),q.trigger(this.id,a,c),!0)},_checkArray:function(){var a=this.curr,b=this.obj,c=d(a,b);return c.changes?(this.curr=b.slice(),q.trigger(this.id,c,b,a),!0):!1},_getValue:function(){var a;switch(this.type){case "attr":a=this.obj[this.code];break;case "expr":try{a=this.getterFn(this.obj)}catch(b){if(window.MetaphorJs)MetaphorJs.asyncError(b);else throw b;}"undefined"==typeof a&&(a="");break;case "object":a=
g(this.obj);break;case "array":a=this.obj}r(a)&&(a=a.slice());var c=this.pipes;if(c){var d,e,y,u=c.length,m=this.obj,f,h;for(d=0;d<u;d++){y=c[d][1];e=[];f=-1;for(h=y.length;++f<h;e.push(D(y[f],m)));e.unshift(a);e.push(m);a=c[d][0].apply(null,e)}}return a},addListener:function(a,b,c){return q.on(this.id,a,b,c)},removeListener:function(a,b){return q.un(this.id,a,b)},getValue:function(){return this._getValue()},setValue:function(a){var b=this.type;if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||
(this.setterFn=C(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";},check:function(){switch(this.type){case "expr":case "attr":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&
(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,b){var c=this.id;q.un(c,a,b);return q.hasListener(c)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b,c,d,e,y;this.itv&&this.clearInterval();if(a)for(b=-1,c=a.length;++b<c;)for(y=a[b][2],d=-1,e=y.length;++d<e;)y[d].unsubscribeAndDestroy(this.check,this);this.pipes=this.obj=this.curr=null;q.destroyEvent(this.id);this.obj&&delete this.obj.$$watchers[this.code]}});var m=function(a,b,c,d,e){b=w(a,n(b));return a?(a.$$watchers||
(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof v&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof v)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].addListener(c,d,{append:[e],allowDupes:!0}):a.$$watchers[b]=new v(a,b,c,d,e),a.$$watchers[b]):new v(a,b,c,d,e)},w=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==
b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},z=Function,G=function(a){var b=a.stack||Error().stack;"undefined"!=typeof console&&console.log&&(console.log(a),b&&console.log(b))};"undefined"!=typeof window&&(window.watchableError=G);"undefined"!=typeof global&&(global.watchableError=G);var H={},A=function(a){return H[a]?H[a]:H[a]=new z("____","".concat("try {","return ",a.replace(l,"$1____.$3"),";} catch (e) { watchableError(e); }"))},J={},C=function(a){if(!J[a]){var b=a.replace(l,
"$1____.$3");return J[a]=new z("____","$$$$","".concat("try {",b," = $$$$",";} catch (e) { watchableError(e); }"))}return J[a]},I={},D=function(a,b){return A(a)(b)},F=function(a){if("string"!=typeof a)return!1;a=a.substr(0,1);return!('"'==a||"'"==a||"."==a)};v.create=m;v.unsubscribeAndDestroy=function(a,b,c,d){b=n(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,d)&&delete a[b]};v.normalizeExpr=w;v.prepareCode=function(a){return a.replace(l,"$1____.$3")};v.createGetter=A;v.createSetter=C;v.createFunc=
function(a){return I[a]?I[a]:I[a]=new z("____","".concat("try {",a.replace(l,"$1____.$3"),";} catch (e) { watchableError(e); }"))};v.eval=D;v.isExpression=function(a){var b=a.substr(0,1);return('"'==b||"'"==b)&&a.substr(a.length-1)==b||""+parseInt(a,10)===a?!1:!0};v.isNativeString=F;v.toExpression=function(a){return F(a)?"'"+a+"'":a};window.MetaphorJs&&MetaphorJs.r&&MetaphorJs.r("MetaphorJs.lib.Watchable",v);"undefined"!=typeof global&&(module.exports=v)})();
(function(){var k,p;if("undefined"!=typeof global)try{k=require("metaphorjs-promise"),p=require("metaphorjs-observable")}catch(l){k=global.MetaphorJs.lib.Promise,p=global.MetaphorJs.lib.Observable}else k=window.MetaphorJs.lib.Promise,p=window.MetaphorJs.lib.Observable;var f=MetaphorJs.extend,h=MetaphorJs.bind,s=MetaphorJs.addListener,r=MetaphorJs.trim,e=MetaphorJs.isArray,a;"undefined"!=typeof window&&(a=document.querySelectorAll||function(a){var b=document,c=b.documentElement.firstChild,d=b.createElement("STYLE");
c.appendChild(d);b.__qsaels=[];d.sheet?d.sheet.insertRule(a+"{x:expression(document.__qsaels.push(this))}",0):d.styleSheet&&(d.styleSheet.cssText=a+"{x:expression(document.__qsaels.push(this))}");window.scrollBy(0,0);return b.__qsaels});var c=/#.*$/,g=/([?&])_=[^&]*/,b=/\?/,d=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,n=/^(?:GET|HEAD)$/i,q=0,x=function(a,b){setTimeout(function(){a.call(b)},0)},v=function(a,b){var c,d;if(!a||"string"!==typeof a)return null;try{d=new DOMParser,c=d.parseFromString(a,
b||"text/xml")}catch(e){c=void 0}if(!c||c.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return c},m=function(a,b,c){var d,g;if("string"==typeof a&&c)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a));else if(e(a)&&c)for(d=0,g=a.length;d<g;d++)m(a[d],b,c+"["+d+"]");else if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&m(a[d],b,c?c+"["+d+"]":d)},w=function(a,d){a.replace(c,"");if(!1===d.cache){var e=(new Date).getTime();return g.test(a)?a.replace(g,"$1_="+e):a+(b.test(a)?
"&":"?")+"_="+e}!d.data||window.FormData&&d.data instanceof window.FormData||("string"!=typeof d.data?(e=[],m(d.data,e,null),e=e.join("&").replace(/%20/g,"+")):e=d.data,d.data=e,n.test(d.method)&&(a+=(b.test(a)?"&":"?")+d.data,d.data=null));return a},z={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},G={url:null,data:null,method:"GET",headers:null,username:null,password:null,
cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},H={},A=new p,J=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},C=function(a,b,c){var d,g;if("object"!=
typeof a&&"function"!=typeof a&&c)d=document.createElement("input"),d.setAttribute("type","hidden"),d.setAttribute("name",c),d.setAttribute("value",a),b.appendChild(d);else if(e(a)&&c)for(d=0,g=a.length;d<g;d++)C(a[d],b,c+"["+d+"]");else if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&C(a[d],b,c?c+"["+d+"]":d)},I=function(a){for(var b,c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],b.hasAttribute("name"))if(c="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT",
"FILE"===c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},D=function(){},F=function(b,c,d){var e=c?c.dataType:null;c=c?c.selector:null;if("string"!=typeof b)return b;d=d||"";if("xml"===e||!e&&0<=d.indexOf("xml"))return b=v(r(b)),c?a.call(b,c):b;if("html"===e)return b=v(b,"text/html"),c?a.call(b,c):b;if("fragment"==e){d=document.createDocumentFragment();
e=document.createElement("div");for(e.innerHTML=b;e.firstChild;)d.appendChild(e.firstChild);return d}if("json"===e||!e&&0<=d.indexOf("json"))return b=r(b),JSON.parse(b);("script"===e||!e&&0<=d.indexOf("javascript"))&&J(b);return b+""},E=function(a){var b=d.exec(("undefined"!=typeof window?window.location.href:"").toLowerCase())||[],c=d.exec(a.url.toLowerCase());this._opt=a;a.crossDomain=!(!c||c[1]===b[1]&&c[2]===b[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(b[3]||("http:"===b[1]?"80":"443")));b=new k;
"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||"undefined"!=typeof window&&window.FormData||"iframe"==a.transport||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):I(a.form));a.url=w(a.url,a);c=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new L(a,b,this):new B(a,b,this):new K(a,b,this);this._deferred=b;this._transport=c;b.done(function(a){A.trigger("success",
a)});b.fail(function(a){A.trigger("error",a)});b.always(function(){A.trigger("end")});A.trigger("start");a.timeout&&(this._timeout=setTimeout(h(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===A.trigger("beforeSend",a,c)&&(this._promise=k.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,c)&&(this._promise=k.reject());this._promise||(x(c.send,c),a=b.promise(),a.abort=h(this.abort,this),b.always(this.destroy,this),this._promise=a)};f(E.prototype,{_jsonpName:null,_transport:null,
_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);C(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,c=a.jsonpParam||
"callback",d=a.jsonpCallback||"jsonp_"+ ++q;a.url+=(b.test(a.url)?"&":"?")+c+"="+d;this._jsonpName=d;"undefined"!=typeof window&&(window[d]=h(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=h(this.jsonpCallback,this));return d},jsonpCallback:function(a){try{this._deferred.resolve(this.processResponseData(a))}catch(b){this._deferred.reject(b)}},processResponseData:function(a,b){var c=this._opt;a=F(a,c,b);A.hasListener("processResponse")&&(a=A.trigger("processResponse",a,this._deferred));
c.processResponse&&(a=c.processResponse.call(c.callbackScope,a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred;if(this._opt.jsonp)if(a){try{J(a)}catch(d){c.reject(d)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else try{c.resolve(this.processResponseData(a,b))}catch(e){c.reject(e)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);
this._transport.destroy();delete this._transport;delete this._opt;delete this._deferred;delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},!0);var t=function(a,b){b=b||{};a&&"string"!=typeof a?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),!b.url))throw"Must provide url";f(b,H,!1);f(b,G,!1);b.method=b.method?b.method.toUpperCase():
b.form?b.form.getAttribute("method").toUpperCase()||"GET":"GET";return(new E(b)).promise()};t.setup=function(a){f(H,a,!0)};t.on=function(){A.on.apply(A,arguments)};t.un=function(){A.un.apply(A,arguments)};t.get=function(a,b){b=b||{};b.method="GET";return t(a,b)};t.post=function(a,b){b=b||{};b.method="POST";return t(a,b)};t.load=function(a,b,c){c=c||{};"string"!=typeof b&&(c=b);c.dataType="fragment";return t(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};
t.loadScript=function(a){return t(a,{transport:"script"})};t.submit=function(a,b){b=b||{};b.form=a;return t(null,b)};var B=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&s(d,"progress",h(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&s(d.upload,"progress",h(a.uploadProgress,a.callbackScope));
try{var e;if(a.xhrFields)for(e in a.xhrFields)d[e]=a.xhrFields[e];a.data&&a.contentType&&d.setRequestHeader("Content-Type",a.contentType);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Accept",a.dataType&&z[a.dataType]?z[a.dataType]+", */*; q=0.01":z._default);for(e in a.headers)d.setRequestHeader(e,a.headers[e])}catch(g){}d.onreadystatechange=h(this.onReadyStateChange,this)};f(B.prototype,{_xhr:null,_deferred:null,_ajax:null,onReadyStateChange:function(){var a=this._xhr,
b=this._deferred;if(0===a.readyState)a.onreadystatechange=D,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=D;var c;a:{try{c=!a.status&&"undefined"!=typeof location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse("string"==typeof a.responseText?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=D;this._xhr.abort()},send:function(){var a=
this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}},!0);var K=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};f(K.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);
s(a,"load",h(this.onLoad,this));s(a,"error",h(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);var L=function(a,b,c){this._opt=a;this._ajax=
c;this._deferred=b};f(L.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+ ++q,c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);s(a,"load",h(this.onLoad,this));s(a,"error",h(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},onLoad:function(){var a=this._el;this._opt&&
!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);"undefined"!=typeof global?module.exports=t:window.MetaphorJs?MetaphorJs.ajax=t:window.MetaphorJs=
{ajax:t}})();
(function(){var k=[],p=!1,l=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/,f=function(a,e,b){a.attachEvent?a.attachEvent("on"+e,b):a.addEventListener(e,b,!1)},h=!!history.pushState,s="onhashchange"in window,r=function(a){var e=location.protocol+"//"+location.hostname;location.port&&(e+=":"+location.port);a=a.replace(e,"");h||(a=encodeURIComponent(a));return a},e=function(){var a;h?a=location.pathname+location.search:(a=location.hash.substr(1))?("!"==
a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a)):a=location.pathname+location.search;return a},a=function(){var a=e();if(k.length)for(var g=-1,b=k.length;++g<b;k[g].call(null,a));window.MetaphorJs&&MetaphorJs.triggerAsync("locationchange",a)};f(window,"load",function(){p=!0});history.initPushState=function(){if(h)history.origPushState=history.pushState,history.origReplaceState=history.replaceState,f(window,"popstate",a),history.pushState=function(b,c,d){history.origPushState(b,c,r(d));a()},
history.replaceState=function(b,c,d){history.origReplaceState(b,c,r(d));a()};else if(s)history.replaceState=history.pushState=function(a,b,c){a=r(c);location.hash=a?"!"+a:""},f(window,"hashchange",a);else{var c=null,e=!1;window.onIframeHistoryChange=function(b){e||(location.hash=b?"!"+b:"",a())};var b=function(a){var b=c.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');
b.close()};history.pushState=function(a,c,d){b(r(d))};history.replaceState=function(a,b,d){a=r(d);c.contentWindow.hashValue=a};var d=function(){c=document.createElement("iframe");c.src="about:blank";c.style.display="none";document.body.appendChild(c);e=!0;b(r(location.hash.substr(1)));e=!1};p?d():f(window,"load",d)}f(document.documentElement,"click",function(a){a=a||window.event;for(var b=a.target||a.srcElement,c;b&&"a"!=b.nodeName.toLowerCase();)b=b.parentNode;if(b){c=b.getAttribute("href");var d;
if(d=c&&"#"!=c.substr(0,1))c=c.match(l),d=c[1]&&location.protocol!=c[1]||c[2]&&location.hostname!=c[2]?!1:c[2]||c[3]?location.port!=c[3]?!1:!0:!0;if(d&&!b.getAttribute("target"))return history.pushState(null,null,b.getAttribute("href")),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1}});history.initPushState=function(){}};window.MetaphorJs?(MetaphorJs.pushUrl=function(a){history.pushState(null,null,a)},MetaphorJs.replaceUrl=function(a){history.replaceState(null,null,
a)},MetaphorJs.currentUrl=function(){return e()}):history.onchange=function(a){k.push(a)}})();
(function(){var k=MetaphorJs.lib.Observable,p=MetaphorJs.extend;MetaphorJs.d("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(l){l=l||{};this._observable=new k;p(this,this._observable.getApi());if(l.callback){var f=l.callback,h=f.scope||this;delete f.scope;for(var s in f)if(f.hasOwnProperty(s))this.on(s,f[s],h);delete l.callback}p(this,l,!0)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",
this);this._observable.destroy();delete this._observable}},onDestroy:MetaphorJs.emptyFn})})();
(function(){var k={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},p=["Moz","Webkit","ms","O","Khtml"],l="animationDelay",f="animationDuration",h="transitionDelay",s="transitionDuration",r=0,e=function(){var a=document.createElement("div"),b=!1,c,d,e;if(void 0!==a.style.animationName)b=!0;else for(d=0,e=p.length;d<e;d++)if(c=p[d],void 0!==a.style[c+"AnimationName"]){b=!0;l=c+"AnimationDelay";f=c+"AnimationDuration";h=c+"TransitionDelay";s=c+"TransitionDuration";
break}return b}(),a=window.requestAnimationFrame?window.requestAnimationFrame:function(a){window.setTimeout(a,0)},c=MetaphorJs.g,g=MetaphorJs.lib.Promise,b=MetaphorJs.data,d=MetaphorJs.isThenable,n=function(b,c,d){var e=function(){(new Date).getTime()-c>=d?b():a(e)};a(e)},q=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},x=function(a,b,c){var d,e,g=b.length;for(d=0;d<g;d++)e=q(b[d])+q(c[d]),a=Math.max(e,a);return a},v=function G(c,e,g,k,q,r,p){var E=function(){var a=
b(c,"mjsAnimationQueue");return a&&a.length&&a[0].id==p?!1:(q.reject(c),!0)},t=function(){if(!E()){var a=g;g++;if(g==e.length){q.resolve(c);b(c,"mjsAnimationQueue").shift();var d=b(c,"mjsAnimationQueue");d.length?(d=d[0],v(d.el,d.stages,0,d.start,d.deferred,!1,d.id)):b(c,"mjsAnimationQueue",null)}else b(c,"mjsAnimationQueue")[0].position=g,G(c,e,g,null,q);w(c,e[a]);w(c,e[a]+"-active")}},B=function(){if(!E()){m(c,e[g]+"-active");var a,b=window.getComputedStyle?window.getComputedStyle(c):c.style;a=
0;var d=(b[f]||"").split(","),B=(b[l]||"").split(","),w=(b[s]||"").split(","),b=(b[h]||"").split(",");a=Math.max(a,x(a,d,B));(a=Math.max(a,x(a,w,b)))?n(t,(new Date).getTime(),a):t()}},K=function(){if(!E()){m(c,e[g]);var b;k&&(b=k(c),k=null);d(b)?b.done(B):a(B)}};r?a(K):K()},m=MetaphorJs.addClass,w=MetaphorJs.removeClass;MetaphorJs.stopAnimation=function(a){var c=b(a,"mjsAnimationQueue"),d;c&&c.length&&(d=c[0])&&d.stages&&(c=d.position,d=d.stages,w(a,d[c]),w(a,d[c]+"-active"));b(a,"mjsAnimationQueue",
null)};MetaphorJs.animate=function(a,m,f){var h=a.getAttribute("mjs-animate"),w=a.getAttribute("mjs-animate-js"),l=new g,n=b(a,"mjsAnimationQueue")||[],q=++r,s,t;m&&"string"==typeof m&&(m=k[m]);"string"==typeof h&&h&&"["==h.substr(0,1)&&(m=(new Function("","return "+h))(),h=null);n.push({el:a,stages:m,start:f,deferred:l,position:0,id:q});b(a,"mjsAnimationQueue",n);void 0!=h&&e&&m?1==n.length&&v(a,m,0,f,l,!0,q):(s=w||h)&&(t=c("animate."+s,!0))?t(a,f,l):f?(m=f(a),d(m)?m.done(function(){l.resolve(a)}):
l.resolve(a)):l.resolve(a);return l.promise()}})();
(function(){var k=MetaphorJs.lib.Observable,p=MetaphorJs.lib.Watchable,l=MetaphorJs.extend,f;f=MetaphorJs.d("MetaphorJs.view.Scope",{$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$checking:!1,$$destroyed:!1,initialize:function(f){this.$$observable=new k;l(this,f,!0);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)},$new:function(){return new f({$parent:this,
$root:this.$root,$app:this.$app})},$on:function(f,k,l){return this.$$observable.on(f,k,l)},$un:function(f,k,l){return this.$$observable.un(f,k,l)},$watch:function(f,k,l){p.create(this,f,k,l,null)},$unwatch:function(f,k,l){p.unsubscribeAndDestroy(this,f,k,l)},$get:function(f){for(var k=this;k;){if(void 0!=k[f])return k[f];k=k.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$check:function(){var f;this.$$checking||(this.$$checking=!0,this.$$watchers&&
(f=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",f))},$destroy:function(){this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;delete this.$app;delete this.$root;delete this.$parent;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);this.$$destroyed=!0}})})();
(function(){var k=navigator.userAgent.toLowerCase(),p=parseInt((/msie (\d+)/.exec(k)||[])[1],10),l=parseInt((/android (\d+)/.exec(k)||[])[1],10),f={};isNaN(p)&&(p=parseInt((/trident\/.*; rv:(\d+)/.exec(k)||[])[1],10));window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.browser={android:l,hasEvent:function(h){if("input"==h&&9==p)return!1;if(void 0===f[h]){var k=document.createElement("div");f[h]="on"+h in k}return f[h]}}})();
(function(){var k=MetaphorJs.nextUid,p=MetaphorJs.view.Scope,l=MetaphorJs.lib.Watchable,f=MetaphorJs.lib.Observable,h=MetaphorJs.isThenable,s=MetaphorJs.toArray,r=MetaphorJs.getAttributeHandlers,e=null,a=MetaphorJs.g,c=l.create,g=l.unsubscribeAndDestroy,b,d="string"==typeof document.createTextNode("").textContent?"textContent":"nodeValue",n=function(a,b,c,d,e,g,f){var h=[];if(a&&!0!==a){if(a.nodeType){f.countdown+=1;x(a,c,d,e,g,f);return}h=s(a)}h.length||(h=s(b.childNodes));b=h.length;f.countdown+=
b;for(a=-1;++a<b;x(h[a],c,d,e,g,f));},q=/^(script|template|mjs-template|style)$/i,x=function(a,b,c,d,e,g){var f;if(!a.nodeName.match(q)){try{f=b.call(c,a,d)}catch(k){MetaphorJs.error(k)}if(!1!==f){if(h(f)){f.done(function(f){!1!==f&&n(f,a,b,c,d,e,g);0==--g.countdown&&e&&e.call(c)});return}n(f,a,b,c,d,e,g)}}0==--g.countdown&&e&&e.call(c)},v=new f;b=MetaphorJs.d("MetaphorJs.view.Renderer",{id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,initialize:function(a,b,c){this.id=
k();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof p&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",this.destroy,this)},on:function(a,b,c){return v.on(a+"-"+this.id,b,c)},un:function(a,b,c){return v.un(a+"-"+this.id,b,c)},createChild:function(a){return new b(a,this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,c,d){var e=a.$isolateScope?new p({$app:b.$app}):a.$breakScope?b.$new():b;b=b.$app;var g={$scope:e,$node:c,$attrValue:d,$renderer:this};c=[e,
c,d,this];return a.__isMetaphorClass?(c=b.inject(a,null,!0,g,c),a.$stopRenderer?!1:h(c)?c.then(function(a){return a.$returnToRenderer}):c.$returnToRenderer):b.inject(a,null,!1,g,c)},processNode:function(b,c){var g=b.nodeType,f=this.texts,h=this.scope,k;if(3==g)h={watchers:[],node:b,text:"",inx:k=f.length},this.processText(h,b[d]),0<h.watchers.length&&(f.push(h),c&&this.renderText(k));else if(1==g){e||(e=r());var l=b.attributes,n,q,p,g="tag."+b.tagName.toLowerCase();if(n=a(g,!0))if((p=this.runHandler(n,
h,b))||!1===p)return p;n=0;for(q=e.length;n<q;n++)if(k=e[n].name,null!==(p=b.getAttribute(k))&&(p=this.runHandler(e[n].handler,h,b,p),b.removeAttribute(k),p||!1===p))return p;n=0;for(q=l.length;n<q;n++)a(g,!0)||(h={watchers:[],node:b,attr:l[n].name,text:"",inx:k=f.length},this.processText(h,l[n].value),0<h.watchers.length&&(f.push(h),c&&this.renderText(k)))}return!0},process:function(){x(this.el,this.processNode,this,!1,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){this.render();
v.trigger("rendered-"+this.id,this)},processText:function(a,b){for(var c=0,d=b.length,e,g,f=[];c<d;)if(-1!=(e=b.indexOf("{{",c))&&-1!=(g=b.indexOf("}}",e+2)))f.push(b.substring(c,e)),f.push(this.watcherMatch(a,b.substring(e+2,g))),c=g+2;else{c!==d&&f.push(b.substring(c));break}return a.text=f.join("")},watcherMatch:function(a,b){var d=a.watchers;d.push({watcher:c(this.scope,b,this.onDataChange,this,a.inx)});return"---"+(d.length-1)+"---"},onDataChange:function(a,b,c){this.renderText(c)},render:function(){var a=
this.texts.length,b;for(b=0;b<a;b++)this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.text,c=a.watchers,e=c.length,g=a.attr,f,h;for(f=0;f<e;f++)h=c[f].watcher.getLastResult(),b=b.replace("---"+f+"---",h);g?(a.node.setAttribute(g,b),"value"==g&&(a.node.value=b),"class"==g&&(a.node.className=b)):a.node[d]=b},destroy:function(){var a=this.texts,b,c,d,e,f;if(!this.destroyed){this.destroyed=!0;c=0;for(d=a.length;c<d;c++)for(b=a[c].watchers,e=0,f=b.length;e<f;e++)g(this.scope,b[e].watcher.code,
this.onDataChange,this);this.parent&&this.parent.un("destroy",this.destroy,this);v.trigger("destroy-"+this.id);this.parent=this.scope=this.el=this.texts=null}}},{eachNode:x});MetaphorJs.onReady(function(){var a=MetaphorJs.app,b;if(document.querySelectorAll)for(var c=document.querySelectorAll("[mjs-app]"),d=-1,e=c.length;++d<e;a(c[d]).run());else x(document.documentElement,function(c){b=c.getAttribute("mjs-app");if(null!==b)return a(c,b),!1})})})();
(function(){var k=window.MetaphorJs,p=k.data,l=k.toFragment,f=k.lib.Watchable,h=f.create,s=f.isExpression,r=f.eval,e=k.view.Renderer,a=k.clone,c=k.view.Scope,g=k.animate,b=k.lib.Promise,d=k.extend,n=k.nextUid,q={},x=new k.lib.Observable,v=function(a){if(!q[a]){var b=document.getElementById(a),c;if(b)c=b.tagName.toLowerCase(),"script"==c?(c=document.createElement("div"),c.innerHTML=b.innerHTML,q[a]=l(c.childNodes)):q[a]="content"in b?b.content:l(b.childNodes);else return q[a]=MetaphorJs.ajax(a,{dataType:"fragment"}).then(function(b){return q[a]=
b})}return q[a]};k.define("MetaphorJs.view.Template",{_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,initialize:function(a){d(this,a,!0);this.id=n();a=this.node;a.removeAttribute("mjs-include");if(this.tpl){if(a.firstChild&&p(a,"mjs-transclude",l(a.childNodes)),s(this.tpl)&&!this.replace&&(this.ownRenderer=!0,this._watcher=h(this.scope,this.tpl,this.onChange,this)),
this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof c&&this.scope.$on("destroy",this.onScopeDestroy,this)},doRender:function(){this._renderer||(this._renderer=new e(this.node,this.scope),this._renderer.on("rendered",
this.onRendered,this),this._renderer.process())},onRendered:function(){x.trigger("rendered-"+this.id,this)},on:function(a,b,c){return x.on(a+"-"+this.id,b,c)},un:function(a,b,c){return x.un(a+"-"+this.id,b,c)},startRendering:function(){var a=this.tpl;if(this.deferRendering){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,c=a._watcher?
a._watcher.getLastResult():r(a.tpl,a.scope),d=new b;(new b(function(a,b){a(v(c))})).done(function(b){a._fragment=b;d.resolve(!a.ownRenderer)}).fail(d.reject,d);return d},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var b=this.node;b.firstChild;)b.removeChild(b.firstChild);this.replace?b.parentNode.replaceChild(a(this._fragment),b):b.appendChild(a(this._fragment));this.ownRenderer&&
this.doRender()},applyTemplate:function(){var a=this.node,c=new b;this._initial?(this.doApplyTemplate(),c.resolve()):(g(a,"leave").done(this.doApplyTemplate,this).done(c.resolve,c),g(a,"enter"));this._initial=!1;return c},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();delete this._renderer},onScopeDestroy:function(){this.destroy();delete this._renderer},destroy:function(){delete this.node;delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,
this),delete this._watcher);delete this.tpl}},{getTemplate:v})})();
(function(){var k=MetaphorJs.extend,p=MetaphorJs.nextUid,l=MetaphorJs.emptyFn,f=MetaphorJs.ns.get,h=MetaphorJs.lib.Promise,s=MetaphorJs.view.Template,r=MetaphorJs.trim,e=MetaphorJs.lib.Watchable.toExpression;MetaphorJs.define("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,scope:null,template:null,tag:null,initialize:function(a){this.supr(a);a.as&&(this.scope[a.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&
(this.originalId=!0);this.id=this.id||"cmp-"+p();this.initComponent.apply(this,arguments);this.scope.$app.registerCmp(this);this.node||this._createNode();var c=this.template;c&&c instanceof s||(this.template=c=new s({scope:this.scope,node:this.node,deferRendering:!0,ownRenderer:!0,tpl:e(r(c))}));if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(c.initPromise?c.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=
document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display="none")},render:function(){this.rendered||(this.renderTo&&this.renderTo.appendChild(this.node),this.hidden=!MetaphorJs.isVisible(this.node),this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},onRenderingFinished:function(){this.rendered=!0;this.afterRender();this.trigger("afterrender",
this)},show:function(){this.hidden&&!1!==this.trigger("beforeshow",this)&&(this.node.style.display="block",this.hidden=!1,this.onShow(),this.trigger("show",this))},hide:function(){this.hidden||!1===this.trigger("beforehide",this)||(this.node.style.display="none",this.hidden=!0,this.onHide(),this.trigger("hide",this))},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:l,
afterRender:l,onShow:l,onHide:l,onParentRendererDestroy:function(){this.destroy()},onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?this.node.parentNode&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.scope.$destroy();delete this.scope;delete this.node;this.supr()}});MetaphorJs.resolveComponent=function(a,c,g,b,d){var l="string"==typeof a?f(a):a,q,p=[];a=l.template||
c.template;var v=g.$app,m={$node:b,$scope:g,$app:v};d=d||[];if(l.resolve)for(q in l.resolve)(function(a){var d=new h,e;p.push(d.done(function(b){c[a]=b}));e=l.resolve[q];"function"==typeof e?d.resolve(e(g,b)):d.resolve(v.inject(e,null,!1,k({},m,c)))})(q);a&&(c.template=new s({scope:g,node:b,deferRendering:!0,ownRenderer:!0,tpl:e(r(a))}),p.push(c.template.initPromise));var w=p.length;w&&(b.style.visibility="hidden");d.unshift(c);return h.all(p).then(function(){w&&(b.style.visibility="visible");c.$config=
c;return v.inject(l,null,!0,c,d)})}})();
(function(){var k=MetaphorJs.data,p=MetaphorJs.currentUrl,l=MetaphorJs.toFragment,f=MetaphorJs.animate,h=MetaphorJs.lib.Scope,s=MetaphorJs.extend,r=MetaphorJs.stopAnimation,e=MetaphorJs.resolveComponent;MetaphorJs.define("MetaphorJs.cmp.View",{route:null,node:null,scope:null,currentComponent:null,initialize:function(a){history.initPushState();s(this,a,!0);MetaphorJs.on("locationchange",this.onLocationChange,this);a=this.node;a.firstChild&&k(a,"mjs-transclude",l(a.childNodes));a.removeAttribute("mjs-view");
this.onLocationChange()},onLocationChange:function(){var a=p(),c=this.route,e,b,d,f,h;b=0;for(d=c.length;b<d;b++){f=c[b];if(h=a.match(f.reg)){this.changeComponent(f,h);return}f["default"]&&!e&&(e=f)}e?this.changeComponent(e,[]):this.clearComponent()},changeComponent:function(a,c){r(this.node);this.clearComponent();this.setComponent(a,c)},clearComponent:function(){var a=this,c=a.node;a.currentComponent&&f(c,"leave").done(function(){a.currentComponent.destroy();for(a.currentComponent=null;c.firstChild;)c.removeChild(c.firstChild)})},
setComponent:function(a,c){var g=this,b=g.node,d=a.params;f(b,"enter",function(){var f=c||[],k={destroyEl:!1,node:b,scope:a.isolateScope?new h({$app:g.scope.$app}):g.scope.$new()},l,p;a.as&&(k.as=a.as);a.template&&(k.template=a.template);f.shift();if(d)for(l=-1,p=d.length;++l<p;k[d[l]]=f[l]);return e(a.cmp||"MetaphorJs.cmp.Component",k,k.scope,b,null,f).done(function(a){g.currentComponent=a})})}})})();
(function(){var k=MetaphorJs.view.Scope,p=MetaphorJs.trim,l=MetaphorJs.define,f=MetaphorJs.ns.get,h=MetaphorJs.lib.Watchable,s=MetaphorJs.view.Renderer,r=MetaphorJs.data,e=MetaphorJs.toArray,a=MetaphorJs.toFragment,c=MetaphorJs.addListener,g=MetaphorJs.normalizeEvent,b=MetaphorJs.registerAttributeHandler,d=MetaphorJs.registerTagHandler,n=MetaphorJs.async,q=h.create,x=h.createGetter,v=MetaphorJs.animate,m=MetaphorJs.addClass,w=MetaphorJs.removeClass,z=MetaphorJs.hasClass,G=MetaphorJs.stopAnimation,
H=MetaphorJs.isArray,A=MetaphorJs.view.Template,J=MetaphorJs.lib.Input,C,I=function(a,b){for(var c;a;){c=r(a,b);if(void 0!=c)return c;a=a.parentNode}};MetaphorJs.d("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,initialize:function(a,b,c){c=p(c);this.node=b;this.expr=c;this.scope=a;this.watcher=q(a,c);this.watcher.addListener(this.onChange,this);this.onChange();a instanceof k&&a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){delete this.node;delete this.scope;
this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)},onChange:function(){}});b("mjs-bind",1E3,l(null,"MetaphorJs.view.AttributeHandler",{isInput:!1,initialize:function(a,b,c){var d=b.tagName.toLowerCase();this.isInput="input"==d||"textarea"==d;this.supr(a,b,c)},onChange:function(){var a=this.watcher.getLastResult();this.isInput?this.node.value=a:this.node.textContent=a}}));b("mjs-bind-html",1E3,l(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.node.innerHTML=
this.watcher.getLastResult()}}));b("mjs-model",1E3,l(null,"MetaphorJs.view.AttributeHandler",{inProg:!1,input:null,initialize:function(a,b,c){this.node=b;this.input=new J(b,this.onInputChange,this);this.supr(a,b,c)},onInputChange:function(a){var b=this.scope;this.watcher.setValue(a);this.inProg=!0;b instanceof k?b.$root.$check():this.watcher.checkAll();this.inProg=!1},onScopeDestroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var a=this.watcher.getLastResult();
this.inProg||this.input.setValue(a)}}));b("mjs-show",500,l(null,"MetaphorJs.view.AttributeHandler",{initial:!0,initialize:function(a,b,c){this.supr(a,b,c)},runAnimation:function(a){var b=this.node.style,c=function(){b.display=a?"":"none"};this.initial?c():v(this.node,a?"show":"hide",function(){a&&(b.display="")}).done(c)},onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));b("mjs-hide",500,l(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();
this.runAnimation(!a);this.initial=!1}}));b("mjs-if",500,l(null,"MetaphorJs.view.AttributeHandler",{parentEl:null,prevEl:null,el:null,initial:!0,initialize:function(a,b,c){this.parentEl=b.parentNode;this.prevEl=b.previousSibling;this.supr(a,b,c)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,d=a.node,e=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},f=
function(){c.removeChild(d)};b?d.parentNode||(a.initial?e():v(d,"enter",e)):d.parentNode&&(a.initial?f():v(d,"leave").done(f));a.initial=!1}}));b("mjs-each",100,l(null,"MetaphorJs.view.AttributeHandler",{model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;
this.node=b;this.scope=a;try{this.watcher=q(a,this.model,this.onChange,this)}catch(d){MetaphorJs.error(d)}this.parentEl.removeChild(b);this.render(this.watcher.getValue())},onScopeDestroy:function(){var a=this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.supr()},doUpdate:function(a,b){for(var c=this.renderers,d=b,e=c.length,f=e-1,g=!(d%2),h,k;d<e;d++)h=c[d],k=h.scope,k.$index=
d,k.$first=0===d,k.$last=d===f,k.$even=g,k.$odd=!g,g=!g,h.renderer?k.$check():(h.renderer=new s(h.el,h.scope),h.renderer.process())},render:function(a){var b=this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,f=document.createDocumentFragment(),g,h,k;h=0;for(k=a.length;h<k;h++)g=c.cloneNode(!0),f.appendChild(g),b.push(this.createItem(g,a,h));d.insertBefore(f,e);this.doUpdate(a,0)},createItem:function(a,b,c){var d=this.itemName,e=this.scope.$new();e[d]=b[c];return{el:a,scope:e}},onChange:function(a){var b=
this,c=b.renderers;a=a.prescription;var d=b.tpl,e=0,f=b.parentEl,g=b.watcher.getValue(),h=null,l,m,p,n;m=0;for(p=a.length;m<p;m++)n=a[m],"-"==n?(c[e].scope.$index=e,e++):(null===h&&(h=0<m?m-1:0),"I"!=n&&c[e]&&(l=c[e],l.scope instanceof k&&l.scope.$destroy(),l.renderer.destroy(),v(l.el,"leave").done(function(a){a.parentNode&&a.parentNode.removeChild(a)})),"D"==n?c.splice(e,1):(l=d.cloneNode(!0),v(l,"enter",function(a){return function(d){0<a?f.insertBefore(d,c[a-1].el.nextSibling):b.prevEl?f.insertBefore(d,
b.prevEl.nextSibling):f.appendChild(d)}}(e)),"R"==n?c[m]=b.createItem(l,g,e):"I"==n&&(m<c.length?c.splice(m,0,b.createItem(l,g,e)):c.push(b.createItem(l,g,e))),e++));b.doUpdate(g,h)},parseExpr:function(a){a=a.split(" ");var b,c,d,e,f;b=0;for(c=a.length;b<c;b++)if(f=a[b],""!=f&&"in"!=f)if(e){d=a.slice(b).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"}},{$stopRenderer:!0}));b("mjs-each-in-store",100,l(null,"attr.mjs-each",{store:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each-in-store");
b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.store=a=x(this.model)(a);this.parentEl.removeChild(b);this.initWatcher();this.render(this.watcher.getValue());n(this.bindStore,this,[a,"on"])},onScopeDestroy:function(){this.bindStore(this.store,"un");delete this.store;this.supr()},initWatcher:function(){this.watcher=q(this.store,".items",null);this.watcher.addListener(this.onChange,
this)},resetWatcher:function(){this.watcher.setValue(this.store.items)},bindStore:function(a,b){a[b]("load",this.onStoreUpdate,this);a[b]("update",this.onStoreUpdate,this);a[b]("add",this.onStoreUpdate,this);a[b]("remove",this.onStoreUpdate,this);a[b]("replace",this.onStoreUpdate,this);a[b]("filter",this.onStoreFilter,this);a[b]("clearfilter",this.onStoreFilter,this);a[b]("clear",this.onStoreClear,this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},onStoreFilter:function(){this.resetWatcher();
this.onStoreUpdate()},onStoreClear:function(){this.resetWatcher();this.onStoreUpdate()},onStoreDestroy:function(){this.onStoreClear();this.watcher.unsubscribeAndDestroy(this.onChange,this);delete this.watcher}},{$stopRenderer:!0}));b("mjs-include",900,function(a,b,c,d){a=new A({scope:a,node:b,tpl:c,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});d("mjs-include",900,function(a,b,c,d){return(new A({scope:a,node:b,tpl:b.getAttribute("src"),parentRenderer:d,replace:!0})).initPromise});b("mjs-transclude",
1E3,function(b,c){var d=I(c,"mjs-transclude");if(d){c.firstChild&&r(c,"mjs-transclude",a(c.childNodes));var f=c.parentNode,g=c.nextSibling,d=MetaphorJs.clone(d),h=e(d.childNodes);f.removeChild(c);f.insertBefore(d,g);return h}});d("mjs-transclude",900,function(b,c){var d=I(c,"mjs-transclude");if(d){c.firstChild&&r(c,"mjs-transclude",a(c.childNodes));var f=c.parentNode,g=c.nextSibling,d=MetaphorJs.clone(d),h=e(d.childNodes);f.removeChild(c);f.insertBefore(d,g);return h}});var D=function(a,b,c,d){if(null!==
c){if(c==z(a,b))return;c=!c}else c=z(a,b);c?d?v(a,[b+"-remove"]).done(function(){w(a,b)}):w(a,b):d?v(a,[b+"-add"]).done(function(){m(a,b)}):m(a,b)};b("mjs-class",1E3,l(null,"MetaphorJs.view.AttributeHandler",{initial:!0,onChange:function(){var a=this.node,b=this.watcher.getLastResult(),c;G(a);if("string"==typeof b)D(a,b,null,!this.initial);else if(H(b)){var d;c=-1;for(d=b.length;++c<d;D(a,b[c],!0,!this.initial));}else for(c in b)D(a,c,b[c]?!0:!1,!this.initial);this.initial=!1}}));var d="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste enter".split(" "),
F,E=h.createFunc,h=0;for(F=d.length;h<F;h++)(function(a){var d=a;"enter"==d&&(d="keyup");b("mjs-"+a,1E3,function(b,e,f){var h=E(f);c(e,d,function(c){c=c||window.event;c=g(c);if("enter"==a&&13!=c.keyCode)return null;b.$event=c;try{h(b)}catch(d){MetaphorJs.error(d)}delete b.$event;b instanceof k?b.$root.$check():b.$$watchers&&b.$$watchers.$checkAll();c.preventDefault();return!1})})})(d[h]);d="selected checked disabled readonly required open".split(" ");h=0;for(F=d.length;h<F;h++)(function(a){b("mjs-"+
a,1E3,l(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.watcher.getLastResult()?this.node.setAttribute(a,!0):this.node.removeAttribute(a)}}))})(d[h]);d=function(a,b,c,d){C||(C=MetaphorJs.resolveComponent);var e,f,g,h,k;b.removeAttribute("mjs-cmp");c=c.split(" ");g=0;for(h=c.length;g<h;g++)k=c[g],""!=k&&"as"!=k&&(e?f=k:e=k);C(e,{scope:a,node:b,as:f,parentRenderer:d},a,b);return!1};d.$breakScope=!0;b("mjs-cmp",200,d);b("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,
b,c){a&&(a[c]=b)}]);b("mjs-view",200,function(a,b,c){b.removeAttribute("mjs-view");var d=f(c);if(d)a.$app.inject(d,null,!0,{$scope:a,$node:b,$app:a.$app},[{scope:a,node:b}]);else throw"View '"+c+"' not found";return!1});b("mjs-init",150,function(a,b,c){b.removeAttribute("mjs-init");E(c)(a)});b("mjs-app",0,function(){return!1})})();
(function(){var k=MetaphorJs.add,p=MetaphorJs.numberFormats,l=MetaphorJs.dateFormats;k("filter.toUpper",function(e){return e.toUpperCase()});k("filter.toLower",function(e){return e.toLowerCase()});k("filter.limitTo",function(e,a){var c=typeof e;if(!MetaphorJs.isArray(e)&&"string"!=c)return e;a=Infinity===Math.abs(Number(a))?Number(a):parseInt(a,10);if("string"==c)return a?0<=a?e.slice(0,a):e.slice(a,e.length):"";var c=[],f,b;a>e.length?a=e.length:a<-e.length&&(a=-e.length);0<a?(f=0,b=a):(f=e.length+
a,b=e.length);for(;f<b;f++)c.push(e[f]);return c});k("filter.ucfirst",function(e){return e.substr(0,1).toUpperCase()+e.substr(1)});var f=MetaphorJs.numberFormats;k("filter.numeral",function(e,a){a=f[a]||a;a=p[a]||a;return numeral(e).format(a)});var h=MetaphorJs.dateFormats;k("filter.moment",function(e,a){a=h[a]||a;a=l[a]||a;return moment(e).format(a)});var s=function(e,a,c){if(""===a||"undefined"==typeof a)return!0;if("undefined"!=typeof e){if("boolean"==typeof e)return e===a;if(c instanceof RegExp)return a.test(""+
e);if("strict"==c)return""+e===""+a;if(!0===c||null===c||"undefined"==typeof c)return-1!=""+e.indexOf(a);if(!1===c)return-1==""+e.indexOf(a)}return!1},r=function(e,a,c){if("object"!=typeof e)return"undefined"==typeof a.$?!0:s(e,a.$,c);var f,b;for(f in a)if("$"==f)for(b in e){if(s(e[b],a.$,c))return!0}else if(s(e[f],a[f],c))return!0;return!1};k("filter.filter",function(e,a,c,f){c&&!f&&(c=null);"object"!=typeof a&&(a={$:a});f=[];var b,d;b=-1;for(d=e.length;++b<d;)r(e[b],a,c)&&f.push(e[b]);return f});
k("filter.sortBy",function(e,a,c,f){c&&!f&&(c="asc");e=e.slice();e.sort(function(b,c){var e=typeof b;return e!=typeof c?0:"object"==e?b[a]>c[a]?1:b[a]<c[a]?-1:0:b>c?1:b<c?-1:0});return"desc"==c?e.reverse():e})})();
