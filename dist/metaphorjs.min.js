(function(){var h=Array.prototype.slice,p=Function.prototype.bind?function(a,d){return a.bind(d)}:function(a,d){return function(){a.apply(d,arguments)}},k=function(){var a=!1,d=h.call(arguments),c=d.shift(),b,e;for("boolean"==typeof d[d.length-1]&&(a=d.pop());b=d.shift();)for(e in b)if(b.hasOwnProperty(e))if(c[e]&&"object"==typeof c[e]&&"object"==typeof b[e])k(c[e],b[e],a);else if(!0===a||"undefined"==typeof c[e]||null===c[e])c[e]=b[e];return c},g=function(){return String.prototype.trim?function(a){return"string"==
typeof a?a.trim():a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),l={},s=function(a){return l[a]||(l[a]=new RegExp("(?:^|\\s)"+a+"(?!\\S)",""))},q=function(a,d){return s(d).test(a.className)},c=["0","0","0"];"undefined"!=typeof window?window.MetaphorJs||(window.MetaphorJs={}):global.MetaphorJs||(global.MetaphorJs={});MetaphorJs.bind=p;MetaphorJs.addListener=function(a,d,c){a.attachEvent?a.attachEvent("on"+d,c):a.addEventListener(d,c,!1)};MetaphorJs.removeListener=
function(a,d,c){a.detachEvent?a.detachEvent("on"+d,c):a.removeEventListener(d,c,!1)};MetaphorJs.extend=k;MetaphorJs.trim=g;MetaphorJs.inArray=function(a,d){return d?aIndexOf.call(d,a):-1};MetaphorJs.isArray=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"==toString.call(a)||!1};MetaphorJs.toArray=function(a){for(var d=[],c=-1,b=a.length>>>0;++c!==b;d[c]=a[c]);return d};MetaphorJs.addClass=function(a,d){q(a,d)||(a.className+=" "+d)};MetaphorJs.removeClass=function(a,
d){var c=s(d);a.className=a.className.replace(c,"")};MetaphorJs.hasClass=q;MetaphorJs.nextUid=function(){for(var a=c.length,d;a;){a--;d=c[a].charCodeAt(0);if(57==d)return c[a]="A",c.join("");if(90==d)c[a]="0";else return c[a]=String.fromCharCode(d+1),c.join("")}c.unshift("0");return c.join("")}})();
(function(){var h={}.undefined,p=MetaphorJs.extend,k=MetaphorJs.nextUid,g=MetaphorJs.addListener,l=MetaphorJs.removeListener,s=MetaphorJs.isArray,q={},c=function(b){return b._mjsId||(b._mjsId=k())},a=[],d=[],f=!1,b=!1,e=function(b,a){return b.priority<a.priority?-1:b.priority>a.priority?1:0},m,v=function(b){var a,e,m;if(s(b)){m=[];a=0;for(e=b.length;a<e;a++)m.push(v(b[a]));return m}switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0);
default:return null}},n=function(b,a,e){setTimeout(function(){b.apply(a,e||[])},0)},t,r;p(MetaphorJs,{VERSION:"0.1",registerAttributeHandler:function(b,e,c){m||(m=MetaphorJs.add);a.push({priority:e,name:b,handler:m("attr."+b,c)});f=!1},registerTagHandler:function(a,e,c){m||(m=MetaphorJs.add);d.push({priority:e,name:a,handler:m("tag."+a,c)});b=!1},getAttributeHandlers:function(){f||(a.sort(e),f=!0);return a},getTagHandlers:function(){b||(d.sort(e),b=!0);return d},numberFormats:{},dateFormats:{},getNodeId:c,
data:function(b,a,e){b=c(b);var m=q[b];return"undefined"!=typeof e?(m||(m=q[b]={}),m[a]=e):m?m[a]:h},emptyFn:function(){},clone:v,isVisible:function(b){return!(0>=b.offsetWidth||0>=b.offsetHeight)},isThenable:function(b){var a;return b&&"function"==typeof(a=b.then)?a:!1},async:n,asyncError:function(b){n(function(){throw b;})},onReady:function(b){var a=!1,e=!0,m=window,c=m.document,d=c.documentElement,v=function(e){if("readystatechange"!=e.type||"complete"==c.readyState)l("load"==e.type?m:c,e.type,
v),!a&&(a=!0)&&b.call(m,e.type||e)},n=function(){try{d.doScroll("left")}catch(b){setTimeout(n,50);return}v("poll")};if("complete"==c.readyState)b.call(m,"lazy");else{if(c.createEventObject&&d.doScroll){try{e=!m.frameElement}catch(r){}e&&n()}g(c,"DOMContentLoaded",v);g(c,"readystatechange",v);g(m,"load",v)}},toFragment:function(b){var a=document.createDocumentFragment();if(b.nodeType)a.appendChild(b);else for(var e=-1,m=b.length>>>0;++e!==m;a.appendChild(b[0]));return a},app:function(b,a){t||(t=MetaphorJs.view.Scope,
r=MetaphorJs.view.Renderer);a?a instanceof t||(a=new t(a)):a=new t;var e=new r(b,a);e.render();return e},error:function(b){var a=b.stack||Error().stack;setTimeout(function(){"undefined"!=typeof console&&console.log&&(console.log(b),a&&console.log(a))},0)}})})();
(function(){var h=/\r/g,p=MetaphorJs.trim,k=MetaphorJs.toArray,g=MetaphorJs.inArray,l=MetaphorJs.isArray,s=function(c){var a,d;if((a=q[c.type]||q[c.nodeName.toLowerCase()])&&"get"in a&&void 0!==(d=a.get(c,"value")))return d;d=c.value;return"string"===typeof d?d.replace(h,""):null==d?"":d},q={option:{get:function(c){var a=c.getAttribute("value");return null!=a?a:p(c.innerText||c.textContent)}},select:{get:function(c){for(var a,d=c.options,f=c.selectedIndex,b=(c="select-one"===c.type||0>f)?null:[],
e=c?f+1:d.length,m,v=0>f?e:c?f:0;v<e;v++)if(a=d[v],m=a.disabled||null!==a.getAttribute("disabled")||d.parentNode.disabled,(a.selected||v===f)&&!m){a=s(a);if(c)return a;b.push(a)}return b},set:function(c,a){for(var d,f,b=c.options,e=k(a),m=b.length;m--;)if(f=b[m],f.selected=g(f.value,e))d=!0;d||(c.selectedIndex=-1);return e}}};q.radio=q.checkbox={set:function(c,a){if(l(a))return c.checked=0<=g(s(c),a)},get:function(c){return null===c.getAttribute("value")?"on":c.value}};MetaphorJs.getValue=s;MetaphorJs.setValue=
function(c,a){if(1===c.nodeType){null==a?a="":"number"===typeof a&&(a+="");var d=q[c.type]||q[c.nodeName.toLowerCase()];d&&"set"in d&&void 0!==d.set(this,a,"value")||(c.value=a)}}})();
(function(){var h=function(){return!1},p=function(){return!0},k=function(g){if(!(this instanceof k))return new k(g);for(var l in g)g.hasOwnProperty&&g.hasOwnProperty(l)||this[l]||(this[l]=g[l]);this.originalEvent=g;this.type=g.type;!this.target&&g.srcElement&&(this.target=g.srcElement);this.isDefaultPrevented=g.defaultPrevented||void 0===g.defaultPrevented&&!1===g.returnValue?p:h;this.timeStamp=g&&g.timeStamp||(new Date).getTime()};k.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,
preventDefault:function(){var g=this.originalEvent;this.isDefaultPrevented=p;g&&g.preventDefault&&g.preventDefault()},stopPropagation:function(){var g=this.originalEvent;this.isPropagationStopped=p;g&&g.stopPropagation&&g.stopPropagation()},stopImmediatePropagation:function(){var g=this.originalEvent;this.isImmediatePropagationStopped=p;g&&g.stopImmediatePropagation&&g.stopImmediatePropagation();this.stopPropagation()}};window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.normalizeEvent=function(g){return new k(g)}})();
(function(){var h=MetaphorJs.extend,p=MetaphorJs.bind,k=MetaphorJs.addListener,g=MetaphorJs.removeListener,l=MetaphorJs.getValue,s=MetaphorJs.setValue,q=function(c,a,d,f){this.el=c;this.cb=a;this.scb=f;this.cbContext=d;this.inputType=a=c.getAttribute("mjs-input-type")||c.type.toLowerCase();this.listeners=[];d=c.type?c.type.toLowerCase():"";this.submittable="input"==c.nodeName.toLowerCase()&&"radio"!=d&&"checkbox"!=d;"radio"==a?this.initRadioInput():"checkbox"==a?this.initCheckboxInput():this.initTextInput()};
h(q.prototype,{el:null,inputType:null,cb:null,scb:null,cbContext:null,listeners:[],radio:null,submittable:!1,destroy:function(){var c=this.inputType,a=this.listeners,d=this.radio,f=this.el,b,e,m,v;b=0;for(e=a.length;b<e;b++)if("radio"==c)for(m=0,v=d.length;m<v;m++)g(d[m],a[b][0],a[b][1]);else g(f,a[b][0],a[b][1]);delete this.radio;delete this.el;delete this.cb;delete this.cbContext},initRadioInput:function(){var c=this.el,a=c.type,c=c.name,d,f,b;this.onRadioInputChangeDelegate=p(this.onRadioInputChange,
this);if(document.querySelectorAll)d=document.querySelectorAll("input[name="+c+"]");else{var e=document.getElementsByTagName("input"),m;d=[];f=0;for(b=e.length;f<b;f++)m=e[f],m.type==a&&m.name==c&&d.push(m)}this.radio=d;this.listeners.push(["click",this.onRadioInputChangeDelegate]);f=0;for(b=d.length;f<b;f++)k(d[f],"click",this.onRadioInputChangeDelegate)},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=p(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate]);
k(this.el,"click",this.onCheckboxInputChangeDelegate)},initTextInput:function(){var c=MetaphorJs.browser,a=!1,d=this,f=d.el,b=d.listeners,e;if(!c.android){var m=function(){a=!0},v=function(){a=!1;n()};b.push(["compositionstart",m]);b.push(["compositionend",v]);k(f,"compositionstart",m);k(f,"compositionend",v)}var n=d.onTextInputChangeDelegate=function(){if(!a)d.onTextInputChange()};if(c.hasEvent("input"))b.push(["input",n]),k(f,"input",n);else{var t=function(b){e||(e=window.setTimeout(function(){n(b);
e=null},0))},m=function(b){b=b||window.event;var a=b.keyCode;if(13==a&&d.submittable&&d.scb)return d.scb.call(d.callbackContext,b);91===a||15<a&&19>a||37<=a&&40>=a||t(b)};b.push(["keydown",m]);k(f,"keydown",m);c.hasEvent("paste")&&(b.push(["paste",t]),b.push(["cut",t]),k(f,"paste",t),k(f,"cut",t))}b.push(["change",n]);k(f,"change",n)},onTextInputChange:function(){var c=this.el.value;switch(this.inputType){case "number":c=parseInt(c,10)}this.cb.call(this.cbContext,c)},onCheckboxInputChange:function(){var c=
this.el;this.cb.call(this.cbContext,c.checked?c.getAttribute("value")||!0:!1)},onRadioInputChange:function(c){c=c||window.event;this.cb.call(this.cbContext,(c.target||c.srcElement).value)},setValue:function(c){var a=this.inputType,d,f;if("radio"==a)for(a=this.radio,d=0,f=a.length;d<f;d++){if(a[d].value==c){a[d].checked=!0;break}}else"checkbox"==a?(a=this.el,a.checked=!0===c||c==a.value):s(this.el,c)},getValue:function(){var c=this.inputType,a,d;if("radio"==c){c=this.radio;a=0;for(d=c.length;a<d;a++)if(c[a].checked)return c[a].value;
return null}return"checkbox"==c?this.el.checked?this.el.getAttribute("value")||!0:!1:l(this.el)}});window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.lib||(MetaphorJs.lib={});MetaphorJs.lib.Input=q})();
(function(){var h="undefined"!=typeof window?window:global,p={},k=function(g,l){if(p[g]||l)return p[g];var c=g.split("."),a,d=c.length,f,b=h;for(a=0;a<d;a++){f=c[a];if(!b[f])return null;b=b[f]}return b},g=function(g,l){var c;c=g.split(".");var a,d=c.pop();a=c.join(".");var f=c.length,b,e=h;if(p[a])c=[p[a],d];else{for(a=0;a<f;a++)b=c[a],e[b]||(e[b]={}),e=e[b];c=[e,d]}c[0][c[1]]=l;return p[g]=l},l=function(g,l){return p[g]=l};g("MetaphorJs.ns",{register:g,exists:function(g){return p[g]?!0:!1},get:k,
add:l,remove:function(g){delete p[g]}});MetaphorJs.r=g;MetaphorJs.g=k;MetaphorJs.add=l;"undefined"!=typeof module&&(module.exports=MetaphorJs.ns)})();
(function(){var h;if("undefined"!=typeof global)try{h=require("metaphorjs-namespace")}catch(p){h=global.MetaphorJs.ns}else h=window.MetaphorJs.ns;var k={}.undefined,g=Array.prototype.slice,l=function(b,a){return c(function(){},b,a)},s=function(b,a,e){return function(){var c=k,d=this.supr;this.supr=b.prototype[a]||function(){};try{c=e.apply(this,arguments)}catch(f){}this.supr=d;return c}},q=function(b,a,e){for(var c in a)a.hasOwnProperty(c)&&(b[c]="function"===typeof a[c]&&e.prototype&&"function"===
typeof e.prototype[c]?s(e,c,a[c]):a[c])},c=function(b,a,e){var c=function(){};c.prototype=b.prototype;c=new c;e=e||function(){this.initialize&&this.initialize.apply(this,arguments)};q(c,a,b);e.prototype=c;e.prototype.constructor=e;e.prototype.getClass=function(){return this.__proto__.constructor.__class};e.prototype.getParentClass=function(){return this.__proto__.constructor.__parentClass};e.__instantiate=function(b){return function(){var a=function(){},e;a.prototype=b.prototype;a=new a;e=b.prototype.constructor.apply(a,
arguments);return"object"==typeof e?e:a}}(e);return e},a=function(b,a,e,d,f,g){null===b&&(b="");"function"==typeof b?(f=e,"string"==typeof a?(f=d,d=e):(d=a,e=b,a=null),b=null):"string"!=typeof b&&(f=a,d=b,b=e=a=null);"string"!=typeof a&&"function"!=typeof a&&(f=d,d=e,e=a,a=null);"function"!=typeof e&&(f=d,d=e,e=null);d=d||{};var A=a&&"string"==typeof a?h.get(a):a;if(a&&!A)throw Error(a+" not found");a=A?c(A,d,e):l(d,e);a.__isMetaphorClass=!0;a.__parent=A;a.__parentClass=A?A.__class:null;a.__class=
b;if(f)for(var k in f)f.hasOwnProperty(k)&&(a[k]=f[k]);b&&(g?h.add(b,a):h.register(b,a));f&&f.alias&&h.add(f.alias,a);return a},d=function(b,e,c,d,f){return a(b,e,c,d,f,!0)},f=function(b){var a=h.get(b),e=g.call(arguments,1);if(!a)throw Error(b+" not found");return a.__instantiate.apply(this,e)},b=function(b,a){var e="string"==typeof a?h.get(a):a;return e?b instanceof e:!1},e=function(b,a){var e=b,c=h.get;"string"!=typeof a&&(a=a.getClass?a.getClass():a.prototype.constructor.__class);for("string"==
typeof b&&(e=c(b));e;){if(e.prototype.constructor.__class==a)return!0;e&&(e=e.getParentClass?c(e.getParentClass()):e.__parent)}return!1};"undefined"!=typeof global?module.exports={define:a,d:a,defineCache:d,dc:d,create:f,c:f,is:b,isSubclass:e}:(MetaphorJs.define=MetaphorJs.d=a,MetaphorJs.defineCache=MetaphorJs.dc=d,MetaphorJs.create=MetaphorJs.c=f,MetaphorJs.is=b,MetaphorJs.isSubclass=MetaphorJs.iss=e)})();
(function(){var h="undefined"!=typeof window?window.setTimeout:global.setTimeout,p=function(b){var a;return!b||"object"!=typeof b&&"function"!=typeof b||"function"!=typeof(a=b.then)?!1:a},k=Function.prototype.bind?function(b,a){return b.bind(a)}:function(b,a){return function(){b.apply(a,arguments)}},g=[],l=!1,s="undefined"!=typeof process?process.nextTick:function(b){h(b,0)},q=function(){l=!0;var b=g.shift();s(function(){b[0].apply(b[1],b[2]);g.length?q():l=!1},0)},c=function(b,a,c){c=c||[];g.push([b,
a,c]);l||q()},a=function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])},d=function(b,a){return function(c){try{a.resolve(b(c))}catch(d){a.reject(d)}}},f=function(b,a){if(b instanceof f)return b;if(!(this instanceof f))return new f(b,a);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(b)if(p(b))this.resolve(b);else if("function"==typeof b)try{b.call(a,k(this.resolve,this),k(this.reject,this))}catch(c){this.reject(c)}else throw"Cannot construct Promise with given value";};
a(f.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(b,a){var c;if(0==this._state)if(b===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(c=
p(b)){b instanceof f?b.then(k(this._processResolveValue,this),k(this._processRejectReason,this)):(new f(c,b)).then(k(this._processResolveValue,this),k(this._processRejectReason,this));return}}catch(d){0==this._state&&this._doReject(d);return}a.call(this,b)}},_callResolveHandlers:function(){this._done();for(var b=this._fulfills,a;a=b.shift();)c(a[0],a[1],[this._value]);this._cleanup()},_doResolve:function(b){this._value=b;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(b){this._processValue(b,
this._doResolve)},resolve:function(b){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(b);return this},_callRejectHandlers:function(){this._fail();for(var b=this._rejects,a;a=b.shift();)c(a[0],a[1],[this._reason]);this._cleanup()},_doReject:function(b){this._state=2;this._reason=b;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(b){this._processValue(b,this._doReject)},reject:function(b){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(b);
return this},then:function(b,a){var m=new f,v=this._state;0==v||0!=this._wait?(b&&"function"==typeof b?this._fulfills.push([d(b,m),null]):this._fulfills.push([m.resolve,m]),a&&"function"==typeof a?this._rejects.push([d(a,m),null]):this._rejects.push([m.reject,m])):1==v?b&&"function"==typeof b?c(d(b,m),null,[this._value]):m.resolve(this._value):2==v&&(a&&"function"==typeof a?c(d(a,m),null,[this._reason]):m.reject(this._reason));return m},"catch":function(b){return this.then(null,b)},_done:function(){for(var b=
this._dones,a;a=b.shift();)a[0].call(a[1]||null,this._value)},done:function(b,a){var c=this._state;1==c&&0==this._wait?b.call(a||null,this._value):0==c&&this._dones.push([b,a]);return this},_fail:function(){for(var b=this._fails,a;a=b.shift();)a[0].call(a[1]||null,this._reason)},fail:function(b,a){var c=this._state;2==c&&0==this._wait?b.call(a||null,this._reason):0==c&&this._fails.push([b,a]);return this},always:function(b,a){this.done(b,a);this.fail(b,a);return this},promise:function(){return{then:k(this.then,
this),done:k(this.done,this),fail:k(this.fail,this),always:k(this.always,this)}},after:function(b){var a=this;if(p(b)){a._wait++;var c=function(){a._wait--;0==a._wait&&0!=a._state&&(1==a._state?a._callResolveHandlers():a._callRejectHandlers())};"function"==typeof b.done?b.done(c):b.then(c)}return a}});a(f,{resolve:function(b){if(p(b)||"function"==typeof b)return new f(b);var a=new f;a.resolve(b);return a},reject:function(b){var a=new f;a.reject(b);return a},all:function(b){if(!b.length)return f.resolve(null);
var a=new f,c=b.length,d=[],n=c,g,r,l=function(b){d.push(b);n--;0==n&&a.resolve(d)};for(g=0;g<c;g++)r=b[g],r instanceof f?r.done(l).fail(a.reject,a):p(r)||"function"==typeof r?(new f(r)).done(l).fail(a.reject,a):l(r);return a},when:function(){return f.all(arguments)},allResolved:function(b){if(!b.length)return f.resolve(null);var a=new f,c=b.length,d=[],n=c,g,r,l=function(b){d.push(b);h()},h=function(){n--;0==n&&a.resolve(d)};for(g=0;g<c;g++)r=b[g],r instanceof f?r.done(l).fail(h):p(r)||"function"==
typeof r?(new f(r)).done(l).fail(h):l(r);return a},race:function(b){if(!b.length)return f.resolve(null);var a=new f,c=b.length,d,n;for(d=0;d<c&&(n=b[d],n instanceof f?n.done(a.resolve,a).fail(a.reject,a):p(n)||"function"==typeof n?(new f(n)).done(a.resolve,a).fail(a.reject,a):a.resolve(n),a.isPending());d++);return a}});"undefined"==typeof global?(window.Promise||(window.Promise=f),window.MetaphorJs&&window.MetaphorJs.r("MetaphorJs.lib.Promise",f)):"undefined"!=typeof module&&(module.exports=f)})();
(function(){"undefined"==typeof window&&(global.window=global);if(window.Promise)h=window.Promise;else{var h;if("undefined"!=typeof global)try{h=require("metaphorjs-promise")}catch(p){global.Promise&&(h=global.Promise)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Promise&&(h=MetaphorJs.lib.Promise)}var k=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){return Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10)},g=function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])},l=Array.prototype.slice,s="undefined"!=typeof process?process.nextTick:function(b){window.setTimeout(b,0)},q=Function.prototype.bind?function(b,a){return b.bind(a)}:function(b,a){return function(){b.apply(a,arguments)}},c=function(){this.events={}};g(c.prototype,{createEvent:function(b,c){b=b.toLowerCase();var d=this.events;d[b]||(d[b]=new a(b,c));return d[b]},getEvent:function(b){b=b.toLowerCase();return this.events[b]},on:function(b,c,d,f){b=b.toLowerCase();var n=this.events;n[b]||
(n[b]=new a(b));return n[b].on(c,d,f)},once:function(b,a,c,d){d=d||{};d.limit=1;return this.on(b,a,c,d)},un:function(b,a,c){b=b.toLowerCase();var d=this.events;d[b]&&d[b].un(a,c)},hasListener:function(b,a,c){b=b.toLowerCase();var d=this.events;return d[b]?d[b].hasListener(a,c):!1},removeAllListeners:function(b){var a=this.events;a[b]&&a[b].removeAllListeners()},triggerAsync:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return[];b=a[b];return b.triggerAsync.apply(b,l.call(arguments,
1))},trigger:function(){var a=arguments[0],c=this.events,a=a.toLowerCase();if(!c[a])return null;a=c[a];return a.trigger.apply(a,l.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var c=this.events;c[a]&&c[a].suspend()},suspendAllEvents:function(){var a=this.events,c;for(c in a)a[c].suspend()},resumeEvent:function(a){a=a.toLowerCase();var c=this.events;c[a]&&c[a].resume()},resumeAllEvents:function(){var a=this.events,c;for(c in a)a[c].resume()},destroyEvent:function(a){var c=this.events;
c[a]&&(c[a].removeAllListeners(),c[a].destroy(),delete c[a])},destroy:function(a){var c=this.events;if(a)a=a.toLowerCase(),c[a]&&(c[a].destroy(),delete c[a]);else{for(var d in c)c[d].destroy();this.events={}}},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners triggerAsync trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),c={},d,f=-1,n=a.length;++f<n;d=a[f],c[d]=q(this[d],this));this.api=c}return this.api}});
var a=function(a,c){this.name=a;this.listeners=[];this.map={};this.hash=k();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=c||!1};g(a.prototype,{getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(a,c,d){if(!a)return null;c=c||null;d=d||{};var f=this.uni,n=c||a;if(n[f]&&!d.allowDupes)return null;var g=++this.lid,r=d.first||!1;n[f]=g;a={fn:a,scope:c,uniScope:n,id:g,called:0,limit:d.limit||0,start:d.start||1,count:0,append:d.append,
prepend:d.prepend};r?this.listeners.unshift(a):this.listeners.push(a);this.map[g]=a;return g},once:function(a,c,d){d=d||{};d.once=!0;return this.on(a,c,d)},un:function(a,c){var d=-1,f=this.uni,n=this.listeners,g;g=a==parseInt(a)?a:(c||a)[f];if(!g)return!1;for(var r=0,l=n.length;r<l;r++)if(n[r].id==g){d=r;delete n[r].uniScope[f];break}if(-1==d)return!1;n.splice(d,1);delete this.map[g];return!0},hasListener:function(a,c){var d=this.listeners,f;if(a){c=c||a;f=a==parseInt(a)?a:c[this.uni];if(!f)return!1;
for(var g=0,l=d.length;g<l;g++)if(d[g].id==f)return!0;return!1}return 0<d.length},removeAllListeners:function(){var a=this.listeners,c=this.uni,d,f;d=0;for(f=a.length;d<f;d++)delete a[d].uniScope[c];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,c){var d;a.append||a.prepend?(d=l.call(c),a.prepend&&(d=a.prepend.concat(d)),a.append&&(d=d.concat(a.append))):d=c;return d},triggerAsync:function(){if("undefined"==typeof h)throw Error("Promises are not defined");
var a=this,c=a.listeners,d=a.returnResult,f=l.call(arguments),g=[],k=[],r,y,A;if(a.suspended||0==c.length)return h.resolve(null);y=0;for(A=c.length;y<A;y++)g.push(c[y]);for(y=function(c){r=a._prepareArgs(c,f);return new h(function(d,f){s(function(){try{d(c.fn.apply(c.scope,r))}catch(e){f(e)}c.called++;c.called==c.limit&&a.un(c.id)},0)})};(c=g.shift())&&(!c||!a.map[c.id]||(c.count++,c.count<c.start||(k.push(y(c)),"first"!=d))););return"last"==d?[k.pop()]:k},trigger:function(){var a=this.listeners,
c=this.returnResult;if(this.suspended||0==a.length)return null;var d="all"==c?[]:null,f=[],g,l;if("first"==c)f.push(a[0]);else for(g=0,l=a.length;g<l;g++)f.push(a[g]);for(;a=f.shift();)if(a&&this.map[a.id]&&(a.count++,!(a.count<a.start))){g=a.fn.apply(a.scope,this._prepareArgs(a,arguments));a.called++;a.called==a.limit&&this.un(a.id);"all"==c&&d.push(g);if("first"==c)return g;"last"==c&&(d=g);if(!1==c&&!1===g)break}if(c)return d}});var d=window.MetaphorJs;if(d&&d.VERSION){var f=new c;g(MetaphorJs,
f.getApi())}d&&d.r?d.r("MetaphorJs.lib.Observable",c):(window.MetaphorJs=window.MetaphorJs||{},MetaphorJs.lib=MetaphorJs.lib||{},MetaphorJs.lib.Observable=c);"undefined"!=typeof global&&(module.exports=c)})();
(function(){"undefined"==typeof window&&(global.window=global);var h;if("undefined"!=typeof global)try{h=require("metaphorjs-observable")}catch(p){global.Observable&&(h=global.Observable)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Observable&&(h=MetaphorJs.lib.Observable);var k=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,g={},l=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){var a;a=Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10);return g[a]?
l():g[a]=a},s=Object.prototype.toString,q=function(a){return"[object Array]"===s.call(a)},c=function(a){return"[object Date]"===s.call(a)},a=function(a){return"[object RegExp]"===s.call(a)},d=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},f=function(b,e){if(d(b))throw Error("Cannot copy window object");if(e){if(b===e)throw Error("Objects are identical");if(q(b))for(var g=e.length=0;g<b.length;g++)e.push(f(b[g]));else{for(g in e)delete e[g];for(g in b)e[g]=f(b[g])}}else(e=b)&&
(q(b)?e=f(b,[]):c(b)?e=new Date(b.getTime()):a(b)?e=new RegExp(b.source):null!=b&&"object"===typeof b&&(e=f(b,{})));return e},b=function(f,e){if(f===e)return!0;if(null===f||null===e)return!1;if(f!==f&&e!==e)return!0;var g=typeof f,x;if(g==typeof e&&"object"==g)if(q(f)){if(!q(e))return!1;if((g=f.length)==e.length){for(x=0;x<g;x++)if(!b(f[x],e[x]))return!1;return!0}}else{if(c(f))return c(e)&&f.getTime()==e.getTime();if(a(f)&&a(e))return f.toString()==e.toString();if(d(f)||d(e)||q(e))return!1;g={};for(x in f)if(("$"!==
x.charAt(0)||"object"!=typeof f[x])&&"function"!==typeof f[x]){if(!b(f[x],e[x]))return!1;g[x]=!0}for(x in e)if(!g.hasOwnProperty(x)&&"$"!==x.charAt(0)&&void 0!==e[x]&&"function"!==typeof e[x])return!1;return!0}return!1},e=function(a,c){var d=a.length,f=c.length,e=Array(d+1),g=Array(d+1),u,w,C,m,r=0;if(d==f&&0==d)return{changes:0,distance:0,prescription:[]};for(u=0;u<=d;u++)e[u]=Array(f+1),g[u]=Array(f+1),e[u][0]=u,g[u][0]="D";for(u=0;u<=f;u++)e[0][u]=u,g[0][u]="I";for(u=1;u<=d;u++)for(w=1;w<=f;w++)C=
b(a[u-1],c[w-1])?0:1,e[u][w-1]<e[u-1][w]&&e[u][w-1]<e[u-1][w-1]+C?(e[u][w]=e[u][w-1]+1,g[u][w]="I"):e[u-1][w]<e[u-1][w-1]+C?(e[u][w]=e[u-1][w]+1,g[u][w]="D"):(e[u][w]=e[u-1][w-1]+C,g[u][w]=1==C?"R":"-");m=[];u=d;w=f;do C=g[u][w],m.push(C),"-"!=C&&r++,"R"==C||"-"==C?(u--,w--):"D"==C?u--:w--;while(0!=u||0!=w);return{changes:r/m.length,distance:e[d][f],prescription:m.reverse()}},m=window.MetaphorJs?MetaphorJs.trim:function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():
a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),v,n=window.MetaphorJs?MetaphorJs.ns.get:null,t=function(a,b,c,d,e){v||(v=new h);var f=l(),u;q(a)&&null===b?u="array":("string"!=typeof b&&(d=c,c=b,b=null,u="object"),"string"==typeof a&&(d=c,c=b,b=a,a=null),b&&a&&(u=a.hasOwnProperty(b)?"attr":"expr"),b&&!a&&(u="expr"));if(c)v.on(f,c,d||this,{append:[e],allowDupes:!0});this.code=b=this._processPipes(b,a);this.getterFn="expr"==u?H(b):null;this.id=f;this.type=u;
this.obj=a;this.itv=null;this.curr=this._getValue()};(function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(t.prototype,{code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,arraySlice:!1,pipes:null,_addPipe:function(a,b,c){var d=b.shift(),e=null,f=[],u;n&&(e=n("filter."+d,!0));e||(e=window[d]||c[d]);if("function"==typeof e){d=-1;for(u=b.length;++d<u;f.push(r(c,b[d],self.check,self)));a.push([e,b,f])}},_processPipes:function(a,b){for(var c=0,d=a.length,e=[],
f,u,w,g=!1,r=a;c<d;)if(-1!=(f=a.indexOf("|",c)))u=a.charAt(f-1),w=a.charAt(f+1),"|"!=u&&"'"!=u&&'"'!=u&&"|"!=w&&"'"!=w&&'"'!=w&&(g?(c=m(a.substring(c,f)).split(":"),this._addPipe(e,c,b)):(g=!0,r=m(a.substring(0,f)))),c=f+1;else{g&&(c=m(a.substr(c)).split(":"),this._addPipe(e,c,b));break}e.length&&(this.pipes=e);return r},_checkCode:function(){var a=this._getValue(),b=!1,c=this.curr;if(q(c)&&q(a))return b=e(c,a),b.changes?(this.curr=a.slice(),v.trigger(this.id,b,a,c),!0):!1;a!==c&&(this.curr=a,v.trigger(this.id,
a,c),b=!0);return b},_checkObject:function(){var a=this.obj,c=this.curr;return b(c,a)?!1:(this.curr=f(a),v.trigger(this.id,a,c),!0)},_checkArray:function(){var a=this.curr,b=this.obj,c=e(a,b);return c.changes?(this.curr=b.slice(),v.trigger(this.id,c,b,a),!0):!1},_getValue:function(){var a;switch(this.type){case "attr":a=this.obj[this.code];break;case "expr":try{a=this.getterFn(this.obj)}catch(b){if(window.MetaphorJs)MetaphorJs.asyncError(b);else throw b;}"undefined"==typeof a&&(a="");break;case "object":a=
f(this.obj);break;case "array":a=this.obj}q(a)&&(a=a.slice());var c=this.pipes;if(c){var d,e,g,u=c.length,w=this.obj,C,m;for(d=0;d<u;d++){g=c[d][1];e=[];C=-1;for(m=g.length;++C<m;e.push(J(g[C],w)));e.unshift(a);e.push(w);a=c[d][0].apply(null,e)}}return a},addListener:function(a,b,c){return v.on(this.id,a,b,c)},removeListener:function(a,b){return v.un(this.id,a,b)},getValue:function(){return this._getValue()},setValue:function(a){var b=this.type;if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||
(this.setterFn=I(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";},check:function(){switch(this.type){case "expr":case "attr":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&
(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,b){var c=this.id;v.un(c,a,b);return v.hasListener(c)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b,c,d,e,f;this.itv&&this.clearInterval();if(a)for(b=-1,c=a.length;++b<c;)for(f=a[b][2],d=-1,e=f.length;++d<e;)f[d].unsubscribeAndDestroy(this.check,this);this.pipes=this.obj=this.curr=null;v.destroyEvent(this.id);this.obj&&delete this.obj.$$watchers[this.code]}});var r=function(a,b,c,d,e){b=y(a,m(b));return a?(a.$$watchers||
(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof t&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof t)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].addListener(c,d,{append:[e],allowDupes:!0}):a.$$watchers[b]=new t(a,b,c,d,e),a.$$watchers[b]):new t(a,b,c,d,e)},y=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==
b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},A=Function,F={},H=function(a){return F[a]?F[a]:F[a]=new A("____","".concat("try {","return ",a.replace(k,"$1____.$3"),";} catch (e) { error(e); }"))},B={},I=function(a){if(!B[a]){var b=a.replace(k,"$1____.$3");return B[a]=new A("____","$$$$","".concat("try {",b," = $$$$",";} catch (e) { error(e); }"))}return B[a]},D={},J=function(a,b){return H(a)(b)},E=function(a){if("string"!=typeof a)return!1;a=a.substr(0,1);return!('"'==a||"'"==
a||"."==a)};t.create=r;t.unsubscribeAndDestroy=function(a,b,c,d){b=m(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,d)&&delete a[b]};t.normalizeExpr=y;t.prepareCode=function(a){return a.replace(k,"$1____.$3")};t.createGetter=H;t.createSetter=I;t.createFunc=function(a){return D[a]?D[a]:D[a]=new A("____","".concat("try {",a.replace(k,"$1____.$3"),";} catch (e) { error(e); }"))};t.eval=J;t.isExpression=function(a){var b=a.substr(0,1);return('"'==b||"'"==b)&&a.substr(a.length-1)==b||""+parseInt(a,
10)===a?!1:!0};t.isNativeString=E;t.toExpression=function(a){return E(a)?"'"+a+"'":a};window.MetaphorJs&&MetaphorJs.r&&MetaphorJs.r("MetaphorJs.lib.Watchable",t);"undefined"!=typeof global&&(module.exports=t)})();
(function(){var h,p;if("undefined"!=typeof global)try{h=require("metaphorjs-promise"),p=require("metaphorjs-observable")}catch(k){h=global.MetaphorJs.lib.Promise,p=global.MetaphorJs.lib.Observable}else h=window.MetaphorJs.lib.Promise,p=window.MetaphorJs.lib.Observable;var g=MetaphorJs.extend,l=MetaphorJs.bind,s=MetaphorJs.addListener,q=MetaphorJs.trim,c=MetaphorJs.isArray,a;"undefined"!=typeof window&&(a=document.querySelectorAll||function(a){var b=document,c=b.documentElement.firstChild,d=b.createElement("STYLE");
c.appendChild(d);b.__qsaels=[];d.sheet?d.sheet.insertRule(a+"{x:expression(document.__qsaels.push(this))}",0):d.styleSheet&&(d.styleSheet.cssText=a+"{x:expression(document.__qsaels.push(this))}");window.scrollBy(0,0);return b.__qsaels});var d=/#.*$/,f=/([?&])_=[^&]*/,b=/\?/,e=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,m=/^(?:GET|HEAD)$/i,v=0,n=function(a,b){setTimeout(function(){a.call(b)},0)},t=function(a,b){var c,d;if(!a||"string"!==typeof a)return null;try{d=new DOMParser,c=d.parseFromString(a,
b||"text/xml")}catch(e){c=void 0}if(!c||c.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return c},r=function(a,b,d){var e,f;if("string"==typeof a&&d)b.push(encodeURIComponent(d)+"="+encodeURIComponent(a));else if(c(a)&&d)for(e=0,f=a.length;e<f;e++)r(a[e],b,d+"["+e+"]");else if("object"==typeof a)for(e in a)a.hasOwnProperty(e)&&r(a[e],b,d?d+"["+e+"]":e)},y=function(a,c){a.replace(d,"");if(!1===c.cache){var e=(new Date).getTime();return f.test(a)?a.replace(f,"$1_="+e):a+(b.test(a)?
"&":"?")+"_="+e}!c.data||window.FormData&&c.data instanceof window.FormData||("string"!=typeof c.data?(e=[],r(c.data,e,null),e=e.join("&").replace(/%20/g,"+")):e=c.data,c.data=e,m.test(c.method)&&(a+=(b.test(a)?"&":"?")+c.data,c.data=null));return a},A={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},F={url:null,data:null,method:"GET",headers:null,username:null,password:null,
cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},H={},B=new p,I=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},D=function(a,b,d){var e,f;if("object"!=
typeof a&&"function"!=typeof a&&d)e=document.createElement("input"),e.setAttribute("type","hidden"),e.setAttribute("name",d),e.setAttribute("value",a),b.appendChild(e);else if(c(a)&&d)for(e=0,f=a.length;e<f;e++)D(a[e],b,d+"["+e+"]");else if("object"==typeof a)for(e in a)a.hasOwnProperty(e)&&D(a[e],b,d?d+"["+e+"]":e)},J=function(a){for(var b,c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],b.hasAttribute("name"))if(c="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT",
"FILE"===c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},E=function(){},L=function(b,c,d){var e=c?c.dataType:null;c=c?c.selector:null;if("string"!=typeof b)return b;d=d||"";if("xml"===e||!e&&0<=d.indexOf("xml"))return b=t(q(b)),c?a.call(b,c):b;if("html"===e)return b=t(b,"text/html"),c?a.call(b,c):b;if("fragment"==e){d=document.createDocumentFragment();
e=document.createElement("div");for(e.innerHTML=b;e.firstChild;)d.appendChild(e.firstChild);return d}if("json"===e||!e&&0<=d.indexOf("json"))return b=q(b),JSON.parse(b);("script"===e||!e&&0<=d.indexOf("javascript"))&&I(b);return b+""},G=function(a){var b=e.exec(("undefined"!=typeof window?window.location.href:"").toLowerCase())||[],c=e.exec(a.url.toLowerCase());this._opt=a;a.crossDomain=!(!c||c[1]===b[1]&&c[2]===b[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(b[3]||("http:"===b[1]?"80":"443")));b=new h;
"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||"undefined"!=typeof window&&window.FormData||"iframe"==a.transport||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):J(a.form));a.url=y(a.url,a);c=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new M(a,b,this):new x(a,b,this):new K(a,b,this);this._deferred=b;this._transport=c;b.done(function(a){B.trigger("success",
a)});b.fail(function(a){B.trigger("error",a)});b.always(function(){B.trigger("end")});B.trigger("start");a.timeout&&(this._timeout=setTimeout(l(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===B.trigger("beforeSend",a,c)&&(this._promise=h.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,c)&&(this._promise=h.reject());this._promise||(n(c.send,c),a=b.promise(),a.abort=l(this.abort,this),b.always(this.destroy,this),this._promise=a)};g(G.prototype,{_jsonpName:null,_transport:null,
_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);D(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,c=a.jsonpParam||
"callback",d=a.jsonpCallback||"jsonp_"+ ++v;a.url+=(b.test(a.url)?"&":"?")+c+"="+d;this._jsonpName=d;"undefined"!=typeof window&&(window[d]=l(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=l(this.jsonpCallback,this));return d},jsonpCallback:function(a){try{this._deferred.resolve(this.processResponseData(a))}catch(b){this._deferred.reject(b)}},processResponseData:function(a,b){var c=this._opt;a=L(a,c,b);B.hasListener("processResponse")&&(a=B.trigger("processResponse",a,this._deferred));
c.processResponse&&(a=c.processResponse.call(c.callbackScope,a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred;if(this._opt.jsonp)if(a){try{I(a)}catch(d){c.reject(d)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else try{c.resolve(this.processResponseData(a,b))}catch(e){c.reject(e)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);
this._transport.destroy();delete this._transport;delete this._opt;delete this._deferred;delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},!0);var z=function(a,b){b=b||{};a&&"string"!=typeof a?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),!b.url))throw"Must provide url";g(b,H,!1);g(b,F,!1);b.method=b.method?b.method.toUpperCase():
b.form?b.form.getAttribute("method").toUpperCase()||"GET":"GET";return(new G(b)).promise()};z.setup=function(a){g(H,a,!0)};z.on=function(){B.on.apply(B,arguments)};z.un=function(){B.un.apply(B,arguments)};z.get=function(a,b){b=b||{};b.method="GET";return z(a,b)};z.post=function(a,b){b=b||{};b.method="POST";return z(a,b)};z.load=function(a,b,c){c=c||{};"string"!=typeof b&&(c=b);c.dataType="fragment";return z(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};
z.loadScript=function(a){return z(a,{transport:"script"})};z.submit=function(a,b){b=b||{};b.form=a;return z(null,b)};var x=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&s(d,"progress",l(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&s(d.upload,"progress",l(a.uploadProgress,a.callbackScope));
try{var e;if(a.xhrFields)for(e in a.xhrFields)d[e]=a.xhrFields[e];a.data&&a.contentType&&d.setRequestHeader("Content-Type",a.contentType);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Accept",a.dataType&&A[a.dataType]?A[a.dataType]+", */*; q=0.01":A._default);for(e in a.headers)d.setRequestHeader(e,a.headers[e])}catch(f){}d.onreadystatechange=l(this.onReadyStateChange,this)};g(x.prototype,{_xhr:null,_deferred:null,_ajax:null,onReadyStateChange:function(){var a=this._xhr,
b=this._deferred;if(0===a.readyState)a.onreadystatechange=E,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=E;var c;a:{try{c=!a.status&&"undefined"!=typeof location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse("string"==typeof a.responseText?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=E;this._xhr.abort()},send:function(){var a=
this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}},!0);var K=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};g(K.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);
s(a,"load",l(this.onLoad,this));s(a,"error",l(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);var M=function(a,b,c){this._opt=a;this._ajax=
c;this._deferred=b};g(M.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+ ++v,c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);s(a,"load",l(this.onLoad,this));s(a,"error",l(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},onLoad:function(){var a=this._el;this._opt&&
!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);"undefined"!=typeof global?module.exports=z:window.MetaphorJs?MetaphorJs.ajax=z:window.MetaphorJs=
{ajax:z}})();
(function(){var h=[],p=!1,k=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/,g=function(a,c,b){a.attachEvent?a.attachEvent("on"+c,b):a.addEventListener(c,b,!1)},l=!!history.pushState,s="onhashchange"in window,q=function(a){var c=location.protocol+"//"+location.hostname;location.port&&(c+=":"+location.port);a=a.replace(c,"");l||(a=encodeURIComponent(a));return a},c=function(){var a;l?a=location.pathname+location.search:(a=location.hash.substr(1))?("!"==
a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a)):a=location.pathname+location.search;return a},a=function(){var a=c();if(h.length)for(var f=-1,b=h.length;++f<b;h[f].call(null,a));window.MetaphorJs&&MetaphorJs.triggerAsync("locationchange",a)};g(window,"load",function(){p=!0});history.initPushState=function(){if(l)history.origPushState=history.pushState,history.origReplaceState=history.replaceState,g(window,"popstate",a),history.pushState=function(b,c,d){history.origPushState(b,c,q(d));a()},
history.replaceState=function(b,c,d){history.origReplaceState(b,c,q(d));a()};else if(s)history.replaceState=history.pushState=function(a,b,c){a=q(c);location.hash=a?"!"+a:""},g(window,"hashchange",a);else{var c=null,f=!1;window.onIframeHistoryChange=function(b){f||(location.hash=b?"!"+b:"",a())};var b=function(a){var b=c.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');
b.close()};history.pushState=function(a,c,d){b(q(d))};history.replaceState=function(a,b,e){a=q(e);c.contentWindow.hashValue=a};var e=function(){c=document.createElement("iframe");c.src="about:blank";c.style.display="none";document.body.appendChild(c);f=!0;b(q(location.hash.substr(1)));f=!1};p?e():g(window,"load",e)}g(document.documentElement,"click",function(a){a=a||window.event;for(var b=a.target||a.srcElement,c;b&&"a"!=b.nodeName.toLowerCase();)b=b.parentNode;if(b){c=b.getAttribute("href");var d;
if(d=c&&"#"!=c.substr(0,1))c=c.match(k),d=c[1]&&location.protocol!=c[1]||c[2]&&location.hostname!=c[2]?!1:c[2]||c[3]?location.port!=c[3]?!1:!0:!0;if(d&&!b.getAttribute("target"))return history.pushState(null,null,b.getAttribute("href")),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1}});history.initPushState=function(){}};window.MetaphorJs?(MetaphorJs.pushUrl=function(a){history.pushState(null,null,a)},MetaphorJs.replaceUrl=function(a){history.replaceState(null,null,
a)},MetaphorJs.currentUrl=function(){return c()}):history.onchange=function(a){h.push(a)}})();
(function(){var h=MetaphorJs.lib.Observable,p=MetaphorJs.extend;MetaphorJs.d("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(k){k=k||{};this._observable=new h;p(this,this._observable.getApi());if(k.callback){var g=k.callback,l=g.scope||this;delete g.scope;for(var s in g)if(g.hasOwnProperty(s))this.on(s,g[s],l);delete k.callback}p(this,k,!0)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",
this);this._observable.destroy();delete this._observable}},onDestroy:MetaphorJs.emptyFn})})();
(function(){var h={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},p=["Moz","Webkit","ms","O","Khtml"],k="animationDelay",g="animationDuration",l="transitionDelay",s="transitionDuration",q=0,c=function(){var a=document.createElement("div"),b=!1,c,d,e;if(void 0!==a.style.animationName)b=!0;else for(d=0,e=p.length;d<e;d++)if(c=p[d],void 0!==a.style[c+"AnimationName"]){b=!0;k=c+"AnimationDelay";g=c+"AnimationDuration";l=c+"TransitionDelay";s=c+"TransitionDuration";
break}return b}(),a=window.requestAnimationFrame?window.requestAnimationFrame:function(a){window.setTimeout(a,0)},d=MetaphorJs.g,f=MetaphorJs.lib.Promise,b=MetaphorJs.data,e=MetaphorJs.isThenable,m=function(b,c,d){var e=function(){(new Date).getTime()-c>=d?b():a(e)};a(e)},v=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},n=function(a,b,c){var d,e,f=b.length;for(d=0;d<f;d++)e=v(b[d])+v(c[d]),a=Math.max(e,a);return a},t=function F(c,d,f,h,p,q,v){var G=function(){var a=
b(c,"mjsAnimationQueue");return a&&a.length&&a[0].id==v?!1:(p.reject(c),!0)},z=function(){if(!G()){var a=f;f++;if(f==d.length){p.resolve(c);b(c,"mjsAnimationQueue").shift();var e=b(c,"mjsAnimationQueue");e.length?(e=e[0],t(e.el,e.stages,0,e.start,e.deferred,!1,e.id)):b(c,"mjsAnimationQueue",null)}else b(c,"mjsAnimationQueue")[0].position=f,F(c,d,f,null,p);y(c,d[a]);y(c,d[a]+"-active")}},x=function(){if(!G()){r(c,d[f]+"-active");var a,b=window.getComputedStyle?window.getComputedStyle(c):c.style;a=
0;var e=(b[g]||"").split(","),x=(b[k]||"").split(","),K=(b[s]||"").split(","),b=(b[l]||"").split(",");a=Math.max(a,n(a,e,x));(a=Math.max(a,n(a,K,b)))?m(z,(new Date).getTime(),a):z()}},K=function(){if(!G()){r(c,d[f]);var b;h&&(b=h(c),h=null);e(b)?b.done(x):a(x)}};q?a(K):K()},r=MetaphorJs.addClass,y=MetaphorJs.removeClass;MetaphorJs.stopAnimation=function(a){var c=b(a,"mjsAnimationQueue"),d;c&&c.length&&(d=c[0])&&d.stages&&(c=d.position,d=d.stages,y(a,d[c]),y(a,d[c]+"-active"));b(a,"mjsAnimationQueue",
null)};MetaphorJs.animate=function(a,g,r){var l=a.getAttribute("mjs-animate"),m=a.getAttribute("mjs-animate-js"),n=new f,k=b(a,"mjsAnimationQueue")||[],y=++q,p,s;g&&"string"==typeof g&&(g=h[g]);"string"==typeof l&&l&&"["==l.substr(0,1)&&(g=(new Function("","return "+l))(),l=null);k.push({el:a,stages:g,start:r,deferred:n,position:0,id:y});b(a,"mjsAnimationQueue",k);void 0!=l&&c&&g?1==k.length&&t(a,g,0,r,n,!0,y):(p=m||l)&&(s=d("animate."+p,!0))?s(a,r,n):r?(g=r(a),e(g)?g.done(function(){n.resolve(a)}):
n.resolve(a)):n.resolve(a);return n.promise()}})();
(function(){var h=MetaphorJs.lib.Observable,p=MetaphorJs.lib.Watchable,k=MetaphorJs.extend,g;g=MetaphorJs.d("MetaphorJs.view.Scope",{$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$checking:!1,$$destroyed:!1,initialize:function(g){this.$$observable=new h;k(this,g);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)},$new:function(){return new g({$parent:this,$root:this.$root})},
$on:function(g,h,k){return this.$$observable.on(g,h,k)},$un:function(g,h,k){return this.$$observable.un(g,h,k)},$watch:function(g,h,k){p.create(this,g,h,k,null)},$unwatch:function(g,h,k){p.unsubscribeAndDestroy(this,g,h,k)},$get:function(g){for(var h=this;h;){if(void 0!=h[g])return h[g];h=h.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$check:function(){var g;this.$$checking||(this.$$checking=!0,this.$$watchers&&(g=this.$$watchers.$checkAll()),this.$$checking=
!1,this.$$destroyed||this.$$observable.trigger("check",g))},$destroy:function(){this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);this.$$destroyed=!0}})})();
(function(){var h=navigator.userAgent.toLowerCase(),p=parseInt((/msie (\d+)/.exec(h)||[])[1],10),k=parseInt((/android (\d+)/.exec(h)||[])[1],10),g={};isNaN(p)&&(p=parseInt((/trident\/.*; rv:(\d+)/.exec(h)||[])[1],10));window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.browser={android:k,hasEvent:function(h){if("input"==h&&9==p)return!1;if(void 0===g[h]){var k=document.createElement("div");g[h]="on"+h in k}return g[h]}}})();
(function(){var h=MetaphorJs.nextUid,p=MetaphorJs.view.Scope,k=MetaphorJs.lib.Watchable,g=MetaphorJs.lib.Observable,l=MetaphorJs.isThenable,s=MetaphorJs.toArray,q=MetaphorJs.getAttributeHandlers,c=null,a=MetaphorJs.g,d=k.create,f=k.unsubscribeAndDestroy,b,e="string"==typeof document.createTextNode("").textContent?"textContent":"nodeValue",m=function(a,b,c,d,e){var f=[];if(a&&!0!==a){if(a.nodeType){n(a,c,d,e);return}f=s(a)}f.length||(f=s(b.childNodes));a=-1;for(b=f.length>>>0;++a!==b;n(f[a],c,d,e));
},v=/^(script|template|mjs-template|style)$/i,n=function(a,b,c,d){var e;if(!a.nodeName.match(v)){try{e=b.call(c,a,d)}catch(f){MetaphorJs.error(f)}!1!==e&&(l(e)?e.done(function(e){!1!==e&&m(e,a,b,c,d)}):m(e,a,b,c,d))}},t=new g;b=MetaphorJs.d("MetaphorJs.view.Renderer",{id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,initialize:function(a,b,c){this.id=h();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof p&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",
this.destroy,this);this.process()},on:function(a,b,c){return t.on(a+"-"+this.id,b,c)},un:function(a,b,c){return t.un(a+"-"+this.id,b,c)},createChild:function(a){return new b(a,this.scope,this)},reset:function(){},getEl:function(){return this.el},runHandler:function(a,b,c,d){var e;if(a.$breakRenderer)return this.createChild(c).render(),!1;a.$isolateScope?e=new p:a.$breakScope?b instanceof p?e=b.$new():(e={},e.$parent=b,e.$root=b.$root):e=b;return a.__isMetaphorClass?(b=new a(e,c,d,this),a.$stopRenderer||
b.$stopRenderer?!1:b.$returnToRenderer):a(e,c,d,this)},processNode:function(b,d){var f=b.nodeType,g=this.texts,h=this.scope,k;if(3==f)h={watchers:[],node:b,text:"",inx:k=g.length},this.processText(h,b[e]),0<h.watchers.length&&(g.push(h),d&&this.renderText(k));else if(1==f){c||(c=q());var m=b.attributes,n,l,p,t,f="tag."+b.tagName.toLowerCase();if(n=a(f,!0))if((t=this.runHandler(n,h,b))||!1===t)return t;n=0;for(l=c.length;n<l;n++)if(p=c[n].name,null!==(k=b.getAttribute(p))&&"undefined"!=typeof k&&(t=
this.runHandler(c[n].handler,h,b,k),b.removeAttribute(p),t||!1===t))return t;n=0;for(l=m.length;n<l;n++)a(f,!0)||(h={watchers:[],node:b,attr:m[n].name,text:"",inx:k=g.length},this.processText(h,m[n].value),0<h.watchers.length&&(g.push(h),d&&this.renderText(k)))}return!0},process:function(){n(this.el,this.processNode,this)},processText:function(a,b){for(var c=0,d=b.length,e,f,g=[];c<d;)if(-1!=(e=b.indexOf("{{",c))&&-1!=(f=b.indexOf("}}",e+2)))g.push(b.substring(c,e)),g.push(this.watcherMatch(a,b.substring(e+
2,f))),c=f+2;else{c!==d&&g.push(b.substring(c));break}return a.text=g.join("")},watcherMatch:function(a,b){var c=a.watchers;c.push({watcher:d(this.scope,b,this.onDataChange,this,a.inx)});return"---"+(c.length-1)+"---"},onDataChange:function(a,b,c){this.renderText(c)},render:function(){var a=this.texts.length,b;for(b=0;b<a;b++)this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.text,c=a.watchers,d=c.length,f=a.attr,g,h;for(g=0;g<d;g++)h=c[g].watcher.getLastResult(),b=b.replace("---"+
g+"---",h);f?(a.node.setAttribute(f,b),"value"==f&&(a.node.value=b),"class"==f&&(a.node.className=b)):a.node[e]=b},destroy:function(){var a=this.texts,b,c,d,e,g;if(!this.destroyed){this.destroyed=!0;c=0;for(d=a.length;c<d;c++)for(b=a[c].watchers,e=0,g=b.length;e<g;e++)f(this.scope,b[e].watcher.code,this.onDataChange,this);this.parent&&this.parent.un("destroy",this.destroy,this);t.trigger("destroy-"+this.id);this.parent=this.scope=this.el=this.texts=null}}},{eachNode:n});MetaphorJs.onReady(function(){var a=
MetaphorJs.app;if(document.querySelectorAll)for(var b=document.querySelectorAll("[mjs-app]"),c=-1,d=b.length;++c<d;a(b[c]));else n(document.documentElement,function(b){if(b.hasAttribute("mjs-app"))return a(b),!1})})})();
(function(){var h=window.MetaphorJs,p=h.data,k=h.toFragment,g=h.lib.Watchable,l=g.create,s=g.isExpression,q=g.eval,c=h.view.Renderer,a=h.clone,d=h.view.Scope,f=h.animate,b=h.lib.Promise,e=h.extend,m={},v=function(a){if(!m[a]){var b=document.getElementById(a),c;if(b)c=b.tagName.toLowerCase(),"script"==c?(c=document.createElement("div"),c.innerHTML=b.innerHTML,m[a]=k(c.childNodes)):m[a]="content"in b?b.content:k(b.childNodes);else return m[a]=MetaphorJs.ajax(a,{dataType:"fragment"}).then(function(b){return m[a]=
b})}return m[a]};h.define("MetaphorJs.view.Template",{_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,scope:null,node:null,tpl:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,initialize:function(a){e(this,a,!0);a=this.node;a.removeAttribute("mjs-include");if(this.tpl){if(a.firstChild&&p(a,"mjs-transclude",k(a.childNodes)),s(this.tpl)&&!this.replace&&(this.ownRenderer=!0,this._watcher=l(this.scope,this.tpl,this.onChange,this)),this.replace&&(this.ownRenderer=
!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof d&&this.scope.$on("destroy",this.onScopeDestroy,this)},doRender:function(){this._renderer||(this._renderer=new c(this.node,this.scope),this._renderer.render())},startRendering:function(){var a=
this.tpl;this.deferRendering&&(this.deferRendering=!1,this.initPromise?this.initPromise.done(a?this.applyTemplate:this.doRender,this):a?this.applyTemplate():this.doRender())},resolveTemplate:function(){var a=this,c=a._watcher?a._watcher.getLastResult():q(a.tpl,a.scope),d=new b;(new b(function(a,b){a(v(c))})).done(function(b){a._fragment=b;d.resolve(!a.ownRenderer)}).fail(d.reject,d);return d},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,
this)},doApplyTemplate:function(){for(var b=this.node;b.firstChild;)b.removeChild(b.firstChild);this.replace?b.parentNode.replaceChild(a(this._fragment),b):b.appendChild(a(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,c=new b;this._initial?(this.doApplyTemplate(),c.resolve()):(f(a,"leave").done(this.doApplyTemplate,this).done(c.resolve,c),f(a,"enter"));this._initial=!1;return c},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();
delete this._renderer},onScopeDestroy:function(){this.destroy();delete this._renderer},destroy:function(){delete this.node;delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),delete this._watcher);delete this.tpl}},{getTemplate:v})})();
(function(){var h={},p=MetaphorJs.nextUid,k=MetaphorJs.emptyFn,g=MetaphorJs.ns.get,l=MetaphorJs.lib.Promise,s=MetaphorJs.view.Template,q=MetaphorJs.trim,c=MetaphorJs.lib.Watchable.toExpression;MetaphorJs.define("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,scope:null,template:null,tag:null,initialize:function(a){this.supr(a);a.as&&(this.scope[a.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&
(this.originalId=!0);this.id=this.id||"cmp-"+p();h[this.id]=this;this.initComponent.apply(this,arguments);this.node||this._createNode();var d=this.template;d&&d instanceof s||(this.template=d=new s({scope:this.scope,node:this.node,deferRendering:!0,ownRenderer:!0,tpl:c(q(d))}));if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(d.initPromise?d.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=
document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display="none")},render:function(){this.rendered||(this.renderTo&&this.renderTo.appendChild(this.node),this.hidden=!MetaphorJs.isVisible(this.node),this.rendered=!0,this.template.startRendering(),this.trigger("render",this),this.afterRender(),this.trigger("afterrender",this))},show:function(){this.hidden&&!1!==this.trigger("beforeshow",
this)&&(this.node.style.display="block",this.hidden=!1,this.onShow(),this.trigger("show",this))},hide:function(){this.hidden||!1===this.trigger("beforehide",this)||(this.node.style.display="none",this.hidden=!0,this.onHide(),this.trigger("hide",this))},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:k,afterRender:k,onShow:k,onHide:k,onParentRendererDestroy:function(){this.destroy()},
onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?this.node.parentNode&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.scope.$destroy();delete this.scope;delete this.node;this.supr();delete h[this.id]}});MetaphorJs.getCmp=function(a){return h[a]||null};MetaphorJs.resolveComponent=function(a,d,f,b,e,h){var k="string"==typeof a?g(a):a,n,p=[];a=k.template||d.template;
h=h||[];if(k.resolve)for(n in k.resolve)(function(a){var c=new l;p.push(c.done(function(b){d[a]=b}));c.resolve(k.resolve[n](f,b))})(n);a&&(d.template=new s({scope:f,node:b,deferRendering:!0,ownRenderer:!0,tpl:c(q(a))}),p.push(d.template.initPromise));var r=p.length;r&&(b.style.visibility="hidden");h.unshift(d);return l.all(p).then(function(){r&&(b.style.visibility="visible");return k.__instantiate.apply(null,h)})}})();
(function(){var h=MetaphorJs.data,p=MetaphorJs.currentUrl,k=MetaphorJs.toFragment,g=MetaphorJs.animate,l=MetaphorJs.lib.Scope,s=MetaphorJs.extend,q=MetaphorJs.stopAnimation,c=MetaphorJs.resolveComponent;MetaphorJs.define("MetaphorJs.cmp.View",{route:null,node:null,scope:null,currentComponent:null,initialize:function(a){history.initPushState();s(this,a,!0);MetaphorJs.on("locationchange",this.onLocationChange,this);a=this.node;a.firstChild&&h(a,"mjs-transclude",k(a.childNodes));a.removeAttribute("mjs-view");
this.onLocationChange()},onLocationChange:function(){var a=p(),c=this.route,f,b,e,g,h;b=0;for(e=c.length;b<e;b++){g=c[b];if(h=a.match(g.reg)){this.changeComponent(g,h);return}g["default"]&&!f&&(f=g)}f?this.changeComponent(f,[]):this.clearComponent()},changeComponent:function(a,c){q(this.node);this.clearComponent();this.setComponent(a,c)},clearComponent:function(){var a=this,c=a.node;a.currentComponent&&g(c,"leave").done(function(){a.currentComponent.destroy();for(a.currentComponent=null;c.firstChild;)c.removeChild(c.firstChild)})},
setComponent:function(a,d){var f=this,b=f.node;g(b,"enter",function(){var e=d||[],g={destroyEl:!1,node:b,scope:a.isolateScope?new l:f.scope.$new()};a.as&&(g.as=a.as);a.template&&(g.template=a.template);e.shift();return c(a.cmp||"MetaphorJs.cmp.Component",g,g.scope,b,null,e).done(function(a){f.currentComponent=a})})}})})();
(function(){var h=MetaphorJs.view.Scope,p=MetaphorJs.trim,k=MetaphorJs.define,g=MetaphorJs.ns.get,l=MetaphorJs.lib.Watchable,s=MetaphorJs.view.Renderer,q=MetaphorJs.data,c=MetaphorJs.toArray,a=MetaphorJs.toFragment,d=MetaphorJs.addListener,f=MetaphorJs.normalizeEvent,b=MetaphorJs.registerAttributeHandler,e=MetaphorJs.registerTagHandler,m=MetaphorJs.async,v=l.create,n=l.createGetter,t=MetaphorJs.animate,r=MetaphorJs.addClass,y=MetaphorJs.removeClass,A=MetaphorJs.hasClass,F=MetaphorJs.stopAnimation,
H=MetaphorJs.isArray,B=MetaphorJs.view.Template,I=MetaphorJs.lib.Input,D,J=function(a,b){for(var c;a;){c=q(a,b);if(void 0!=c)return c;a=a.parentNode}};MetaphorJs.d("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,initialize:function(a,b,c){c=p(c);this.node=b;this.expr=c;this.scope=a;this.watcher=v(a,c);this.watcher.addListener(this.onChange,this);this.onChange();a instanceof h&&a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){delete this.node;delete this.scope;
this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)},onChange:function(){}});b("mjs-bind",1E3,k(null,"MetaphorJs.view.AttributeHandler",{isInput:!1,initialize:function(a,b,c){var d=b.tagName.toLowerCase();this.isInput="input"==d||"textarea"==d;this.supr(a,b,c)},onChange:function(){var a=this.watcher.getLastResult();this.isInput?this.node.value=a:this.node.textContent=a}}));b("mjs-bind-html",1E3,k(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.node.innerHTML=
this.watcher.getLastResult()}}));b("mjs-model",1E3,k(null,"MetaphorJs.view.AttributeHandler",{inProg:!1,input:null,initialize:function(a,b,c){this.node=b;this.input=new I(b,this.onInputChange,this);this.supr(a,b,c)},onInputChange:function(a){var b=this.scope;this.watcher.setValue(a);this.inProg=!0;b instanceof h?b.$root.$check():this.watcher.checkAll();this.inProg=!1},onScopeDestroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var a=this.watcher.getLastResult();
this.inProg||this.input.setValue(a)}}));b("mjs-show",500,k(null,"MetaphorJs.view.AttributeHandler",{initial:!0,initialize:function(a,b,c){this.supr(a,b,c)},runAnimation:function(a){var b=this.node.style,c=function(){b.display=a?"":"none"};this.initial?c():t(this.node,a?"show":"hide",function(){a&&(b.display="")}).done(c)},onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));b("mjs-hide",500,k(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();
this.runAnimation(!a);this.initial=!1}}));b("mjs-if",500,k(null,"MetaphorJs.view.AttributeHandler",{parentEl:null,prevEl:null,el:null,initial:!0,initialize:function(a,b,c){this.parentEl=b.parentNode;this.prevEl=b.previousSibling;this.supr(a,b,c)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,d=a.node,e=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},f=
function(){c.removeChild(d)};b?d.parentNode||(a.initial?e():t(d,"enter",e)):d.parentNode&&(a.initial?f():t(d,"leave").done(f));a.initial=!1}}));b("mjs-each",100,k(null,"MetaphorJs.view.AttributeHandler",{model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;
this.node=b;this.scope=a;try{this.watcher=v(a,this.model,this.onChange,this)}catch(d){MetaphorJs.error(d)}this.parentEl.removeChild(b);this.render(this.watcher.getValue())},onScopeDestroy:function(){var a=this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.supr()},doUpdate:function(a,b){for(var c=this.renderers,d=b,e=c.length,f=e-1,g=!(d%2),h,k;d<e;d++)h=c[d],k=h.scope,k.$index=
d,k.$first=0===d,k.$last=d===f,k.$even=g,k.$odd=!g,g=!g,h.renderer?k.$check():(h.renderer=new s(h.el,h.scope),h.renderer.render())},render:function(a){var b=this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,f=document.createDocumentFragment(),g,h,k;h=0;for(k=a.length;h<k;h++)g=c.cloneNode(!0),f.appendChild(g),b.push(this.createItem(g,a,h));d.insertBefore(f,e);this.doUpdate(a,0)},createItem:function(a,b,c){var d=this.itemName,e=this.scope,e=e instanceof h?e.$new():{$parent:e,$root:e.$root};e[d]=
b[c];return{el:a,scope:e}},onChange:function(a){var b=this,c=b.renderers;a=a.prescription;var d=b.tpl,e=0,f=b.parentEl,g=b.watcher.getValue(),k=null,l,m,p,n;m=0;for(p=a.length;m<p;m++)n=a[m],"-"==n?(c[e].scope.$index=e,e++):(null===k&&(k=0<m?m-1:0),"I"!=n&&c[e]&&(l=c[e],l.scope instanceof h&&l.scope.$destroy(),l.renderer.destroy(),t(l.el,"leave").done(function(a){a.parentNode&&a.parentNode.removeChild(a)})),"D"==n?c.splice(e,1):(l=d.cloneNode(!0),t(l,"enter",function(a){return function(d){0<a?f.insertBefore(d,
c[a-1].el.nextSibling):b.prevEl?f.insertBefore(d,b.prevEl.nextSibling):f.appendChild(d)}}(e)),"R"==n?c[m]=b.createItem(l,g,e):"I"==n&&(m<c.length?c.splice(m,0,b.createItem(l,g,e)):c.push(b.createItem(l,g,e))),e++));b.doUpdate(g,k)},parseExpr:function(a){a=a.split(" ");var b,c,d,e,f;b=0;for(c=a.length;b<c;b++)if(f=a[b],""!=f&&"in"!=f)if(e){d=a.slice(b).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"}},{$stopRenderer:!0}));b("mjs-each-in-store",100,k(null,"attr.mjs-each",{store:null,initialize:function(a,
b,c){this.parseExpr(c);b.removeAttribute("mjs-each-in-store");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;this.store=a=n(this.model)(a);this.parentEl.removeChild(b);this.initWatcher();this.render(this.watcher.getValue());m(this.bindStore,this,[a,"on"])},onScopeDestroy:function(){this.bindStore(this.store,"un");delete this.store;this.supr()},initWatcher:function(){this.watcher=
v(this.store,".items",null);this.watcher.addListener(this.onChange,this)},resetWatcher:function(){this.watcher.setValue(this.store.items)},bindStore:function(a,b){a[b]("load",this.onStoreUpdate,this);a[b]("update",this.onStoreUpdate,this);a[b]("add",this.onStoreUpdate,this);a[b]("remove",this.onStoreUpdate,this);a[b]("replace",this.onStoreUpdate,this);a[b]("filter",this.onStoreFilter,this);a[b]("clearfilter",this.onStoreFilter,this);a[b]("clear",this.onStoreClear,this);a[b]("destroy",this.onStoreDestroy,
this)},onStoreUpdate:function(){this.watcher.check()},onStoreFilter:function(){this.resetWatcher();this.onStoreUpdate()},onStoreClear:function(){this.resetWatcher();this.onStoreUpdate()},onStoreDestroy:function(){this.onStoreClear();this.watcher.unsubscribeAndDestroy(this.onChange,this);delete this.watcher}},{$stopRenderer:!0}));b("mjs-include",900,function(a,b,c,d){a=new B({scope:a,node:b,tpl:c,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});e("mjs-include",900,function(a,b,c,d){return(new B({scope:a,
node:b,tpl:b.getAttribute("src"),parentRenderer:d,replace:!0})).initPromise});b("mjs-transclude",1E3,function(b,d){var e=J(d,"mjs-transclude");if(e){d.firstChild&&q(d,"mjs-transclude",a(d.childNodes));var f=d.parentNode,g=d.nextSibling,e=MetaphorJs.clone(e),h=c(e.childNodes);f.removeChild(d);f.insertBefore(e,g);return h}});e("mjs-transclude",900,function(b,d){var e=J(d,"mjs-transclude");if(e){d.firstChild&&q(d,"mjs-transclude",a(d.childNodes));var f=d.parentNode,g=d.nextSibling,e=MetaphorJs.clone(e),
h=c(e.childNodes);f.removeChild(d);f.insertBefore(e,g);return h}});var E=function(a,b,c,d){if(null!==c){if(c==A(a,b))return;c=!c}else c=A(a,b);c?d?t(a,[b+"-remove"]).done(function(){y(a,b)}):y(a,b):d?t(a,[b+"-add"]).done(function(){r(a,b)}):r(a,b)};b("mjs-class",1E3,k(null,"MetaphorJs.view.AttributeHandler",{initial:!0,onChange:function(){var a=this.node,b=this.watcher.getLastResult(),c;F(a);if("string"==typeof b)E(a,b,null,!this.initial);else if(H(b)){var d;c=-1;for(d=b.length;++c<d;E(a,b[c],!0,
!this.initial));}else for(c in b)E(a,c,b[c]?!0:!1,!this.initial);this.initial=!1}}));var e="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste enter".split(" "),L,G=l.createFunc,l=0;for(L=e.length;l<L;l++)(function(a){var c=a;"enter"==c&&(c="keyup");b("mjs-"+a,1E3,function(b,e,g){var k=G(g);d(e,c,function(c){c=c||window.event;c=f(c);if("enter"==a&&13!=c.keyCode)return null;b.$event=c;try{k(b)}catch(d){MetaphorJs.error(d)}delete b.$event;
b instanceof h?b.$root.$check():b.$$watchers&&b.$$watchers.$checkAll();c.preventDefault();return!1})})})(e[l]);e="selected checked disabled readonly required open".split(" ");l=0;for(L=e.length;l<L;l++)(function(a){b("mjs-"+a,1E3,k(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.watcher.getLastResult()?this.node.setAttribute(a,!0):this.node.removeAttribute(a)}}))})(e[l]);e=function(a,b,c,d){D||(D=MetaphorJs.resolveComponent);var e,f,g,h,k;b.removeAttribute("mjs-cmp");c=c.split(" ");
g=0;for(h=c.length;g<h;g++)k=c[g],""!=k&&"as"!=k&&(e?f=k:e=k);D(e,{scope:a,node:b,as:f,parentRenderer:d},a,b,d);return!1};e.$breakScope=!0;b("mjs-cmp",200,e);var z=MetaphorJs.getCmp;b("mjs-cmp-prop",200,function(a,b,c){a=b.parentNode;for(var d;a;){if(d=a.getAttribute("cmp-id")){(a=z(d))&&(a[c]=b);break}a=a.parentNode}});b("mjs-view",200,function(a,b,c){b.removeAttribute("mjs-view");var d=g(c);if(d)new d({scope:a,node:b});else throw"View '"+c+"' not found";return!1});b("mjs-init",150,function(a,b,
c){b.removeAttribute("mjs-init");G(c)(a)})})();
(function(){var h=MetaphorJs.add,p=MetaphorJs.numberFormats,k=MetaphorJs.dateFormats;h("filter.toUpper",function(c){return c.toUpperCase()});h("filter.toLower",function(c){return c.toLowerCase()});h("filter.limitTo",function(c,a){var d=typeof c;if(!MetaphorJs.isArray(c)&&"string"!=d)return c;a=Infinity===Math.abs(Number(a))?Number(a):parseInt(a,10);if("string"==d)return a?0<=a?c.slice(0,a):c.slice(a,c.length):"";var d=[],f,b;a>c.length?a=c.length:a<-c.length&&(a=-c.length);0<a?(f=0,b=a):(f=c.length+
a,b=c.length);for(;f<b;f++)d.push(c[f]);return d});h("filter.ucfirst",function(c){return c.substr(0,1).toUpperCase()+c.substr(1)});var g=MetaphorJs.numberFormats;h("filter.numeral",function(c,a){a=g[a]||a;a=p[a]||a;return numeral(c).format(a)});var l=MetaphorJs.dateFormats;h("filter.moment",function(c,a){a=l[a]||a;a=k[a]||a;return moment(c).format(a)});var s=function(c,a,d){if(""===a||"undefined"==typeof a)return!0;if("undefined"!=typeof c){if("boolean"==typeof c)return c===a;if(d instanceof RegExp)return a.test(""+
c);if("strict"==d)return""+c===""+a;if(!0===d||null===d||"undefined"==typeof d)return-1!=""+c.indexOf(a);if(!1===d)return-1==""+c.indexOf(a)}return!1},q=function(c,a,d){if("object"!=typeof c)return"undefined"==typeof a.$?!0:s(c,a.$,d);var f,b;for(f in a)if("$"==f)for(b in c){if(s(c[b],a.$,d))return!0}else if(s(c[f],a[f],d))return!0;return!1};h("filter.filter",function(c,a,d,f){d&&!f&&(d=null);"object"!=typeof a&&(a={$:a});f=[];var b,e;b=-1;for(e=c.length;++b<e;)q(c[b],a,d)&&f.push(c[b]);return f});
h("filter.sortBy",function(c,a,d,f){d&&!f&&(d="asc");c=c.slice();c.sort(function(b,c){var d=typeof b;return d!=typeof c?0:"object"==d?b[a]>c[a]?1:b[a]<c[a]?-1:0:b>c?1:b<c?-1:0});return"desc"==d?c.reverse():c})})();
