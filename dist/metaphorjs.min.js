Array.prototype.indexOf||(Array.prototype.indexOf=function(g,r){var m;if(null==this)throw new TypeError('"this" is null or not defined');var k=Object(this),p=k.length>>>0;if(0===p)return-1;m=+r||0;Infinity===Math.abs(m)&&(m=0);if(m>=p)return-1;for(m=Math.max(0<=m?m:p-Math.abs(m),0);m<p;){if(m in k&&k[m]===g)return m;m++}return-1});
(function(){var g=Array.prototype.slice,r=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},m=function(a){return a&&a.constructor===Object},k=function(){var a=!1,b=!0,c=g.call(arguments),d=c.shift(),h,f,n;"boolean"==typeof c[c.length-1]&&(a=c.pop());"boolean"==typeof c[c.length-1]&&(b=a,a=c.pop());for(;h=c.shift();)for(f in h)if(h.hasOwnProperty(f)&&"undefined"!=typeof(n=h[f]))if(b)if(d[f]&&m(d[f])&&m(n))k(d[f],n,a,b);else{if(!0===
a||"undefined"==typeof d[f]||null===d[f])m(n)?(d[f]={},k(d[f],n,a,!1)):d[f]=n}else if(!0===a||"undefined"==typeof d[f]||null===d[f])d[f]=n;return d},p=function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),n=Array.prototype.indexOf,q=Object.prototype.toString,f={},c=function(a){return f[a]||(f[a]=new RegExp("(?:^|\\s)"+a+"(?!\\S)",""))},h=function(a,b){return b?c(b).test(a.className):
!1},d=["0","0","0"],a=function(){for(var a=d.length,b;a;){a--;b=d[a].charCodeAt(0);if(57==b)return d[a]="A",d.join("");if(90==b)d[a]="0";else return d[a]=String.fromCharCode(b+1),d.join("")}d.unshift("0");return d.join("")},b={};"undefined"!=typeof window?window.MetaphorJs||(window.MetaphorJs={}):global.MetaphorJs||(global.MetaphorJs={});MetaphorJs.bind=r;MetaphorJs.addListener=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)};MetaphorJs.removeListener=function(a,b,
c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)};MetaphorJs.extend=k;MetaphorJs.trim=p;MetaphorJs.inArray=function(a,b){return b?n.call(b,a):-1};MetaphorJs.isArray=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"==q.call(a)||!1};MetaphorJs.toArray=function(a){for(var b=[],c=-1,d=a.length>>>0;++c!==d;b[c]=a[c]);return b};MetaphorJs.addClass=function(a,b){b&&!h(a,b)&&(a.className+=" "+b)};MetaphorJs.removeClass=function(a,b){b&&(a.className=
a.className.replace(c(b),""))};MetaphorJs.hasClass=h;MetaphorJs.nextUid=a;MetaphorJs.data=function(l,c,d){l=l._mjsId||(l._mjsId=a());var f=b[l];return"undefined"!=typeof d?(f||(f=b[l]={}),f[c]=d):f?f[c]:void 0};MetaphorJs.isPlainObject=m;MetaphorJs.isThenable=function(a){var b;return a&&"function"==typeof(b=a.then)?b:!1};MetaphorJs.isAttached=function(a){var b=document.body;return a===b?!0:b.contains(a)}})();
(function(){var g=window.MetaphorJs,r=g.extend,m=g.addListener,k=g.removeListener,p=g.isArray,n=[],q=[],f=!1,c=!1,h=function(a,l){return a.priority<l.priority?-1:a.priority>l.priority?1:0},d,a=function(b){var l,c,d;if(p(b)){d=[];l=0;for(c=b.length;l<c;l++)d.push(a(b[l]));return d}if(b)switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0)}return null};r(g,{registerAttributeHandler:function(a,l,c){d||(d=MetaphorJs.add);
n.push({priority:l,name:a,handler:d("attr."+a,c)});f=!1},registerTagHandler:function(a,l,t){d||(d=MetaphorJs.add);q.push({priority:l,name:a,handler:d("tag."+a,t)});c=!1},getAttributeHandlers:function(){f||(n.sort(h),f=!0);return n},getTagHandlers:function(){c||(q.sort(h),c=!0);return q},numberFormats:{},dateFormats:{},emptyFn:function(){},clone:a,async:function(a,l,c){a.apply(l,c||[])},toFragment:function(a){var l=document.createDocumentFragment();if("string"==typeof a){var c=document.createElement("div");
c.innerHTML=a;a=c.childNodes}if(a.nodeType)l.appendChild(a);else for(var c=-1,d=a.length>>>0;++c!==d;l.appendChild(a[0]));return l},app:function(a,l,c){try{return MetaphorJs.create(l||"MetaphorJs.cmp.App",a,c)}catch(d){MetaphorJs.error(d)}},isVisible:function(a){return!(0>=a.offsetWidth||0>=a.offsetHeight)},isInjectable:function(a){return a.length&&"function"==typeof a[a.length-1]},onReady:function(a){var l=!1,c=!0,d=window,f=d.document,h=f.documentElement,g=function(c){if("readystatechange"!=c.type||
"complete"==f.readyState)k("load"==c.type?d:f,c.type,g),!l&&(l=!0)&&a.call(d,c.type||c)},n=function(){try{h.doScroll("left")}catch(a){setTimeout(n,50);return}g("poll")};if("complete"==f.readyState)a.call(d,"lazy");else{if(f.createEventObject&&h.doScroll){try{c=!d.frameElement}catch(p){}c&&n()}m(f,"DOMContentLoaded",g);m(f,"readystatechange",g);m(d,"load",g)}},error:function(a){throw a;}})})();
(function(){var g=/^[\w[:#.][\w\]*^|=!]*$/,r=/=([^\]]+)/,m=/ *, */,k=/(\([^)]*)\+/,p=/(\[[^\]]+)~/,n=/(~|>|\+)/,q=/ +/,f=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,c=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,h=/\D/,d=/[^(]*\(([^)]*)\)/,a=/\(.*/,b=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,l=MetaphorJs.toArray,t=document,L=!!t.getElementsByClassName,v=!!t.querySelectorAll,z={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==
a},"last-child":function(a){for(;(a=a.nextSibling)&&1!=a.nodeType;);return!!a},root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,b){var l=a.nodeIndex||0,c=b[3]=b[3]?("%"===b[2]?-1:1)*b[3]:0,d=b[1];if(l)return!((l+c)%d);var C=a.parentNode.firstChild;l++;do if(1==C.nodeType&&(C.nodeIndex=++l)&&a===C&&(l+c)%d)return 0;while(C=C.nextSibling);return 1},"nth-last-child":function(a,b){var l=a.nodeIndexLast||0,c=b[3]?("%"===b[2]?-1:1)*b[3]:0,d=b[1];if(l)return!((l+c)%d);var C=
a.parentNode.lastChild;l++;do if(1==C.nodeType&&(C.nodeLastIndex=l++)&&a===C&&(l+c)%d)return 0;while(C=C.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!=a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},lang:function(a,b){return a.lang!==b&&t.documentElement.lang!==b},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){a.parentNode.selectedIndex;
return!a.selected}},D={},J=function(a){return D[a]||(D[a]=new RegExp("(^| +)"+a+"($| +)"))},A={"":function(a,b){return!!a.getAttribute(b)},"=":function(a,b,l){return(b=a.getAttribute(b))&&b===l},"&=":function(a,b,l){return(b=a.getAttribute(b))&&J(l).test(b)},"^=":function(a,b,l){return(b=a.getAttribute(b)+"")&&!b.indexOf(l)},"$=":function(a,b,l){return(b=a.getAttribute(b)+"")&&b.indexOf(l)==b.length-l.length},"*=":function(a,b,l){return(b=a.getAttribute(b)+"")&&-1!=b.indexOf(l)},"|=":function(a,b,
l){return(b=a.getAttribute(b)+"")&&(b===l||!!b.indexOf(l+"-"))},"!=":function(a,b,l){return!(b=a.getAttribute(b))||!J(l).test(b)}},B=function(w,M){M=M||t;var x=[],y=null,F,C,N,u,B,K,E;if(v)try{x=l(M.querySelectorAll(w.replace(r,'="$1"')))}catch(s){y=!0}if(!v||y)if(g.test(w))switch(y=0,w.charAt(0)){case "#":y=w.slice(1);x=t.getElementById(y);x.id!==y&&(x=t.all[y]);x=x?[x]:[];break;case ".":F=w.slice(1);if(L)x=l((x=M.getElementsByClassName(F)).length?x:[]);else{F=" "+F+" ";C=M.getElementsByTagName("*");
for(N=0;u=C[N++];)-1!=(" "+u.className+" ").indexOf(F)&&(x[y++]=u);x=y?x:[]}break;case ":":C=M.getElementsByTagName("*");N=0;B=w.replace(d,"$1");for(K=w.replace(a,"");u=C[N++];)z[K]&&!z[K](u,B)&&(x[y++]=u);x=y?x:[];break;case "[":C=M.getElementsByTagName("*");N=0;u=b.exec(w);F=u[1];E=u[2]||"";for(B=u[3];u=C[N++];)A[E]&&(A[E](u,F,B)||"class"===F&&A[E](u,"className",B))&&(x[y++]=u);x=y?x:[];break;default:x=l((x=M.getElementsByTagName(w)).length?x:[])}else{for(var G=w.split(m),W=G.length-1,Y=!!W,D,J,
I,V,O,P,Q,R,X,H,T,U;y=G[W--];){J=(D=y.replace(k,"$1%").replace(p,"$1&").replace(n," $1 ").split(q)).length;N=0;V=" ";for(C=[M];I=D[N++];)if(" "!==I&&">"!==I&&"~"!==I&&"+"!==I&&C){I=I.match(f);O=I[1]||"*";P=I[2];Q=I[3]?" "+I[3]+" ":"";F=I[4];E=I[5]||"";K=I[7];B="nth-child"===K||"nth-last-child"===K?c.exec("even"===I[8]&&"2n"||"odd"===I[8]&&"2n%1"||!h.test(I[8])&&"0n%"+I[8]||I[8]):I[8];R=[];y=X=0;for(T=N==J;H=C[X++];)switch(V){case " ":U=H.getElementsByTagName(O);for(H=0;u=U[H++];)P&&u.id!==P||Q&&-1==
(" "+u.className+" ").indexOf(Q)||!(!F||A[E]&&(A[E](u,F,I[6])||"class"===F&&A[E](u,"className",I[6])))||u.yeasss||(z[K]?z[K](u,B):K)||(T&&(u.yeasss=1),R[y++]=u);break;case "~":for(O=O.toLowerCase();(H=H.nextSibling)&&!H.yeasss;)1!=H.nodeType||"*"!==O&&H.nodeName.toLowerCase()!==O||P&&H.id!==P||Q&&-1==(" "+H.className+" ").indexOf(Q)||!(!F||A[E]&&(A[E](u,F,I[6])||"class"===F&&A[E](u,"className",I[6])))||H.yeasss||(z[K]?z[K](H,B):K)||(T&&(H.yeasss=1),R[y++]=H);break;case "+":for(;(H=H.nextSibling)&&
1!=H.nodeType;);!H||H.nodeName.toLowerCase()!==O.toLowerCase()&&"*"!==O||P&&H.id!==P||Q&&-1==(" "+u.className+" ").indexOf(Q)||!(!F||A[E]&&(A[E](u,F,I[6])||"class"===F&&A[E](u,"className",I[6])))||H.yeasss||(z[K]?z[K](H,B):K)||(T&&(H.yeasss=1),R[y++]=H);break;case ">":for(U=H.getElementsByTagName(O),N=0;u=U[N++];)u.parentNode!==H||P&&u.id!==P||Q&&-1==(" "+u.className+" ").indexOf(Q)||!(!F||A[E]&&(A[E](u,F,I[6])||"class"===F&&A[E](u,"className",I[6])))||u.yeasss||(z[K]?z[K](u,B):K)||(T&&(u.yeasss=
1),R[y++]=u)}C=R}else V=I;if(Y){if(!C.concat){R=[];for(H=0;u=C[H];)R[H++]=u;C=R}x=C.concat(1==x.length?x[0]:x)}else x=C}for(y=x.length;y--;)x[y].yeasss=x[y].nodeIndex=x[y].nodeIndexLast=null}return x};MetaphorJs.select=B;MetaphorJs.select.is=function(a,b){var l=B(b,a.parentNode),c,d;c=-1;for(d=l.length;++c<d;)if(l[c]===a)return!0;return!1}})();
(function(){var g=/\r/g,r=MetaphorJs.trim,m=MetaphorJs.toArray,k=MetaphorJs.inArray,p=MetaphorJs.isArray,n=function(f){var c,h;if((c=q[f.type]||q[f.nodeName.toLowerCase()])&&"get"in c&&void 0!==(h=c.get(f,"value")))return h;h=f.value;return"string"===typeof h?h.replace(g,""):null==h?"":h},q={option:{get:function(f){var c=f.getAttribute("value");return null!=c?c:r(f.innerText||f.textContent)}},select:{get:function(f){for(var c,h=f.options,d=f.selectedIndex,a=(f="select-one"===f.type||0>d)?null:[],
b=f?d+1:h.length,l,t=0>d?b:f?d:0;t<b;t++)if(c=h[t],l=c.disabled||null!==c.getAttribute("disabled")||h.parentNode.disabled,(c.selected||t===d)&&!l){c=n(c);if(f)return c;a.push(c)}return a},set:function(f,c){for(var h,d,a=f.options,b=m(c),l=a.length;l--;)if(d=a[l],d.selected=k(d.value,b))h=!0;h||(f.selectedIndex=-1);return b}}};q.radio=q.checkbox={set:function(f,c){if(p(c))return f.checked=0<=k(n(f),c)},get:function(f){return null===f.getAttribute("value")?"on":f.value}};MetaphorJs.getValue=n;MetaphorJs.setValue=
function(f,c){if(1===f.nodeType){null==c?c="":"number"===typeof c&&(c+="");var h=q[f.type]||q[f.nodeName.toLowerCase()];h&&"set"in h&&void 0!==h.set(this,c,"value")||(f.value=c)}}})();
(function(){var g=function(){return!1},r=function(){return!0},m=function(k){if(k instanceof m)return k;if(!(this instanceof m))return new m(k);for(var p in k)if(!this[p])try{this[p]=k[p]}catch(n){}this.originalEvent=k;this.type=k.type;!this.target&&k.srcElement&&(this.target=k.srcElement);var q,f=k.button;"undefined"==typeof this.pageX&&null!=k.clientX&&(q=this.target?this.target.ownerDocument||document:document,p=q.documentElement,q=q.body,this.pageX=k.clientX+(p&&p.scrollLeft||q&&q.scrollLeft||
0)-(p&&p.clientLeft||q&&q.clientLeft||0),this.pageY=k.clientY+(p&&p.scrollTop||q&&q.scrollTop||0)-(p&&p.clientTop||q&&q.clientTop||0));this.which||void 0===f||(this.which=f&1?1:f&2?3:f&4?2:0);this.isDefaultPrevented=k.defaultPrevented||void 0===k.defaultPrevented&&!1===k.returnValue?r:g;this.timeStamp=k&&k.timeStamp||(new Date).getTime()};m.prototype={isDefaultPrevented:g,isPropagationStopped:g,isImmediatePropagationStopped:g,preventDefault:function(){var g=this.originalEvent;this.isDefaultPrevented=
r;g.returnValue=!1;g&&g.preventDefault&&g.preventDefault()},stopPropagation:function(){var g=this.originalEvent;this.isPropagationStopped=r;g&&g.stopPropagation&&g.stopPropagation()},stopImmediatePropagation:function(){var g=this.originalEvent;this.isImmediatePropagationStopped=r;g&&g.stopImmediatePropagation&&g.stopImmediatePropagation();this.stopPropagation()}};window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.normalizeEvent=function(g){return new m(g)}})();
(function(){var g=MetaphorJs.extend,r=MetaphorJs.bind,m=MetaphorJs.addListener,k=MetaphorJs.removeListener,p=MetaphorJs.getValue,n=MetaphorJs.setValue,q=function(f,c,h,d){this.el=f;this.cb=c;this.scb=d;this.cbContext=h;this.inputType=c=f.getAttribute("mjs-input-type")||f.type.toLowerCase();this.listeners=[];h=f.type?f.type.toLowerCase():"";this.submittable="input"==f.nodeName.toLowerCase()&&"radio"!=h&&"checkbox"!=h;"radio"==c?this.initRadioInput():"checkbox"==c?this.initCheckboxInput():this.initTextInput()};
g(q.prototype,{el:null,inputType:null,cb:null,scb:null,cbContext:null,listeners:[],radio:null,submittable:!1,destroy:function(){var f=this.inputType,c=this.listeners,h=this.radio,d=this.el,a,b,l,t;a=0;for(b=c.length;a<b;a++)if("radio"==f)for(l=0,t=h.length;l<t;l++)k(h[l],c[a][0],c[a][1]);else k(d,c[a][0],c[a][1]);delete this.radio;delete this.el;delete this.cb;delete this.cbContext},initRadioInput:function(){var f=this.el,c=f.type,f=f.name,h,d,a;this.onRadioInputChangeDelegate=r(this.onRadioInputChange,
this);if(document.querySelectorAll)h=document.querySelectorAll("input[name="+f+"]");else{var b=document.getElementsByTagName("input"),l;h=[];d=0;for(a=b.length;d<a;d++)l=b[d],l.type==c&&l.name==f&&h.push(l)}this.radio=h;this.listeners.push(["click",this.onRadioInputChangeDelegate]);d=0;for(a=h.length;d<a;d++)m(h[d],"click",this.onRadioInputChangeDelegate)},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=r(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate]);
m(this.el,"click",this.onCheckboxInputChangeDelegate)},initTextInput:function(){var f=MetaphorJs.browser,c=!1,h=this,d=h.el,a=h.listeners,b;if(!f.android){var l=function(){c=!0},t=function(){c=!1;g()};a.push(["compositionstart",l]);a.push(["compositionend",t]);m(d,"compositionstart",l);m(d,"compositionend",t)}var g=h.onTextInputChangeDelegate=function(){if(!c)h.onTextInputChange()};if(f.hasEvent("input"))a.push(["input",g]),m(d,"input",g);else{var v=function(a){b||(b=window.setTimeout(function(){g(a);
b=null},0))},l=function(a){a=a||window.event;var b=a.keyCode;if(13==b&&h.submittable&&h.scb)return h.scb.call(h.cbContext,a);91===b||15<b&&19>b||37<=b&&40>=b||v(a)};a.push(["keydown",l]);m(d,"keydown",l);f.hasEvent("paste")&&(a.push(["paste",v]),a.push(["cut",v]),m(d,"paste",v),m(d,"cut",v))}a.push(["change",g]);m(d,"change",g)},onTextInputChange:function(){var f=this.el.value;switch(this.inputType){case "number":f=parseInt(f,10)}this.cb.call(this.cbContext,f)},onCheckboxInputChange:function(){var f=
this.el;this.cb.call(this.cbContext,f.checked?f.getAttribute("value")||!0:!1)},onRadioInputChange:function(f){f=f||window.event;this.cb.call(this.cbContext,(f.target||f.srcElement).value)},setValue:function(f){var c=this.inputType,h,d;if("radio"==c)for(c=this.radio,h=0,d=c.length;h<d;h++){if(c[h].value==f){c[h].checked=!0;break}}else"checkbox"==c?(c=this.el,c.checked=!0===f||f==c.value):n(this.el,f)},getValue:function(){var f=this.inputType,c,h;if("radio"==f){f=this.radio;c=0;for(h=f.length;c<h;c++)if(f[c].checked)return f[c].value;
return null}return"checkbox"==f?this.el.checked?this.el.getAttribute("value")||!0:!1:p(this.el)}});window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.lib||(MetaphorJs.lib={});MetaphorJs.lib.Input=q})();
(function(){var g="undefined"!=typeof window?window:global,r={},m=function(k,p){if(r[k]||p)return r[k];var f=k.split("."),c,h=f.length,d,a=g;for(c=0;c<h;c++){d=f[c];if(!a[d])return null;a=a[d]}return a},k=function(k,p){var f;f=k.split(".");var c,h=f.pop();c=f.join(".");var d=f.length,a,b=g;if(r[c])f=[r[c],h];else{for(c=0;c<d;c++)a=f[c],b[a]||(b[a]={}),b=b[a];f=[b,h]}f[0][f[1]]=p;return r[k]=p},p=function(g,k){return r[g]=k};k("MetaphorJs.ns",{register:k,exists:function(g){return r[g]?!0:!1},get:m,
add:p,remove:function(g){delete r[g]}});MetaphorJs.r=k;MetaphorJs.g=m;MetaphorJs.add=p;"undefined"!=typeof module&&(module.exports=MetaphorJs.ns)})();
(function(){var g;if("undefined"!=typeof global)try{g=require("metaphorjs-namespace")}catch(r){g=global.MetaphorJs.ns}else g=window.MetaphorJs.ns;var m={}.undefined,k=Array.prototype.slice,p=function(a,b){return f(function(){},a,b)},n=function(a,b,c){return function(){var d=m,f=this.supr;this.supr=a.prototype[b]||function(){};try{d=c.apply(this,arguments)}catch(h){}this.supr=f;return d}},q=function(a,b,c){for(var d in b)b.hasOwnProperty(d)&&(a[d]="function"===typeof b[d]&&c.prototype&&"function"===
typeof c.prototype[d]?n(c,d,b[d]):b[d])},f=function(a,b,c){var d=function(){};d.prototype=a.prototype;d=new d;c=c||function(){this.initialize&&this.initialize.apply(this,arguments)};q(d,b,a);c.prototype=d;c.prototype.constructor=c;c.prototype.getClass=function(){return this.__proto__.constructor.__class};c.prototype.getParentClass=function(){return this.__proto__.constructor.__parentClass};c.__instantiate=function(a){return function(){var b=function(){},l;b.prototype=a.prototype;b=new b;l=a.prototype.constructor.apply(b,
arguments);return"object"==typeof l?l:b}}(c);return c},c=function(a,b,c,d,h,k){null===a&&(a="");"function"==typeof a?(h=c,"string"==typeof b?(h=d,d=c):(d=b,c=a,b=null),a=null):"string"!=typeof a&&(h=b,d=a,a=c=b=null);"string"!=typeof b&&"function"!=typeof b&&(h=d,d=c,c=b,b=null);"function"!=typeof c&&(h=d,d=c,c=null);d=d||{};var n=b&&"string"==typeof b?g.get(b):b;if(b&&!n)throw Error(b+" not found");b=n?f(n,d,c):p(d,c);b.__isMetaphorClass=!0;b.__parent=n;b.__parentClass=n?n.__class:null;b.__class=
a;if(h)for(var m in h)h.hasOwnProperty(m)&&(b[m]=h[m]);a&&(k?g.add(a,b):g.register(a,b));h&&h.alias&&g.add(h.alias,b);return b},h=function(a,b,d,f,h){return c(a,b,d,f,h,!0)},d=function(a){var b=g.get(a),c=k.call(arguments,1);if(!b)throw Error(a+" not found");return b.__instantiate.apply(this,c)},a=function(a,b){var c="string"==typeof b?g.get(b):b;return c?a instanceof c:!1},b=function(a,b){var c=a,d=g.get;"string"!=typeof b&&(b=b.getClass?b.getClass():b.prototype.constructor.__class);for("string"==
typeof a&&(c=d(a));c;){if(c.prototype.constructor.__class==b)return!0;c&&(c=c.getParentClass?d(c.getParentClass()):c.__parent)}return!1};"undefined"!=typeof global?module.exports={define:c,d:c,defineCache:h,dc:h,create:d,c:d,is:a,isSubclass:b}:(MetaphorJs.define=MetaphorJs.d=c,MetaphorJs.defineCache=MetaphorJs.dc=h,MetaphorJs.create=MetaphorJs.c=d,MetaphorJs.is=a,MetaphorJs.isSubclass=MetaphorJs.iss=b)})();
(function(){var g="undefined"!=typeof window?window.setTimeout:global.setTimeout,r=function(a){var b;return!a||"object"!=typeof a&&"function"!=typeof a||"function"!=typeof(b=a.then)?!1:b},m=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},k=[],p=!1,n="undefined"!=typeof process?process.nextTick:function(a){g(a,0)},q=function(){p=!0;var a=k.shift();n(function(){a[0].apply(a[1],a[2]);k.length?q():p=!1},0)},f=function(a,b,c){c=c||[];
k.push([a,b,c]);p||q()},c=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},h=function(a,b){return function(c){try{b.resolve(a(c))}catch(d){b.reject(d)}}},d=function(a,b){if(a instanceof d)return a;if(!(this instanceof d))return new d(a,b);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if("undefined"!=typeof a)if(r(a)||"function"!=typeof a)this.resolve(a);else try{a.call(b,m(this.resolve,this),m(this.reject,this))}catch(c){this.reject(c)}};c(d.prototype,{_state:0,_fulfills:null,
_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(a,b){var c;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(c=r(a)){a instanceof d?a.then(m(this._processResolveValue,
this),m(this._processRejectReason,this)):(new d(c,a)).then(m(this._processResolveValue,this),m(this._processRejectReason,this));return}}catch(f){0==this._state&&this._doReject(f);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)f(b[0],b[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;
this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,b;b=a.shift();)f(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b){var c=new d,g=this._state;
0==g||0!=this._wait?(a&&"function"==typeof a?this._fulfills.push([h(a,c),null]):this._fulfills.push([c.resolve,c]),b&&"function"==typeof b?this._rejects.push([h(b,c),null]):this._rejects.push([c.reject,c])):1==g?a&&"function"==typeof a?f(h(a,c),null,[this._value]):c.resolve(this._value):2==g&&(b&&"function"==typeof b?f(h(b,c),null,[this._reason]):c.reject(this._reason));return c},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)b[0].call(b[1]||null,
this._value)},done:function(a,b){var c=this._state;1==c&&0==this._wait?a.call(b||null,this._value):0==c&&this._dones.push([a,b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)b[0].call(b[1]||null,this._reason)},fail:function(a,b){var c=this._state;2==c&&0==this._wait?a.call(b||null,this._reason):0==c&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:m(this.then,this),done:m(this.done,this),fail:m(this.fail,
this),always:m(this.always,this)}},after:function(a){var b=this;if(r(a)){b._wait++;var c=function(){b._wait--;0==b._wait&&0!=b._state&&(1==b._state?b._callResolveHandlers():b._callRejectHandlers())};"function"==typeof a.done?a.done(c):a.then(c)}return b}});c(d,{resolve:function(a){return new d(a)},reject:function(a){var b=new d;b.reject(a);return b},all:function(a){if(!a.length)return d.resolve(null);var b=new d,c=a.length,f=Array(c),h=c,g,k,n=function(a,c){f[c]=a;h--;0==h&&b.resolve(f)};for(g=0;g<
c;g++)(function(c){k=a[g];k instanceof d?k.done(function(a){n(a,c)}).fail(b.reject,b):r(k)||"function"==typeof k?(new d(k)).done(function(a){n(a,c)}).fail(b.reject,b):n(k,c)})(g);return b},when:function(){return d.all(arguments)},allResolved:function(a){if(!a.length)return d.resolve(null);var b=new d,c=a.length,f=[],h=c,g,k,n=function(a){f.push(a);p()},p=function(){h--;0==h&&b.resolve(f)};for(g=0;g<c;g++)k=a[g],k instanceof d?k.done(n).fail(p):r(k)||"function"==typeof k?(new d(k)).done(n).fail(p):
n(k);return b},race:function(a){if(!a.length)return d.resolve(null);var b=new d,c=a.length,f,h;for(f=0;f<c&&(h=a[f],h instanceof d?h.done(b.resolve,b).fail(b.reject,b):r(h)||"function"==typeof h?(new d(h)).done(b.resolve,b).fail(b.reject,b):b.resolve(h),b.isPending());f++);return b}});"undefined"==typeof global?(window.Promise||(window.Promise=d),window.MetaphorJs&&(MetaphorJs.r?MetaphorJs.r("MetaphorJs.lib.Promise",d):(MetaphorJs.lib=MetaphorJs.lib||{},MetaphorJs.lib.Promise=d))):"undefined"!=typeof module&&
(module.exports=d)})();
(function(){"undefined"==typeof window&&(global.window=global);if(window.Promise)g=window.Promise;else{var g;if("undefined"!=typeof global)try{g=require("metaphorjs-promise")}catch(r){global.Promise&&(g=global.Promise)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Promise&&(g=MetaphorJs.lib.Promise)}var m=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){return Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10)},k=function(a,b){for(var c in b)b.hasOwnProperty(c)&&
(a[c]=b[c])},p=Array.prototype.slice,n="undefined"!=typeof process?process.nextTick:function(a){window.setTimeout(a,0)},q=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},f=function(){this.events={}};k(f.prototype,{createEvent:function(a,b){a=a.toLowerCase();var d=this.events;d[a]||(d[a]=new c(a,b));return d[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,b,d,f){a=a.toLowerCase();var h=this.events;
h[a]||(h[a]=new c(a));return h[a].on(b,d,f)},once:function(a,b,c,d){d=d||{};d.limit=1;return this.on(a,b,c,d)},un:function(a,b,c){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(b,c)},hasListener:function(a,b,c){a=a.toLowerCase();var d=this.events;return d[a]?d[a].hasListener(b,c):!1},removeAllListeners:function(a){var b=this.events;b[a]&&b[a].removeAllListeners()},triggerAsync:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return[];a=b[a];return a.triggerAsync.apply(a,p.call(arguments,
1))},trigger:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return null;a=b[a];return a.trigger.apply(a,p.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=this.events;
b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(a){var b=this.events;if(a)a=a.toLowerCase(),b[a]&&(b[a].destroy(),delete b[a]);else{for(var c in b)b[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners triggerAsync trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),b={},c,d=-1,f=a.length;++d<f;c=a[d],b[c]=q(this[c],this));this.api=b}return this.api}});
var c=function(a,b){this.name=a;this.listeners=[];this.map={};this.hash=m();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=b||!1};k(c.prototype,{getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var d=this.uni,f=b||a;if(f[d]&&!c.allowDupes)return null;var h=++this.lid,g=c.first||!1;f[d]=h;a={fn:a,scope:b,uniScope:f,id:h,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,
prepend:c.prepend};g?this.listeners.unshift(a):this.listeners.push(a);this.map[h]=a;return h},once:function(a,b,c){c=c||{};c.once=!0;return this.on(a,b,c)},un:function(a,b){var c=-1,d=this.uni,f=this.listeners,h;h=a==parseInt(a)?a:(b||a)[d];if(!h)return!1;for(var g=0,k=f.length;g<k;g++)if(f[g].id==h){c=g;delete f[g].uniScope[d];break}if(-1==c)return!1;f.splice(c,1);delete this.map[h];return!0},hasListener:function(a,b){var c=this.listeners,d;if(a){b=b||a;d=a==parseInt(a)?a:b[this.uni];if(!d)return!1;
for(var f=0,h=c.length;f<h;f++)if(c[f].id==d)return!0;return!1}return 0<c.length},removeAllListeners:function(){var a=this.listeners,b=this.uni,c,d;c=0;for(d=a.length;c<d;c++)delete a[c].uniScope[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){var c;a.append||a.prepend?(c=p.call(b),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append))):c=b;return c},triggerAsync:function(){if("undefined"==typeof g)throw Error("Promises are not defined");
var a=this,b=a.listeners,c=a.returnResult,d=p.call(arguments),f=[],h=[],k,m,q;if(a.suspended||0==b.length)return g.resolve(null);m=0;for(q=b.length;m<q;m++)f.push(b[m]);for(m=function(b){k=a._prepareArgs(b,d);return new g(function(c,d){n(function(){try{c(b.fn.apply(b.scope,k))}catch(f){d(f)}b.called++;b.called==b.limit&&a.un(b.id)},0)})};(b=f.shift())&&(!b||!a.map[b.id]||(b.count++,b.count<b.start||(h.push(m(b)),"first"!=c))););return"last"==c?[h.pop()]:h},trigger:function(){var a=this.listeners,
b=this.returnResult;if(this.suspended||0==a.length)return null;var c="all"==b?[]:null,d=[],f,h;if("first"==b)d.push(a[0]);else for(f=0,h=a.length;f<h;f++)d.push(a[f]);for(;a=d.shift();)if(a&&this.map[a.id]&&(a.count++,!(a.count<a.start))){f=a.fn.apply(a.scope,this._prepareArgs(a,arguments));a.called++;a.called==a.limit&&this.un(a.id);"all"==b&&c.push(f);if("first"==b)return f;"last"==b&&(c=f);if(!1==b&&!1===f)break}if(b)return c}});var h=window.MetaphorJs;if(h){var d=new f;k(h,d.getApi())}h&&h.r?
h.r("MetaphorJs.lib.Observable",f):(window.MetaphorJs=window.MetaphorJs||{},MetaphorJs.lib=MetaphorJs.lib||{},MetaphorJs.lib.Observable=f);"undefined"!=typeof global&&(module.exports=f)})();
(function(){"undefined"==typeof window&&(global.window=global);var g;if("undefined"!=typeof global)try{g=require("metaphorjs-observable")}catch(r){global.Observable&&(g=global.Observable)}else window.MetaphorJs&&MetaphorJs.lib&&MetaphorJs.lib.Observable&&(g=MetaphorJs.lib.Observable);var m=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,k={},p=window.MetaphorJs&&MetaphorJs.nextUid?MetaphorJs.nextUid:function(){var a;a=Array(11).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,10);return k[a]?
p():k[a]=a},n=Object.prototype.toString,q=function(a){return"[object Array]"===n.call(a)},f=function(a){return"[object Date]"===n.call(a)},c=function(a){return"[object RegExp]"===n.call(a)},h=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},d=function(a,b){if(h(a))throw Error("Cannot copy window object");if(b){if(a===b)throw Error("Objects are identical");if(q(a))for(var g=b.length=0;g<a.length;g++)b.push(d(a[g]));else{for(g in b)delete b[g];for(g in a)b[g]=d(a[g])}}else(b=a)&&
(q(a)?b=d(a,[]):f(a)?b=new Date(a.getTime()):c(a)?b=new RegExp(a.source):null!=a&&"object"===typeof a&&(b=d(a,{})));return b},a=function(b,d){if(b===d)return!0;if(null===b||null===d)return!1;if(b!==b&&d!==d)return!0;var g=typeof b,l;if(g==typeof d&&"object"==g)if(q(b)){if(!q(d))return!1;if((g=b.length)==d.length){for(l=0;l<g;l++)if(!a(b[l],d[l]))return!1;return!0}}else{if(f(b))return f(d)&&b.getTime()==d.getTime();if(c(b)&&c(d))return b.toString()==d.toString();if(h(b)||h(d)||q(d))return!1;g={};for(l in b)if(("$"!==
l.charAt(0)||"object"!=typeof b[l])&&"function"!==typeof b[l]){if(!a(b[l],d[l]))return!1;g[l]=!0}for(l in d)if(!g.hasOwnProperty(l)&&"$"!==l.charAt(0)&&void 0!==d[l]&&"function"!==typeof d[l])return!1;return!0}return!1},b=function(b,c){var d=b.length,f=c.length,h=Array(d+1),g=Array(d+1),s,G,l,k,y=0;if(d==f&&0==d)return{changes:0,distance:0,prescription:[]};for(s=0;s<=d;s++)h[s]=Array(f+1),g[s]=Array(f+1),h[s][0]=s,g[s][0]="D";for(s=0;s<=f;s++)h[0][s]=s,g[0][s]="I";for(s=1;s<=d;s++)for(G=1;G<=f;G++)l=
a(b[s-1],c[G-1])?0:1,h[s][G-1]<h[s-1][G]&&h[s][G-1]<h[s-1][G-1]+l?(h[s][G]=h[s][G-1]+1,g[s][G]="I"):h[s-1][G]<h[s-1][G-1]+l?(h[s][G]=h[s-1][G]+1,g[s][G]="D"):(h[s][G]=h[s-1][G-1]+l,g[s][G]=1==l?"R":"-");k=[];s=d;G=f;do l=g[s][G],k.push(l),"-"!=l&&y++,"R"==l||"-"==l?(s--,G--):"D"==l?s--:G--;while(0!=s||0!=G);return{changes:y/k.length,distance:h[d][f],prescription:k.reverse()}},l=window.MetaphorJs?MetaphorJs.trim:function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():
a}:function(a){return"string"==typeof a?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),t,L=window.MetaphorJs?MetaphorJs.ns.get:null,v=function(a,b,c,d,f){t||(t=new g);var h=p(),s;q(a)&&null===b?s="array":("string"!=typeof b&&(d=c,c=b,b=null,s="object"),"string"==typeof a&&(d=c,c=b,b=a,a=null),b&&a&&(s=a.hasOwnProperty(b)?"attr":"expr"),b&&!a&&(s="expr"));if(c)t.on(h,c,d||this,{append:[f],allowDupes:!0});this.code=b=this._processPipes(b,a);this.getterFn="expr"==s?w(b):null;this.id=h;this.type=s;
this.obj=a;this.itv=null;this.curr=this._getValue()};(function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(v.prototype,{code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,arraySlice:!1,pipes:null,_addPipe:function(a,b,c){var d=b.shift(),f=null,h=[],s;L&&(f=L("filter."+d,!0));f||(f=window[d]||c[d]);if("function"==typeof f){d=-1;for(s=b.length;++d<s;h.push(z(c,b[d],self.check,self)));a.push([f,b,h])}},_processPipes:function(a,b){for(var c=0,d=a.length,f=[],
h,s,g,k=!1,y=a;c<d;)if(-1!=(h=a.indexOf("|",c)))s=a.charAt(h-1),g=a.charAt(h+1),"|"!=s&&"'"!=s&&'"'!=s&&"|"!=g&&"'"!=g&&'"'!=g&&(k?(c=l(a.substring(c,h)).split(":"),this._addPipe(f,c,b)):(k=!0,y=l(a.substring(0,h)))),c=h+1;else{k&&(c=l(a.substr(c)).split(":"),this._addPipe(f,c,b));break}f.length&&(this.pipes=f);return y},_checkCode:function(){var a=this._getValue(),c=!1,d=this.curr;if(q(d)&&q(a))return c=b(d,a),c.changes?(this.curr=a.slice(),t.trigger(this.id,c,a,d),!0):!1;a!==d&&(this.curr=a,t.trigger(this.id,
a,d),c=!0);return c},_checkObject:function(){var b=this.obj,c=this.curr;return a(c,b)?!1:(this.curr=d(b),t.trigger(this.id,b,c),!0)},_checkArray:function(){var a=this.curr,c=this.obj,d=b(a,c);return d.changes?(this.curr=c.slice(),t.trigger(this.id,d,c,a),!0):!1},_getValue:function(){var a;switch(this.type){case "attr":a=this.obj[this.code];break;case "expr":try{a=this.getterFn(this.obj)}catch(b){if(window.MetaphorJs)MetaphorJs.error(b);else throw e;}"undefined"==typeof a&&(a="");break;case "object":a=
d(this.obj);break;case "array":a=this.obj}q(a)&&(a=a.slice());var c=this.pipes;if(c){var f,h,g,s=c.length,G=this.obj,l,k;for(f=0;f<s;f++){g=c[f][1];h=[];l=-1;for(k=g.length;++l<k;h.push(F(g[l],G)));h.unshift(a);h.push(G);a=c[f][0].apply(null,h)}}return a},addListener:function(a,b,c){return t.on(this.id,a,b,c)},removeListener:function(a,b){return t.un(this.id,a,b)},getValue:function(){return this._getValue()},setValue:function(a){var b=this.type;if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||
(this.setterFn=x(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";},check:function(){switch(this.type){case "expr":case "attr":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&
(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,b){var c=this.id;t.un(c,a,b);return t.hasListener(c)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b,c,d,f,h;this.itv&&this.clearInterval();if(a)for(b=-1,c=a.length;++b<c;)for(h=a[b][2],d=-1,f=h.length;++d<f;)h[d].unsubscribeAndDestroy(this.check,this);this.pipes=this.obj=this.curr=null;t.destroyEvent(this.id);this.obj&&delete this.obj.$$watchers[this.code]}});var z=function(a,b,c,d,f){b=D(a,l(b));return a?(a.$$watchers||
(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof v&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof v)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].addListener(c,d,{append:[f],allowDupes:!0}):a.$$watchers[b]=new v(a,b,c,d,f),a.$$watchers[b]):new v(a,b,c,d,f)},D=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==
b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},J=Function,A=MetaphorJs.error;"undefined"!=typeof window&&(window.watchableError=A);"undefined"!=typeof global&&(global.watchableError=A);var B={},w=function(a){return B[a]?B[a]:B[a]=new J("____","".concat("try {","return ",a.replace(m,"$1____.$3"),";} catch (thrownError) { watchableError(thrownError); }"))},M={},x=function(a){if(!M[a]){var b=a.replace(m,"$1____.$3");return M[a]=new J("____","$$$$","".concat("try {",b," = $$$$",";} catch (thrownError) { watchableError(thrownError); }"))}return M[a]},
y={},F=function(a,b){return w(a)(b)};v.create=z;v.unsubscribeAndDestroy=function(a,b,c,d){b=l(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,d)&&delete a[b]};v.normalizeExpr=D;v.prepareCode=function(a){return a.replace(m,"$1____.$3")};v.createGetter=w;v.createSetter=x;v.createFunc=function(a){return y[a]?y[a]:y[a]=new J("____","".concat("try {",a.replace(m,"$1____.$3"),";} catch (thrownError) { watchableError(thrownError); }"))};v.eval=F;window.MetaphorJs&&MetaphorJs.r&&MetaphorJs.r("MetaphorJs.lib.Watchable",
v);"undefined"!=typeof global&&(module.exports=v)})();
(function(){var g,r;if("undefined"!=typeof global)try{g=require("metaphorjs-promise"),r=require("metaphorjs-observable")}catch(m){g=global.MetaphorJs.lib.Promise,r=global.MetaphorJs.lib.Observable}else g=window.MetaphorJs.lib.Promise,r=window.MetaphorJs.lib.Observable;var k=MetaphorJs.extend,p=MetaphorJs.bind,n=MetaphorJs.addListener,q=MetaphorJs.trim,f=MetaphorJs.isArray,c;"undefined"!=typeof window&&(c=document.querySelectorAll||function(a){var b=document,c=b.documentElement.firstChild,d=b.createElement("STYLE");
c.appendChild(d);b.__qsaels=[];d.sheet?d.sheet.insertRule(a+"{x:expression(document.__qsaels.push(this))}",0):d.styleSheet&&(d.styleSheet.cssText=a+"{x:expression(document.__qsaels.push(this))}");window.scrollBy(0,0);return b.__qsaels});var h=/#.*$/,d=/([?&])_=[^&]*/,a=/\?/,b=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,l=/^(?:GET|HEAD)$/i,t=0,L=function(a,b){setTimeout(function(){a.call(b)},0)},v=function(a,b){var c,d;if(!a||"string"!==typeof a)return null;try{d=new DOMParser,c=d.parseFromString(a,
b||"text/xml")}catch(f){c=void 0}if(!c||c.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return c},z=function(a,b,c){var d,h;if("string"==typeof a&&c)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a));else if(f(a)&&c)for(d=0,h=a.length;d<h;d++)z(a[d],b,c+"["+d+"]");else if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&z(a[d],b,c?c+"["+d+"]":d)},D=function(b,c){b.replace(h,"");if(!1===c.cache){var f=(new Date).getTime();return d.test(b)?b.replace(d,"$1_="+f):b+(a.test(b)?
"&":"?")+"_="+f}!c.data||window.FormData&&c.data instanceof window.FormData||("string"!=typeof c.data?(f=[],z(c.data,f,null),f=f.join("&").replace(/%20/g,"+")):f=c.data,c.data=f,l.test(c.method)&&(b+=(a.test(b)?"&":"?")+c.data,c.data=null));return b},J={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},A={url:null,data:null,method:"GET",headers:null,username:null,password:null,
cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},B={},w=new r,M=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},x=function(a,b,c){var d,h;if("object"!=
typeof a&&"function"!=typeof a&&c)d=document.createElement("input"),d.setAttribute("type","hidden"),d.setAttribute("name",c),d.setAttribute("value",a),b.appendChild(d);else if(f(a)&&c)for(d=0,h=a.length;d<h;d++)x(a[d],b,c+"["+d+"]");else if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&x(a[d],b,c?c+"["+d+"]":d)},y=function(a){for(var b,c,d="",f=0;f<a.elements.length;f++)if(b=a.elements[f],b.hasAttribute("name"))if(c="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT",
"FILE"===c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},F=function(){},C=function(a,b,d){var f=b?b.dataType:null;b=b?b.selector:null;if("string"!=typeof a)return a;d=d||"";if("xml"===f||!f&&0<=d.indexOf("xml"))return a=v(q(a)),b?c.call(a,b):a;if("html"===f)return a=v(a,"text/html"),b?c.call(a,b):a;if("fragment"==f){d=document.createDocumentFragment();
f=document.createElement("div");for(f.innerHTML=a;f.firstChild;)d.appendChild(f.firstChild);return d}if("json"===f||!f&&0<=d.indexOf("json"))return a=q(a),JSON.parse(a);("script"===f||!f&&0<=d.indexOf("javascript"))&&M(a);return a+""},N=function(a){var c=b.exec(("undefined"!=typeof window?window.location.href:"").toLowerCase())||[],d=b.exec(a.url.toLowerCase());this._opt=a;a.crossDomain=!(!d||d[1]===c[1]&&d[2]===c[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(c[3]||("http:"===c[1]?"80":"443")));c=new g;
"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||"undefined"!=typeof window&&window.FormData||"iframe"==a.transport||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):y(a.form));a.url=D(a.url,a);d=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new E(a,c,this):new S(a,c,this):new K(a,c,this);this._deferred=c;this._transport=d;c.done(function(a){w.trigger("success",
a)});c.fail(function(a){w.trigger("error",a)});c.always(function(){w.trigger("end")});w.trigger("start");a.timeout&&(this._timeout=setTimeout(p(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===w.trigger("beforeSend",a,d)&&(this._promise=g.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,d)&&(this._promise=g.reject());this._promise||(L(d.send,d),a=c.promise(),a.abort=p(this.abort,this),c.always(this.destroy,this),this._promise=a)};k(N.prototype,{_jsonpName:null,_transport:null,
_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);x(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var b=this._opt,c=b.jsonpParam||
"callback",d=b.jsonpCallback||"jsonp_"+ ++t;b.url+=(a.test(b.url)?"&":"?")+c+"="+d;this._jsonpName=d;"undefined"!=typeof window&&(window[d]=p(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=p(this.jsonpCallback,this));return d},jsonpCallback:function(a){try{this._deferred.resolve(this.processResponseData(a))}catch(b){this._deferred.reject(b)}},processResponseData:function(a,b){var c=this._opt;a=C(a,c,b);w.hasListener("processResponse")&&(a=w.trigger("processResponse",a,this._deferred));
c.processResponse&&(a=c.processResponse.call(c.callbackScope,a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred;if(this._opt.jsonp)if(a){try{M(a)}catch(d){c.reject(d)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else try{c.resolve(this.processResponseData(a,b))}catch(f){c.reject(f)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);
this._transport.destroy();delete this._transport;delete this._opt;delete this._deferred;delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},!0);var u=function(a,b){b=b||{};a&&"string"!=typeof a?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),!b.url))throw"Must provide url";k(b,B,!1);k(b,A,!1);b.method=b.method?b.method.toUpperCase():
b.form?b.form.getAttribute("method").toUpperCase()||"GET":"GET";return(new N(b)).promise()};u.setup=function(a){k(B,a,!0)};u.on=function(){w.on.apply(w,arguments)};u.un=function(){w.un.apply(w,arguments)};u.get=function(a,b){b=b||{};b.method="GET";return u(a,b)};u.post=function(a,b){b=b||{};b.method="POST";return u(a,b)};u.load=function(a,b,c){c=c||{};"string"!=typeof b&&(c=b);c.dataType="fragment";return u(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};
u.loadScript=function(a){return u(a,{transport:"script"})};u.submit=function(a,b){b=b||{};b.form=a;return u(null,b)};var S=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&n(d,"progress",p(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&n(d.upload,"progress",p(a.uploadProgress,a.callbackScope));
try{var f;if(a.xhrFields)for(f in a.xhrFields)d[f]=a.xhrFields[f];a.data&&a.contentType&&d.setRequestHeader("Content-Type",a.contentType);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Accept",a.dataType&&J[a.dataType]?J[a.dataType]+", */*; q=0.01":J._default);for(f in a.headers)d.setRequestHeader(f,a.headers[f])}catch(h){}d.onreadystatechange=p(this.onReadyStateChange,this)};k(S.prototype,{_xhr:null,_deferred:null,_ajax:null,onReadyStateChange:function(){var a=this._xhr,
b=this._deferred;if(0===a.readyState)a.onreadystatechange=F,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=F;var c;a:{try{c=!a.status&&"undefined"!=typeof location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse("string"==typeof a.responseText?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=F;this._xhr.abort()},send:function(){var a=
this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}},!0);var K=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};k(K.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);
n(a,"load",p(this.onLoad,this));n(a,"error",p(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);var E=function(a,b,c){this._opt=a;this._ajax=
c;this._deferred=b};k(E.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+ ++t,c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);n(a,"load",p(this.onLoad,this));n(a,"error",p(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},onLoad:function(){var a=this._el;this._opt&&
!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}},!0);"undefined"!=typeof global?module.exports=u:window.MetaphorJs?MetaphorJs.ajax=u:window.MetaphorJs=
{ajax:u}})();
(function(){var g=[],r=!1,m=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/,k=function(c,d,a){c.attachEvent?c.attachEvent("on"+d,a):c.addEventListener(d,a,!1)},p=!!history.pushState,n="onhashchange"in window,q=function(c){var d=location.protocol+"//"+location.hostname;location.port&&(d+=":"+location.port);c=c.replace(d,"");p||(c=encodeURIComponent(c));return c},f=function(){var c;p?c=location.pathname+location.search:(c=location.hash.substr(1))?("!"==
c.substr(0,1)&&(c=c.substr(1)),c=decodeURIComponent(c)):c=location.pathname+location.search;return c},c=function(){var c=f();if(g.length)for(var d=-1,a=g.length;++d<a;g[d].call(null,c));window.MetaphorJs&&MetaphorJs.triggerAsync("locationchange",c)};k(window,"load",function(){r=!0});history.initPushState=function(){if(p)history.origPushState=history.pushState,history.origReplaceState=history.replaceState,k(window,"popstate",c),history.pushState=function(a,b,d){history.origPushState(a,b,q(d));c()},
history.replaceState=function(a,b,d){history.origReplaceState(a,b,q(d));c()};else if(n)history.replaceState=history.pushState=function(a,b,c){a=q(c);location.hash=a?"!"+a:""},k(window,"hashchange",c);else{var f=null,d=!1;window.onIframeHistoryChange=function(a){d||(location.hash=a?"!"+a:"",c())};var a=function(a){var b=f.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');
b.close()};history.pushState=function(b,c,d){a(q(d))};history.replaceState=function(a,b,c){a=q(c);f.contentWindow.hashValue=a};var b=function(){f=document.createElement("iframe");f.src="about:blank";f.style.display="none";document.body.appendChild(f);d=!0;a(q(location.hash.substr(1)));d=!1};r?b():k(window,"load",b)}k(document.documentElement,"click",function(a){a=a||window.event;for(var b=a.target||a.srcElement,c;b&&"a"!=b.nodeName.toLowerCase();)b=b.parentNode;if(b){c=b.getAttribute("href");var d;
if(d=c&&"#"!=c.substr(0,1))c=c.match(m),d=c[1]&&location.protocol!=c[1]||c[2]&&location.hostname!=c[2]?!1:c[2]||c[3]?location.port!=c[3]?!1:!0:!0;if(d&&!b.getAttribute("target"))return history.pushState(null,null,b.getAttribute("href")),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1}});history.initPushState=function(){}};window.MetaphorJs?(MetaphorJs.pushUrl=function(c){history.pushState(null,null,c)},MetaphorJs.replaceUrl=function(c){history.replaceState(null,null,
c)},MetaphorJs.currentUrl=function(){return f()}):history.onchange=function(c){g.push(c)}})();
(function(){var g=window.MetaphorJs,r=g.extend,m=g.lib.Promise,k=g.isThenable,p=Array.prototype.slice,n=g.bind,q,f=function(c){c&&(this.store={$rootScope:{type:1,value:c.$root},$app:{type:1,value:c.$app}})};r(f.prototype,{store:null,getApi:function(){return{value:n(this.value,this),constant:n(this.constant,this),factory:n(this.factory,this),service:n(this.service,this),provider:n(this.provider,this),resolve:n(this.resolve,this),inject:n(this.inject,this)}},instantiate:function(c,f){var d=function(){},
a;d.prototype=c.prototype;d=new d;a=c.prototype.constructor.apply(d,f);return"object"==typeof a?a:d},inject:function(c,f,d,a,b){a=a||{};b=b||[];if("function"==typeof c)if(c.inject)b=p.call(c.inject),b.push(c),c=b;else return d||c.__isMetaphorClass?this.instantiate(c,b):c.apply(f,b);c=p.call(c);var g=this;b=[];var k=c.pop(),n,v;n=-1;for(v=c.length;++n<v;b.push(g.resolve(c[n],a)));return m.all(b).then(function(a){return d||k.__isMetaphorClass?g.instantiate(k,a):k.apply(f,a)})},value:function(c,f){this.store[c]=
{type:1,value:f}},constant:function(c,f){var d=this.store;d[c]||(d[c]={type:2,value:f})},factory:function(c,f,d,a){"boolean"==typeof d&&(a=d,d=null);this.store[c]={type:3,singleton:a,fn:f,context:d}},service:function(c,f,d){this.store[c]={type:4,singleton:d,fn:f}},provider:function(c,f){this.store[c+"Provider"]={name:c,type:5,fn:f,instance:null}},resolve:function(c,f){var d=this.store,a,b,g;if(f[c])return f[c];if(b=d[c]){a=b.type;if(1==a||2==a)return b.value;if(3==a)g=this.inject(b.fn,b.context,!1,
f);else if(4==a)g=this.inject(b.fn,null,!0,f);else if(5==a)return b.instance||(b.instance=m.resolve(this.inject(b.fn,null,!0,f)).done(function(a){b.instance=a;d[b.name]={type:3,fn:a.$get,context:a}})),b.instance;b.singleton&&(b.type=1,b.value=g,3==a&&k(g)&&g.done(function(a){b.value=a}));return f[c]=g}if(d[c+"Provider"])return this.resolve(c+"Provider",f),this.resolve(c,f);if(this===q)throw"Could not provide value for "+c;return q.resolve(c)},destroy:function(){delete this.store;delete this.scope}});
g.r("MetaphorJs.lib.Provider",f);f.global=function(){return q};q=new f})();
(function(){var g=MetaphorJs.lib.Observable,r=MetaphorJs.extend;MetaphorJs.d("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(m){m=m||{};this._observable=new g;r(this,this._observable.getApi());if(m.callback){var k=m.callback,p=k.scope||this;delete k.scope;for(var n in k)if(k.hasOwnProperty(n))this.on(n,k[n],p);delete m.callback}r(this,m,!0)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",
this);this._observable.destroy();delete this._observable}},onDestroy:MetaphorJs.emptyFn})})();
(function(){var g=window.MetaphorJs,r=g.g,m=g.lib.Promise,k=g.data,p=g.isThenable,n=g.isArray,q=g.extend,f={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},c=["Moz","Webkit","ms","O","Khtml"],h="animationDelay",d="animationDuration",a="transitionDelay",b="transitionDuration",l=0,t=function(){var f=document.createElement("div"),g=!1,l,k,n;if(void 0!==f.style.animationName)g=!0;else for(k=0,n=c.length;k<n;k++)if(l=c[k],void 0!==f.style[l+"AnimationName"]){g=
!0;h=l+"AnimationDelay";d=l+"AnimationDuration";a=l+"TransitionDelay";b=l+"TransitionDuration";break}return g}(),L=window.requestAnimationFrame?window.requestAnimationFrame:function(a){window.setTimeout(a,0)},v=function(a,b,c){var d=function(){(new Date).getTime()-b>=c?a():L(d)};L(d)},z=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},D=function(a,b,c){var d,f,g=b.length;for(d=0;d<g;d++)f=z(b[d])+z(c[d]),a=Math.max(f,a);return a},J=function(c){var f=window.getComputedStyle?
window.getComputedStyle(c,null):c.style;c=0;var g=(f[d]||"").split(","),l=(f[h]||"").split(","),k=(f[b]||"").split(","),f=(f[a]||"").split(",");c=Math.max(c,D(c,g,l));return c=Math.max(c,D(c,k,f))},A=function x(a,b,c,d,f,g,h){var l=function(){var b=k(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==h?!1:(f.reject(a),!0)},s=function(){if(!l()){var d=c;c++;if(c==b.length){f.resolve(a);k(a,"mjsAnimationQueue").shift();var g=k(a,"mjsAnimationQueue");g.length?(g=g[0],A(g.el,g.stages,0,g.start,g.deferred,
!1,g.id)):k(a,"mjsAnimationQueue",null)}else k(a,"mjsAnimationQueue")[0].position=c,x(a,b,c,null,f);w(a,b[d]);w(a,b[d]+"-active")}},n=function(){if(!l()){B(a,b[c]+"-active");var d=J(a);d?v(s,(new Date).getTime(),d):s()}},m=function(){if(!l()){B(a,b[c]);var f;d&&(f=d(a),d=null);p(f)?f.done(n):L(n)}};g?L(m):m()},B=MetaphorJs.addClass,w=MetaphorJs.removeClass;MetaphorJs.stopAnimation=function(a){var b=k(a,"mjsAnimationQueue"),c;n(b)&&b.length?(c=b[0])&&c.stages&&(b=c.position,c=c.stages,w(a,c[b]),w(a,
c[b]+"-active")):"function"==typeof b?b(a):"stop"==b&&$(a).stop(!0,!0);k(a,"mjsAnimationQueue",null)};MetaphorJs.animate=function(a,b,c,d){var g=new m,h=k(a,"mjsAnimationQueue")||[],v=++l,K=a.getAttribute("mjs-animate"),E,s,w,B,z,D,L;b=b||K;d&&null===K&&(b=null);if(b){"string"==typeof b?"["==b.substr(0,1)?E=(new Function("","return "+b))():(E=f[b],b=r&&r("animate."+b,!0)):"function"==typeof b?s=b:n(b)&&("string"==typeof b[0]?E=b:(w=b[0],B=b[1]));b&&b.constructor===Object&&(E=b.stages,s=b.fn,w=b.before,
B=b.after,z=b.options||{},D=b.context||null,L=b.duration||null,c=c||z.start);if(t&&E)return h.push({el:a,stages:E,start:c,deferred:g,position:0,id:v}),k(a,"mjsAnimationQueue",h),1==h.length&&A(a,E,0,c,g,!0,v),g;if(s&&"function"==typeof s)return w&&q(a.style,w,!0),c&&c(a),k(a,"mjsAnimationQueue",s.call(D,a,function(){g.resolve(a)})),g;if(window.jQuery){if(s&&"string"==typeof s)return c&&c(a),$(a)[s](L,function(){g.resolve(a)}),k(a,"mjsAnimationQueue","stop"),g;if(B)return b=$(a),w&&b.css(w),c&&(z.start=
function(){c(a)}),z.complete=function(){g.resolve(a)},b.animate(B,z),k(a,"mjsAnimationQueue","stop"),g}}c?(w=c(a),p(w)?w.done(function(){g.resolve(a)}):g.resolve(a)):g.resolve(a);return g};MetaphorJs.animate.getAnimationDuration=J;MetaphorJs.animate.addAnimationType=function(a,b){f[a]=b}})();
(function(){var g=MetaphorJs.lib.Observable,r=MetaphorJs.lib.Watchable,m=MetaphorJs.extend,k;k=MetaphorJs.d("MetaphorJs.view.Scope",{$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$checking:!1,$$destroyed:!1,initialize:function(k){this.$$observable=new g;m(this,k,!0);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)},$new:function(){return new k({$parent:this,
$root:this.$root,$app:this.$app})},$on:function(g,k,m){return this.$$observable.on(g,k,m)},$un:function(g,k,m){return this.$$observable.un(g,k,m)},$watch:function(g,k,m){r.create(this,g,k,m,null)},$unwatch:function(g,k,m){r.unsubscribeAndDestroy(this,g,k,m)},$get:function(g){for(var k=this;k;){if(void 0!=k[g])return k[g];k=k.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$check:function(){var g;this.$$checking||(this.$$checking=!0,this.$$watchers&&
(g=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",g))},$destroy:function(){this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;delete this.$app;delete this.$root;delete this.$parent;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);this.$$destroyed=!0}})})();
(function(){var g=navigator.userAgent.toLowerCase(),r=parseInt((/msie (\d+)/.exec(g)||[])[1],10),m=parseInt((/android (\d+)/.exec(g)||[])[1],10),k={};isNaN(r)&&(r=parseInt((/trident\/.*; rv:(\d+)/.exec(g)||[])[1],10));window.MetaphorJs||(window.MetaphorJs={});MetaphorJs.browser={android:m,hasEvent:function(g){if("input"==g&&9==r)return!1;if(void 0===k[g]){var m=document.createElement("div");k[g]="on"+g in m}return k[g]}}})();
(function(){var g=window.MetaphorJs,r=g.nextUid,m=g.isArray,k=g.view.Scope,p=g.lib.Watchable,n=g.lib.Observable,q=g.isThenable,f=g.toArray,c=g.getAttributeHandlers,h=null,d=g.g,a=p.create,b=p.unsubscribeAndDestroy,l=g.lib.Promise,t,L="string"==typeof document.createTextNode("").textContent?"textContent":"nodeValue",v=function(a,b,c,d,g,h){var l=[];if(a&&!0!==a){if(a.nodeType){h.countdown+=1;J(a,c,d,g,h);return}l=f(a)}l.length||(l=f(b.childNodes));b=l.length;h.countdown+=b;for(a=-1;++a<b;J(l[a],c,
d,g,h));},z=function(a,b){if(b)if(b.nodeType)a.push(b);else if(m(b))for(var c=-1,d=b.length;++c<d;z(a,b[c]));},D=/^(script|template|mjs-template|style)$/i,J=function(a,b,c,d,f){if(a){var g,h=a.nodeName;f||(f={countdown:1});if(!h||!h.match(D))if(a.nodeType&&(g=b.call(c,a)),!1!==g){if(q(g)){g.done(function(g){!1!==g&&v(g,a,b,c,d,f);0==--f.countdown&&d&&d.call(c)});return}v(g,a,b,c,d,f)}0==--f.countdown&&d&&d.call(c)}},A=new n;t=MetaphorJs.d("MetaphorJs.view.Renderer",{id:null,el:null,scope:null,texts:null,
parent:null,destroyed:!1,_observable:null,initialize:function(a,b,c){this.id=r();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof k&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",this.destroy,this)},on:function(a,b,c){return A.on(a+"-"+this.id,b,c)},un:function(a,b,c){return A.un(a+"-"+this.id,b,c)},createChild:function(a){return new t(a,this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,c,d){var f=a.$isolateScope?new k({$app:b.$app}):a.$breakScope?
b.$new():b;b=b.$app;var g={$scope:f,$node:c,$attrValue:d,$renderer:this};c=[f,c,d,this];return a.__isMetaphorClass?(c=b.inject(a,null,!0,g,c),a.$stopRenderer?!1:c):b.inject(a,null,!1,g,c)},processNode:function(a){var b=a.nodeType,f=this.texts,g=this.scope,k;if(3==b)g={watchers:[],node:a,text:"",inx:k=f.length},this.processText(g,a[L]),0<g.watchers.length&&(f.push(g),this.renderText(k));else if(1==b){h||(h=c());var m=a.attributes;k=[];var n=[],v,p,t,K,b="tag."+a.tagName.toLowerCase();if(v=d(b,!0)){t=
this.runHandler(v,g,a);if(!1===t)return!1;q(t)?k.push(t):z(n,t)}v=0;for(p=h.length;v<p;v++)if(K=h[v].name,null!==(t=a.getAttribute(K))){t=this.runHandler(h[v].handler,g,a,t);a.removeAttribute(K);if(!1===t)return!1;q(t)?k.push(t):z(n,t)}if(k.length){var E=new l;l.all(k).done(function(a){z(n,a);E.resolve(n)});return E}v=0;for(p=m.length;v<p;v++)d(b,!0)||(g={watchers:[],node:a,attr:m[v].name,text:"",inx:k=f.length},this.processText(g,m[v].value),0<g.watchers.length&&(f.push(g),this.renderText(k)));return n.length?
n:!0}return!0},process:function(){J(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){A.trigger("rendered-"+this.id,this)},processText:function(a,b){for(var c=0,d=b.length,f,g,h=[];c<d;)if(-1!=(f=b.indexOf("{{",c))&&-1!=(g=b.indexOf("}}",f+2)))h.push(b.substring(c,f)),h.push(this.watcherMatch(a,b.substring(f+2,g))),c=g+2;else{c!==d&&h.push(b.substring(c));break}return a.text=h.join("")},watcherMatch:function(b,c){var d=b.watchers;d.push({watcher:a(this.scope,
c,this.onDataChange,this,b.inx)});return"---"+(d.length-1)+"---"},onDataChange:function(a,b,c){this.renderText(c)},render:function(){var a=this.texts.length,b;for(b=0;b<a;b++)this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.text,c=a.watchers,d=c.length,f=a.attr,g,h;for(g=0;g<d;g++)h=c[g].watcher.getLastResult(),b=b.replace("---"+g+"---",h);f?(a.node.setAttribute(f,b),"value"==f&&(a.node.value=b),"class"==f&&(a.node.className=b)):a.node[L]=b},destroy:function(){var a=this.texts,c,
d,f,g,h;if(!this.destroyed){this.destroyed=!0;d=0;for(f=a.length;d<f;d++)for(c=a[d].watchers,g=0,h=c.length;g<h;g++)b(this.scope,c[g].watcher.code,this.onDataChange,this);this.parent&&this.parent.un("destroy",this.destroy,this);A.trigger("destroy-"+this.id);this.parent=this.scope=this.el=this.texts=null}}},{eachNode:J});MetaphorJs.onReady(function(){var a=MetaphorJs.app,b;if(document.querySelectorAll)for(var c=document.querySelectorAll("[mjs-app]"),d=-1,f=c.length;++d<f;a(c[d]).run());else J(document.documentElement,
function(c){b=c.getAttribute&&c.getAttribute("mjs-app");if(null!==b)return a(c,b),!1})})})();
(function(){var g=window.MetaphorJs,r=g.data,m=g.toFragment,k=g.lib.Watchable.create,p=g.view.Renderer,n=g.clone,q=g.view.Scope,f=g.animate,c=g.lib.Promise,h=g.extend,d=g.nextUid,a=g.trim,b=new g.lib.Observable,l={},t=function(a){if(!l[a]){var b=document.getElementById(a),c;b&&(c=b.tagName.toLowerCase(),"script"==c?(c=document.createElement("div"),c.innerHTML=b.innerHTML,l[a]=m(c.childNodes)):l[a]="content"in b?b.content:m(b.childNodes))}return l[a]},L=function(a){return l[a]?l[a]:l[a]=MetaphorJs.ajax(a,
{dataType:"fragment"}).then(function(b){return l[a]=b})};g.define("MetaphorJs.view.Template",{_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,initialize:function(b){h(this,b,!0);this.id=d();this.tpl&&(this.tpl=a(this.tpl));this.url&&(this.url=a(this.url));b=this.node;var c=this.tpl||this.url;b&&b.removeAttribute("mjs-include");b||(this.deferRendering=!0);
if(c){if(b&&b.firstChild&&r(b,"mjs-transclude",m(b.childNodes)),"."!=c.substr(0,1)||this.replace||(this.ownRenderer=!0,this._watcher=k(this.scope,c,this.onChange,this)),this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof
q&&this.scope.$on("destroy",this.onScopeDestroy,this)},doRender:function(){this._renderer||(this._renderer=new p(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){b.trigger("rendered-"+this.id,this)},on:function(a,c,d){return b.on(a+"-"+this.id,c,d)},un:function(a,c,d){return b.un(a+"-"+this.id,c,d)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?
this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,b=a.url,d=a._watcher?a._watcher.getLastResult():a.tpl||b,f=new c;(new c(function(a){b?a(t(d)||L(b)):a(t(d)||m(d))})).done(function(b){a._fragment=b;f.resolve(a.ownRenderer?!1:a.node)}).fail(f.reject,f);return f},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=
this.node;a.firstChild;)a.removeChild(a.firstChild);this.replace?a.parentNode.replaceChild(n(this._fragment),a):a.appendChild(n(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new c;this._initial?(this.doApplyTemplate(),b.resolve()):(f(a,"leave",null,!0).done(this.doApplyTemplate,this).done(b.resolve,b),f(a,"enter",null,!0));this._initial=!1;return b},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();delete this._renderer},onScopeDestroy:function(){this.destroy();
delete this._renderer},destroy:function(){delete this.node;delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),delete this._watcher);delete this.tpl}},{getTemplate:t,loadTemplate:L})})();
(function(){var g=window.MetaphorJs,r=g.extend,m=g.nextUid,k=g.emptyFn,p=g.ns.get,n=g.lib.Promise,q=g.view.Template,f=g.toFragment,c=g.isAttached,h=g.data,d=g.view.Scope;MetaphorJs.define("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,initialize:function(a){this.scope||(this.scope=new d);this.supr(a);a.as&&(this.scope[a.as]=this);this.node&&
(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);this.id=this.id||"cmp-"+m();this.node||this._createNode();this.initComponent.apply(this,arguments);this.scope.$app&&this.scope.$app.registerCmp(this);var b=this.template,c=this.templateUrl;b&&b instanceof q?b instanceof q&&(this.template.node=this.node):this.template=b=new q({scope:this.scope,node:this.node,deferRendering:!b,ownRenderer:!0,tpl:b,url:c});if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,
this);this._initElement();this.autoRender&&(b.initPromise?b.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display="none")},render:function(){this.rendered||(this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},onRenderingFinished:function(){this.renderTo?
this.renderTo.appendChild(this.node):c(this.node)||document.body.appendChild(this.node);this.rendered=!0;this.afterRender();this.trigger("afterrender",this)},show:function(){if(this.hidden){if(!1===this.trigger("beforeshow",this))return!1;this.node.style.display="block";this.hidden=!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("beforehide",this))return!1;this.node.style.display="none";this.hidden=!0;this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},
isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:k,afterRender:k,onShow:k,onHide:k,onParentRendererDestroy:function(){this.destroy()},onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?c(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.destroyScope&&this.scope&&this.scope.$destroy();
delete this.scope;delete this.node;this.supr()}});MetaphorJs.resolveComponent=function(a,b,c,g,k){b=b||{};k=k||[];c=c||b.scope||new d;g=g||b.node;b.scope=b.scope||c;b.node=b.node||g;if(!c.$app)throw"Cannot resolve component outside app's scope";var m="string"==typeof a?p(a):a,z,D=[];a=m.template||b.template||null;var J=m.templateUrl||b.templateUrl||null,A=c.$app,B={$node:g,$scope:c,$app:A};if(m.resolve)for(z in m.resolve)(function(a){var d=new n,f;D.push(d.done(function(c){b[a]=c}));f=m.resolve[z];
"function"==typeof f?d.resolve(f(c,g)):d.resolve(A.inject(f,null,!1,r({},B,b)))})(z);if(a||J)b.template=new q({scope:c,node:g,deferRendering:!0,ownRenderer:!0,tpl:a,url:J}),D.push(b.template.initPromise),g&&g.firstChild&&h(g,"mjs-transclude",f(g.childNodes));k.unshift(b);if(D.length){var w=new n;n.all(D).done(function(){b.$config=b;w.resolve(A.inject(m,null,!0,b,k))});return w}b.$config=b;return n.resolve(A.inject(m,null,!0,b,k))}})();
(function(){var g=window.MetaphorJs,r=g.view.Scope,m=g.view.Renderer,k=g.lib.Provider,p=g.lib.Observable,n=g.lib.Promise,q=g.bind,f=g.extend;MetaphorJs.define("MetaphorJs.cmp.App","MetaphorJs.cmp.Base",{scope:null,renderer:null,cmpListeners:null,components:null,initialize:function(c,g){var d=g instanceof r?g:new r(g),a,b;d.$app=this;this.supr();a=new k(d);b=new p;f(this,a.getApi());this.destroyProvider=q(a.destroy,a);f(this,b.getApi());this.destroyObservable=q(b.destroy,b);this.scope=d;this.cmpListeners=
{};this.components={};this.renderer=new m(c,d);this.factory("$parentCmp",["$node",this.getParentCmp],this)},run:function(){this.renderer.process()},getParentCmp:function(c){c=c.parentNode;for(var f;c;){if(f=c.getAttribute("cmp-id"))return this.getCmp(f);c=c.parentNode}return null},onAvailable:function(c,f,d){var a=this.cmpListeners;a[c]||(a[c]=new n);f&&a[c].done(f,d);return a[c]},getCmp:function(c){return this.components[c]||null},registerCmp:function(c){var f=this;f.onAvailable(c.id).resolve(c);
f.components[c.id]=c;c.on("destroy",function(c){delete f.cmpListeners[c.id];delete f.components[c.id]})},destroy:function(){var c;this.destroyObservable();this.destroyProvider();this.renderer.destroy();this.scope.$destroy();for(c in this)this.hasOwnProperty(c)&&delete this[c]}})})();
(function(){var g=window.MetaphorJs,r=g.data,m=g.currentUrl,k=g.toFragment,p=g.animate,n=g.lib.Scope,q=g.extend,f=g.stopAnimation,c=g.resolveComponent,h=g.lib.Watchable.create;MetaphorJs.define("MetaphorJs.cmp.View",{route:null,node:null,scope:null,cmp:null,currentComponent:null,watchable:null,defaultCmp:null,initialize:function(c){q(this,c,!0);(c=this.node)&&c.firstChild&&r(c,"mjs-transclude",k(c.childNodes));this.cmp||(this.cmp=c.getAttribute("mjs-view-cmp"));this.defaultCmp=c.getAttribute("mjs-view-default");
c.removeAttribute("mjs-view");c.removeAttribute("mjs-view-cmp");c.removeAttribute("mjs-view-default");this.route?(history.initPushState(),MetaphorJs.on("locationchange",this.onLocationChange,this),this.onLocationChange()):this.cmp&&(this.watchable=h(this.scope,this.cmp,this.onCmpChange,this),this.onCmpChange())},onCmpChange:function(){var c=this.watchable.getLastResult()||this.defaultCmp;this.clearComponent();c&&this.setComponent(c)},onLocationChange:function(){var c=m(),a=this.route,b,f,g,h,k;f=
0;for(g=a.length;f<g;f++){h=a[f];if(k=c.match(h.reg)){this.changeRouteComponent(h,k);return}h["default"]&&!b&&(b=h)}b?this.setRouteComponent(b,[]):this.clearComponent();!b&&this.defaultCmp&&this.setComponent(this.defaultCmp)},changeRouteComponent:function(c,a){f(this.node);this.clearComponent();this.setRouteComponent(c,a)},clearComponent:function(){var c=this,a=c.node;c.currentComponent&&p(a,"leave",null,!0).done(function(){c.currentComponent.destroy();for(c.currentComponent=null;a.firstChild;)a.removeChild(a.firstChild)})},
setRouteComponent:function(d,a){var b=this,f=b.node,g=d.params;p(f,"enter",function(){var h=a||[],k={destroyEl:!1,node:f,scope:d.isolateScope?new n({$app:b.scope.$app}):b.scope.$new()},m,p;d.as&&(k.as=d.as);d.template&&(k.template=d.template);h.shift();if(g)for(m=-1,p=g.length;++m<p;k[g[m]]=h[m]);return c(d.cmp||"MetaphorJs.cmp.Component",k,k.scope,f,null,h).done(function(a){b.currentComponent=a})},!0)},setComponent:function(d){var a=this,b=a.node;p(b,"enter",function(){var f="object"==typeof d?d:
{},g=("string"==typeof d?d:null)||"MetaphorJs.cmp.Component",h=f.scope||a.scope.$new();f.destroyEl=!1;return c(g,f,h,b).done(function(b){a.currentComponent=b})},!0)},destroy:function(){this.clearComponent();this.route&&(MetaphorJs.un("locationchange",this.onLocationChange,this),delete this.route);this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),delete this.watchable);delete this.scope;delete this.currentComponent}})})();
(function(){var g=window.MetaphorJs,r=g.view.Scope,m=g.trim,k=g.define,p=g.ns.get,n=g.lib.Watchable,q=g.view.Renderer,f=g.data,c=g.toArray,h=g.toFragment,d=g.clone,a=g.addListener,b=g.normalizeEvent,l=g.registerAttributeHandler,t=g.registerTagHandler,L=g.async,v=n.create,z=n.createGetter,D=g.animate,J=g.addClass,A=g.removeClass,B=g.hasClass,w=g.stopAnimation,M=g.isArray,x=g.isAttached,y=g.view.Template,F=g.lib.Input,C,N=function(a,b){for(var c;a;){c=f(a,b);if(void 0!=c)return c;a=a.parentNode}};MetaphorJs.d("MetaphorJs.view.AttributeHandler",
{watcher:null,scope:null,node:null,expr:null,initialize:function(a,b,c){c=m(c);this.node=b;this.expr=c;this.scope=a;this.watcher=v(a,c,this.onChange,this);this.onChange();a instanceof r&&a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){delete this.node;delete this.scope;this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)},onChange:function(){}});l("mjs-bind",1E3,k(null,"MetaphorJs.view.AttributeHandler",{isInput:!1,initialize:function(a,b,
c){var d=b.tagName.toLowerCase();this.isInput="input"==d||"textarea"==d;this.supr(a,b,c)},onChange:function(){var a=this.watcher.getLastResult();this.isInput?this.node.value=a:this.node.textContent=a}}));l("mjs-bind-html",1E3,k(null,"MetaphorJs.view.AttributeHandler",{onChange:function(){this.node.innerHTML=this.watcher.getLastResult()}}));l("mjs-model",1E3,k(null,"MetaphorJs.view.AttributeHandler",{inProg:!1,input:null,initialize:function(a,b,c){this.node=b;this.input=new F(b,this.onInputChange,
this);this.supr(a,b,c)},onInputChange:function(a){var b=this.scope;this.watcher.setValue(a);this.inProg=!0;b instanceof r?b.$root.$check():this.watcher.checkAll();this.inProg=!1},onScopeDestroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var a=this.watcher.getLastResult();this.inProg||this.input.setValue(a)}}));l("mjs-show",500,k(null,"MetaphorJs.view.AttributeHandler",{initial:!0,initialize:function(a,b,c){this.supr(a,b,c)},runAnimation:function(a){var b=this.node.style,
c=function(){b.display=a?"":"none"};this.initial?c():D(this.node,a?"show":"hide",function(){a&&(b.display="")},!0).done(c)},onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));l("mjs-hide",500,k(null,"attr.mjs-show",{onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(!a);this.initial=!1}}));l("mjs-if",500,k(null,"MetaphorJs.view.AttributeHandler",{parentEl:null,prevEl:null,el:null,initial:!0,initialize:function(a,b,c){this.parentEl=
b.parentNode;this.prevEl=b.previousSibling;this.supr(a,b,c)},onScopeDestroy:function(){delete this.prevEl;delete this.parentEl;this.supr()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,d=a.node,f=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},g=function(){c.removeChild(d)};b?x(d)||(a.initial?f():D(d,"enter",f,!0)):x(d)&&(a.initial?g():D(d,"leave",null,!0).done(g));a.initial=!1}}));l("mjs-each",100,k(null,"MetaphorJs.view.AttributeHandler",
{model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=b;this.scope=a;try{this.watcher=v(a,this.model,this.onChange,this)}catch(d){MetaphorJs.error(d)}this.parentEl.removeChild(b);this.render(this.watcher.getValue())},onScopeDestroy:function(){var a=
this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.supr()},doUpdate:function(a,b){for(var c=this.renderers,d=b,f=c.length,g=f-1,h=!(d%2),k,l;d<f;d++)k=c[d],l=k.scope,l.$index=d,l.$first=0===d,l.$last=d===g,l.$even=h,l.$odd=!h,h=!h,k.renderer?l.$check():(k.renderer=new q(k.el,k.scope),k.renderer.process())},render:function(a){var b=this.renderers,c=this.tpl,d=this.parentEl,f=this.nextEl,
g=document.createDocumentFragment(),h,k,l;k=0;for(l=a.length;k<l;k++)h=c.cloneNode(!0),g.appendChild(h),b.push(this.createItem(h,a,k));d.insertBefore(g,f);this.doUpdate(a,0)},createItem:function(a,b,c){var d=this.itemName,f=this.scope.$new();f[d]=b[c];return{el:a,scope:f}},onChange:function(a){var b=this,c=b.renderers;a=a.prescription;var d=b.tpl,f=0,g=b.parentEl,h=b.watcher.getValue(),k=null,l,m,n,p;m=0;for(n=a.length;m<n;m++)p=a[m],"-"==p?(c[f].scope.$index=f,f++):(null===k&&(k=0<m?m-1:0),"I"!=
p&&c[f]&&(l=c[f],l.scope instanceof r&&l.scope.$destroy(),l.renderer.destroy(),D(l.el,"leave",null,!0).done(function(a){x(a)&&a.parentNode.removeChild(a)})),"D"==p?c.splice(f,1):(l=d.cloneNode(!0),D(l,"enter",function(a){return function(d){0<a?g.insertBefore(d,c[a-1].el.nextSibling):b.prevEl?g.insertBefore(d,b.prevEl.nextSibling):g.insertBefore(d,g.firstChild)}}(f),!0),"R"==p?c[m]=b.createItem(l,h,f):"I"==p&&(m<c.length?c.splice(m,0,b.createItem(l,h,f)):c.push(b.createItem(l,h,f))),f++));b.doUpdate(h,
k)},parseExpr:function(a){a=a.split(" ");var b,c,d,f,g;b=0;for(c=a.length;b<c;b++)if(g=a[b],""!=g&&"in"!=g)if(f){d=a.slice(b).join(" ");break}else f=g;this.model=d;this.itemName=f||"item"}},{$stopRenderer:!0}));l("mjs-each-in-store",100,k(null,"attr.mjs-each",{store:null,initialize:function(a,b,c){this.parseExpr(c);b.removeAttribute("mjs-each-in-store");b.removeAttribute("mjs-include");this.tpl=b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;
this.node=b;this.scope=a;this.store=a=z(this.model)(a);this.parentEl.removeChild(b);this.initWatcher();this.render(this.watcher.getValue());L(this.bindStore,this,[a,"on"]);this.bindStore(a,"on")},onScopeDestroy:function(){this.bindStore(this.store,"un");delete this.store;this.supr()},initWatcher:function(){this.watcher=v(this.store,".items",null);this.watcher.addListener(this.onChange,this)},resetWatcher:function(){this.watcher.setValue(this.store.items)},bindStore:function(a,b){a[b]("load",this.onStoreUpdate,
this);a[b]("update",this.onStoreUpdate,this);a[b]("add",this.onStoreUpdate,this);a[b]("remove",this.onStoreUpdate,this);a[b]("replace",this.onStoreUpdate,this);a[b]("filter",this.onStoreFilter,this);a[b]("clearfilter",this.onStoreFilter,this);a[b]("clear",this.onStoreClear,this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},onStoreFilter:function(){this.resetWatcher();this.onStoreUpdate()},onStoreClear:function(){this.resetWatcher();this.onStoreUpdate()},
onStoreDestroy:function(){this.onStoreClear();this.watcher.unsubscribeAndDestroy(this.onChange,this);delete this.watcher}},{$stopRenderer:!0}));l("mjs-include",900,function(a,b,c,d){a=new y({scope:a,node:b,url:c,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});t("mjs-include",900,function(a,b,c,d){return(new y({scope:a,node:b,tpl:b.getAttribute("src"),parentRenderer:d,replace:!0})).initPromise});l("mjs-transclude",1E3,function(a,b){var g=N(b,"mjs-transclude");if(g){b.firstChild&&f(b,"mjs-transclude",
h(b.childNodes));var k=b.parentNode,l=b.nextSibling,g=d(g),m=c(g.childNodes);k.removeChild(b);k.insertBefore(g,l);return m}return null});t("mjs-transclude",900,function(a,b){var g=N(b,"mjs-transclude");if(g){b.firstChild&&f(b,"mjs-transclude",h(b.childNodes));var k=b.parentNode,l=b.nextSibling,g=d(g),m=c(g.childNodes);k.removeChild(b);k.insertBefore(g,l);return m}return null});var u=function(a,b,c,d){if(null!==c){if(c==B(a,b))return;c=!c}else c=B(a,b);c?d?D(a,[b+"-remove"],null,!0).done(function(){A(a,
b)}):A(a,b):d?D(a,[b+"-add"],null,!0).done(function(){J(a,b)}):J(a,b)};l("mjs-class",1E3,k(null,"MetaphorJs.view.AttributeHandler",{initial:!0,onChange:function(){var a=this.node,b=this.watcher.getLastResult(),c;w(a);if("string"==typeof b)u(a,b,null,!this.initial);else if(M(b)){var d;c=-1;for(d=b.length;++c<d;u(a,b[c],!0,!this.initial));}else for(c in b)u(a,c,b[c]?!0:!1,!this.initial);this.initial=!1}}));for(var g="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste enter".split(" "),
S=n.createFunc,n=0,t=g.length;n<t;n++)(function(c){var d=c;"enter"==d&&(d="keyup");l("mjs-"+c,1E3,function(f,g,h,k){var l=S(h);a(g,d,function(a){a=a||window.event;a=b(a);if("enter"==c&&13!=a.keyCode)return null;f.$event=a;l(f);delete f.$event;f instanceof r?f.$root.$check():f.$$watchers&&f.$$watchers.$checkAll();a.preventDefault();return!1})})})(g[n]);g="selected checked disabled readonly required open".split(" ");n=0;for(t=g.length;n<t;n++)(function(a){l("mjs-"+a,1E3,k(null,"MetaphorJs.view.AttributeHandler",
{onChange:function(){this.watcher.getLastResult()?this.node.setAttribute(a,!0):this.node.removeAttribute(a)}}))})(g[n]);n=function(a,b,c,d){C||(C=MetaphorJs.resolveComponent);var f,g,h,k,l;b.removeAttribute("mjs-cmp");c=c.split(" ");h=0;for(k=c.length;h<k;h++)l=c[h],""!=l&&"as"!=l&&(f?g=l:f=l);C(f,{scope:a,node:b,as:g,parentRenderer:d,destroyScope:!0},a,b);return!1};n.$breakScope=!0;l("mjs-cmp",200,n);l("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,b,c){a&&(a[c]=b)}]);l("mjs-view",
200,function(a,b,c){b.removeAttribute("mjs-view");c=p(c||"MetaphorJs.cmp.View");a.$app.inject(c,null,!0,{$scope:a,$node:b,$app:a.$app},[{scope:a,node:b}]);return!1});l("mjs-init",250,function(a,b,c){b.removeAttribute("mjs-init");S(c)(a)});l("mjs-app",0,function(){return!1})})();
(function(){var g=MetaphorJs.add,r=MetaphorJs.numberFormats,m=MetaphorJs.dateFormats;g("filter.toUpper",function(f){return f.toUpperCase()});g("filter.toLower",function(f){return f.toLowerCase()});g("filter.limitTo",function(f,c){var g=typeof f;if(!MetaphorJs.isArray(f)&&"string"!=g)return f;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);if("string"==g)return c?0<=c?f.slice(0,c):f.slice(c,f.length):"";var g=[],d,a;c>f.length?c=f.length:c<-f.length&&(c=-f.length);0<c?(d=0,a=c):(d=f.length+
c,a=f.length);for(;d<a;d++)g.push(f[d]);return g});g("filter.ucfirst",function(f){return f.substr(0,1).toUpperCase()+f.substr(1)});var k=MetaphorJs.numberFormats;g("filter.numeral",function(f,c){c=k[c]||c;c=r[c]||c;return numeral(f).format(c)});var p=MetaphorJs.dateFormats;g("filter.moment",function(f,c){c=p[c]||c;c=m[c]||c;return moment(f).format(c)});var n=function(f,c,g){if(""===c||"undefined"==typeof c)return!0;if("undefined"!=typeof f){if("boolean"==typeof f)return f===c;if(g instanceof RegExp)return c.test(""+
f);if("strict"==g)return""+f===""+c;if(!0===g||null===g||"undefined"==typeof g)return-1!=""+f.indexOf(c);if(!1===g)return-1==""+f.indexOf(c)}return!1},q=function(f,c,g){if("object"!=typeof f)return"undefined"==typeof c.$?!0:n(f,c.$,g);var d,a;for(d in c)if("$"==d)for(a in f){if(n(f[a],c.$,g))return!0}else if(n(f[d],c[d],g))return!0;return!1};g("filter.filter",function(f,c,g,d){g&&!d&&(g=null);"object"!=typeof c&&(c={$:c});d=[];var a,b;a=-1;for(b=f.length;++a<b;)q(f[a],c,g)&&d.push(f[a]);return d});
g("filter.sortBy",function(f,c,g,d){g&&!d&&(g="asc");f=f.slice();f.sort(function(a,b){var d=typeof a,f=a,g=b;if(d!=typeof b)return 0;"object"==d&&(f=a[c],g=b[c]);if("number"==typeof f)return f-g;f=(""+f).toLowerCase();g=(""+g).toLowerCase();return f===g?0:f>g?1:-1});return"desc"==g?f.reverse():f})})();
