'use strict';(function(){function E(g){return"function"==typeof g}function B(g){return"string"==typeof g||g===""+g}function K(g){return"object"==typeof g&&5===fa(g)}function Ea(g){if(null===g||"object"!=typeof g)return!1;g=fa(g);return 2<g||-1==g}function ua(g){return"object"==typeof g&&3===fa(g)&&!g.nodeType&&g.constructor===Object}function Fa(g){return!0===g||!1===g}function M(){}function z(g,b){return g.getAttribute?g.getAttribute(b):null}function rb(g){return g===window||g&&g.document&&g.location&&
g.alert&&g.setInterval}function xa(g){g=fa(g);return 3>g&&-1<g}function ya(){return!1}function pa(g,b,a,c){return setTimeout(function(){g.apply(b,a||[])},c||0)}function ja(g){var b=g.stack||Error().stack;if("undefined"!=typeof console&&console.log)pa(function(){console.log(g);b&&console.log(b)});else throw g;}function ga(g){if(g&&void 0!=!g.length&&g!==""+g){for(var b=[],a=-1,c=g.length>>>0;++a!==c;b[a]=g[a]);return b}return g?[g]:[]}function ka(g){if(!g)return!1;var b,a;return"object"!=(a=typeof g)&&
"function"!=a?!1:E(b=g.then)?b:!1}function eb(g){return null===g}function sb(g){var b={},a,c,d=g.attributes;g=0;for(a=d.length;g<a;g++)c=d[g],b[c.name]=c.value;return b}function na(g){var b=window.document.createDocumentFragment(),a,c;B(g)&&(a=window.document.createElement("div"),a.innerHTML=g,g=a.childNodes);if(!g)return b;if(g.nodeType)b.appendChild(g);else if(g.item)for(a=-1,c=g.length>>>0;++a!==c;b.appendChild(g[0]));else for(a=-1,c=g.length;++a!==c;b.appendChild(g[a]));return b}function R(g,
b){b&&(g.className=g.className.replace(Oa("(?:^|\\s)"+b+"(?!\\S)"),""))}function Pa(g,b){return b?Oa("(?:^|\\s)"+b+"(?!\\S)").test(g.className):!1}function L(g,b){b&&!Pa(g,b)&&(g.className+=" "+b)}function tb(g,b){var a,c;if(!g||!B(g))return null;try{c=new DOMParser,a=c.parseFromString(g,b||"text/xml")}catch(d){a=void 0}if(!a||a.getElementsByTagName("parsererror").length)throw"Invalid XML: "+g;return a}function Va(){return!0}function aa(g){return new Qa(g)}function Nb(g){return g.replace(Ob,function(b){return b.charAt(1).toUpperCase()})}
function ba(g,b,a){var c=H(g,"config"),d;if(c)return c;c={};if(a||null!==(a=z(g,"mjs-config")))for(d in g.removeAttribute("mjs-config"),b=a?la(a)(b||{}):{},b)c[d]=b[d];b=Pb(g);for(d in b)a=b[d],c[d]=""===a?!0:a;H(g,"config",c);return c}function Ra(g,b,a,c,d){var e=!1!==b;b=b||{};d=d||[];a=a||b.scope;c=c||b.node;b.scope=b.scope||a;b.node=b.node||c;var f=B(g)?za(g):g;if(!f)throw"Component "+g+" not found";a&&f.$isolateScope&&(b.scope=a=a.$newIsolated());var h,k=[];g=f.template||b.template||null;var p=
f.templateUrl||b.templateUrl||null,m=a?a.$app:null,u=ub.global(),r=m?m.inject:u.inject,s=m?m:u,t=c?z(c,"mjs-cloak"):null,n={$node:c||null,$scope:a||null,$config:b||null,$args:d||null};if(f.resolve)for(h in f.resolve)(function(e){var g=new N,q;k.push(g.done(function(a){n[e]=a;b[e]=a;d.push(a)}));q=f.resolve[h];E(q)?g.resolve(q(a,c)):B(q)?g.resolve(r.resolve(q)):g.resolve(r.call(s,q,null,y({},n,b,!1,!1)))})(h);e&&(g||p)&&(b.template=new Ga({scope:a,node:c,deferRendering:!0,ownRenderer:!0,shadow:f.$shadow,
tpl:g,url:p}),k.push(b.template.initPromise),c&&c.firstChild&&H(c,"mjs-transclude",na(c.childNodes)));e&&d.unshift(b);var q;k.length?(q=new N,N.all(k).done(function(){q.resolve(r.call(s,f,null,y({},n,b,!1,!1),d))})):q=N.resolve(r.call(s,f,null,y({},n,b,!1,!1),d));c&&q.isPending()&&null!==t&&(t?L(c,t):c.style.visibility="hidden",q.then(function(){t?R(c,t):c.style.visibility=""}));c&&q.then(function(){R(c,"mjs-cloak")});return q}function fb(g){var b=g.nodeName.toLowerCase();g=g.type;return"input"!=
b&&"textarea"!=b&&"select"!=b||"submit"==g||"reset"==g||"button"==g?!1:!0}function vb(g,b){var a;a:{for(var c=g,d;c;){d=H(c,"mjs-transclude");if(void 0!==d){a=d;break a}c=c.parentNode}a=void 0}if(a){g.firstChild&&H(g,"mjs-transclude",na(g.childNodes));c=g.parentNode;d=g.nextSibling;a=gb(a);var e=ga(a.childNodes);b?(c.removeChild(g),c.insertBefore(a,d)):g.appendChild(a);return e}return null}function wb(g,b,a){a||(a="asc");g=g.slice();g.sort(function(a,d){var e=typeof a,f=a,h=d;if(e!=typeof d)return 0;
"object"==e&&(E(b)?(f=b(a),h=b(d)):(f=a[b],h=d[b]));if("number"==typeof f)return f-h;f=(""+f).toLowerCase();h=(""+h).toLowerCase();return f===h?0:f>h?1:-1});return"desc"==a?g.reverse():g}function Qb(g,b){var a=!1,c=!0,d=b||window,e,f,h=function(b){if("readystatechange"!=b.type||"complete"==f.readyState)Z("load"==b.type?d:f,b.type,h),!a&&(a=!0)&&g.call(d,b.type||b)},k=function(){try{e.doScroll("left")}catch(a){setTimeout(k,50);return}h("poll")};f=d.document;e=f.documentElement;if("complete"==f.readyState)g.call(d,
"lazy");else{if(f.createEventObject&&e.doScroll){try{c=!d.frameElement}catch(p){}c&&k()}I(f,"DOMContentLoaded",h);I(f,"readystatechange",h);I(d,"load",h)}}function Rb(g,b,a,c){try{var d=Ra(b||"MetaphorJs.App",!1,a,g,[g,a]);return!1!==c?d.done(function(a){a.run()}):d}catch(e){return ja(e),N.reject(e)}}function Sa(g){var b={top:0,left:0},a=window.document.documentElement;if(!Ta(g)||g===window)return b;g.getBoundingClientRect&&(b=g.getBoundingClientRect());return{top:b.top+Aa()-a.clientTop,left:b.left+
Ba()-a.clientLeft}}function xb(g,b){var a,c,d={top:0,left:0},e=window.document.documentElement;if(g===window||g===e)return d;if("fixed"==va(g,"position"))c=g.getBoundingClientRect();else{if(b)return d=Sa(g),e=Sa(b),d={left:d.left-e.left,top:d.top-e.top},0>d.left&&(d.left=0),0>d.top&&(d.top=0),d;a=window.document.documentElement;for(c=g.offsetParent||a;c&&c!=a&&"static"==va(c,"position");)c=c.offsetParent;a=c||a;c=Sa(g);a!==e&&(d=Sa(a));d.top+=va(a,"borderTopWidth",!0);d.left+=va(a,"borderLeftWidth",
!0)}return{top:c.top-d.top-va(g,"marginTop",!0),left:c.left-d.left-va(g,"marginLeft",!0)}}function Ca(g){return g.substr(0,1).toUpperCase()+g.substr(1)}function Sb(g,b,a,c){var d=b+"-"+a,e=function(a){a=aa(a);return hb(a.target,b)?c(a):null};Wa[d]||(Wa[d]=[]);Wa[d].push({el:g,ls:e,fn:c});I(g,a,e)}function Tb(g,b,a,c){var d,e;if(e=Wa[b+"-"+a])for(b=-1,d=e.length;++b<d;)e[b].el===g&&e[b].fn===c&&Z(g,a,e[b].ls)}function Xa(g,b,a){var c,d=g.childNodes;if(!1!==b.call(a,g))for(g=-1,c=d.length>>>0;++g!==
c;Xa(d[g],b,a));}var Ha={},Ub=Object.prototype.toString,fa=function(){var g={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var a=g[Ub.call(b)];return void 0===a?-1:1==a&&isNaN(b)?8:a}}(),yb=function(){var g,b=function(a){var b={},d=[];0==arguments.length&&(a=!0);return{addFinder:function(a,b,c){d[c?"unshift":"push"]({fn:a,
context:b})},add:function(d,f,h){if(b[d]&&!1===b[d].rewritable)return b[d];b[d]={rewritable:"undefined"!=typeof h?h:a,value:f};return f},get:function(a){if(b[a])return b[a].value;if(d.length){var f,h,k;f=0;for(h=d.length;f<h;f++)if(k=d[f].fn.call(d[f].context,a,this),void 0!==k)return this.add(a,k,!0)}},remove:function(a){var d=b[a];d&&!0===d.rewritable&&delete b[a];return d?d.value:void 0},exists:function(a){return!!b[a]},eachEntry:function(a,d){for(var h in b)a.call(d,b[h].value,h)},destroy:function(){this===
g&&(g=null);this.remove=this.exists=this.destroy=this.get=this.add=a=b=null}}};b.global=function(){g||(g=new b(!0));return g};return b}(),ib=function(){var g=function(a,c,d){d=d||new yb(!1);var e=c?c.length:null;a||(a="undefined"!=typeof global?global:window);var f=function(a){return a&&c&&a.substr(0,e)!=c?c+"."+a:a},h=function(b,e){b=f(b);if(d.exists(b))return d.get(b);if(!e){var h=b.split("."),g,r=h.length,s,t=a;for(g=0;g<r;g++)if(s=h[g],c&&0==g&&s==c)t=a;else{if(void 0===t[s])return;t=t[s]}t&&
d.add(b,t);return t}};this.register=function(b,e){var h;h=f(b);var g=h.split("."),r,s=g.pop();r=g.join(".");var t=g.length,n,q=a;if(d[r])h=[d[r],s,h];else{if(0<t)for(r=0;r<t;r++)n=g[r],c&&0==r&&n==c?q=a:(void 0===q[n]&&(q[n]={}),q=q[n]);h=[q,s,h]}g=h[0];s=h[1];Ea(g)&&void 0===g[s]&&(g[s]=e,d.add(h[2],e));return e};this.exists=function(a){return void 0!==h(a,!0)};this.get=h;this.add=function(a,b){a=f(a);d.add(a,b);return b};this.remove=function(a){a=f(a);d.remove(a)};this.normalize=f;this.makeAlias=
function(a,b){a=f(a);b=f(b);var c=d.get(a);void 0!==c&&d.add(b,c)};this.destroy=function(){var a;this===b&&(b=null);d.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});d.destroy();d=null;for(a in this)this[a]=null}};g.prototype.register=null;g.prototype.exists=null;g.prototype.get=null;g.prototype.add=null;g.prototype.remove=null;g.prototype.normalize=null;g.prototype.makeAlias=null;g.prototype.destroy=null;var b;g.global=function(){b||(b=new g);return b};return g}(),oa=Array.prototype.slice,y=
function(){return function b(){var a=!1,c=!1,d=oa.call(arguments),e=d.shift(),f,h,k;Fa(d[d.length-1])&&(a=d.pop());Fa(d[d.length-1])&&(c=a,a=d.pop());for(;d.length;)if(f=d.shift())for(h in f)if(f.hasOwnProperty(h)&&void 0!==(k=f[h]))if(c)if(e[h]&&ua(e[h])&&ua(k))b(e[h],k,a,c);else{if(!0===a||void 0==e[h])ua(k)?(e[h]={},b(e[h],k,a,!0)):e[h]=k}else if(!0===a||void 0==e[h])e[h]=k;return e}}(),zb=function(g,b){var a=function(){},c;a.prototype=g.prototype;a=new a;c=g.apply(a,b);return Ea(c)||!1===c?c:
a},Vb=function(g,b,a,c,d,e){d=d||"before";return function(){var f,h;if("instead"==d)return b.apply(a||c,arguments);"before"==d?(f=b.apply(a||c,arguments),h=!1!==f?g.apply(c||a,arguments):null):(h=g.apply(c||a,arguments),f=b.apply(a||c,arguments));return e?f:h}},Wb=function(){var g=function(){this.$super&&this.$super!==M&&this.$super.apply(this,arguments)},b=function(a,b,c){var $super=a.prototype[b]||("$constructor"==b?a:M)||M;return function(){var a,b=this.$super;this.$super=$super;a=c.apply(this,
arguments);this.$super=b;return a}},a=function(a,c,d,e){var g,u,r,s=d.prototype;for(g in c)c.hasOwnProperty(g)&&(r=s[g],u=c[g],a[g]=!E(u)||r&&!E(r)?u:b(d,g,u));e||(a.$plugins=null,s.$beforeInit?(a.$beforeInit=s.$beforeInit.slice(),a.$afterInit=s.$afterInit.slice(),a.$beforeDestroy=s.$beforeDestroy.slice(),a.$afterDestroy=s.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},c=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("$beforeInit"==c?a.$beforeInit.push(b[c]):
"$afterInit"==c?a.$afterInit.push(b[c]):"$beforeDestroy"==c?a.$beforeDestroy.push(b[c]):"$afterDestroy"==c?a.$afterDestroy.push(b[c]):a[c]||(a[c]=b[c]))},d=function(b){b||(b=new ib);var h=function(){return function(){var a=[],c=[],d=arguments,e,h,k,g,p;if(!this)throw"Must instantiate via new";this.$plugins=[];(e=this.$constructor.apply(this,arguments))&&K(e)&&(d=e);k=this.$plugins;e=-1;for(h=this.$beforeInit.length;++e<h;a.push([this.$beforeInit[e],this]));e=-1;for(h=this.$afterInit.length;++e<h;c.push([this.$afterInit[e],
this]));if(k&&k.length)for(e=0,h=k.length;e<h;e++){g=k[e];if(B(g)&&(p=g,g=b.get(g,!0),!g))throw p+" not found";g=new g(this,d);g.$beforeHostInit&&a.push([g.$beforeHostInit,g]);g.$afterHostInit&&c.push([g.$afterHostInit,g]);k[e]=g}e=-1;for(h=a.length;++e<h;a[e][0].apply(a[e][1],d));this.$init&&this.$init.apply(this,d);e=-1;for(h=c.length;++e<h;c[e][0].apply(c[e][1],d));}},k=function(){};y(k.prototype,{$class:null,$extends:null,$plugins:null,$mixins:null,$destroyed:!1,$constructor:M,$init:M,$beforeInit:[],
$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},$intercept:function(a,b,c,d,e){var h=this[a];this[a]=Vb(h,b,c||this,this,d,e);return h},$implement:function(b){var c=this.constructor;c&&c.$parent&&a(this,b,c.$parent)},$destroy:function(){var a=this.$beforeDestroy,b=this.$afterDestroy,c=this.$plugins,d,e,h;if(!this.$destroyed){this.$destroyed=!0;d=-1;for(e=a.length;++d<e;a[d].apply(this,arguments));d=0;for(e=
c.length;d<e;d++)c[d].$beforeHostDestroy&&c[d].$beforeHostDestroy.call(c[d],arguments);h=this.destroy.apply(this,arguments);d=-1;for(e=a.length;++d<e;b[d].apply(this,arguments));d=0;for(e=c.length;d<e;d++)c[d].$destroy.apply(c[d],arguments);if(!1!==h)for(d in this)this.hasOwnProperty(d)&&(this[d]=null);this.$destroyed=!0}},destroy:function(){}});k.$self=k;k.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);
case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return zb(this,a)}};k.$override=function(b){var c=this.$self,d=this.$parent;c&&d&&a(c.prototype,b,d)};k.$extend=function(a,b){return p(a,b,this)};k.$destroy=function(){for(var a in this)this[a]=null};var p=function(d,e,p){d=d||{};var t=d.$class,n=p||d.$extends,q=d.$mixins,v,l,m;n?B(n)?p=b.get(n):(p=n,n=p.$class||""):(p=k,n="");if(n&&!p)throw n+" not found";t&&(t=b.normalize(t));d.$class=t;d.$extends=n;d.$mixins=
null;v=function(){};v.prototype=p.prototype;n=new v;v=null;d.$constructor=d.$constructor||g;a(n,d,p);if(q)for(d=0,v=q.length;d<v;d++)m=q[d],B(m)&&(m=b.get("mixin."+m,!0)),c(n,m);q=h();n.constructor=q;q.prototype=n;for(l in k)"prototype"!=l&&k.hasOwnProperty(l)&&(q[l]=k[l]);for(l in p)"prototype"!=l&&p.hasOwnProperty(l)&&(q[l]=p[l]);if(e)for(l in e)"prototype"!=l&&e.hasOwnProperty(l)&&(q[l]=e[l]);q.$parent=p;q.$self=q;t&&b.register(t,q);return q},m=this;m.factory=function(a){var c=b.get(a),d=oa.call(arguments,
1);if(!c)throw a+" not found";return c.$instantiate.apply(c,d)};m.isSubclassOf=function(a,c){var d=a,e=b.get;c=B(c)?b.normalize(c):c.prototype.$class;for(B(a)&&(d=e(b.normalize(a)));d&&d.prototype;){if(d.prototype.$class==c)return!0;d=d.$parent}return!1};m.isInstanceOf=function(a,c){var d=B(c)?b.get(c):c;return d?a instanceof d:!1};m.define=p;m.destroy=function(){m===e&&(e=null);k.$destroy();k=null;b.destroy();d=b=null};m.BaseClass=k};d.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,
define:null,destroy:null};var e;d.global=function(){e||(e=new d(ib.global()));return e};return d}(),V=new ib(Ha,"MetaphorJs"),Ia=new Wb(V),P=Ia.define,ca=function(){var g=["0","0","0"];return function(){for(var b=g.length,a;b;){b--;a=g[b].charCodeAt(0);if(57==a)return g[b]="A",g.join("");if(90==a)g[b]="0";else return g[b]=String.fromCharCode(a+1),g.join("")}g.unshift("0");return g.join("")}}(),A=Function.prototype.bind?function(g,b){return g.bind(b)}:function(g,b){return function(){return g.apply(b,
arguments)}},ha=function(){this.events={}};y(ha.prototype,{createEvent:function(g,b,a,c,d){g=g.toLowerCase();var e=this.events;e[g]||(e[g]=new jb(g,b,a,c,d));return e[g]},getEvent:function(g){g=g.toLowerCase();return this.events[g]},on:function(g,b,a,c){g=g.toLowerCase();var d=this.events;d[g]||(d[g]=new jb(g));return d[g].on(b,a,c)},once:function(g,b,a,c){c=c||{};c.limit=1;return this.on(g,b,a,c)},un:function(g,b,a){g=g.toLowerCase();var c=this.events;c[g]&&c[g].un(b,a)},hasListener:function(g,b,
a){var c=this.events;if(g)return g=g.toLowerCase(),c[g]?c[g].hasListener(b,a):!1;for(g in c)if(c[g].hasListener())return!0;return!1},removeAllListeners:function(g){var b=this.events;b[g]&&b[g].removeAllListeners()},trigger:function(){var g=arguments[0],b=this.events,g=g.toLowerCase();if(!b[g])return null;g=b[g];return g.trigger.apply(g,oa.call(arguments,1))},suspendEvent:function(g){g=g.toLowerCase();var b=this.events;b[g]&&b[g].suspend()},suspendAllEvents:function(){var g=this.events,b;for(b in g)g[b].suspend()},
resumeEvent:function(g){g=g.toLowerCase();var b=this.events;b[g]&&b[g].resume()},resumeAllEvents:function(){var g=this.events,b;for(b in g)g[b].resume()},destroyEvent:function(g){var b=this.events;b[g]&&(b[g].removeAllListeners(),b[g].destroy(),delete b[g])},destroy:function(){var g=this.events,b;for(b in g)this.destroyEvent(b);for(b in this)this[b]=null},getApi:function(){if(!this.api){for(var g="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),
b={},a,c=-1,d=g.length;++c<d;a=g[c],b[a]=A(this[a],this));this.api=b}return this.api}},!0,!1);var jb=function(g,b,a,c,d){this.name=g;this.listeners=[];this.map={};this.hash=ca();this.uni="$$"+g+"_"+this.hash;this.suspended=!1;this.lid=0;"object"==typeof b&&null!==b?y(this,b,!0,!1):(this.returnResult=void 0===b?null:b,this.autoTrigger=a,this.triggerFilter=c,this.filterContext=d)};y(jb.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,returnResult:null,autoTrigger:null,
lastTrigger:null,triggerFilter:null,filterContext:null,getName:function(){return this.name},destroy:function(){for(var g in this)this[g]=null},on:function(g,b,a){if(!g)return null;b=b||null;a=a||{};var c=this.uni,d=b||g;if(d[c]&&!a.allowDupes)return null;var e=++this.lid,f=a.first||!1;d[c]=e;g={fn:g,context:b,uniContext:d,id:e,called:0,limit:0,start:1,count:0,append:null,prepend:null};y(g,a,!0,!1);f?this.listeners.unshift(g):this.listeners.push(g);this.map[e]=g;if(this.autoTrigger&&this.lastTrigger&&
!this.suspended){var h=this.triggerFilter;this.triggerFilter=function(a){return a.id==e?h?!1!==h(a):!0:!1};this.trigger.apply(this,this.lastTrigger);this.triggerFilter=h}return e},once:function(g,b,a){a=a||{};a.once=!0;return this.on(g,b,a)},un:function(g,b){var a=-1,c=this.uni,d=this.listeners,e;e=g==parseInt(g)?g:(b||g)[c];if(!e)return!1;for(var f=0,h=d.length;f<h;f++)if(d[f].id==e){a=f;delete d[f].uniContext[c];break}if(-1==a)return!1;d.splice(a,1);delete this.map[e];return!0},hasListener:function(g,
b){var a=this.listeners,c;if(g){b=b||g;c=E(g)?b[this.uni]:g;if(!c)return!1;for(var d=0,e=a.length;d<e;d++)if(a[d].id==c)return!0;return!1}return 0<a.length},removeAllListeners:function(){var g=this.listeners,b=this.uni,a,c;a=0;for(c=g.length;a<c;a++)delete g[a].uniContext[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(g,b){var a;g.append||g.prepend?(a=oa.call(b),g.prepend&&(a=g.prepend.concat(a)),g.append&&(a=a.concat(g.append))):
a=b;return a},trigger:function(){var g=this.listeners,b=this.returnResult,a=this.triggerFilter,c=this.filterContext,d;if(this.suspended)return null;this.autoTrigger&&(this.lastTrigger=oa.call(arguments));if(0==g.length)return null;for(var e="all"==b||"merge"==b?[]:null,f,g="first"==b?[g[0]]:oa.call(g);f=g.shift();)if(f&&this.map[f.id]&&(d=this._prepareArgs(f,arguments),!a||!1!==a.call(c,f,d,this))&&(f.count++,!(f.count<f.start)))if(d=f.fn.apply(f.context,d),f.called++,f.called==f.limit&&this.un(f.id),
"all"==b)e.push(d);else if("merge"==b&&d)e=e.concat(d);else{if("first"==b)return d;if("last"==b)e=d;else if(!1==b&&!1===d)return!1}if(b)return e}},!0,!1);var X=function(){return String.prototype.trim?function(g){return B(g)?g.trim():g}:function(g){return B(g)?g.replace(/^\s\s*/,"").replace(/\s\s*$/,""):g}}(),kb=function(g,b,a){var c=g.length,d=b.length,e=0,f=0,h=!1,k=!1,p=[],m;if(!d)return[g];for(;e<c;e++)if(m=g.charAt(e),"\\"==m)e++;else if('"'==m)h=!h;else if("'"==m)k=!k;else if(!h&&!k&&(1==d&&
m==b||1<d&&g.substring(e,e+d)==b)){if(g.substr(e-1,d)!=b&&g.substr(e+1,d)!=b||a)p.push(g.substring(f,e).replace("\\"+b,b)),f=e+d;e+=d-1}p.push(g.substring(f).replace("\\"+b,b));return p},Ab=function(){return function b(a,c){if(a===c)return!0;if(null===a||null===c)return!1;if(a!==a&&c!==c)return!0;var d=typeof a,e;if(d==typeof c&&"object"==d)if(K(a)){if(!K(c))return!1;if((d=a.length)==c.length){for(e=0;e<d;e++)if(!b(a[e],c[e]))return!1;return!0}}else{if(10===fa(a))return 10===fa(c)&&a.getTime()==c.getTime();
if(9===fa(a)&&9===fa(c))return a.toString()==c.toString();if(rb(a)||rb(c)||K(c))return!1;d={};for(e in a)if("$"!=e.charAt(0)&&!E(a[e])){if(!b(a[e],c[e]))return!1;d[e]=!0}for(e in c)if(!d.hasOwnProperty(e)&&"$"!=e.charAt(0)&&void 0!==c[e]&&!E(c[e]))return!1;return!0}return!1}}(),Bb=function(){var g="undefined"!=typeof window?window:null,b="undefined"!=typeof global?global:null;return function c(d,e){if(g&&d===g)throw Error("Cannot copy window object");if(b&&d===b)throw Error("Cannot copy global object");
if(e){if(d===e)throw Error("Objects are identical");if(K(d))for(var f=e.length=0,h=d.length;f<h;f++)e.push(c(d[f]));else{for(f in e)delete e[f];for(f in d)d.hasOwnProperty(f)&&("$"==f.charAt(0)||E(d[f])?e[f]=d[f]:e[f]=c(d[f]))}}else(e=d)&&(K(d)?e=c(d,[]):10===fa(d)?e=new Date(d.getTime()):9===fa(d)?e=new RegExp(d.source):ua(d)&&(e=c(d,{})));return e}}(),Xb=function(){var g=Object.prototype.toString,b=Function.prototype.toString,a=/^\[object .+?Constructor\]$/,c=RegExp("^"+String(g).replace(/[.*+?^${}()|[\]\/\\]/g,
"\\$&").replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return function(d){var e=typeof d;return"function"==e?!("prototype"in d)||c.test(b.call(d)):d&&"object"==e&&a.test(g.call(d))||!1}}(),lb=function(){var g=/(^|[^a-z0-9_$\]\)'"])(\.)([^0-9])/ig,b=Function,a=function(a,b){return function(c){var d=oa.call(arguments),e;d.push(null);d.push(a);if(b){for(e=a.apply(null,d);(void 0===e||"number"==typeof e&&isNaN(e))&&!c.$isRoot;)c=c.$parent,d[0]=c,e=a.apply(null,d);return e}return a.apply(null,
d)}},c={},d=0,e={},f=0,h={},k=0,p=function(){1E3<=d&&(c={});1E3<=f&&(e={});1E3<=k&&(h={})};return{createGetter:function(e){try{return c[e]?c[e]:(d++,c[e]=a(new b("____","$$interceptor","$$itself","".concat("try {","return ",e.replace(g,"$1____.$3"),";} catch (thrownError) { return undefined; }")),!0))}catch(h){return ja(h),M}},createSetter:function(c){try{if(!e[c]){f++;var d=c.replace(g,"$1____.$3");return e[c]=a(new b("____","$$$$","$$interceptor","$$itself","".concat("try {",d," = $$$$",";} catch (thrownError) { return undefined; }")))}return e[c]}catch(h){return ja(h),
M}},createFunc:function(c){try{return h[c]?h[c]:(k++,h[c]=a(new b("____","$$interceptor","$$itself","".concat("try {",c.replace(g,"$1____.$3"),";} catch (thrownError) { return undefined; }"))))}catch(d){return ja(d),M}},resetCache:p,enableResetCacheInterval:function(){setTimeout(p,1E4)}}}(),la=lb.createGetter,Yb=lb.createSetter,mb=function(){var g=Object.observe&&Xb(Object.observe),b=function(a){if(!B(a))return!0;var b=a.substr(0,1),c=a.length-1;return'"'!=b&&"'"!=b||a.indexOf(b,1)!=c?!1:a.substring(1,
c)},a,c=function(c,d,f,g,u,r){a||(a=new ha);var s=ca(),t;r&&(this.namespace=r,this.nsGet=r.get);this.origCode=d;B(d)||(g=f,f=d,d=null,t="object");B(c)&&(g=f,f=d,d=c,c=null);d&&c&&(t=c.hasOwnProperty(d)?"attr":"expr");d&&!c&&(t="expr");if(f)a.on(s,f,g||this,{append:[u],allowDupes:!0});if("expr"==t){d=this._parsePipes(d,c,!0);d=this._parsePipes(d,c,!1);if(this.inputPipes||this.pipes)d=e(c,d),t=c.hasOwnProperty(d)?"attr":"expr";if(this.staticValue=b(d))t="static"}this.userData=u;this.code=d;this.id=
s;this.type=t;this.obj=c;"expr"==t&&(this.getterFn=la(d));"static"!=t||this.pipes?(this.curr=this.curr||this._getValue(),this.currCopy=xa(this.curr)?this.curr:Bb(this.curr)):(this.check=ya,this.curr=this.prev=this.staticValue)};y(c.prototype,{namespace:null,nsGet:null,staticValue:null,origCode:null,code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,currCopy:null,prev:null,unfiltered:null,pipes:null,inputPipes:null,lastSetValue:null,userData:null,obsrvDelegate:null,
obsrvChanged:!1,_indexArrayItems:function(a){var b="$$"+this.id,c,d,e;if(a)for(c=0,d=a.length;c<d;c++)e=a[c],!e||xa(e)||e[b]||(e[b]=ca())},_parsePipes:function(a,b,c){var d=c?">>":"|",e=c?"inputPipes":"pipes",f=c?this.onInputParamChange:this.onPipeParamChange;if(-1==a.indexOf(d))return a;a=kb(a,d);c=c?a.pop():a.shift();var d=[],g,t,n;t=0;for(n=a.length;t<n;t++)g=kb(X(a[t]),":"),this._addPipe(d,g,b,f);d.length&&(this[e]=d);return X(c)},_addPipe:function(a,b,c,e){var f=b.shift(),g=null,s=[],t=!1,n;
"!"==f.substr(0,1)&&(f=f.substr(1),t=!0);this.nsGet&&(g=this.nsGet("filter."+f,!0));g||(g=("undefined"!=typeof window?window[f]:null)||c[f]);if(E(g)){f=-1;for(n=b.length;++f<n;s.push(d(c,b[f],e,this,null,this.namespace)));a.push([g,b,s,t])}},_getValue:function(){var a;switch(this.type){case "static":a=this.staticValue;break;case "attr":a=this.obj[this.code];break;case "expr":a=this.getterFn(this.obj);break;case "object":a=this.obj}K(a)&&(this.inputPipes||this._indexArrayItems(a),a=a.slice());this.unfiltered=
a;return a=this._runThroughPipes(a,this.pipes)},_runThroughPipes:function(a,b){if(b){var c,d,e,g=b.length,s=this.obj,t,n,q;for(c=0;c<g;c++){e=b[c][1];t=b[c][3];d=[];n=-1;for(q=e.length;++n<q;d.push(f(e[n],s)));d.unshift(s);d.unshift(a);a=b[c][0].apply(null,d);t&&(a=!a)}}return a},subscribe:function(b,c,d){a.on(this.id,b,c,d)},unsubscribe:function(b,c){return a.un(this.id,b,c)},hasPipes:function(){return null!==this.pipes},hasInputPipes:function(){return null!=this.inputPipes},getValue:function(){return this._getValue()},
getUnfilteredValue:function(){return this.unfiltered||this.curr},getPrevValue:function(){return this.prev},getPrescription:function(a,b){var c;b=b||this._getValue();var d=a||[],e=b||[],f=d.length,g=e.length,t=Array(f+1);c=Array(f+1);var n,q,v,l=0;if(f==g&&0==f)c=[];else{for(n=0;n<=f;n++)t[n]=Array(g+1),c[n]=Array(g+1),t[n][0]=n,c[n][0]="D";for(n=0;n<=g;n++)t[0][n]=n,c[0][n]="I";for(n=1;n<=f;n++)for(q=1;q<=g;q++)v=Ab(d[n-1],e[q-1])?0:1,t[n][q-1]<t[n-1][q]&&t[n][q-1]<t[n-1][q-1]+v?(t[n][q]=t[n][q-1]+
1,c[n][q]="I"):t[n-1][q]<t[n-1][q-1]+v?(t[n][q]=t[n-1][q]+1,c[n][q]="D"):(t[n][q]=t[n-1][q-1]+v,c[n][q]=1==v?"R":"-");d=[];n=f;q=g;do f=c[n][q],d.push(f),"-"!=f&&l++,"R"==f||"-"==f?(n--,q--):"D"==f?n--:q--;while(0!=n||0!=q);c=d.reverse()}return c},getMovePrescription:function(a,b,c){c=c||this._getValue();var d=a||[],e=c||[];a=this.getPrescription(a||[],c||[]);c=[];var f,g,t,n={},q,v;f=0;for(g=d.length;f<g;f++)(t=b(d[f]))&&(n[t]=f);q=0;var l={};f=0;for(g=a.length;f<g;f++)d=a[f],"D"!=d&&(t=b(e[q]),
void 0!=t&&!0!==l[t]&&void 0!==(v=n[t])?(c.push(v),l[t]=!0):c.push(d),q++);return c},setValue:function(a){var c=this.type;this.lastSetValue=a;a=this._runThroughPipes(a,this.inputPipes);"attr"==c?this.obj[this.code]=a:"expr"==c?(this.setterFn||(this.setterFn=Yb(this.code)),this.setterFn(this.obj,a)):"object"==c&&(this.obj=a)},onInputParamChange:function(a,c,b){this.setValue(this.lastSetValue);b&&this.checkAll()},onPipeParamChange:function(a,c,b){this.check()},onObserverChange:function(a){var c=this.code,
b,d,e;b=0;for(d=a.length;b<d;b++)if(e=a[b],e.name==c){this.obsrvChanged=!0;break}},_check:function(c){var b=this._getValue(),d=this.currCopy;return(this.obsrvDelegate?this.obsrvChanged:!Ab(d,b))?(this.curr=b,this.prev=d,this.currCopy=xa(b)?b:Bb(b),this.obsrvChanged=!1,a.trigger(this.id,b,d,c),!0):!1},check:function(a){return this._check(a)},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();
b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(b,c){var d=this.id;b&&a.un(d,b,c);return a.hasListener(d)?!1:(this.destroy(),!0)},destroy:function(){var b=this.pipes,c=this.inputPipes,d,e,f,g,s;this.itv&&this.clearInterval();if(b)for(d=-1,e=b.length;++d<e;)for(s=b[d][2],f=-1,g=s.length;++f<g;)s[f].unsubscribeAndDestroy(this.check,this);if(c)for(d=-1,e=c.length;++d<e;)for(s=c[d][2],f=-1,g=s.length;++f<
g;)s[f].unsubscribeAndDestroy(this.onInputParamChange,this);this.obsrvDelegate&&Object.unobserve(this.obj,this.obsrvDelegate);this.obj&&(this.obj.$$watchers.$codes[this.origCode]=null);a.destroyEvent(this.id);for(d in this)this.hasOwnProperty(d)&&(this[d]=null)}},!0,!1);var d=function(a,b,d,f,g,r){b=e(a,X(b));return a?(a.$$watchers||(a.$$watchers={$codes:{},$checkAll:function(){var a=this.$codes,b,c=0;for(b in a)a[b]&&a[b].check()&&c++;return c},$destroyAll:function(){var a=this.$codes,b;for(b in a)a[b]&&
(a[b].destroy(),a[b]=null)}}),a.$$watchers.$codes[b]?a.$$watchers.$codes[b].subscribe(d,f,{append:[g],allowDupes:!0}):a.$$watchers.$codes[b]=new c(a,b,d,f,g,r),a.$$watchers.$codes[b]):new c(a,b,d,f,g,r)},e=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},f=function(a,c){var d;return(d=b(a))?d:la(a)(c)};c.create=d;c.unsubscribeAndDestroy=function(a,b,c,d){b=X(b);(a=a.$$watchers?a.$$watchers.$codes:null)&&a[b]&&
a[b].unsubscribeAndDestroy(c,d)&&(a[b]=null)};c.normalizeExpr=e;c.eval=f;c.usesNativeObserver=function(){return g};return c}(),ra=function(g){this.$$observable=new ha;this.$$historyWatchers={};y(this,g,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)};y(ra.prototype,{$app:null,$parent:null,$root:null,$isRoot:!1,$level:0,$$observable:null,$$watchers:null,$$historyWatchers:null,$$checking:!1,
$$destroyed:!1,$new:function(){return new ra({$parent:this,$root:this.$root,$app:this.$app,$level:this.$level+1})},$newIsolated:function(){return new ra({$app:this.$app,$level:self.$level+1})},$on:function(g,b,a){return this.$$observable.on(g,b,a)},$un:function(g,b,a){return this.$$observable.un(g,b,a)},$watch:function(g,b,a){return mb.create(this,g,b,a,null)},$unwatch:function(g,b,a){return mb.unsubscribeAndDestroy(this,g,b,a)},$watchHistory:function(g,b){this.$$historyWatchers[b]||(this.$$historyWatchers[b]=
g,Ha.history.on("change-"+b,this.$$onHistoryChange,this))},$unwatchHistory:function(g){this.$$historyWatchers[g]||(delete this.$$historyWatchers[g],Ha.history.un("change-"+g,this.$$onHistoryChange,this))},$get:function(g){for(var b=this;b;){if(void 0!==b[g])return b[g];b=b.$parent}},$set:function(g,b){if("string"==typeof g)this[g]=b;else for(var a in g)this[a]=g[a];this.$check()},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$$onHistoryChange:function(g,b,
a){this.$$historyWatchers[a]&&(b=this.$$historyWatchers[a],this[b]=g,this.$check())},$check:function(){var g;this.$$checking||(this.$$checking=!0,this.$$watchers&&(g=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",g),0<g&&this.$check())},$destroy:function(){var g,b;this.$$observable.trigger("destroy");this.$$observable.destroy();this.$$watchers&&this.$$watchers.$destroyAll();for(g in this.$$historyWatchers)this.$unwatchHistory(g);for(b in this)this.hasOwnProperty(b)&&
(this[b]=null);this.$$destroyed=!0}},!0,!1);var qa=mb.create,J=V.add,za=V.get,D=function(){var g=[],b=!1,a=function(a,b){return a.priority<b.priority?-1:a.priority>b.priority?1:0};return P({$class:"Directive",watcher:null,scope:null,node:null,expr:null,autoOnChange:!0,$init:function(a,b,e){var f;e=X(e);this.node=b;this.expr=e;this.scope=a;this.watcher=qa(a,e,this.onChange,this,null,V);if(this.autoOnChange&&void 0!==(f=this.watcher.getLastResult()))this.onChange(f,void 0);a.$on("destroy",this.onScopeDestroy,
this)},onScopeDestroy:function(){this.$destroy()},onChange:function(){},destroy:function(){this.watcher&&this.watcher.unsubscribeAndDestroy(this.onChange,this);this.$super()}},{registerAttribute:function(a,d,e){za("attr."+a,!0)||(g.push({priority:d,name:a,handler:J("attr."+a,e)}),b=!1)},getAttributes:function(){b||(g.sort(a),b=!0);return g},registerTag:function(a,b){za("tag."+a,!0)||J("tag."+a,b)}})}(),Cb=function(){var g=/\\{/g,b=new ha,a=function(a,b,f,h,g){return!b||!b.indexOf||-1==b.indexOf("{{")&&
-1==b.indexOf("{[")?null:new c(a,b,f,h,g)},c=P({$class:"TextRenderer",id:null,parent:null,isRoot:null,scope:null,origin:"",processed:null,text:null,watchers:null,children:null,data:null,recursive:!1,dataChangeDelegate:null,changeTmt:null,lang:null,$init:function(a,b,c,h,g){this.id=ca();this.origin=b;this.scope=a;this.parent=c;this.isRoot=!c;this.data=h;this.lang=a.$app?a.$app.lang:null;if(!0===g||!1===g)this.recursive=g;this.watchers=[];this.children=[];this.dataChangeDelegate=A(this.doDataChange,
this);this.processed=this.processText(b);this.render()},subscribe:function(a,c){return b.on(this.id,a,c)},unsubscribe:function(a,c){return b.un(this.id,a,c)},getString:function(){null===this.text&&this.render();var a=this.text;return-1!=a.indexOf("\\{")?a.replace(g,"{"):a},render:function(){var a=this.processed,b,f,h;this.children.length||this.createChildren();h=this.children;b=-1;for(f=h.length;++b<f;a=a.replace("---"+b+"---",h[b]instanceof c?h[b].getString():h[b]));return this.text=a},processText:function(a){for(var b=
0,c=a.length,h,g,p="";b<c;)if(-1!=(h=a.indexOf("{{",b))&&-1!=(g=a.indexOf("}}",h+2))&&"\\"!=a.substr(h-1,1))p+=a.substring(b,h),g!=h+2&&(p+=this.watcherMatch(a.substring(h+2,g))),b=g+2;else{b!==c&&(p+=a.substring(b));break}b=0;a=p;c=a.length;for(p="";b<c;)if(-1!=(h=a.indexOf("{[",b))&&-1!=(g=a.indexOf("]}",h+2))&&"\\"!=a.substr(h-1,1))p+=a.substring(b,h),g!=h+2&&(p+=this.watcherMatch(a.substring(h+2,g),!0)),b=g+2;else{b!==c&&(p+=a.substring(b));break}return p},watcherMatch:function(a,b){var c=this.watchers;
if(b){a=X(a);var h=kb(a,"|"),g=X(h[0]);"."!=g.substr(0,1)&&(h[0]="'"+g+"'");1==h.length&&h.push("l");a=h.join(" | ")}c.push(qa(this.scope,a,this.onDataChange,this,null,V));return"---"+(c.length-1)+"---"},onDataChange:function(){this.changeTmt||(this.changeTmt=setTimeout(this.dataChangeDelegate,0))},doDataChange:function(){this.destroyChildren();this.triggerChange();this.changeTmt=null},triggerChange:function(){this.text=null;this.isRoot?b.trigger(this.id,this,this.data):this.parent.triggerChange()},
createChildren:function(){var b=this.watchers,c=this.children,f=this.scope,h=this.recursive,g,p,m;g=-1;for(p=b.length;++g<p;)m=b[g].getLastResult(),void 0===m&&(m=""),c.push(h&&a(f,m,this,null,!0)||m)},destroyChildren:function(){var a=this.children,b,f;b=-1;for(f=a.length;++b<f;)a[b]instanceof c&&a[b].$destroy();this.children=[]},destroyWatchers:function(){var a=this.watchers,b,c;b=-1;for(c=a.length;++b<c;a[b].unsubscribeAndDestroy(this.onDataChange,this));this.watchers=[]},destroy:function(){this.destroyChildren();
this.destroyWatchers();b.destroyEvent(this.id);this.changeTmt&&clearTimeout(this.changeTmt)}},{create:a});return c}(),N=function(){var g=[],b=!1,a="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)},c=function(){b=!0;var d=g.shift();a(function(){d[0].apply(d[1],d[2]);g.length?c():b=!1},0)},d=function(a,d,e){e=e||[];g.push([a,d,e]);b||c()},e=function(a,b){return function(c){try{b.resolve(a(c))}catch(d){b.reject(d)}}},f=function(a,b){if(a instanceof f)return a;if(!(this instanceof
f))return new f(a,b);var c;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(c=ka(a))a instanceof f?a.then(A(this.resolve,this),A(this.reject,this)):(new f(c,a)).then(A(this.resolve,this),A(this.reject,this));else if(E(a))try{a.call(b,A(this.resolve,this),A(this.reject,this))}catch(d){this.reject(d)}else this.resolve(a)};y(f.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==
this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,b){var c;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(c=ka(a)){a instanceof f?a.then(A(this._processResolveValue,this),A(this._processRejectReason,this)):(new f(c,a)).then(A(this._processResolveValue,this),A(this._processRejectReason,
this));return}}catch(d){0==this._state&&this._doReject(d);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)d(b[0],b[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();
for(var a=this._rejects,b;b=a.shift();)d(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b){var c=new f,g=this._state;0==g||0!=this._wait?(a&&E(a)?this._fulfills.push([e(a,c),null]):this._fulfills.push([c.resolve,c]),
b&&E(b)?this._rejects.push([e(b,c),null]):this._rejects.push([c.reject,c])):1==g?a&&E(a)?d(e(a,c),null,[this._value]):c.resolve(this._value):2==g&&(b&&E(b)?d(e(b,c),null,[this._reason]):c.reject(this._reason));return c},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)try{b[0].call(b[1]||null,this._value)}catch(c){ja(c)}},done:function(a,b){var c=this._state;if(1==c&&0==this._wait)try{a.call(b||null,this._value)}catch(d){ja(d)}else 0==c&&this._dones.push([a,
b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)try{b[0].call(b[1]||null,this._reason)}catch(c){ja(c)}},fail:function(a,b){var c=this._state;if(2==c&&0==this._wait)try{a.call(b||null,this._reason)}catch(d){ja(d)}else 0==c&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:A(this.then,this),done:A(this.done,this),fail:A(this.fail,this),always:A(this.always,this)}},after:function(a){var b=this;if(ka(a)){b._wait++;
var c=function(){b._wait--;0==b._wait&&0!=b._state&&(1==b._state?b._callResolveHandlers():b._callRejectHandlers())};E(a.done)?a.done(c):a.then(c)}return b}},!0,!1);f.fcall=function(a,b,c){return f.resolve(a.apply(b,c||[]))};f.resolve=function(a){var b=new f;b.resolve(a);return b};f.reject=function(a){var b=new f;b.reject(a);return b};f.all=function(a){if(!a.length)return f.resolve(null);var b=new f,c=a.length,d=Array(c),e=c,g,s,t=function(a,c){d[c]=a;e--;0==e&&b.resolve(d)};for(g=0;g<c;g++)(function(c){s=
a[g];s instanceof f?s.done(function(a){t(a,c)}).fail(b.reject,b):ka(s)||E(s)?(new f(s)).done(function(a){t(a,c)}).fail(b.reject,b):t(s,c)})(g);return b};f.when=function(){return f.all(arguments)};f.allResolved=function(a){if(!a.length)return f.resolve(null);var b=new f,c=a.length,d=[],e=c,g,s,t=function(a){d.push(a);n()},n=function(){e--;0==e&&b.resolve(d)};for(g=0;g<c;g++)s=a[g],s instanceof f?s.done(t).fail(n):ka(s)||E(s)?(new f(s)).done(t).fail(n):t(s);return b};f.race=function(a){if(!a.length)return f.resolve(null);
var b=new f,c=a.length,d,e;for(d=0;d<c&&(e=a[d],e instanceof f?e.done(b.resolve,b).fail(b.reject,b):ka(e)||E(e)?(new f(e)).done(b.resolve,b).fail(b.reject,b):b.resolve(e),b.isPending());d++);return b};f.waterfall=function(a){if(!a.length)return f.resolve(null);for(var b=a.shift(),b=E(b)?f.fcall(b):f.resolve(c),c;c=a.shift();)ka(c)?b=b.then(function(a){return function(){return a}}(c)):E(c)?b=b.then(c):b.resolve(c);return b};f.counter=function(a){var b=new f;b.countdown=function(){a--;0==a&&b.resolve()};
return b};return f}(),Ya=Array.prototype.indexOf;Ya||(Ya=Array.prototype.indexOf=function(g,b){var a;if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>0;if(0===d)return-1;a=+b||0;Infinity===Math.abs(a)&&(a=0);if(a>=d)return-1;for(a=Math.max(0<=a?a:d-Math.abs(a),0);a<d;){if(a in c&&c[a]===g)return a;a++}return-1});var Za=function(){var g=null,b=Cb.create,a=function(a,b,c,d,f,g){var s=[];if(a&&!0!==a){if(a.nodeType){g.countdown+=1;e(a,c,d,f,g);return}s=
oa.call(a)}s.length||(s=ga(b.childNodes||b));b=s.length;g.countdown+=b;for(a=-1;++a<b;e(s[a],c,d,f,g));},c=function(a,b){if(b)if(b.nodeType)a.push(b);else if(K(b))for(var d=-1,e=b.length;++d<e;c(a,b[d]));},d={script:!0,template:!0,"mjs-template":!0,style:!0},e=function(b,c,e,f,g){if(b){var r;r=b.nodeName;g||(g={countdown:1});if(!r||!d[r.toLowerCase()])if(r=c.call(e,b),!1!==r){if(ka(r)){r.done(function(d){!1!==d&&a(d,b,c,e,f,g);0==--g.countdown&&f&&f.call(e)});return}a(r,b,c,e,f,g)}0==--g.countdown&&
f&&f.call(e)}},f=new ha;return P({$class:"Renderer",id:null,el:null,scope:null,texts:null,parent:null,$init:function(a,b,c){this.id=ca();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof ra&&b.$on("destroy",this.$destroy,this);if(c)c.on("destroy",this.$destroy,this)},on:function(a,b,c){return f.on(a+"-"+this.id,b,c)},once:function(a,b,c){return f.once(a+"-"+this.id,b,c)},un:function(a,b,c){return f.un(a+"-"+this.id,b,c)},createChild:function(a){return new Za(a,this.scope,this)},getEl:function(){return this.el},
runHandler:function(a,b,c,d){var e=a.$isolateScope?b.$newIsolated():a.$breakScope?b.$new():b,f=b.$app,g={$scope:e,$node:c,$attrValue:d,$renderer:this};c=[e,c,d,this];g=f?f.inject(a,null,g,c):a.apply(null,c);f&&a.$registerBy&&g&&(ka(g)?g.done(function(c){f.registerCmp(c,b,a.$registerBy)}):f.registerCmp(g,b,a.$registerBy));if("function"==typeof g)this.on("destroy",g);else if(g&&g.$destroy)this.on("destroy",g.$destroy,g);return a.$stopRenderer?!1:g},processNode:function(a){var d=a.nodeType,e=this.texts,
f=this.scope,u,r;if(3==d){if(u=null!==z(a.parentNode,"mjs-recursive"),d=b(f,a.textContent||a.nodeValue,null,e.length,u))d.subscribe(this.onTextChange,this),e.push({node:a,tr:d}),this.renderText(e.length-1)}else if(1==d){g||(g=D.getAttributes());var d=[],s=[],t,n,q;r="tag."+a.tagName.toLowerCase();if(r=za(r,!0)){n=this.runHandler(r,f,a);if(!1===n)return!1;ka(n)?d.push(n):c(s,n)}t=sb(a);r=0;for(u=g.length;r<u;r++)if(q=g[r].name,void 0!==(n=t[q])){a.removeAttribute(q);n=this.runHandler(g[r].handler,
f,a,n);t[q]=null;if(!1===n)return!1;ka(n)?d.push(n):c(s,n)}if(d.length){var v=new N;N.all(d).done(function(a){c(s,a);v.resolve(s)});return v}u=void 0!==t["mjs-recursive"];delete t["mjs-recursive"];for(r in t)null!==t[r]&&(d=b(f,t[r],null,e.length,u))&&(a.removeAttribute(r),d.subscribe(this.onTextChange,this),e.push({node:a,attr:r,tr:d}),this.renderText(e.length-1));return s.length?s:!0}return!0},process:function(){this.el.nodeType?e(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1}):
a(null,this.el,this.processNode,this,this.onProcessingFinished,{countdown:0})},onProcessingFinished:function(){f.trigger("rendered-"+this.id,this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.tr.getString(),c=a.attr;c?("value"==c?a.node.value=b:"class"==c?a.node.className=b:"src"==c&&(a.node.src=b),a.node.setAttribute(c,b)):(a.node.textContent=b,a.node.nodeValue=b)},destroy:function(){var a=this.texts,b,c;b=-1;for(c=a.length;++b<c;a[b].tr.$destroy());
this.parent&&this.parent.un("destroy",this.$destroy,this);f.trigger("destroy-"+this.id)}})}(),Zb=function(){var g=function(a,b){"pt_BR"==b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1==
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0==a||1==a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1==a?0:2<=a&&4>=a?1:2;case "ga":return 1==a?0:2==a?1:2;case "lt":return 1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1==a%100?0:2==a%100?1:3==a%100||4==a%100?2:3;
case "mk":return 1==a%10?0:1;case "mt":return 1==a?0:0==a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0==a?0:1==a%10&&11!=a%100?1:2;case "pl":return 1==a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1==a?0:2==a?1:8==a||11==a?2:3;case "ro":return 1==a?0:0==a||0<a%100&&20>a%100?1:2;case "ar":return 0==a?0:1==a?1:2==a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},b=function(a){this.store={};a&&(this.locale=a)};y(b.prototype,{store:null,locale:"en",setLocale:function(a){this.locale=
a},set:function(a,b){var e=this.store;void 0===e[a]&&(e[a]=b)},load:function(a){y(this.store,a,!1,!1)},get:function(b){return this.store[b]||(this===a?"-- "+b+" --":a.get(b))},plural:function(a,b){var e=this.get(a),f=g(b,this.locale);return K(e)?e[f]:ua(e)?e[b]?e[b]:1==b&&void 0!=e.one?e.one:0>b&&void 0!=e.negative?e.negative:e.other:e},destroy:function(){this.store=null}},!0,!1);var a=new b;b.global=function(){return a};return b}(),Ua=V.add("mixin.Observable",{$$observable:null,$beforeInit:function(g){this.$$observable=
new ha;if(g&&g.callback){var b=g.callback,a=b.context,c;b.context=null;for(c in b)if(b[c])this.$$observable.on(c,b[c],a||this);g.callback=null}},on:function(){var g=this.$$observable;return g.on.apply(g,arguments)},un:function(){var g=this.$$observable;return g.un.apply(g,arguments)},once:function(){var g=this.$$observable;return g.once.apply(g,arguments)},trigger:function(){var g=this.$$observable;return g.trigger.apply(g,arguments)},$beforeDestroy:function(){this.$$observable.trigger("beforedestroy",
this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.destroy();this.$$observable=null}}),ub=function(){var g,b=function(){this.store={}};y(b.prototype,{store:null,instantiate:function(a,b,d,e){return a.$instantiate?a.$instantiate.apply(a,d):e?zb(a,d):a.apply(b,d)},inject:function(a,b,d,e,f){d=d||{};e=e||[];var g=this;if(E(a))if(a.inject)e=oa.call(a.inject),e.push(a),a=e;else return g.instantiate(a,b,e,f);a=oa.call(a);e=[];var k=a.pop(),p,m;p=-1;for(m=a.length;++p<
m;e.push(g.resolve(a[p],d)));return N.all(e).then(function(a){return g.instantiate(k,b,a,f)})},value:function(a,b){this.store[a]={type:1,value:b}},constant:function(a,b){var d=this.store;d[a]||(d[a]={type:2,value:b})},factory:function(a,b,d,e){Fa(d)&&(e=d,d=null);this.store[a]={type:3,singleton:e,fn:b,context:d}},service:function(a,b,d){this.store[a]={type:4,singleton:d,fn:b}},provider:function(a,b){this.store[a+"Provider"]={name:a,type:5,fn:b,instance:null}},resolve:function(a,b){var d=this.store,
e,f,h;if(void 0!==b[a])return b[a];if(f=d[a]){e=f.type;if(1==e||2==e)return f.value;if(3==e)h=this.inject(f.fn,f.context,b);else if(4==e)h=this.inject(f.fn,null,b,null,!0);else if(5==e)return f.instance||(f.instance=N.resolve(this.inject(f.fn,null,b)).done(function(a){f.instance=a;d[f.name]={type:3,fn:a.$get,context:a}})),f.instance;f.singleton&&(f.type=1,f.value=h,3==e&&ka(h)&&h.done(function(a){f.value=a}));return b[a]=h}if(d[a+"Provider"])return this.resolve(a+"Provider",b),this.resolve(a,b);if(this===
g)throw"Could not provide value for "+a;return g.resolve(a)},destroy:function(){this.scope=this.store=null}},!0,!1);b.global=function(){return g};g=new b;return b}(),$b=function(){var g=[],b=function(a){var b,d,e,f;b=0;for(d=g.length;b<d;b++)e=g[b],e.$destroy?e.$destroy():e.destroy&&e.destroy();g=null;Ia&&Ia.destroy&&(Ia.destroy(),Ia=null);V&&V.destroy&&(V.destroy(),V=null);for(f in Ha)Ha[f]=null;Ha=null;if(a)for(f in window)window.hasOwnProperty(f)&&(window[f]=null)};b.collect=function(a){g.push(a)};
return b}();P({$class:"App",$mixins:[Ua,{$$provider:null,$beforeInit:function(){this.$$provider=new ub},value:function(){var g=this.$$provider;return g.value.apply(g,arguments)},constant:function(){var g=this.$$provider;return g.constant.apply(g,arguments)},factory:function(){var g=this.$$provider;return g.factory.apply(g,arguments)},service:function(){var g=this.$$provider;return g.service.apply(g,arguments)},provider:function(){var g=this.$$provider;return g.provider.apply(g,arguments)},resolve:function(){var g=
this.$$provider;return g.resolve.apply(g,arguments)},inject:function(){var g=this.$$provider;return g.inject.apply(g,arguments)},$afterDestroy:function(){this.$$provider.destroy();this.$$provider=null}}],lang:null,scope:null,renderer:null,cmpListeners:null,components:null,$init:function(g,b){var a=b instanceof ra?b:new ra(b),c;$b.collect(this);g.removeAttribute("mjs-app");a.$app=this;this.$super();this.lang=new Zb;this.scope=a;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",
this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",a.$root);this.value("$lang",this.lang);this.renderer=new Za(g,a);c=oa.call(arguments);c[1]=a;this.initApp.apply(this,c)},initApp:M,run:function(){this.renderer.process()},getParentCmp:function(g){g=g.parentNode;for(var b;g;){if(b=z(g,"cmp-id"))return this.getCmp(b);g=g.parentNode}return null},onAvailable:function(g,b,a){var c=this.cmpListeners,d=this.components;c[g]||(c[g]=new N);b&&c[g].done(b,a);d[g]&&c[g].resolve(d[g]);return c[g]},
getCmp:function(g){return this.components[g]||null},registerCmp:function(g,b,a){var c=this,d=g[a];a=function(){delete c.cmpListeners[d];delete c.components[d]};c.components[d]=g;c.cmpListeners[d]&&c.cmpListeners[d].resolve(g);if(g.on)g.on("destroy",a);b.$on("$destroy",a)},destroy:function(){this.renderer.$destroy();this.scope.$destroy();this.lang.destroy();this.$super()}});var Ta=function(){return function b(a){if(a===window)return!0;if(3==a.nodeType)return a.parentElement?b(a.parentElement):!0;var c=
window.document.documentElement;return a===c?!0:c.contains(a)}}(),H=function(){var g={};return function(b,a,c){b=b._mjsid||(b._mjsid=ca());var d=g[b];return void 0!==c?(d||(d=g[b]={}),d[a]=c):d?d[a]:void 0}}(),gb=function b(a){var c,d,e;if(K(a)){e=[];c=0;for(d=a.length;c<d;c++)e.push(b(a[c]));return e}if(a)switch(a.nodeType){case 1:return a.cloneNode(!0);case 3:return window.document.createTextNode(a.innerText||a.textContent);case 11:return a.cloneNode(!0)}return null},Ja=function(){var b=["Moz",
"Webkit","ms","O","Khtml"],a="animationDelay",c="animationDuration",d="transitionDelay",e="transitionDuration",f="transform",h=null,k=null,p=!1;return function(){if(!p){var m=window.document.createElement("div"),u=!1,r,s,t;if(void 0!==m.style.animationName)u=!0;else for(s=0,t=b.length;s<t;s++)if(r=b[s],void 0!==m.style[r+"AnimationName"]){u=!0;a=r+"AnimationDelay";c=r+"AnimationDuration";d=r+"TransitionDelay";e=r+"TransitionDuration";f=r+"Transform";break}u&&("ontransitionend"in window?h="transitionend":
"onwebkittransitionend"in window&&(h="webkitTransitionEnd"));k=u?{animationDelay:a,animationDuration:c,transitionDelay:d,transitionDuration:e,transform:f,transitionend:h}:{};p=!0}return k}}(),Db=function(){var b=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},a=function(a,c,d){var e,f,h=c.length;for(e=0;e<h;e++)f=b(c[e])+b(d[e]),a=Math.max(f,a);return a},c=!1,d=null,e=null,f=null,h=null;return function(b){!1===c&&(d=(c=Ja())?c.animationDuration:null,e=c?c.animationDelay:
null,f=c?c.transitionDuration:null,h=c?c.transitionDelay:null);if(!c)return 0;var p=window.getComputedStyle?window.getComputedStyle(b,null):b.style;b=0;var m=(p[d]||"").split(","),u=(p[e]||"").split(","),r=(p[f]||"").split(","),p=(p[h]||"").split(",");b=Math.max(b,a(b,m,u));return b=Math.max(b,a(b,r,p))}}(),Oa=function(){var b={};return function(a){return b[a]||(b[a]=new RegExp(a))}}(),Da=function(b){var a=H(b,"mjsAnimationQueue"),c,d;if(K(a)&&a.length){if(a=a[0])a.stages&&(c=a.position,d=a.stages,
R(b,d[c]),R(b,d[c]+"-active")),a.deferred&&a.deferred.reject(a.el)}else E(a)?a(b):"stop"==a&&$(b).stop(!0,!0);H(b,"mjsAnimationQueue",null)},Y=function(){var b,a;if("undefined"!=typeof window){var c=window;b=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame;a=c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.webkitCancelRequestAnimationFrame;if(b)return function(c){var e=b(c);return function(){a(e)}}}return function(a){var b=setTimeout(a,
0);return function(){clearTimeout(b)}}}(),ea=function(){var b={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},a=0,c=!1,d=!1,e=function(a,b,c){var d=function(){(new Date).getTime()-b>=c?a():Y(d)};Y(d)},f=function(){!1===c&&(c=Ja(),d=!!c);return d},h=function m(a,b,c,d,f,q,v,l){var k=function(){var b=H(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==v?!1:(f.reject(a),!0)},w=function(){if(!k()){var d=c;c++;if(c==b.length){f.resolve(a);H(a,"mjsAnimationQueue").shift();
var e=H(a,"mjsAnimationQueue");e.length?(e=e[0],h(e.el,e.stages,0,e.start,e.deferred,!1,e.id,e.step)):H(a,"mjsAnimationQueue",null)}else H(a,"mjsAnimationQueue")[0].position=c,m(a,b,c,null,f,!1,v,l);R(a,b[d]);R(a,b[d]+"-active")}},C=function(){k()||(L(a,b[c]+"-active"),N.resolve(l&&l(a,c,"active")).done(function(){if(!k()){var b=Db(a);b?e(w,(new Date).getTime(),b):Y(w)}}))},da=function(){k()||(L(a,b[c]),N.waterfall([l&&l(a,c,"start"),function(){return d?d(a):null}]).done(function(){!k()&&Y(C)}))};
q?Y(da):da()},k=function(c,d,e,k,t,n){var q=new N,v=H(c,"mjsAnimationQueue")||[],l=++a,O=z(c,"mjs-animate"),w,C,da,x,F,T,W;d=d||O;k&&null===O&&(d=null);if(d){B(d)?"["==d.substr(0,1)?w=(new Function("","return "+d))():(w=b[d],d=t&&t.get("animate."+d,!0)):E(d)?C=d:K(d)&&(B(d[0])?w=d:(da=d[0],x=d[1]));ua(d)&&(w=d.stages,C=d.fn,da=d.before,x=d.after,F=d.options?y({},d.options):{},T=d.context||null,W=d.duration||null,e=e||F.start);if(f()&&w)return v.push({el:c,stages:w,start:e,step:n,deferred:q,position:0,
id:l}),H(c,"mjsAnimationQueue",v),1==v.length&&h(c,w,0,e,q,!0,l,n),q;F=F||{};e&&(F.start=function(){e(c)});F.complete=function(){q.resolve(c)};W&&(F.duration=W);if(C&&E(C))return da&&y(c.style,da,!0,!1),e&&e(c),H(c,"mjsAnimationQueue",C.call(T,c,function(){q.resolve(c)})),q;if(window.jQuery){d=$(c);da&&d.css(da);H(c,"mjsAnimationQueue","stop");if(C&&B(C))return d[C](F),q;if(x)return d.animate(x,F),q}}e?(C=e(c),ka(C)?C.done(function(){q.resolve(c)}):q.resolve(c)):q.resolve(c);return q};k.addAnimationType=
function(a,c){b[a]=c};k.stop=Da;k.getPrefixes=Ja;k.getDuration=Db;k.cssAnimationSupported=f;return k}(),ac=function(){return"undefined"!=typeof JSON?function(b){return JSON.parse(b)}:function(b){return(new Function("return "+b))()}}(),U=function(){var b=/^[\w[:#.][\w\]*^|=!]*$/,a=/=([^\]]+)/,c=/ *, */,d=/(\([^)]*)\+/,e=/(\[[^\]]+)~/,f=/(~|>|\+)/,h=/ +/,k=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,p=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,
m=/\D/,u=/[^(]*\(([^)]*)\)/,r=/\(.*/,s=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,t=window.document,n=!!t.getElementsByClassName,q=!!t.querySelectorAll,v={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=a.nextSibling)&&1!=a.nodeType;);return!!a},root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,b){var c=a.nodeIndex||0,d=b[3]=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.firstChild;
c++;do if(1==f.nodeType&&(f.nodeIndex=++c)&&a===f&&(c+d)%e)return 0;while(f=f.nextSibling);return 1},"nth-last-child":function(a,b){var c=a.nodeIndexLast||0,d=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.lastChild;c++;do if(1==f.nodeType&&(f.nodeLastIndex=c++)&&a===f&&(c+d)%e)return 0;while(f=f.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!=a.parentNode.getElementsByTagName("*").length},
checked:function(a){return!a.checked},lang:function(a,b){return a.lang!==b&&t.documentElement.lang!==b},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},l={},O=function(a){return l[a]||(l[a]=new RegExp("(^| +)"+a+"($| +)"))},w={"":function(a,b){return null!==z(a,b)},"=":function(a,b,c){var d;return(d=z(a,b))&&d===c},"&=":function(a,b,c){var d;return(d=z(a,b))&&O(c).test(d)},"^=":function(a,b,c){var d;return(d=
z(a,b)+"")&&!d.indexOf(c)},"$=":function(a,b,c){var d;return(d=z(a,b)+"")&&d.indexOf(c)==d.length-c.length},"*=":function(a,b,c){var d;return(d=z(a,b)+"")&&-1!=d.indexOf(c)},"|=":function(a,b,c){var d;return(d=z(a,b)+"")&&(d===c||!!d.indexOf(c+"-"))},"!=":function(a,b,c){var d;return!(d=z(a,b))||!O(c).test(d)}},C=function(l,C){C=C||t;var F=[],T=null,W,ia,O,G,y,z,B;if(q)try{F=ga(C.querySelectorAll(l.replace(a,'="$1"')))}catch(A){T=!0}if(!q||T)if(b.test(l))switch(T=0,l.charAt(0)){case "#":T=l.slice(1);
F=t.getElementById(T);F.id!==T&&(F=t.all[T]);F=F?[F]:[];break;case ".":W=l.slice(1);if(n)F=ga((F=C.getElementsByClassName(W)).length?F:[]);else{W=" "+W+" ";ia=C.getElementsByTagName("*");for(O=0;G=ia[O++];)-1!=(" "+G.className+" ").indexOf(W)&&(F[T++]=G);F=T?F:[]}break;case ":":ia=C.getElementsByTagName("*");O=0;y=l.replace(u,"$1");for(z=l.replace(r,"");G=ia[O++];)v[z]&&!v[z](G,y)&&(F[T++]=G);F=T?F:[];break;case "[":ia=C.getElementsByTagName("*");O=0;G=s.exec(l);W=G[1];B=G[2]||"";for(y=G[3];G=ia[O++];)w[B]&&
(w[B](G,W,y)||"class"===W&&w[B](G,"className",y))&&(F[T++]=G);F=T?F:[];break;default:F=ga((F=C.getElementsByTagName(l)).length?F:[])}else{for(var D=l.split(c),E=D.length-1,I=!!E,M,N,S,P,H,J,K,L,U,Q,R,V;T=D[E--];){N=(M=T.replace(d,"$1%").replace(e,"$1&").replace(f," $1 ").split(h)).length;O=0;P=" ";for(ia=[C];S=M[O++];)if(" "!==S&&">"!==S&&"~"!==S&&"+"!==S&&ia){S=S.match(k);H=S[1]||"*";J=S[2];K=S[3]?" "+S[3]+" ":"";W=S[4];B=S[5]||"";z=S[7];y="nth-child"===z||"nth-last-child"===z?p.exec("even"===S[8]&&
"2n"||"odd"===S[8]&&"2n%1"||!m.test(S[8])&&"0n%"+S[8]||S[8]):S[8];L=[];T=U=0;for(R=O==N;Q=ia[U++];)switch(P){case " ":V=Q.getElementsByTagName(H);for(Q=0;G=V[Q++];)J&&G.id!==J||K&&-1==(" "+G.className+" ").indexOf(K)||!(!W||w[B]&&(w[B](G,W,S[6])||"class"===W&&w[B](G,"className",S[6])))||G.yeasss||(v[z]?v[z](G,y):z)||(R&&(G.yeasss=1),L[T++]=G);break;case "~":for(H=H.toLowerCase();(Q=Q.nextSibling)&&!Q.yeasss;)1!=Q.nodeType||"*"!==H&&Q.nodeName.toLowerCase()!==H||J&&Q.id!==J||K&&-1==(" "+Q.className+
" ").indexOf(K)||!(!W||w[B]&&(w[B](G,W,S[6])||"class"===W&&w[B](G,"className",S[6])))||Q.yeasss||(v[z]?v[z](Q,y):z)||(R&&(Q.yeasss=1),L[T++]=Q);break;case "+":for(;(Q=Q.nextSibling)&&1!=Q.nodeType;);!Q||Q.nodeName.toLowerCase()!==H.toLowerCase()&&"*"!==H||J&&Q.id!==J||K&&-1==(" "+G.className+" ").indexOf(K)||!(!W||w[B]&&(w[B](G,W,S[6])||"class"===W&&w[B](G,"className",S[6])))||Q.yeasss||(v[z]?v[z](Q,y):z)||(R&&(Q.yeasss=1),L[T++]=Q);break;case ">":for(V=Q.getElementsByTagName(H),O=0;G=V[O++];)G.parentNode!==
Q||J&&G.id!==J||K&&-1==(" "+G.className+" ").indexOf(K)||!(!W||w[B]&&(w[B](G,W,S[6])||"class"===W&&w[B](G,"className",S[6])))||G.yeasss||(v[z]?v[z](G,y):z)||(R&&(G.yeasss=1),L[T++]=G)}ia=L}else P=S;if(I){if(!ia.concat){L=[];for(Q=0;G=ia[Q];)L[Q++]=G;ia=L}F=ia.concat(1==F.length?F[0]:F)}else F=ia}for(T=F.length;T--;)F[T].yeasss=F[T].nodeIndex=F[T].nodeIndexLast=null}return F};C.is=function(a,b){var c=C(b,a.parentNode),d,e;d=-1;for(e=c.length;++d<e;)if(c[d]===a)return!0;return!1};return C}(),Qa=function(b){if(b instanceof
Qa)return b;if(!(this instanceof Qa))return new Qa(b);for(var a in b)if(!this[a])try{this[a]=b[a]}catch(c){}this.originalEvent=b;this.type=b.type;!this.target&&b.srcElement&&(this.target=b.srcElement);var d,e=b.button;void 0===this.pageX&&null!==b.clientX&&(d=this.target?this.target.ownerDocument||window.document:window.document,a=d.documentElement,d=d.body,this.pageX=b.clientX+(a&&a.scrollLeft||d&&d.scrollLeft||0)-(a&&a.clientLeft||d&&d.clientLeft||0),this.pageY=b.clientY+(a&&a.scrollTop||d&&d.scrollTop||
0)-(a&&a.clientTop||d&&d.clientTop||0));this.which||void 0===e||(this.which=e&1?1:e&2?3:e&4?2:0);this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?Va:ya;this.timeStamp=b&&b.timeStamp||(new Date).getTime()};y(Qa.prototype,{isDefaultPrevented:ya,isPropagationStopped:ya,isImmediatePropagationStopped:ya,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=Va;b.returnValue=!1;b&&b.preventDefault&&b.preventDefault()},stopPropagation:function(){var b=
this.originalEvent;this.isPropagationStopped=Va;b&&b.stopPropagation&&b.stopPropagation()},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=Va;b&&b.stopImmediatePropagation&&b.stopImmediatePropagation();this.stopPropagation()}},!0,!1);var Eb=function(b){function a(){d=null}var c,d;b=function(b){return function(f){var h=aa(f||window.event),k=oa.call(arguments,1),p=0,m=0,u=0,r=0,s=0,t=0;h.type="mousewheel";"detail"in h&&(u=-1*h.detail);"wheelDelta"in h&&
(u=h.wheelDelta);"wheelDeltaY"in h&&(u=h.wheelDeltaY);"wheelDeltaX"in h&&(m=-1*h.wheelDeltaX);"axis"in h&&h.axis===h.HORIZONTAL_AXIS&&(m=-1*u,u=0);p=0===u?m:u;"deltaY"in h&&(p=u=-1*h.deltaY);"deltaX"in h&&(m=h.deltaX,0===u&&(p=-1*m));if(0!==u||0!==m){r=Math.max(Math.abs(u),Math.abs(m));if(!d||r<d)d=r,"mousewheel"===h.type&&0===r%120&&(d/=40);"mousewheel"===h.type&&0===r%120&&(p/=40,m/=40,u/=40);p=Math[1<=p?"floor":"ceil"](p/d);m=Math[1<=m?"floor":"ceil"](m/d);u=Math[1<=u?"floor":"ceil"](u/d);this.getBoundingClientRect&&
(r=this.getBoundingClientRect(),s=h.clientX-r.left,t=h.clientY-r.top);h.deltaX=m;h.deltaY=u;h.deltaFactor=d;h.offsetX=s;h.offsetY=t;h.deltaMode=0;k.unshift(h,p,m,u);c&&clearTimeout(c);c=setTimeout(a,200);return b.apply(this,k)}}};b.events=function(){var a=window.document;return"onwheel"in a||9<=a.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]};return b}(),I=function(){var b=null,a=null;return function(c,d,e){null===b&&(b=c.attachEvent?"attachEvent":"addEventListener",
a=c.attachEvent?"on":"");if("mousewheel"==d){e=Eb(e);d=Eb.events();var f,h;f=0;for(h=d.length;f<h;f++)c[b](a+d[f],e,!1)}else c[b](a+d,e,!1);return e}}(),$a=function(){var b=/#.*$/,a=/([?&])_=[^&]*/,c=/\?/,d=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,e=/^(?:GET|HEAD)$/i,f=function(a,b,c){var d,e;if(xa(a)&&c)b.push(encodeURIComponent(c)+"="+encodeURIComponent(""+a));else if(K(a)&&c)for(d=0,e=a.length;d<e;d++)f(a[d],b,c+"["+d+"]");else if(Ea(a))for(d in a)a.hasOwnProperty(d)&&f(a[d],
b,c?c+"["+d+"]":d)},h=function(d,n){d.replace(b,"");if(!1===n.cache){var h=(new Date).getTime();d=a.test(d)?d.replace(a,"$1_="+h):d+(c.test(d)?"&":"?")+"_="+h}!n.data||window.FormData&&n.data instanceof window.FormData||(B(n.data)?h=n.data:(h=[],f(n.data,h,null),h=h.join("&").replace(/%20/g,"+")),n.data=h,e.test(n.method)&&(d+=(c.test(d)?"&":"?")+n.data,n.data=null));return d},k={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",
text:"text/plain",_default:"*/*"},p={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},m={},u=new ha,r=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),
b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},s=function(a,b,c){var d,e;if(!Ea(a)&&!E(a)&&c)d=document.createElement("input"),d.setAttribute("type","hidden"),d.setAttribute("name",c),d.setAttribute("value",a),b.appendChild(d);else if(K(a)&&c)for(d=0,e=a.length;d<e;d++)s(a[d],b,c+"["+d+"]");else if(Ea(a))for(d in a)a.hasOwnProperty(d)&&s(a[d],b,c?c+"["+d+"]":d)},t=function(a){for(var b,c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],null!==z(b,"name"))if(c="INPUT"===
b.nodeName.toUpperCase()?z(b,"type").toUpperCase():"TEXT","FILE"===c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},n=function(a,b,c){var d=b?b.dataType:null;b=b?b.selector:null;if(!B(a))return a;c=c||"";if("xml"===d||!d&&0<=c.indexOf("xml"))return a=tb(X(a)),b?U(b,a):a;if("html"===d)return a=tb(a,"text/html"),b?U(b,a):a;
if("fragment"==d){c=document.createDocumentFragment();d=document.createElement("div");for(d.innerHTML=a;d.firstChild;)c.appendChild(d.firstChild);return c}if("json"===d||!d&&0<=c.indexOf("json"))return ac(X(a));("script"===d||!d&&0<=c.indexOf("javascript"))&&r(a);return a+""},q=function(a){var b=d.exec((window?window.location.href:"").toLowerCase())||[],c=d.exec(a.url.toLowerCase());this._opt=a;!0!==a.crossDomain&&(a.crossDomain=!(!c||c[1]===b[1]&&c[2]===b[2]&&(c[3]||("http:"===c[1]?"80":"443"))===
(b[3]||("http:"===b[1]?"80":"443"))));b=new N;"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||window&&window.FormData||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):t(a.form));a.url=h(a.url,a);c=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new w(a,b,this):new l(a,b,this):new O(a,b,this);this._deferred=b;this._transport=c;b.done(function(a){u.trigger("success",
a)});b.fail(function(a){u.trigger("error",a)});b.always(function(){u.trigger("end")});u.trigger("start");a.timeout&&(this._timeout=setTimeout(A(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===u.trigger("beforeSend",a,c)&&(this._promise=N.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,c)&&(this._promise=N.reject());this._promise||(pa(c.send,c),b.abort=A(this.abort,this),b.always(this.destroy,this),this._promise=b)};y(q.prototype,{_jsonpName:null,_transport:null,
_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);s(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,b=a.jsonpParam||
"callback",d=a.jsonpCallback||"jsonp_"+ca();a.url+=(c.test(a.url)?"&":"?")+b+"="+d;this._jsonpName=d;"undefined"!=typeof window&&(window[d]=A(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=A(this.jsonpCallback,this));return d},jsonpCallback:function(a){var b;try{b=this.processResponseData(a)}catch(c){this._deferred?this._deferred.reject(c):ja(c)}this._deferred&&this._deferred.resolve(b)},processResponseData:function(a,b){var c=this._opt;a=n(a,c,b);u.hasListener("processResponse")&&
(a=u.trigger("processResponse",a,this._deferred));c.processResponse&&(a=c.processResponse.call(c.callbackScope,a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred,d;if(this._opt.jsonp)if(a){try{r(a)}catch(e){c.reject(e)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else{try{d=this.processResponseData(a,b)}catch(f){c.reject(f)}c.resolve(d)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&
this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.destroy();this._form=this._timeout=this._promise=this._deferred=this._opt=this._transport=null;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},!0,!1);var v=function(a,b){b=b||{};a&&!B(a)?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=z(b.form,"action")),!b.url))throw"Must provide url";y(b,m,!1,!0);y(b,p,!1,!0);b.method=
b.method?b.method.toUpperCase():b.form?z(b.form,"method").toUpperCase()||"GET":"GET";return(new q(b)).promise()};v.setup=function(a){y(m,a,!0,!0)};v.on=function(){u.on.apply(u,arguments)};v.un=function(){u.un.apply(u,arguments)};v.get=function(a,b){b=b||{};b.method="GET";return v(a,b)};v.post=function(a,b){b=b||{};b.method="POST";return v(a,b)};v.load=function(a,b,c){c=c||{};B(b)||(c=b);c.dataType="fragment";return v(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);
a.appendChild(b)})};v.loadScript=function(a){return v(a,{transport:"script"})};v.submit=function(a,b){b=b||{};b.form=a;return v(null,b)};var l=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&I(d,"progress",A(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&I(d.upload,"progress",A(a.uploadProgress,
a.callbackScope));d.onreadystatechange=A(this.onReadyStateChange,this)};y(l.prototype,{_xhr:null,_deferred:null,_ajax:null,setHeaders:function(){var a=this._opt,b=this._xhr,c;if(a.xhrFields)for(c in a.xhrFields)b[c]=a.xhrFields[c];a.data&&a.contentType&&b.setRequestHeader("Content-Type",a.contentType);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.setRequestHeader("Accept",a.dataType&&k[a.dataType]?k[a.dataType]+", */*; q=0.01":k._default);for(c in a.headers)b.setRequestHeader(c,a.headers[c])},
onReadyStateChange:function(){var a=this._xhr,b=this._deferred;if(0===a.readyState)a.onreadystatechange=M,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=M;var c;a:{try{c=!a.status&&location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse(B(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=M;this._xhr.abort()},
send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this.setHeaders(),this._xhr.send(a.data)}catch(b){this._deferred&&this._deferred.reject(b)}},destroy:function(){this._ajax=this._opt=this._deferred=this._xhr=null}},!0,!1);var O=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};y(O.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset",
"utf-8");a.setAttribute("src",this._opt.url);I(a,"load",A(this.onLoad,this));I(a,"error",A(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);this._deferred=this._ajax=this._opt=this._el=null}},!0,!1);var w=function(a,b,
c){this._opt=a;this._ajax=c;this._deferred=b};y(w.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+ca(),c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);I(a,"load",A(this.onLoad,this));I(a,"error",A(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},onLoad:function(){var a=
this._el;this._opt&&!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);this._deferred=this._ajax=this._opt=this._el=null}},!0,!1);return v}(),Ga=function(){var b=new ha,a=new yb,c=function(b){var c=a.get(b);"string"==typeof c&&
(c=na(c),a.add(b,c));return c},d=function(b){return a.exists(b)?a.get(b):a.add(b,$a(b,{dataType:"fragment"}).then(function(c){return a.add(b,c)}))};a.addFinder(function(a){a=window.document.getElementById(a);var b;if(a)return b=a.tagName.toLowerCase(),"script"==b?(b=window.document.createElement("div"),b.innerHTML=a.innerHTML,na(b.childNodes)):"content"in a?a.content:na(a.childNodes)});return P({$class:"Template",_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,_originalNode:null,
_intendedShadow:!1,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,tplPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,shadow:!1,animationEnabled:!0,$init:function(a){y(this,a,!0,!1);window.document.documentElement.createShadowRoot||(this._intendedShadow=this.shadow,this.shadow=!1);this.id=ca();b.createEvent("rendered-"+this.id,!1,!0);this.tpl&&(this.tpl=X(this.tpl));this.url&&(this.url=X(this.url));var c=this.node;a=this.tpl||this.url;c&&c.removeAttribute("mjs-include");
this.shadow&&(this._originalNode=c,this.node=c=c.createShadowRoot());c||(this.deferRendering=!0);if(a){if(c&&c.firstChild&&!this.shadow&&H(c,"mjs-transclude",na(c.childNodes)),"."==a.substr(0,1)?(c=a.substr(1,1),c=!("."==c||"/"==c)):c=!1,c&&(this._watcher=qa(this.scope,a,this.onChange,this,null,V)),this._watcher&&!this.replace?this.ownRenderer=!0:this.shadow?this.ownRenderer=!0:this.replace&&(this.ownRenderer=!1),this.resolveTemplate(),this._watcher&&this.replace&&(this._watcher.unsubscribeAndDestroy(this.onChange,
this),this._watcher=null),this.deferRendering&&this.ownRenderer||this.tplPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope instanceof ra&&this.scope.$on("destroy",this.onScopeDestroy,this)},setAnimation:function(a){this.animationEnabled=a},doRender:function(){this._renderer||(this._renderer=new Za(this.node,this.scope),this._renderer.on("rendered",
this.onRendered,this),this._renderer.process())},onRendered:function(){b.trigger("rendered-"+this.id,this)},on:function(a,c,d){return b.on(a+"-"+this.id,c,d)},un:function(a,c,d){return b.un(a+"-"+this.id,c,d)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.tplPromise)return this.tplPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=
this,b=a.url,h=a._watcher?a._watcher.getLastResult():a.tpl||b;a.initPromise=new N;a.tplPromise=new N;a.ownRenderer&&a.initPromise.resolve(!1);return(new N(function(a){b?a(c(h)||d(b)):a(c(h)||na(h))})).done(function(b){a._fragment=b;a.tplPromise.resolve()}).fail(a.initPromise.reject,a.initPromise).fail(a.tplPromise.reject,a.tplPromise)},onChange:function(){this._renderer&&(this._renderer.$destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=
this.node;a.firstChild;)a.removeChild(a.firstChild);this._intendedShadow&&this.makeTranscludes();if(this.replace){var b=gb(this._fragment),c=H(a,"mjs-transclude"),d=oa.call(b.childNodes);if(c){var p=U("[mjs-transclude], mjs-transclude",b);p.length&&H(p[0],"mjs-transclude",c)}a.parentNode.replaceChild(b,a);this.node=d;this.initPromise.resolve(d)}else a.appendChild(gb(this._fragment)),this.initPromise.resolve(this.node);this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new N;
!this._initial&&this.animationEnabled?(ea(a,"leave",null,!0).done(this.doApplyTemplate,this).done(b.resolve,b),ea(a,"enter",null,!0)):(this.doApplyTemplate(),b.resolve());this._initial=!1;return b},makeTranscludes:function(){var a=this._fragment,b=U("content",a),c,d,p,m,u,r;u=0;for(r=b.length;u<r;u++)p=window.document.createElement("mjs-transclude"),c=b[u],d=c.nextSibling,(m=z(c,"select"))&&p.setAttribute("select",m),a.removeChild(c),a.insertBefore(p,d)},onParentRendererDestroy:function(){this._renderer.$destroy();
this.$destroy()},onScopeDestroy:function(){this.$destroy()},destroy:function(){this.shadow&&this._originalNode.createShadowRoot();this._watcher&&this._watcher.unsubscribeAndDestroy(this.onChange,this)}},{cache:a})}(),bc=P({$class:"MetaphorJs.Component",$mixins:[Ua],id:null,originalId:!1,node:null,cls:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,as:null,$init:function(b){b=b||{};this.$super(b);y(this,b,!0,!1);
this.scope||(this.scope=new ra);this.as&&(this.scope[this.as]=this);if(this.node){var a=z(this.node,"id");a&&(this.originalId=!0,this.id||(this.id=a))}this.id=this.id||"cmp-"+ca();this.node||this._createNode();this.cls&&L(this.node,this.cls);this.initComponent.apply(this,arguments);this.scope.$app&&this.scope.$app.registerCmp(this,this.scope,"id");var a=this.template,c=this.templateUrl;a&&a instanceof Ga?a instanceof Ga&&(this.template.node=this.node):this.template=a=new Ga({scope:this.scope,node:this.node,
deferRendering:!a,ownRenderer:!0,tpl:a,url:c,shadow:this.constructor.$shadow,animationEnabled:!this.hidden});this.template.on("rendered",this.onRenderingFinished,this);if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(a.initPromise?a.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=window.document.createElement(this.tag||"div")},_initElement:function(){var b=this.node;b.setAttribute("id",
this.id);b.setAttribute("cmp-id",this.id);this.hidden&&(b.style.display="none")},render:function(){this.rendered||(this.trigger("render",this),this.template.startRendering())},onRenderingFinished:function(){this.renderTo?this.renderTo.appendChild(this.node):Ta(this.node)||window.document.body.appendChild(this.node);this.rendered=!0;this.afterRender();this.trigger("afterrender",this)},show:function(){if(this.hidden){if(!1===this.trigger("beforeshow",this))return!1;this.rendered||this.render();this.template.setAnimation(!0);
this.node.style.display="block";this.hidden=!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("beforehide",this))return!1;this.template.setAnimation(!1);this.node.style.display="none";this.hidden=!0;this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:M,afterRender:M,onShow:M,onHide:M,
onParentRendererDestroy:function(){this.$destroy()},destroy:function(){this.template&&this.template.$destroy();this.destroyEl?Ta(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"),this.cls&&R(this.node,this.cls));this.destroyScope&&this.scope&&this.scope.$destroy();this.$super()}}),ma=function(b){b=b||{};this._queue=[];this._map={};this.id="$$"+ca();for(var a in b)this[a]=b[a]};ma.REPLACE=1;ma.ONCE=2;ma.MULTIPLE=
3;ma.ONCE_EVER=4;y(ma.prototype,{_queue:null,_map:null,_nextRequested:!1,_running:!1,length:0,id:null,async:!0,auto:!0,thenable:!1,stack:!1,context:null,mode:ma.MULTIPLE,add:function(b,a,c,d,e,f){var h=this.id,k=b[h]||ca();a={id:k,fn:b,context:a,args:c,async:f};d=d||this.mode;if(d==ma.ONCE_EVER&&b[h])return b[h];b[h]=k;if(this._map[k])if(d==ma.REPLACE)this.remove(k);else if(d==ma.ONCE)return k;this._queue[e?"unshift":"push"](a);this._map[k]=a;this.length=this._queue.length;this.auto&&this.next();
return k},append:function(b,a,c,d,e){return this.add(b,a,c,d,!1,e)},prepend:function(b,a,c,d,e){return this.add(b,a,c,d,!0,e)},remove:function(b){var a=this._queue,c,d;c=0;for(d=a.length;c<d;c++)if(a[c].id==b){a.splice(c,1);break}delete this._map[b]},isEmpty:function(){return 0==this.length},next:function(){var b=this,a;if(b._running)b._nextRequested=!0;else if(b._nextRequested=!1,a=b._queue[b.stack?"pop":"shift"](),b.length=b._queue.length,a)if(b._running=!0,delete b._map[a.id],b.async||a.async){var c=
0;1===fa(a.async)?c=a.async:1===fa(b.async)&&(c=b.async);var d=function(){try{b._processResult(a.fn.apply(a.context||b.context,a.args||[]))}catch(c){throw ja(c),b._finish(),c;}};"raf"==a.async||!a.async&&"raf"==b.async?Y(d):pa(d,null,null,c)}else try{b._processResult(a.fn.apply(a.context||b.context,a.args||[]))}catch(e){throw ja(e),b._finish(),e;}},_processResult:function(b){var a=this;a.thenable&&ka(b)?b.then(function(){a._finish()},function(){a._finish()}):a._finish();return b},_finish:function(){this._running=
!1;(this.auto||this._nextRequested)&&this.next()},destroy:function(){this.context=this._map=this._queue=null;this._running=this._nextRequested=!1;this.next=M}},!0,!1);var Ob=/-./g,Pb=function(){return function(b){if(b.dataset)return b.dataset;var a;if(void 0!==(a=H(b,"data")))return a;a=b.attributes;var c={},d,e,f;d=0;for(e=a.length;d<e;d++)f=a[d].name,0===f.indexOf("data-")&&(c[Nb(f.substr(5))]=a[d].value);a=c;H(b,"data",a);return a}}(),nb=P({$class:"ListRenderer",id:null,model:null,itemName:null,
tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,trackBy:null,trackByWatcher:null,animateMove:!1,animate:!1,trackByFn:null,griDelegate:null,tagMode:!1,queue:null,buffered:!1,bufferPlugin:null,$constructor:function(b,a,c){b=ba(a,b);this.tagMode="mjs-each"==a.nodeName.toLowerCase();this.animateMove=!this.tagMode&&!b.buffered&&b.animateMove&&ea.cssAnimationSupported();this.animate=!this.tagMode&&!b.buffered&&(null!==z(a,"mjs-animate")||b.animate);this.id=b.id||ca();a.removeAttribute("mjs-animate");
this.animate&&this.animateMove&&this.$plugins.push("plugin.ListAnimatedMove");b.observable&&this.$plugins.push("plugin.Observable");this.tagMode&&(b.buffered=!1);b.buffered&&(this.buffered=!0,this.$plugins.push("plugin.ListBuffered"))},$init:function(b,a,c){a.removeAttribute("mjs-include");this.tagMode&&(c=z(a,"value"));this.parseExpr(c);this.tpl=this.tagMode?na(a.childNodes):a;this.renderers=[];this.prevEl=a.previousSibling;this.nextEl=a.nextSibling;this.parentEl=a.parentNode;this.node=null;this.scope=
b;this.queue=new ma({async:!1,auto:!0,thenable:!0,stack:!1,context:this,mode:ma.ONCE});this.parentEl.removeChild(a);this.afterInit(b,a);this.queue.add(this.render,this,[ga(this.watcher.getLastResult())])},afterInit:function(b,a){var c=ba(a,b);this.watcher=qa(b,this.model,this.onChange,this,null,V);(this.trackBy=c.trackBy)&&"$"!=this.trackBy?this.trackByWatcher=qa(b,this.trackBy,this.onChangeTrackBy,this,null,V):"$"==this.trackBy||this.watcher.hasInputPipes()||(this.trackBy="$$"+this.watcher.id);this.griDelegate=
A(this.scopeGetRawIndex,this)},trigger:M,render:function(b){var a=this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,f=this.buffered,h=window.document.createDocumentFragment(),k,p,m;p=0;for(m=b.length;p<m;p++)k=c.cloneNode(!0),a.push(this.createItem(k,b,p)),f||(h.appendChild(k),a[p].attached=!0);f?(this.bufferPlugin.getScrollOffset(),this.bufferPlugin.updateScrollBuffer()):(d.insertBefore(h,e),this.doUpdate());this.trigger("render",this)},doUpdate:function(b,a,c,d){var e=this.renderers;b=b||
0;var f=e.length;a=a||f-1;var h=this.watcher.getLastResult(),k=this.getTrackByFunction();for(a>f-1&&(a=f-1);b<=a;b++)c&&e[b].action!=c||this.renderItem(b,e,h,k,d)},renderItem:function(b,a,c,d,e){c=c||this.watcher.getLastResult();a=a||this.renderers;d=d||this.getTrackByFunction();var f=a[b],h=f.scope;a=a.length-1;var k=!(b%2);e&&f.rendered||(h.$index=b,h.$first=0===b,h.$last=b===a,h.$even=k,h.$odd=!k,h.$trackId=d(c[b]),h.$getRawIndex=this.griDelegate,f.renderer?h.$check():(f.renderer=new Za(f.el,h),
f.renderer.process(),f.rendered=!0))},createItem:function(b,a,c){var d=this.itemName,e=this.scope.$new(),f=this.tagMode;e[d]=this.getListItem(a,c);b=f?ga(b.childNodes):b;return{index:c,action:"enter",el:b,firstEl:f?b[0]:b,lastEl:f?b[b.length-1]:b,scope:e,attached:!1,rendered:!1}},onChange:function(b,a){this.queue.prepend(this.applyChanges,this,[a],ma.REPLACE)},applyChanges:function(b){var a=this,c=a.renderers,d=a.tpl,e=0,f=ga(a.watcher.getLastResult()),h=null,k=a.animateMove,p=a.animate,m=[],u=a.itemName,
r=c.slice(),s=!1,t,n,q,v,l,O;b=a.watcher.getMovePrescription(b,a.getTrackByFunction(),f);q=0;for(v=b.length;q<v;q++)t=b[q],1===fa(t)?(n=t,t=c[n],n!=e&&null===h&&(h=q),t.action="move",t.scope[u]=a.getListItem(f,q),s=k,m.push(t),c[n]=null,e++):(null===h&&(h=q),l=a.createItem(d.cloneNode(!0),f,q),m.push(l));a.renderers=m;if(p){a.doUpdate(h,null,"enter");s&&(O=a.calculateTranslates(m,r,c));var d=[],w=new N,C=new N,y=new N,x=N.counter(m.length),e=function(){x.countdown();return w};q=0;for(v=c.length;q<
v;q++)if(l=c[q])l.scope.$destroy(),Da(l.el),d.push(ea(l.el,"leave",null,!1,V).done(function(a){a.style.visibility="hidden"}));q=0;for(v=m.length;q<v;q++)l=m[q],Da(l.el),"enter"==l.action?d.push(ea(l.el,"enter",e,!1,V)):d.push(a.moveAnimation(l.el,s?O[q][0]:null,s?O[q][1]:null,e,C));x.done(function(){Y(function(){C.resolve();a.applyDomPositions(c);s||a.doUpdate(h,null,"move");Y(function(){w.resolve()});a.trigger("change",a)})});N.all(d).always(function(){Y(function(){var b=Ja();a.doUpdate(h||0);a.removeOldElements(c);
if(s)for(a.doUpdate(h,null,"move"),q=0,v=m.length;q<v;q++)l=m[q],l.el.style[b.transform]=null,l.el.style[b.transform]="";y.resolve()})});return y}a.buffered?(a.bufferPlugin.getScrollOffset(),a.removeOldElements(c),a.queue.append(a.bufferPlugin.updateScrollBuffer,a.bufferPlugin,[!0])):(a.applyDomPositions(),a.doUpdate(h||0),a.removeOldElements(c));a.trigger("change",a)},removeOldElements:function(b){var a,c,d,e,f,h=this.parentEl;a=0;for(c=b.length;a<c;a++)if((d=b[a])&&d.attached)if(d.attached=!1,self.tagMode)for(e=
0,f=d.el.length;e<f;e++)h.removeChild(d.el[e]);else h.removeChild(d.el)},applyDomPositions:function(b){var a=this.renderers,c=this.parentEl,d=this.prevEl,e=this.tagMode,d=d?d.nextSibling:c.firstChild,f,h,k,p,m;h=0;for(k=a.length;h<k;h++)m=a[h],p=m.el,f=b&&b[h]?b[h].lastEl.nextSibling:0<h?a[h-1].lastEl.nextSibling||d:d,m.firstEl!==f&&(f&&m.lastEl.nextSibling!==f?c.insertBefore(e?na(p):p,f):f||c.appendChild(e?na(p):p)),m.attached=!0},getListItem:function(b,a){return b[a]},onChangeTrackBy:function(b){this.trackByFn=
null;this.trackBy=b},getTrackByFunction:function(){var b;this.trackByFn||((b=this.trackBy)&&"$"!=b?E(b)?this.trackByFn=b:this.trackByFn=function(a){return a&&!xa(a)?a[b]:void 0}:this.trackByFn=function(a){return xa(a)?a:void 0});return this.trackByFn},scopeGetRawIndex:function(b){if(void 0===b)return-1;var a=this.watcher.getUnfilteredValue(),c=this.getTrackByFunction(),d,e;d=0;for(e=a.length;d<e;d++)if(c(a[d])===b)return d;return-1},getNodePositions:function(b,a,c){return{}},calculateTranslates:function(b,
a,c){return[]},moveAnimation:function(b,a,c,d,e){return ea(b,"move",d,!1,V)},scrollTo:function(){},parseExpr:function(b){b=b.split(" ");var a,c,d,e,f;a=0;for(c=b.length;a<c;a++)if(f=b[a],""!=f&&"in"!=f)if(e){d=b.slice(a).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"},destroy:function(){var b=this.renderers,a,c;a=0;for(c=b.length;a<c;a++)b[a].renderer.$destroy();this.trackByWatcher&&this.trackByWatcher.unsubscribeAndDestroy();this.queue.destroy();this.watcher.unsubscribeAndDestroy(this.onChange,
this)}},{$stopRenderer:!0,$registerBy:"id"}),cc=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,Ka=function(b){var a=b.match(cc)||[],c=("undefined"!=typeof window?window.location:null)||{};return{protocol:a[4]||c.protocol||"http:",hostname:a[11]||c.hostname||"",host:(a[11]||"")+(a[12]?":"+a[12]:"")||c.host||"",username:a[8]||c.username||"",password:a[9]||c.password||"",
port:parseInt(a[12],10)||c.port||"",href:b,path:(a[13]||"/")+(a[16]||""),pathname:a[13]||"/",search:a[16]||"",hash:a[17]&&"#"!=a[17]?a[17]:""}},ob=function(b,a){var c="";a=a||{};a.onlyPath||(c+=b.protocol+"//",b.username&&b.password&&(c+=b.username+":"+b.password+"@"),c+=b.hostname,b.hostname&&b.port&&(c+=":"+b.port));a.onlyHost||(c+=b.pathname||"/",b.search&&"?"!=b.search&&(c+=b.search),b.hash&&"#"!=b.hash&&(c+=b.hash));return c},ab=function(){var b,a,c,d=new ha,e={},f,h,k="undefined"==typeof window,
p=null,m,u,r;d.createEvent("beforeLocationChange",!1);var s=function(a,b){"string"==typeof a&&(a=Ka(a));"string"==typeof b&&(b=Ka(b));var c=["protocol","host","port"],d,e,f;d=0;for(e=c.length;d<e;d++)if(f=c[d],a[f]&&b[f]&&a[f]!=b[f])return!0;return!1},t=function(a,b){"string"==typeof a&&(a=Ka(a));"string"==typeof b&&(b=Ka(b));return s(a,b)||a.pathname!=b.pathname||a.search!=b.search||a.hash!=b.hash},n=function(a){a=Ka(a);if(!m||r)a.hash="#!"+encodeURIComponent(a.path),a.pathname="/",a.search="";return ob(a,
{onlyPath:!0})},q=function(a){c.hash=a?"!"+a:""},v=function(){var a,b;m?a=ob(c):(a=c.hash.substr(1),b=y({},c,!0,!1),a&&("!"==a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a).split("?"),b.pathname=a[0],b.search=a[1]?"?"+a[1]:""),a=ob(b));return a},l=function(a,b){var c=e[a].extractor;return E(c)?c(b,a):(c=b.match(c))?c.pop():null},O=function(a){var b,c,f;for(b in e)c=e[b].value,f=l(b,a),e[b].value=f,f!=c&&d.trigger("change-"+b,f,c,b,a)},w=function(a){p=y({},c,!0,!1);da("locationChange",a);O(a)},
C=function(){if(t(p,c)){var a=v();p=y({},c,!0,!1);da("locationChange",a);O(a)}},da=function(a,b){var c=b||v();return d.trigger(a,c)},x=function(){b=window;a=b.history;c=b.location;m=!!a.pushState;u="onhashchange"in b;r=m&&(navigator.vendor||"").match(/Opera/);p=y({},c,!0,!1);if(m)I(b,"popstate",C),f=function(b){if(!1===da("beforeLocationChange",b))return!1;a.pushState(null,null,n(b));w(b)},h=function(b){if(!1===da("beforeLocationChange",b))return!1;a.replaceState(null,null,n(b));w(b)};else if(u)h=
f=function(a){if(!1===da("beforeLocationChange",a))return!1;pa(q,null,[n(a)])},I(b,"hashchange",C);else{var d=null,e=!1;b.onIframeHistoryChange=function(a){e||pa(function(){q(a);C()})};var l=function(a){var b=d.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');b.close()};f=function(a){if(!1===da("beforeLocationChange",
a))return!1;l(n(a))};h=function(a){if(!1===da("beforeLocationChange",a))return!1;a=n(a);d.contentWindow.hashValue=a};var v=function(){d=window.document.createElement("iframe");d.src="about:blank";d.style.display="none";window.document.body.appendChild(d);e=!0;l(n(c.hash.substr(1)));e=!1};k?v():I(b,"load",v)}I(window.document.documentElement,"click",function(a){a=aa(a||b.event);for(var d=a.target,e;d&&"a"!=d.nodeName.toLowerCase();)d=d.parentNode;if(d&&!a.isDefaultPrevented()){e=z(d,"href");if("#"==
e)return a.preventDefault(),a.stopPropagation(),!1;if(e&&"#"!=e.substr(0,1)&&!z(d,"target")){var d=y({},c,!0,!1),n=Ka(e);if(s(d,n))return null;t(d,n)&&f(e);a.preventDefault();a.stopPropagation();return!1}}return null});x=M};I(window,"load",function(){k=!0});return y({},d.getApi(),{push:function(b){x();a.pushState(null,null,b)},replace:function(b){x();a.replaceState(null,null,b)},current:function(){x();return v()},init:function(){return x()},polyfill:function(){x();window.history.pushState=function(a,
b,c){f(c)};window.history.replaceState=function(a,b,c){h(c)}},getParam:function(a){return e[a]?e[a].value:null},addParam:function(a,b){x();e[a]||(b?E(b)||(b=B(b)?Oa(b):b):b=Oa(a+"=([^&]+)"),e[a]={name:a,value:null,extractor:b},e[a].value=l(a,v()))}})}(),dc=ab.current;P({$class:"View",route:null,node:null,scope:null,cmp:null,id:null,currentViewId:null,currentComponent:null,cmpCache:null,domCache:null,currentView:null,watchable:null,defaultCmp:null,currentCls:null,currentHtmlCls:null,$init:function(b){y(this,
b,!0,!1);b=this.node;var a=ba(b,this.scope);y(this,a,!0,!1);b&&b.firstChild&&H(b,"mjs-transclude",na(b.childNodes));this.id||(this.id=ca());this.cmpCache={};this.domCache={};this.initView();this.scope.$app.registerCmp(this,this.scope,"id");this.route?(ab.init(),ab.on("locationChange",this.onLocationChange,this),this.initRouteIds(),this.onLocationChange()):this.cmp&&(this.watchable=qa(this.scope,this.cmp,this.onCmpChange,this,null,V),this.onCmpChange())},initView:function(){},initRouteIds:function(){var b=
this.route,a,c;a=0;for(c=b.length;a<c;a++)b[a].id=b[a].id||ca()},onCmpChange:function(){var b=this.watchable.getLastResult()||this.defaultCmp;this.clearComponent();b&&this.setComponent(b)},onLocationChange:function(){var b=dc(),a=this.route,c=this.currentView||{},d,e,f,h,k;e=0;for(f=a.length;e<f;e++){h=a[e];if(h.reg&&(k=b.match(h.reg))){this.changeRouteComponent(h,k);return}h["default"]&&!d&&(d=h)}d?d.id!=c.id&&(this.clearComponent(),this.setRouteClasses(d),this.setRouteComponent(d,[])):this.defaultCmp&&
(this.clearComponent(),this.currentView=null,this.setComponent(this.defaultCmp))},changeRouteComponent:function(b,a){b.id!=(this.currentView||{}).id&&(Da(this.node),this.clearComponent(),this.setRouteClasses(b),this.setRouteComponent(b,a))},setRouteClasses:function(b){b.cls&&(this.currentCls=b.cls,L(this.node,b.cls));b.htmlCls&&(this.currentHtmlCls=b.htmlCls,L(window.document.documentElement,b.htmlCls))},clearComponent:function(){var b=this,a=b.node,c=b.currentView||{};b.currentCls&&R(b.node,b.currentCls);
b.currentHtmlCls&&R(window.document.documentElement,b.currentHtmlCls);b.currentComponent&&ea(a,"leave",null,!0).done(function(){if(c.keepAlive)for(var d=b.domCache[c.id];a.firstChild;)d.appendChild(a.firstChild);else for(b.currentComponent.destroy();a.firstChild;)a.removeChild(a.firstChild);b.currentComponent=null})},setRouteComponent:function(b,a){var c=this,d=c.node,e=b.params;c.currentView=b;ea(d,"enter",function(){var f=a||[],h={destroyEl:!1,node:d,scope:b.$isolateScope?c.scope.$newIsolated():
c.scope.$new()},k,p;b.as&&(h.as=b.as);b.template&&(h.template=b.template);f.shift();if(e)for(k=-1,p=e.length;++k<p;h[e[k]]=f[k]);if(c.cmpCache[b.id])c.currentComponent=c.cmpCache[b.id],d.appendChild(c.domCache[b.id]);else return Ra(b.cmp||"MetaphorJs.Component",h,h.scope,d,null,f).done(function(a){c.currentComponent=a;b.keepAlive&&(c.cmpCache[b.id]=a,c.domCache[b.id]=window.document.createDocumentFragment())})},!0)},setComponent:function(b){var a=this,c=a.node;ea(c,"enter",function(){var d=Ea(b)?
b:{},e=(B(b)?b:null)||"MetaphorJs.Component",f=d.scope||a.scope.$new();d.destroyEl=!1;return Ra(e,d,f,c).done(function(b){a.currentComponent=b})},!0)},destroy:function(){this.clearComponent();this.route&&(ab.un("locationchange",this.onLocationChange,this),this.route=null);this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),this.watchable=null);this.currentComponent=this.scope=null;this.$super()}});D.registerAttribute("mjs-app",100,ya);var wa=function(){var b=/\r/,a={option:function(a){var b=
a.getAttribute("value")||a.value;return void 0!=b?b:X(a.innerText||a.textContent)},select:function(a){for(var b,e=a.options,f=a.selectedIndex,h=(a="select-one"===a.type||0>f)?null:[],k=a?f+1:e.length,p,m=0>f?k:a?f:0;m<k;m++)if(b=e[m],p=b.disabled||b.parentNode.disabled,(b.selected||m===f)&&!p){b=wa(b);if(a)return b;h.push(b)}return h},radio:function(a){return eb(a.getAttribute("value"))?"on":a.value},checkbox:function(a){return eb(a.getAttribute("value"))?"on":a.value}};return function(c){var d,e;
if((d=a[c.type]||a[c.nodeName.toLowerCase()])&&void 0!==(e=d(c,"value")))return e;e=c.value;return B(e)?e.replace(b,""):null==e?"":e}}(),pb=function(){var b={select:function(a,b){for(var d,e,f=a.options,h=ga(b),k=f.length,p,m=-1;k--;)e=f[k],(p=h?-1!=Ya.call(h,e.value):!1)?(e.setAttribute("selected","selected"),d=e.selected=!0):e.removeAttribute("selected"),p||eb(z(e,"mjs-default-option"))||(m=k);d||(a.selectedIndex=m);return h}};b.radio=b.checkbox=function(a,b){if(K(b)){var d;d=wa(a);d=b?-1!=Ya.call(b,
d):!1;return a.checked=d}};return function(a,c){if(1===a.nodeType){null===c?c="":1===fa(c)&&(c+="");var d=b[a.type]||b[a.nodeName.toLowerCase()];d&&void 0!==d(a,c,"value")||(a.value=c)}}}(),Z=function(){var b=null,a=null;return function(c,d,e){null===b&&(b=c.detachEvent?"detachEvent":"removeEventListener",a=c.detachEvent?"on":"");c[b](a+d,e)}}(),ec=function(){var b=null;return function(){null===b&&(b=parseInt((/android (\d+)/i.exec(navigator.userAgent)||[])[1],10)||!1);return b}}(),bb=function(){var b;
return function(){if(null===b){var a=navigator.userAgent;b=parseInt((/msie (\d+)/i.exec(a)||[])[1],10);isNaN(b)&&(b=parseInt((/trident\/.*; rv:(\d+)/i.exec(a)||[])[1],10)||!1)}return b}}(),Fb=function(){var b={};return function(a){if(void 0===b[a]){if("input"==a&&9==bb())return b[a]=!1;var c=window.document.createElement("div");b[a]=!!("on"+a in c)}return b[a]}}(),sa=function(b,a,c){if(b.$$input){if(a)b.$$input.on("change",a,c);return b.$$input}var d=ba(b);this.observable=new ha;this.el=b;this.inputType=
b.type.toLowerCase();this.dataType=d.type||this.inputType;this.listeners=[];if(a)this.onChange(a,c)};y(sa.prototype,{el:null,inputType:null,dataType:null,listeners:null,radio:null,keydownDelegate:null,changeInitialized:!1,destroy:function(){var b;this.observable.destroy();this._addOrRemoveListeners(Z,!0);this.el.$$input=null;for(b in this)this.hasOwnProperty(b)&&(this[b]=null)},_addOrRemoveListeners:function(b,a){var c=this.inputType,d=this.listeners,e=this.radio,f=this.el,h,k,p,m;k=0;for(p=d.length;k<
p;k++)if(h=!!d[k][2],h==a){if("radio"==c)for(h=0,m=e.length;h<m;h++)b(e[h],d[k][0],d[k][1]);else b(f,d[k][0],d[k][1]);d[k][2]=!a}},initInputChange:function(){var b=this.inputType;"radio"==b?this.initRadioInput():"checkbox"==b?this.initCheckboxInput():this.initTextInput();this._addOrRemoveListeners(I,!1);this.changeInitialized=!0},initRadioInput:function(){var b=this.el,a=b.name;if(Ta(b))b=b.ownerDocument;else for(;b.parentNode;)b=b.parentNode;this.radio=U("input[name="+a+"]",b);this.onRadioInputChangeDelegate=
A(this.onRadioInputChange,this);this.listeners.push(["click",this.onRadioInputChangeDelegate,!1])},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=A(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate,!1])},initTextInput:function(){var b=!1,a=this,c=a.listeners,d;ec()||(c.push(["compositionstart",function(){b=!0},!1]),c.push(["compositionend",function(){b=!1;e()},!1]));var e=a.onTextInputChangeDelegate=function(){if(!b)a.onTextInputChange()},
f=function(a){d||(d=setTimeout(function(){e(a);d=null},0))},h=function(a){a=a||window.event;var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||f(a)};Fb("input")?c.push(["input",e,!1]):(c.push(["keydown",h,!1]),Fb("paste")&&(c.push(["paste",f,!1]),c.push(["cut",f,!1])));c.push(["change",e,!1])},processValue:function(b){switch(this.dataType){case "number":b=parseInt(b,10);isNaN(b)&&(b=0);break;case "bool":case "boolean":return!("false"===b||"0"===b||0===b||"off"===b||!1===b||""===b)}return b},onTextInputChange:function(){var b=
this.getValue();this.observable.trigger("change",this.processValue(b))},onCheckboxInputChange:function(){var b=this.el;this.observable.trigger("change",this.processValue(b.checked?z(b,"value")||!0:!1))},onRadioInputChange:function(b){b=b||window.event;this.observable.trigger("change",this.processValue((b.target||b.srcElement).value))},setValue:function(b){var a=this.inputType,c,d;b=this.processValue(b);if("radio"==a)for(a=this.radio,c=0,d=a.length;c<d;c++)a[c].checked=this.processValue(a[c].value)==
b;else"checkbox"==a?(a=this.el,a.checked=!0===b||b==this.processValue(a.value)):pb(this.el,b)},getValue:function(){var b=this.inputType,a,c;if("radio"==b){b=this.radio;a=0;for(c=b.length;a<c;a++)if(b[a].checked)return this.processValue(b[a].value);return null}return"checkbox"==b?this.processValue(this.el.checked?z(this.el,"value")||!0:!1):this.processValue(wa(this.el))},onChange:function(b,a){this.changeInitialized||this.initInputChange();this.observable.on("change",b,a)},unChange:function(b,a){this.observable.un("change",
b,a)},onKey:function(b,a,c){this.keydownDelegate||(this.keydownDelegate=A(this.keyHandler,this),this.listeners.push(["keydown",this.keydownDelegate,!1]),I(this.el,"keydown",this.keydownDelegate),this.observable.createEvent("key",!1,!1,this.keyEventFilter));this.observable.on("key",a,c,{key:b})},unKey:function(b,a,c){this.observable.un("key",a,c)},keyEventFilter:function(b,a){var c=b.key,d=a[0];return"object"!=typeof c?c==d.keyCode:void 0!==c.ctrlKey&&c.ctrlKey!=d.ctrlKey||void 0!==c.shiftKey&&c.shiftKey!=
d.shiftKey?!1:!(void 0!==c.keyCode&&c.keyCode!=d.keyCode)},keyHandler:function(b){b=aa(b||window.event);this.observable.trigger("key",b)}},!0,!1);sa.get=function(b){return b.$$input?b.$$input:new sa(b)};sa.getValue=wa;sa.setValue=pb;D.registerAttribute("mjs-bind",1E3,P({$extends:D,isInput:!1,input:null,lockInput:null,recursive:!1,textRenderer:null,$init:function(b,a,c){var d=ba(a,b);this.isInput=fb(a);this.recursive=d.recursive||null!==z(a,"mjs-recursive");this.lockInput=d.lockInput;a.removeAttribute("mjs-recursive");
this.isInput&&(this.input=new sa(a,this.onInputChange,this));this.recursive?(this.scope=b,this.node=a,this.textRenderer=new Cb(b,"{{"+c+"}}",null,null,!0),this.textRenderer.subscribe(this.onTextRendererChange,this),this.onTextRendererChange(),b instanceof ra&&b.$on("destroy",this.onScopeDestroy,this)):this.$super(b,a,c)},onInputChange:function(){if(this.lockInput)this.onChange()},onTextRendererChange:function(){this.updateElement(this.textRenderer.getString())},onChange:function(){var b=this.watcher.getLastResult();
this.updateElement(b)},updateElement:function(b){this.isInput?this.input.setValue(b):this.node["string"==typeof this.node.textContent?"textContent":"innerText"]=b},destroy:function(){this.textRenderer&&(this.textRenderer.$destroy(),this.textRenderer=null);this.input&&(this.input.destroy(),this.input=null);this.$super()}}));D.registerAttribute("mjs-bind-html",1E3,P({$extends:"attr.mjs-bind",updateElement:function(b){this.node.innerHTML=b}}));D.registerAttribute("mjs-break-if",500,function(b,a,c){(b=
!!la(c)(b))&&a.parentNode.removeChild(a);return!b});(function(){var b=function(a,b,e,f){if(null!==e){if(e==Pa(a,b))return;e=!e}else e=Pa(a,b);e?f?ea(a,[b+"-remove"],null,!0).done(function(){R(a,b)}):R(a,b):f?ea(a,[b+"-add"],null,!0).done(function(){L(a,b)}):L(a,b)},a=function(a){var b={},e,f,h;if(!a)return b;if(B(a))b[a]=!0;else if(K(a))for(e=-1,h=a.length;++e<h;b[a[e]]=!0);else for(e in a)if("_"==e)for(f=-1,h=a._.length;++f<h;b[a._[f]]=!0);else b[e]=a[e];return b};D.registerAttribute("mjs-class",
1E3,P({$extends:D,initial:!0,onChange:function(){var c=this.node,d=a(this.watcher.getLastResult()),e=a(this.watcher.getPrevValue()),f;Da(c);for(f in e)e.hasOwnProperty(f)&&void 0===d[f]&&b(c,f,!1,!1);for(f in d)d.hasOwnProperty(f)&&b(c,f,d[f]?!0:!1,!this.initial);this.initial=!1}}))})();D.registerAttribute("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(b,a,c){b&&(b[c]=a)}]);(function(){var b=function(a,b,d,e){var f,h,k,p,m,u=ba(b,a);d=d.split(" ");k=0;for(p=d.length;k<p;k++)m=d[k],
""!=m&&"as"!=m&&(f?h=m:f=m);d=za(f,!0);k=u.sameScope||d.$sameScope;a=u.isolateScope||d.$isolateScope?a.$newIsolated():k?a:a.$new();e=y({scope:a,node:b,as:h,parentRenderer:e,destroyScope:!0},u,!1,!1);Ra(f,e,a,b);return!!d.$shadow};b.$breakScope=!1;D.registerAttribute("mjs-cmp",200,b)})();D.registerAttribute("mjs-config",50,function(b,a,c){ba(a,b,c)});D.registerAttribute("mjs-each",100,nb);var va=function(b,a,c){if(window.getComputedStyle){if(b===window)return a?c?0:null:{};b=getComputedStyle(b,null)}else b=
b.currentStyle||b.style||{};a=a?b[a]:b;return c?parseFloat(a)||0:a},fc=function(){var b;return function(){if(void 0===b){var a=window.document,c=a.createElement("div"),d=a.createElement("div"),a=a.body;d.style&&window.getComputedStyle?(c.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",c.appendChild(d),d.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",
d.innerHTML="",a.appendChild(c),d="4px"===window.getComputedStyle(d,null).width,a.removeChild(c),b=d):b=!1}return b}}(),cb=function(b,a){var c=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,d=["Top","Right","Bottom","Left"],e=b?"inner"==b?"padding":"":"content";return function(b,h){if(b===window)return b.document.documentElement["client"+a];if(9===b.nodeType){var k=b.documentElement;return Math.max(b.body["scroll"+a],k["scroll"+a],b.body["offset"+a],k["offset"+a],k["client"+a])}a:{var p=a.toLowerCase(),
m=e||(!0===h?"margin":"border"),k=va(b),u=!0,r="width"===p?b.offsetWidth:b.offsetHeight,s="border-box"===k.boxSizing;if(0>=r||null==r){r=b.style[p];if(c.test(r)){k=r;break a}u=s&&(fc()||r===b.style[p]);r=parseFloat(r)||0}m=m||(s?"border":"content");p=m===(u?"border":"content")?4:"width"===p?1:0;for(s=0;4>p;p+=2)"margin"===m&&(s+=parseFloat(k[m+d[p]])),u?("content"===m&&(s-=parseFloat(k["padding"+d[p]])),"margin"!==m&&(s-=parseFloat(k["border"+d[p]+"Width"]))):(s+=parseFloat(k["padding"+d[p]]),"padding"!==
m&&(s+=parseFloat(k["border"+d[p]+"Width"])));k=r+s}return k}},Gb=cb("","Width"),Hb=cb("","Height"),Ib=function(b){var a,c=b?"pageYOffset":"pageXOffset",d=b?"scrollTop":"scrollLeft";b=window.document;var e=b.body,f=b.documentElement;a=void 0!==window[c]?function(){return window[c]}:f.clientHeight?function(){return f[d]}:function(){return e[d]};return function(b){return b&&b!==window?b&&1==b.nodeType&&b!==e&&b!==f?b[d]:a():a()}},Aa=Ib(!0),Ba=Ib(!1),gc=function(){var b=P({queue:null,observable:null,
handlerDelegate:null,triggerDelegate:null,watchers:null,breaks:null,running:!1,lastEvent:null,currentEvent:null,interval:null,$init:function(a,b,d){var e="$$"+b+"_"+d;if(a[e])return a[e];a[e]=this;this.breaks={};this.watchers={};this.node=a;this.event=b;this.observable=new ha;this.interval=d||0;this.handlerDelegate=A(this.handler,this);this.triggerDelegate=A(this.trigger,this);this.up()},handler:function(a){this.running?a&&(this.lastEvent=a):this.next(a)},next:function(a){var b=this.interval;if(a=
a||this.lastEvent)this.lastEvent=null,this.running=!0,this.currentEvent=a,"raf"==b?Y(this.triggerDelegate):setTimeout(this.triggerDelegate,b)},watchWidth:function(){this.addWatcher("width",Gb)},watchHeight:function(){this.addWatcher("width",Hb)},watchScrollTop:function(){this.addWatcher("scrollTop",Aa)},watchScrollLeft:function(){this.addWatcher("scrollLeft",Ba)},addWatcher:function(a,b,d){this.watchers[a]={fn:b,context:d,prev:null,current:parseInt(b.call(d,this.node),10)}},removeWatcher:function(a){delete this.watchers[a]},
breakFilter:function(a,b,d){a=a.breakValue;var e=this.watchers[d.watcher];d=e.current;var f=e.prev,e=Math.min(f,d),f=Math.max(f,d);b[0].breakPosition=d<a?-1:1;return e<=a&&a<=f},onBreak:function(a,b,d,e,f){var h=a+"_"+b;f=f||{};f.breakValue=b;this.breaks[h]||(this.breaks[h]=this.observable.createEvent(h,{watcher:a,triggerFilter:this.breakFilter,filterContext:this}));this.breaks[h].on(d,e,f)},unBreak:function(a,b,d,e,f){a=a+"_"+b;this.breaks[a]&&(this.breaks[a].un(d,e),this.breaks[a].hasListener()||
(this.breaks[a].destroy(),delete this.breaks[a]));f&&this.destroyIfIdle()},on:function(a,b){this.observable.on(this.event,a,b)},un:function(a,b,d){this.observable.un(this.event,a,b);d&&this.destroyIfIdle()},trigger:function(){var a=this.currentEvent,b=this.watchers,d=this.breaks,e=this.node,f,h;this.observable.trigger(this.event,a);for(f in b)b[f].prev=b[f].current,b[f].current=parseInt(b[f].fn.call(b[f].context,e,a),10);for(h in d)d[h].trigger(a);this.running=!1;this.currentEvent=null;this.next()},
up:function(){I(this.node,this.event,this.handlerDelegate)},down:function(){Z(this.node,this.event,this.handlerDelegate)},destroyIfIdle:function(){if(!this.observable.hasListener())return this.$destroy(),!0},destroy:function(){this.down();this.observable.destroy();this.queue.destroy()}},{get:function(a,c,d){var e="$$"+c+"_"+d;return a[e]?a[e]:a[e]=new b(a,c,d)}});return b}(),Jb=P({cfg:null,scope:null,node:null,listeners:null,event:null,buffers:null,$init:function(b,a,c,d,e){this.event=d;e=e||{};c=
c||{};"string"==typeof c&&(d=c.substr(0,1),"{"==d?(this.watcher=qa(b,c,this.onConfigChange,this),c=this.watcher.getLastResult()):"="==d?(c=c.substr(1),this.watcher=qa(b,c,this.onConfigChange,this),c=this.watcher.getLastResult()):c={handler:la(c)});this.prepareConfig(c,e);this.buffers={};this.listeners=[];this.scope=b;this.node=a;this.up()},prepareConfig:function(b,a){var c,d=this.event;if(b.event){c={};var d=b.event.split(","),e,f;delete b.event;e=0;for(f=d.length;e<f;e++)c[X(d[e])]=b;b=c}else d&&
(c={},c[d]=b,b=c);y(b,a,!1,!1);this.cfg=b},onConfigChange:function(b){this.down();this.prepareConfig(b);this.up()},createHandler:function(b,a){return function(c){var d,e=!0,f=!1,h=!1;void 0!==b.preventDefault&&(e=b.preventDefault);void 0!==b.stopPropagation&&(h=b.stopPropagation);void 0!==b.returnValue&&(f=b.returnValue);void 0!==b.keyCode&&(d=b.keyCode);c=aa(c||window.event);if(d&&("number"==typeof d&&d!=c.keyCode||-1==d.indexOf(c.keyCode)))return null;a.$event=c;b.handler&&b.handler.call(b.context||
null,a);a.$event=null;a.$root.$check();h&&c.stopPropagation();e&&c.preventDefault();return f}},up:function(){var b=this.cfg,a=this.listeners,c=this.buffers,d=this.node,e=this.scope,f=b.buffer,h,k;for(k in b)if(void 0===b.if||b.if)h=this.createHandler(b[k],e),a.push([k,h]),f?c[k]||(c[k]=gc.get(d,k,f),c[k].on(h)):I(d,k,h)},down:function(){var b=this.listeners,a=this.buffers,c=this.node,d=this.cfg.buffer,e,f,h,k;h=0;for(k=b.length;h<k;h++)e=b[h][0],f=b[h][1],d?(a[e].un(f),!0===a[e].destroyIfIdle()&&
delete a[e]):Z(c,e,f);this.listeners=[]},destroy:function(){this.down();this.watcher&&this.watcher.unsubscribeAndDestroy(this.onConfigChange,this)}});(function(){D.registerAttribute("mjs-event",1E3,function(b,a,c){var d=new Jb(b,a,c);return function(){d.$destroy();d=null}})})();(function(){var b="click dblclick mousedown mouseup mouseover mouseout mousemove keydown keyup keypress submit focus blur copy cut paste mousewheel touchstart touchend touchcancel touchleave touchmove".split(" "),a,c;a=0;for(c=
b.length;a<c;a++)(function(a){D.registerAttribute("mjs-"+a,1E3,function(b,c,h){var k=new Jb(b,c,h,a,{stopPropagation:!0});return function(){k.$destroy();k=null}})})(b[a]);b=null})();D.registerAttribute("mjs-show",500,P({$extends:D,initial:!0,display:"",$init:function(b,a,c){this.display=ba(a,b).display||"";this.$super(b,a,c)},runAnimation:function(b){var a=this,c=a.node.style,d=function(){c.display=b?a.display:"none"};a.initial?d():ea(a.node,b?"show":"hide",function(){b&&(c.display=a.display)},!0).done(d)},
onChange:function(){var b=this.watcher.getLastResult();this.runAnimation(b);this.initial=!1}}));D.registerAttribute("mjs-hide",500,P({$extends:"attr.mjs-show",onChange:function(){var b=this.watcher.getLastResult();this.runAnimation(!b);this.initial=!1}}));D.registerAttribute("mjs-if",500,D.$extend({parentEl:null,prevEl:null,el:null,initial:!0,cfg:null,$init:function(b,a,c){this.parentEl=a.parentNode;this.prevEl=a.previousSibling;this.$super(b,a,c)},onScopeDestroy:function(){this.parentEl=this.prevEl=
null;this.$super()},onChange:function(){var b=this,a=b.watcher.getLastResult(),c=b.parentEl,d=b.node,e=function(){b.prevEl?c.insertBefore(d,b.prevEl?b.prevEl.nextSibling:null):c.appendChild(d)},f=function(){c.removeChild(d)};a?b.initial?e():ea(d,"enter",e,!0):d.parentNode&&(b.initial?f():ea(d,"leave",null,!0).done(f));b.initial?b.initial=!1:(b.cfg||(b.cfg=ba(d,b.scope)),b.cfg.ifOnce&&b.$destroy())}}));D.registerAttribute("mjs-ignore",0,ya);D.registerAttribute("mjs-include-file",900,function(b,a,c){b=
require("fs");a.innerHTML=b.readFileSync(c).toString()});D.registerAttribute("mjs-include",900,function(b,a,c,d){b=new Ga({scope:b,node:a,url:c,parentRenderer:d});return b.ownRenderer?!1:b.initPromise});var Kb=lb.createFunc;D.registerAttribute("mjs-init",250,function(b,a,c){Kb(c)(b)});D.registerAttribute("mjs-key",1E3,function(b,a,c){var d=la(c)(b),e=d.handler,f=d.context||b;delete d.handler;delete d.context;sa.get(a).onKey(d,e,f);return function(){sa.get(a).unKey(d,e,f)}});D.registerAttribute("mjs-model",
1E3,D.$extend({inProg:!1,input:null,binding:null,autoOnChange:!1,$init:function(b,a,c){var d=ba(a,b);this.node=a;this.input=sa.get(a);this.binding=d.binding||"both";this.input.onChange(this.onInputChange,this);this.$super(b,a,c);b=this.input.getValue();a=this.watcher.getLastResult();if(a!=b)if("input"!=this.binding&&void 0!=a)this.onChange(a);else if("scope"!=this.binding&&void 0!=b)this.onInputChange(b)},onInputChange:function(b){var a=this.scope;"scope"!=this.binding&&(b&&B(b)&&-1!=b.indexOf("\\{")&&
(b=b.replace(/\\{/g,"{")),this.watcher.getLastResult()!=b&&(this.watcher.setValue(b),this.inProg=!0,a instanceof ra?a.$root.$check():this.watcher.checkAll(),this.inProg=!1))},destroy:function(){this.input.destroy();this.$super()},onChange:function(){var b=this.watcher.getLastResult()||"",a;"input"==this.binding||this.inProg||((a=bb())&&8>a?pa(this.input.setValue,this.input,[b]):this.input.setValue(b))}}));D.registerAttribute("mjs-on",1E3,function(b,a,c){var d=la(c)(b),e=function(a){var c,e,p,m,u;
p=0;for(m=d.length;p<m;p++)c=d[p],e=c[0],(c=c[1])&&e&&(c[a]||c["$"+a])&&(u=c[a]||c["$"+a],u.call(c,e,b.$check,b))};e("on");return function(){e("un");d=null}});D.registerAttribute("mjs-options",100,P({$extends:D,model:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,$init:function(b,a,c){this.parseExpr(c);this.node=a;this.scope=b;for(this.defOption=a.options.length?a.options[0]:null;a.firstChild;)a.removeChild(a.firstChild);this.defOption&&this.defOption.setAttribute("mjs-default-option",
"");try{this.watcher=qa(b,this.model,this.onChange,this,null,V)}catch(d){ja(d)}this.render(ga(this.watcher.getValue()))},onChange:function(){this.render(ga(this.watcher.getValue()))},renderOption:function(b,a,c){var d=this.groupEl||this.fragment,e=bb();c.item=b;c.$index=a;b=this.getterFn(c);void 0!=b.group&&(b.group=""+b.group);b.group!==this.prevGroup&&(b.group?(this.groupEl=d=window.document.createElement("optgroup"),d.setAttribute("label",b.group),b.disabledGroup&&d.setAttribute("disabled","disabled"),
this.fragment.appendChild(d)):(d=this.fragment,this.groupEl=null));this.prevGroup=b.group;a=window.document.createElement("option");a.setAttribute("value",b.value);a.text=b.name;e&&9>e&&(a.innerHTML=b.name);b.disabled&&a.setAttribute("disabled","disabled");d.appendChild(a)},render:function(b){var a=this.node,c=wa(a),d=this.defOption,e=this.scope.$new(),f=bb(),h,k,p,m;this.fragment=window.document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;a.firstChild;)a.removeChild(a.firstChild);
p=0;for(m=b.length;p<m;p++)this.renderOption(b[p],p,e);d&&a.insertBefore(d,a.firstChild);e.$destroy();f&&8>f&&(k=a.nextSibling,h=a.parentNode,h.removeChild(a));a.appendChild(this.fragment);this.fragment=null;f&&8>f&&h.insertBefore(a,k);pb(a,c)},parseExpr:function(b){var a=b.indexOf(" in "),c;-1==a?(c=b,b="{name: .item, value: .$index}"):(c=b.substr(a+4),b=b.substr(0,a));this.model=c;this.getterFn=la(b)}}));(function(){var b="selected checked disabled readonly open required".split(" "),a,c,d=P({$extends:D,
propName:null,$init:function(a,b,c,d){this.propName=d;this.$super(a,b,c)},onChange:function(a){var b=this.propName;a?this.node.setAttribute(b,b):this.node.removeAttribute(b)}});a=0;for(c=b.length;a<c;a++)(function(a){D.registerAttribute("mjs-"+a,1E3,function(b,c,k){return new d(b,c,k,a)})})(b[a])})();var Lb=function(){var b={},a=0;return function(c){if(b[c])return N.resolve(c);1E3<a&&(b={},a=0);var d=window.document,e=d.createElement("img"),f=e.style,h=new N;I(e,"load",function(){b[c]=!0;a++;d.body.removeChild(e);
h.resolve(c)});f.position="absolute";f.visibility="hidden";f.left="-10000px";f.top="0";e.src=c;d.body.appendChild(e);return h}}();D.registerAttribute("mjs-src",1E3,P({$extends:D,queue:null,usePreload:!0,$constructor:function(b,a,c){var d=ba(a,b);d.deferred&&this.$plugins.push("plugin.SrcDeferred");d.preloadSize&&this.$plugins.push("plugin.SrcSize");if(d.srcPlugin){var d=d.srcPlugin.split(","),e,f;e=0;for(f=d.length;e<f;e++)this.$plugins.push(X(d[e]))}this.$super(b,a,c)},$init:function(b,a,c){ba(a,
b).noPreload?this.usePreload=!1:a.style.visibility="hidden";this.queue=new ma({auto:!0,async:!0,mode:ma.ONCE,thenable:!0});this.$super(b,a,c)},onChange:function(){this.queue.add(this.doChange,this)},doChange:function(){var b=this,a=b.watcher.getLastResult();if(b.usePreload)return Lb(a).done(function(){b&&b.node&&Y(function(){b.node.src=a;b.node.setAttribute("src",a);b.onSrcChanged();b.node.style.visibility=""})});b.node.src=a;b.node.setAttribute("src",a);b.onSrcChanged()},onSrcChanged:function(){},
destroy:function(){this.queue.destroy();this.$super()}}));D.registerAttribute("mjs-transclude",1E3,function(b,a){return vb(a)});D.registerAttribute("mjs-view",200,function(b,a,c){Ra(c||"MetaphorJs.View",{scope:b,node:a},b,a);return!1});D.registerTag("mjs-bind-html",function(b,a){var c=z(a,"value"),c=qa(b,c,null,null,null,V),d=c.getLastResult(),d=na(d),e=a.nextSibling,f=ga(d.childNodes);a.parentNode.insertBefore(d,e);a.parentNode.removeChild(a);c.unsubscribeAndDestroy();return f});D.registerTag("mjs-bind",
function(b,a){var c=z(a,"value"),c=la(c)(b),c=window.document.createTextNode(c);a.parentNode.insertBefore(c,a.nextSibling);a.parentNode.removeChild(a);return[c]});D.registerTag("mjs-each",nb);D.registerTag("mjs-if",function(b,a){var c=z(a,"value");if(la(c)(b)){var c=ga(a.childNodes),d=na(a.childNodes);a.parentNode.insertBefore(d,a.nextSibling);a.parentNode.removeChild(a);return c}a.parentNode.removeChild(a);return!1});D.registerTag("mjs-include",function(b,a,c,d){return(new Ga({scope:b,node:a,url:z(a,
"src"),parentRenderer:d,replace:!0})).initPromise});D.registerTag("mjs-tag",function(b,a){var c=z(a,"value");if(c=la(c)(b)){for(var c=window.document.createElement(c),d=a.nextSibling,e=sb(a),f;a.firstChild;)c.appendChild(a.firstChild);delete e.value;for(f in e)c.setAttribute(f,e[f]);a.parentNode.insertBefore(c,d);a.parentNode.removeChild(a);return[c]}a.parentNode.removeChild(a);return!1});D.registerTag("mjs-transclude",function(b,a){return vb(a,!0)});J("filter.collect",function(b,a,c){a=[];var d,
e,f;d=0;for(e=b.length;d<e;d++)f=b[d][c],void 0!=f&&a.push(f);return a});var Mb=function(){var b=function(a,b,c){if(E(b))return b(a,c);if(""===b||void 0===b)return!0;if(void 0!==a){if(Fa(a))return a===b;if(b instanceof RegExp)return b.test(""+a);if("strict"==c)return""+a===""+b;if(!0===c||null===c||void 0===c)return-1!=""+a.indexOf(b);if(!1===c)return-1==""+a.indexOf(b)}return!1},a=function(a,c,f){if(xa(a))return void 0===c.$?!0:b(a,c.$,f);var h,k;for(h in c)if("$"==h)for(k in a){if(b(a[k],c.$,f))return!0}else if(b(a[h],
c[h],f))return!0;return!1},c=function(b,c,f){ua(c)||(c={$:c});var h=[],k,p;k=-1;for(p=b.length;++k<p;)a(b[k],c,f)&&h.push(b[k]);return h};c.compare=a;return c}();J("filter.filter",function(b,a,c,d){return Mb(b,c,d)});J("filter.get",function(b,a,c){for(a=(""+c).split(".");c=a.shift();)if(b=b[c],void 0==b)return;return b});J("filter.join",function(b,a,c){c=c||", ";return b&&b.length?(K(b)||(b=ga(b)),b.join(c)):""});J("filter.l",function(b,a){return a.$app.lang.get(b)});J("filter.limitTo",function(b,
a,c){a=B(b);if(!K(b)&&!a)return b;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);if(a)return c?0<=c?b.slice(0,c):b.slice(c,b.length):"";a=[];var d;c>b.length?c=b.length:c<-b.length&&(c=-b.length);0<c?d=0:(d=b.length+c,c=b.length);for(;d<c;d++)a.push(b[d]);return a});J("filter.linkify",function(b,a,c){return b?b.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(c?' target="'+c+'"':"")+">$1</a>"):""});J("filter.lowercase",function(b){return b.toLowerCase()});
J("filter.map",function(b,a,c){var d=za(c,!0)||window[c]||la(c)(a);if(d)for(a=0,c=b.length;a<c;a++)b[a]=d(b[a]);return b});var hc={};J("filter.moment",function(b,a,c){c=hc[c]||c;return moment(b).format(c)});var ic={};J("filter.numeral",function(b,a,c){c=ic[c]||c;return numeral(b).format(c)});J("filter.offset",function(b,a,c){a=B(b);if(!K(b)&&!a)return b;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);return a?b.substr(c):b.slice(c)});J("filter.p",function(b,a,c){return a.$app.lang.plural(b,
parseInt(c,10)||0)});J("filter.preloaded",function(b,a){var c=Lb(b);if(c.isFulfilled())return!0;c.done(function(){a.$check()});return!1});J("filter.sortBy",function(b,a,c,d){return wb(b,c,d)});J("filter.split",function(b,a,c,d){d=d||void 0;c=c||"/\\n|,/";if(!b)return[];b=""+b;"/"==c.substr(0,1)&&"/"==c.substr(c.length-1)&&(c=Oa(c.substring(1,c.length-1)));b=b.split(c,d);a=-1;for(c=b.length;++a<c;b[a]=X(b[a]));return b});J("filter.toArray",function(b){if(ua(b)){var a=[],c;for(c in b)b.hasOwnProperty(c)&&
a.push({key:c,value:b[c]});return a}return ga(b)});J("filter.ucfirst",function(b){return b.substr(0,1).toUpperCase()+b.substr(1)});J("filter.uppercase",function(b){return b.toUpperCase()});(function(b,a){var c=b||window;if(!c)throw"Window object neither defined nor provided";Qb(function(){var b=U("[mjs-app]",c.document),e,f,h;e=-1;for(f=b.length;++e<f;)h=b[e],Rb(h,z(h,"mjs-app"),a,!0)},c)})();var db=Ia.factory,ta=function(){var b={},a={};return P({$class:"MetaphorJs.Model",type:null,fields:null,record:null,
store:null,plain:!1,lastAjaxResponse:null,$init:function(a){this.fields||(this.fields={});y(this,{record:{load:null,save:null,"delete":null,id:null,data:null,success:null,extra:{}},store:{load:null,save:null,"delete":null,id:null,data:null,total:null,start:null,limit:null,success:null,extra:{}}},!1,!0);y(this,a,!0,!0);this.plain=!this.type},isPlain:function(){return this.plain},getRecordProp:function(a,b){return this.getProp("record",a,b)},setRecordProp:function(a,b){this.record[a]=b},getStoreProp:function(a,
b){return this.getProp("store",a,b)},setStoreProp:function(a,b){this.store[a]=b},getProp:function(a,b,e){a=this[a];return a[b]&&a[b][e]||a[e]||this[e]||null},setProp:function(a,b){return this[a]=b},_makeRequest:function(a,b,e,f,h){var k=this,p=k[a],m=y({},B(p[b])||E(p[b])?{url:p[b]}:p[b]),u=k.getProp(a,b,"id"),r=k.getProp(a,b,"data"),s=k.getProp(a,b,"url"),t=k.getProp(a,b,"json");if(!m)if(s)m={url:s};else throw a+"."+b+" not defined";if(B(m)||E(m))m={url:m};if(!m.url){if(!s)throw a+"."+b+" url not defined";
m.url=s}m.data=y({},m.data,k.extra,p.extra,p[b]?p[b].extra:{},h,!0,!0);if(E(m.url)){e=m.url(m.data);var n=new N;e.then(function(e){"record"==a?k._processRecordResponse(b,e,n):"store"==a&&k._processStoreResponse(b,e,n)});return n}m.method||(m.method="load"==b?"GET":"POST");e&&(m.data[u]=e);f&&(r?m.data[r]=f:m.data=f);t&&m.data&&"GET"!=m.method&&(m.data=JSON.stringify(m.data));m.callbackScope=k;"record"==a?m.processResponse=function(a,c){k.lastAjaxResponse=a;k._processRecordResponse(b,a,c)}:"store"==
a&&(m.processResponse=function(a,c){k.lastAjaxResponse=a;k._processStoreResponse(b,a,c)});return $a(m)},_processRecordResponse:function(a,b,e){var f=this.getRecordProp(a,"id"),h=this.getRecordProp(a,"data"),f=(h=h?b[h]:b)&&h[f]||b[f];this._getSuccess("record",a,b)?e.resolve({id:f,data:h}):e.reject(b)},_processStoreResponse:function(a,b,e){var f=this.getStoreProp(a,"data"),h=this.getStoreProp(a,"total"),f=f?b[f]:b,h=h?b[h]:null;this._getSuccess("store",a,b)?e.resolve({data:f,total:h}):e.reject(b)},
_getSuccess:function(a,b,e){return(a=this.getProp(a,b,"success"))&&void 0!=e[a]?e[a]:!0},loadRecord:function(a){return this._makeRequest("record","load",a)},saveRecord:function(a,b,e){return this._makeRequest("record",a.getId()?"save":"create",a.getId(),y({},a.storeData(a.getData(b)),e))},deleteRecord:function(a){return this._makeRequest("record","delete",a.getId())},loadStore:function(a,b){return this._makeRequest("store","load",null,null,b)},saveStore:function(a,b){return this._makeRequest("store",
"save",null,b)},deleteRecords:function(a,b){return this._makeRequest("store","delete",b)},getFields:function(){return this.fields},restoreField:function(a,b,e){var f=this.fields[b];if(f){switch(B(f)?f:f.type){case "int":e=parseInt(e);break;case "bool":case "boolean":B(e)?(e=e.toLowerCase(),e=!("off"===e||"no"===e||"0"===e||"false"==e||"null"==e)):e=e?!0:!1;break;case "double":case "float":e=parseFloat(e);break;case "date":f.parseFn?e=f.parseFn(e,f.format):Date.parse?e=Date.parse(e,f.format):("timestamp"==
f.format&&(e=1E3*parseInt(e)),e=new Date(e))}f.restore&&(e=f.restore.call(a,e,b))}return this.onRestoreField(a,b,e)},onRestoreField:function(a,b,e){return e},storeField:function(a,b,e){var f=this.fields[b];if(f){switch(B(f)?f:f.type){case "bool":case "boolean":e=e?"1":"0";break;case "date":e=f.formatFn?f.formatFn(e,f.format):Date.format?Date.format(e,f.format):"timestamp"==f.format?e.getTime()/1E3:e.format?e.format(f.format):e.toString();break;default:e=e.toString()}f.store&&(e=f.store.call(a,e,b))}return this.onStoreField(a,
b,e)},onStoreField:function(a,b,e){return e}},{create:function(a,d){return"MetaphorJs.Model"==a?db(a,d):d?db(a,d):b[a]?b[a]:b[a]=db(a)},addToCache:function(b){var d=b.$getClass(),e=b.getId();"MetaphorJs.Record"!=d&&(a[d]||(a[d]={}),a[d][e]=b)},getFromCache:function(b,d){return a[b]&&a[b][d]?a[b][d]:null},removeFromCache:function(b,d){a[b]&&a[b][d]&&delete a[b][d]}})}(),La=P({$class:"MetaphorJs.Record",$mixins:[Ua],id:null,data:null,orig:null,modified:null,loaded:!1,dirty:!1,model:null,standalone:!0,
stores:null,$init:function(b,a,c){var d=arguments.length;1==d?(c=b,a=b=null):2==d&&(c=a,a=null);this.data={};this.orig={};this.stores=[];this.modified={};c=c||{};this.$super(c);B(this.model)?this.model=ta.create(this.model):this.model instanceof ta||(this.model=new ta(this.model));this.id=b;a?this.importData(a):!1!==c.autoLoad&&b&&this.load();"MetaphorJs.Record"!=this.$getClass()&&ta.addToCache(this)},isLoaded:function(){return this.loaded},isStandalone:function(){return this.standalone},isDirty:function(){return this.dirty},
getModel:function(){return this.model},attachStore:function(b){b=b.getId();-1==this.stores.indexOf(b)&&this.stores.push(b)},detachStore:function(b){b=b.getId();var a;this.$destroyed||-1==(a=this.stores.indexOf(b))||(this.stores.splice(a,1),0!=this.stores.length||this.standalone||this.$destroy())},setDirty:function(b){this.dirty!=b&&(this.dirty=!!b,this.trigger("dirtychange",this,b))},importData:function(b){var a={},c;if(b){for(c in b)a[c]=this.model.restoreField(this,c,b[c]);this.data=a}this.orig=
y({},this.data);this.modified={};this.loaded=!0;this.setDirty(!1)},storeData:function(b){var a={},c;for(c in b)a[c]=this.model.storeField(this,c,b[c]);return a},getId:function(){return this.id},getData:function(b){if(b){var a={},c,d;b=B(b)?[b]:b;c=0;for(d=b.length;c<d;c++)a[b[c]]=this.data[b[c]];return a}return y({},this.data)},getChanged:function(){return y({},this.modified)},isChanged:function(b){return this.modified[b]||!1},get:function(b){return this.data[b]},setId:function(b){!this.id&&b&&(this.id=
b)},set:function(b,a){var c=this.data[b];a=this.model.restoreField(this,b,a);this.data[b]=a;c!=a&&(this.modified[b]=!0,this.setDirty(!0),this.trigger("change",this,b,a,c),this.trigger("change-"+b,this,b,a,c))},revert:function(){this.dirty&&(this.data=y({},this.orig),this.modified={},this.setDirty(!1))},load:function(){var b=this;b.trigger("beforeload",b);return b.model.loadRecord(b.id).done(function(a){b.setId(a.id);b.importData(a.data);b.trigger("load",b)}).fail(function(){b.trigger("failedload",
b)})},save:function(b,a){var c=this;c.trigger("beforesave",c);return c.model.saveRecord(c,b,a).done(function(a){c.setId(a.id);c.importData(a.data);c.trigger("save",c)}).fail(function(a){c.trigger("failedsave",c)})},"delete":function(){var b=this;b.trigger("beforedelete",b);return b.model.deleteRecord(b).done(function(){b.trigger("delete",b);b.$destroy()}).fail(function(){b.trigger("faileddelete",b)})},reset:function(){this.id=null;this.data={};this.orig={};this.modified={};this.dirty=this.loaded=
!1;this.trigger("reset",this)},destroy:function(){ta.removeFromCache(this.$getClass(),this.id);this.$super()}});(function(){var b={};return P({$class:"MetaphorJs.Store",$mixins:[Ua],id:null,autoLoad:!1,clearOnLoad:!0,model:null,extraParams:null,loaded:!1,loading:!1,local:!1,items:null,current:null,map:null,currentMap:null,length:0,currentLength:0,maxLength:0,totalLength:0,start:0,pageSize:null,pages:null,filtered:!1,sorted:!1,filterBy:null,filterOpt:null,sortBy:null,sortDir:null,publicStore:!1,idProp:null,
$init:function(a,c,d){this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=!1;this.extraParams=this.extraParams||{};a&&!B(a)&&(d=c,c=a,a=null);c=c||{};a&&(c.url=a);this.$super(c);y(this,c,!0,!1);this.id=this.id||ca();this.publicStore&&(b[this.id]=this);this.initModel(c);this.$$observable.createEvent("beforeload",!1);!this.local&&this.autoLoad?this.load():d&&(K(d)?this._loadArray(d):this._loadAjaxData(d));this.local&&(this.loaded=!0)},initModel:function(a){B(this.model)?this.model=
ta.create(this.model):this.model instanceof ta||(this.model=new ta(this.model));a.url&&(this.model.store.load=a.url);this.idProp=this.model.getStoreProp("load","id")},getId:function(){return this.id},isLoaded:function(){return this.loaded},isLocal:function(){return this.local},setLocal:function(a){this.local=!!a},isLoading:function(){return this.loading},isFiltered:function(){return this.filtered},isSorted:function(){return this.sorted},getLength:function(a){return a?this.length:this.currentLength},
getTotalLength:function(){return this.totalLength||this.currentLength},getPagesCount:function(){return null!==this.pageSize?parseInt(this.totalLength/this.pageSize):1},setParam:function(a,b){this.extraParams[a]=b},getParam:function(a){return this.extraParams[a]},setStart:function(a){this.start=a},setPageSize:function(a){this.pageSize=a},getAjaxData:function(){return this.ajaxData},hasDirty:function(a){if(this.model.isPlain())return!1;var b=!1;this.each(function(a){return a.isDirty()?(b=!0,!1):!0},
null,a);return b},getDirty:function(a){var b=[];if(this.model.isPlain())return b;this.each(function(a){a.isDirty()&&b.push(a)},null,a);return b},getModel:function(){return this.model},_loadAjaxData:function(a,b){var d=this;b=b||{};if(b.silent||!1!==d.trigger("beforeload",d))d.ajaxData=a,d.model._processStoreResponse("load",a,{resolve:function(a){d._onModelLoadSuccess(a,b)},reject:function(a){d._onModelLoadFail(a,b)}})},_loadArray:function(a,b){b=b||{};(b.silent||!1!==this.trigger("beforeload",this))&&
K(a)&&(this._load(a,b),this.totalLength=this.length)},_load:function(a,b){var d=b.prepend;b=b||{};for(var e=0;e<a.length;e++)d?this.insert(e,a[e],!0,!0):this.add(a[e],!0,!0);this.loaded=!0;this.loading=!1;this.trigger("loadingend",this);this.onLoad();b.skipUpdate||this.update();b.silent||this.trigger("load",this)},load:function(a,b){var d=this,e=d.model.store,f=e.start,e=e.limit,h=d.pageSize;b=b||{};if(d.local)return null;a=y({},d.extraParams,a||{});null===h||a[f]||a[e]||(f&&(a[f]=d.start),e&&(a[e]=
h));if(!b.silent&&!1===d.trigger("beforeload",d))return null;d.loading=!0;d.trigger("loadingstart",d);return d.model.loadStore(d,a).done(function(a){d.ajaxData=d.model.lastAjaxResponse;d._onModelLoadSuccess(a,b)}).fail(function(a){d.ajaxData=d.model.lastAjaxResponse;d._onModelLoadFail(a,b)})},_onModelLoadSuccess:function(a,b){b=b||{};if(!b.noopOnEmpty||a.data.length)!b.prepend&&!b.append&&this.clearOnLoad&&0<this.length&&this.clear(!0),this.totalLength=parseInt(a.total),this._load(a.data,b)},_onModelLoadFail:function(a,
b){this.onFailedLoad();b.silent||this.trigger("failedload",this,a)},onLoad:M,onFailedLoad:M,save:function(a){var b=this,d={},e=0;if(b.local)return null;if(b.model.isPlain())throw Error("Cannot save plain store");b.each(function(a){a.isDirty()&&(d[a.getId()]=a.storeData(a.getData()),e++)});if(!e)throw Error("Nothing to save");return a||!1!==b.trigger("beforesave",b,d)?b.model.saveStore(b,d).done(function(d){b._onModelSaveSuccess(d,a)}).fail(function(d){b._onModelSaveFail(d,a)}):null},_onModelSaveSuccess:function(a,
b){var d,e,f,h=a.data;if(h&&h.length)for(d=0,e=h.length;d<e;d++)f=this.getRecordId(h[d]),(f=this.getById(f))&&f.importData(h[d]);this.onSave();b||this.trigger("save",this)},_onModelSaveFail:function(a,b){this.onFailedSave(a);b||this.trigger("failedsave",this)},onSave:M,onFailedSave:M,deleteById:function(a,b,d){var e=this,f,h,k;if(e.local)return null;if(!a||K(a)&&!a.length)throw Error("Record id required");K(a)||(a=[a]);f=0;for(h=a.length;f<h;f++)k=e.getById(a[f]),e.remove(k,b,d),k instanceof La&&
k.$destroy();return b||!1!==e.trigger("beforedelete",e,a)?e.model.deleteRecords(e,a).done(function(){e.totalLength-=a.length;e.onDelete();b||e.trigger("delete",e,a)}).fail(function(){e.onFailedDelete();b||e.trigger("faileddelete",e,a)}):null},onDelete:M,onFailedDelete:M,deleteAt:function(a,b,d){var e=this.getAt(a);if(!e)throw Error("Record not found at "+a);return this["delete"](e,b,d)},"delete":function(a,b,d){return this.deleteById(this.getRecordId(a),b,d)},deleteRecords:function(a,b,d){var e=[],
f,h;f=0;for(h=a.length;f<h;f++)e.push(this.getRecordId(a[f]));return this.deleteById(e,b,d)},loadOr:function(a,b,d){this.local||this.isLoading()||(this.isLoaded()?a&&a.call(b||this):this.load(null,d))},addPrevPage:function(a){a=a||{};a.append=!1;a.prepend=!0;a.noopOnEmpty=!0;return this.loadPrevPage(a)},addNextPage:function(a){a=a||{};a.append=!0;a.prepend=!1;a.noopOnEmpty=!0;if(!this.local&&(!this.totalLength||this.length<this.totalLength))return this.load({start:this.length,limit:this.pageSize},
a)},loadNextPage:function(a){if(!this.local&&(!this.totalLength||this.length<this.totalLength))return this.start+=this.pageSize,this.load(null,a)},loadPrevPage:function(a){if(!this.local&&0<this.start)return this.start-=this.pageSize,0>this.start&&(this.start=0),this.load(null,a)},loadPage:function(a,b){if(!this.local)return this.start=parseInt(a,10),0>this.start&&(this.start=0),this.load(null,b)},getRecordId:function(a){return a instanceof La?a.getId():a[this.idProp]||null},getRecordData:function(a){return this.model.isPlain()?
a:a.data},processRawDataItem:function(a){if(a instanceof La||this.model.isPlain())return a;var b=this.model.type,d=this.getRecordId(a),e;d&&(e=ta.getFromCache(b,d));e||(e=db(b,d,a,{model:this.model,standalone:!1}));return e},bindRecord:function(a,b){b[a]("change",this.onRecordChange,this);b[a]("destroy",this.onRecordDestroy,this);b[a]("dirtychange",this.onRecordDirtyChange,this);return b},onRecordDirtyChange:function(a){this.trigger("update",this,a)},onRecordChange:function(a,b,d,e){this.trigger("update",
this,a)},onRecordDestroy:function(a){this.remove(a)},shift:function(a,b,d){return this.removeAt(0,a,b,d)},unshift:function(a,b,d){return this.insert(0,a,b,d)},pop:function(a,b,d){return this.removeAt(this.length-1,a,b,d)},addMany:function(a,b,d){var e,f,h=this.length;e=0;for(f=a.length;e<f;e++)this.insert(h+e,a[e],!0,!0);d||this.update();0<f&&!b&&this.trigger("add",a)},add:function(a,b,d){return this.insert(this.length,a,b,d)},onAdd:M,removeAt:function(a,b,d,e){e||(a=this.items.indexOf(this.current[a]));
if(a<this.length&&0<=a)return this.length--,e=this.items[a],this.items.splice(a,1),a=this.getRecordId(e),void 0!=a&&(delete this.map[a],delete this.currentMap[a]),this.onRemove(e,a),d||this.update(),b||this.trigger("remove",e,a),e instanceof La?(this.bindRecord("un",e),e.detachStore(this),e.$destroyed?void 0:e):e},onRemove:M,insertMany:function(a,b,d,e){var f,h;f=0;for(h=b.length;f<h;f++)this.insert(a+f,b[f],!0,!0);0<h&&!e&&this.update();0<h&&!d&&this.trigger("add",b)},insert:function(a,b,d,e){var f,
h=!1;b=this.processRawDataItem(b);f=this.getRecordId(b);this.map[f]&&(this.suspendAllEvents(),this.removeId(f),this.resumeAllEvents());a>=this.length?(this.items.push(b),h=!0):this.items.splice(a,0,b);this.length++;this.maxLength&&this.length>this.maxLength&&(h?this.pop(d,!0):this.shift(d,!0));void 0!=f&&(this.map[f]=b);b instanceof La&&(b.attachStore(this),this.bindRecord("on",b));this.onAdd(a,b);e||this.update();d||this.trigger("add",[b]);return b},replace:function(a,b,d,e){var f;f=this.items.indexOf(a);
this.removeAt(f,!0,!0,!0);this.insert(f,b,!0,!0);e||this.update();d||this.trigger("replace",a,b);return b},onReplace:M,remove:function(a,b,d){return this.removeAt(this.indexOf(a,!0),b,d,!0)},removeId:function(a,b,d){return this.removeAt(this.indexOfId(a,!0),b,d,!0)},contains:function(a,b){return-1!=this.indexOf(a,b)},containsId:function(a,b){return b?void 0!==this.map[a]:void 0!==this.currentMap[a]},clear:function(a){var b=this.getRange();this._reset();this.onClear();a||this.trigger("clear",b)},onClear:M,
reset:function(){this._reset();this.start=0},_reset:function(a){var b,d;if(!a)for(a=0,b=this.items.length;a<b;a++)d=this.items[a],d instanceof La&&(this.bindRecord("un",d),d.detachStore(this));this.totalLength=this.currentLength=this.length=0;this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=this.local},getAt:function(a,b){return b?this.items[a]||void 0:this.current[a]||void 0},getById:function(a,b){return b?this.map[a]||void 0:this.currentMap[a]||void 0},indexOf:function(a,
b){return b?this.items.indexOf(a):this.current.indexOf(a)},indexOfId:function(a,b){return this.indexOf(this.getById(a,b),b)},each:function(a,b,d){d=d?this.items.slice():this.current.slice();for(var e=0,f=d.length;e<f&&!1!==a.call(b,d[e],e,f);e++);},eachId:function(a,b,d){var e=this;e.each(function(d,h,k){return a.call(b,e.getRecordId(d),h,k)},null,d)},collect:function(a,b){var d=[],e=!this.model.isPlain();this.each(function(b){(b=e?b.get(a):b[a])&&d.push(b)},null,b);return d},first:function(a){return a?
this.items[0]:this.current[0]},last:function(a){return a?this.items[this.length-1]:this.current[this.current-1]},getRange:function(a,b,d){d=d?this.items:this.current;var e=[];if(1>d.length)return e;a=a||0;b=Math.min(void 0==b?this.length-1:b,this.length-1);if(a<=b)for(;a<=b;a++)e.push(d[a]);else for(;a>=b;a--)e.push(d[a]);return e},findBy:function(a,b,d,e){a=this.findIndexBy(a,b,d,e);return-1==a?void 0:this.getAt(a,e)},findIndexBy:function(a,b,d,e){e=e?this.items:this.current;d=d||0;for(var f=e.length;d<
f;d++)if(a.call(b,e[d],this.getRecordId(e[d])))return d;return-1},find:function(a,b,d,e){var f=!this.model.isPlain(),h;return this.findIndexBy(function(e){h=f?e.get(a):e[a];return d?h===b:h==b},this,0,e)},findExact:function(a,b,d){return this.find(a,b,!0,d)},findBySet:function(a,b){var d=null,e,f;this.each(function(b){e=!0;for(f in a)if(a[f]!=b[f]){e=!1;break}return e?(d=b,!1):!0},null,b);return d},update:function(){var a=this,b=a.filtered,d=a.sorted;a.currentLength=a.length;a.currentMap=a.map;a.current=
a.items;if(b){var e=a.filterBy,f=a.filterOpt,h,k;a.current=h=[];a.currentMap=k={};a.each(function(b){Mb.compare(b.data,e,f)&&(h.push(b),k[a.getRecordId(b)]=b)},null,!0);a.currentLength=a.current.length}if(d){var p=a.sortBy,m=!a.model.isPlain();a.current=wb(a.current,function(a){return m?a.get(p):a[p]},a.sortDir)}a.trigger("update",a)},filter:function(a,b){this.filtered=!0;this.filterBy=a;this.filterOpt=b;this.update()},clearFilter:function(){this.filtered&&(this.filterOpt=this.filterBy=null,this.update())},
sort:function(a,b){this.sorted=!0;this.sortBy=a;this.sortDir=b;this.update()},clearSorting:function(){this.sorted=!1;this.sortDir=this.sortBy=null;this.update()},destroy:function(){delete b[this.id];this.clear();this.$super()}},{lookupStore:function(a){return b[a]||null},eachStore:function(a,c){for(var d in b)if(!1===a.call(c,b[d]))break}})})();P({$class:"MetaphorJs.FirebaseStore",$extends:"MetaphorJs.Store",firebase:null,$init:function(b){this.firebase=B(b)?new Firebase(b):b;this.firebase.on("child_added",
A(this.onChildAdded,this));this.firebase.on("child_removed",A(this.onChildRemoved,this));this.firebase.on("child_changed",A(this.onChildChanged,this));this.firebase.on("child_moved",A(this.onChildMoved,this));this.$super()},initModel:M,ref:function(){return this.firebase.ref?this.firebase.ref():this.firebase},load:function(){if(!this.loaded)this.firebase.once("value",A(this.onSnapshotLoaded,this))},onSnapshotLoaded:function(b){var a=this;b.forEach(function(b){a.add(b,!0,!0)});a.update();a.loaded=
!0;a.trigger("load",a)},onChildAdded:function(b,a){if(this.loaded){var c=this.indexOfId(a,!0);this.insert(c+1,b)}},onChildRemoved:function(b){this.loaded&&this.removeId(b.name())},onChildChanged:function(b,a){if(this.loaded){var c=this.getById(b.name(),!0);this.replace(c,b)}},onChildMoved:function(b,a){},getRecordId:function(b){return b.name()},getRecordData:function(b){return b.val()},processRawDataItem:function(b){return b},bindRecord:M});var jc=nb.$extend({store:null,$constructor:function(b,a,
c){var d=ba(a,b);d.pullNext&&(d.buffered&&(d.bufferedPullNext=!0,d.buffered=!1),this.$plugins.push("plugin.ListPullNext"));this.$super(b,a,c)},afterInit:function(b,a,c){this.store=b=la(this.model)(b);this.watcher=qa(b,".current",this.onChange,this,null,V);this.trackByFn=A(b.getRecordId,b);this.griDelegate=A(b.indexOfId,b);this.bindStore(b,"on")},bindStore:function(b,a){b[a]("update",this.onStoreUpdate,this);b[a]("clear",this.onStoreUpdate,this);b[a]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},
getListItem:function(b,a){return this.store.getRecordData(b[a])},onStoreDestroy:function(){this.onStoreUpdate();this.watcher.unsubscribeAndDestroy(this.onChange,this);this.watcher=null},destroy:function(){this.bindStore(this.store,"un");this.$super()}},{$stopRenderer:!0,$registerBy:"id"});D.registerAttribute("mjs-each-in-store",100,jc);var qb=function(){var b=/(auto|scroll)/,a,c=function(a){a=va(a);return a.overflow+a.overflowY+a.overflowY};return function(d){a||(a=window.document.body);for(;d&&d!==
a;){if(b.test(c(d)))return d;d=d.parentNode}return window}}();J("plugin.ListBuffered",P({list:null,itemSize:null,itemsOffsite:1,bufferState:null,scrollOffset:0,horizontal:!1,bufferEventDelegate:null,topStub:null,botStub:null,$init:function(b){this.list=b;b.$intercept("scrollTo",this.scrollTo,this,"instead");b.$intercept("afterInit",this.afterInit,this,"before");b.bufferPlugin=this},afterInit:function(){var b=ba(this.list.node);this.itemSize=b.itemSize;this.itemsOffsite=b.itemsOffsite||5;this.horizontal=
b.horizontal||!1;this.initScrollParent(b);this.initScrollStubs(b);this.bufferEventDelegate=A(this.bufferUpdateEvent,this);I(this.scrollEl,"scroll",this.bufferEventDelegate);I(window,"resize",this.bufferEventDelegate)},initScrollParent:function(b){this.scrollEl=qb(this.list.parentEl)},initScrollStubs:function(b){var a=this.list,c=a.parentEl,d=a.prevEl,e,f,h={fontSize:0,lineHeight:0,padding:0,paddingTop:0,paddingLeft:0,paddingBottom:0,paddingRight:0,margin:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0};
this.topStub=e=window.document.createElement(b.stub||"div");this.botStub=b=window.document.createElement(b.stub||"div");L(e,"mjs-buffer-top");L(b,"mjs-buffer-bottom");for(f in h)e.style[f]=h[f],b.style[f]=h[f];c.insertBefore(e,d?d.nextSibling:c.firstChild);c.insertBefore(b,a.nextEl);a.prevEl=e;a.nextEl=b},getScrollOffset:function(){var b=xb(this.topStub,this.scrollEl);return this.scrollOffset=this.horizontal?b.left:b.top},getBufferState:function(b){var a=this.scrollEl,c=this.horizontal,d=window.document.documentElement,
d=a===window?window[c?"innerWidth":"innerHeight"]||d[c?"clientWidth":"clientHeight"]:a[c?"offsetWidth":"offsetHeight"],e=c?Ba(a):Aa(a),a=this.itemSize,c=this.itemsOffsite,f=b?this.getScrollOffset():this.scrollOffset;b=this.list.renderers.length;var h,e=Math.max(0,e+f),f=Math.ceil(e/a);0>f&&(f=0);e=f;h=d=f+Math.ceil(d/a);f=f>c?f-c:0;h+=c;h>b-1&&(h=b-1);return f>h?this.bufferState:this.bufferState={first:f,last:h,viewFirst:e,viewLast:d,ot:f*a,ob:(b-h-1)*a}},updateStubs:function(b){var a=this.horizontal;
this.topStub.style[a?"width":"height"]=b.ot+"px";this.botStub.style[a?"width":"height"]=b.ob+"px"},bufferUpdateEvent:function(){this.list.queue.add(this.updateScrollBuffer,this)},updateScrollBuffer:function(b){var a=this,c=a.list,d=a.bufferState,e=c.parentEl,f=c.renderers,h=a.botStub,k=a.getBufferState(!1),p=new N,m,u,r,s;if(!k)return null;d&&k.first==d.first&&k.last==d.last||c.trigger("bufferchange",a,k,d);Y(function(){if(b||!d||k.last<d.first||k.first>d.last){if(d)for(u=d.first,r=d.last;u<=r;u++)(s=
f[u])&&s.attached&&(e.removeChild(s.el),s.attached=!1);m=window.document.createDocumentFragment();u=k.first;for(r=k.last;u<=r;u++)if(s=f[u])s.rendered||c.renderItem(u),m.appendChild(s.el),s.attached=!0;e.insertBefore(m,h)}else{if(d.first<k.first)for(u=d.first,r=k.first;u<r;u++)(s=f[u])&&s.attached&&(e.removeChild(s.el),s.attached=!1);else if(d.first>k.first){m=window.document.createDocumentFragment();u=k.first;for(r=d.first;u<r;u++)if(s=f[u])s.rendered||c.renderItem(u),m.appendChild(s.el),s.attached=
!0;e.insertBefore(m,f[d.first].el)}if(d.last<k.last){m=window.document.createDocumentFragment();u=d.last+1;for(r=k.last;u<=r;u++)if(s=f[u])s.rendered||c.renderItem(u),m.appendChild(s.el),s.attached=!0;e.insertBefore(m,h)}else if(d.last>k.last)for(u=k.last+1,r=d.last;u<=r;u++)(s=f[u])&&s.attached&&(e.removeChild(s.el),s.attached=!1)}a.updateStubs(k);c.trigger("bufferupdate",a);a.onBufferStateChange(k,d);p.resolve()});return p},scrollTo:function(b){var a=this.list,c=this.itemSize,d=this.scrollEl||qb(a.parentEl),
e=this.horizontal,f=e?"scrollLeft":"scrollTop",h=new N,k;a.queue.append(function(){Y(function(){k=c*b;d===window?window.scrollTo(e?k:Ba(),e?Aa():k):d[f]=k;h.resolve()});return h});return h},onBufferStateChange:function(b,a){},$beforeHostDestroy:function(){var b=this.list.parentEl;b.removeChild(this.topStub);b.removeChild(this.botStub);Z(this.scrollEl,"scroll",this.bufferEventDelegate);Z(window,"resize",this.bufferEventDelegate)}}));J("plugin.ListPullNext",P({$extends:"plugin.ListBuffered",buffered:!1,
$init:function(b,a){var c=ba(a[1]);c.bufferedPullNext&&(this.buffered=c.bufferedPullNext,b.buffered=!0);this.$super(b,a)},afterInit:function(){this.$super();this.getScrollOffset()},updateScrollBuffer:function(b){if(this.buffered)return this.$super(b);b=this.bufferState;var a=this.getBufferState();b&&a.first==b.first&&a.last==b.last||(this.trigger("bufferchange",this,a,b),this.onBufferStateChange(a,b))},onBufferStateChange:function(b,a){var c=this.list,d=c.store.getLength();this.$super(b,a);d-b.last<
(b.last-b.first)/3&&!c.store.loading&&(c.store.addNextPage(),c.trigger("pull",this))}}));var hb=U.is,Ma=cb("outer","Width"),Na=cb("outer","Height"),Wa={},kc=function(){var b=function(a,b){var c=a.style,d;for(d in b)c[d]=b[d]},a={t:"b",r:"l",b:"t",l:"r"},c={t:"top",r:"right",b:"bottom",l:"left"},d={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]},e=null,f=function(){var a={},b={};return{register:function(c){var d=c.getInstanceId(),e=c.getGroup(),f,h,k;a[d]=c;f=0;for(h=e.length;f<h;f++)k=e[f],b[k]||
(b[k]={}),b[k][d]=!0;c.on("destroy",this.unregister,this)},unregister:function(b){b=b.getInstanceId();delete a[b]},hideAll:function(c){var d=c.getInstanceId();c=c.getGroup();var e,f,h,k;e=0;for(f=c.length;e<f;e++)for(k in h=c[e],h=b[h],h)a[k]?k==d||a[k].isHideAllIgnored()||a[k].hide(null,!0,!0):delete h[k]}}}(),h=function(f,k,t){null===e&&(e=window.document.all&&!window.XMLHttpRequest);var n,q=this,v,l={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"},
p=k.size,m=k.width||2*p;y(q,{init:function(){k.border&&q.createInner()},getEl:function(){return n},getDialogPositionOffset:function(){var b=(q.detectPointerPosition()||"").substr(0,1),c=(f.getCfg().position.type||"").replace(/(w|m|c)/,"").substr(0,1),d={x:0,y:0};b==a[c]&&(d["t"==b||"b"==b?"y":"x"]="b"==b||"r"==b?-p:p);return d},createInner:function(){var a=y({},k);a.size=p-2*k.border;a.width=m-4*k.border;a.border=null;a.borderColor=null;a.borderCls=null;a.offset=null;v=new h(f,a,k.border)},detectPointerPosition:function(){if(k.position)return k.position;
var b=(f.getCfg().position.type||"").replace(/(w|m|c)/,"").substr(0,1);return b?a[b]:null},detectPointerDirection:function(a){return k.direction?k.direction:a},getBorders:function(b,f,n){var q={},h=b.substr(0,1);b=f.substr(0,1);var l=f.substr(1);f=e?"dotted":"solid";q["border"+Ca(c[a[h]])]=p+"px solid "+n;q["border"+Ca(c[h])]="0 "+f+" transparent";l?(q["border"+Ca(c[l])]="0 solid transparent",q["border"+Ca(c[a[l]])]=m+"px "+f+" transparent"):(n=Math.floor(m/2),q["border"+Ca(c[d[b][0]])]=n+"px "+f+
" transparent",q["border"+Ca(c[d[b][1]])]=n+"px "+f+" transparent");return q},getOffsets:function(b,d){var e={},f=b.substr(0,1),q="t"==f||"b"==f?"r":"b";if(!p)switch(window.document.body.appendChild(n),f){case "t":case "b":p=Na(n);m=Ma(n);break;case "l":case "r":m=Na(n),p=Ma(n)}e[c[f]]=t?"auto":-p+"px";e[c[q]]="auto";if(t){var f=d.substr(0,1),h=d.substr(1);e[c[a[q]]]=h?"l"==h||"t"==h?t+"px":-m-t+"px":Math.floor(-m/2)+"px";e[c[a[f]]]=-(p+2*t)+"px"}else{switch(b){case "t":case "r":case "b":case "l":f=
d!=b?"l"==d||"t"==d?k.offset:-m+k.offset:-m/2+k.offset;break;case "bl":case "tl":case "lt":case "rt":f=k.offset;break;default:f=-m-k.offset}e["margin"+Ca(c[a[q]])]=f+"px";switch(b){case "t":case "r":case "b":case "l":f="50%";break;case "tr":case "rb":case "br":case "lb":f="100%";break;default:f=0}e[c[a[q]]]=f}return e},render:function(){if(!n){var a=q.detectPointerPosition();if(a)if(k.el){if(B(k.el)){var c=window.document.createElement("div");c.innerHTML=k.el;n=c.firstChild}else n=k.el;b(n,{position:"absolute"});
b(n,q.getOffsets(a));L(n,k.cls);f.getElem().appendChild(n)}else{c=q.detectPointerDirection(a);n=window.document.createElement("div");var d=window.document.createComment(" ");n.appendChild(d);b(n,l);b(n,q.getBorders(a,c,k.borderColor||k.color));b(n,q.getOffsets(a,c));L(n,k.borderCls||k.cls);v&&(v.render(),n.appendChild(v.getEl()));t||f.getElem().appendChild(n)}}},destroy:function(){q.remove();t=k=f=v=q=null},remove:function(){v&&v.remove();n&&(n.parentNode.removeChild(n),n=null)}},!0,!1);q.init();
return q},k=function(a,b,c,d){if("show"==c||!d)return b.preventDefault(),b.stopPropagation(),!1},p=function(a){if(!a)return{};var b=function(b,c,d){var e=a[b],f=!1;if(void 0!==e){switch(d){case "string":f=B(e);break;case "function":f=E(e);break;case "number":f=1===fa(e)||e==parseInt(e);break;case "dom":f=e&&(e.tagName||e.nodeName)?!0:!1;break;case "jquery":(f=e&&e.jquery?!0:!1)&&(e=e.get(0));break;case "boolean":if(!0===e||!1===e)f=!0;break;default:!0===d&&!0===e&&(f=!0),!1===d&&!1===e&&(f=!0)}f&&
(a[b]={},a[b][c]=e)}};b("content","value","string");b("content","value","boolean");b("content","fn","function");b("ajax","url","string");b("cls","dialog","string");b("render","tpl","string");b("render","fn","function");b("render","el","dom");b("render","el","jquery");b("show","events",!1);b("show","events","string");b("hide","events",!1);b("hide","events","string");b("toggle","events",!1);b("toggle","events","string");b("position","type","string");b("position","type",!1);b("position","get","function");
b("overlay","enabled","boolean");b("pointer","position","string");b("pointer","size","number");return a},m={target:null,debug:!1,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},ajax:{url:null,data:null,dataType:"text",method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",fn:null,el:null,zIndex:null,lazy:!0,style:null,appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{"*":{process:k}},
hide:{"*":{process:k}}},show:{delay:null,single:!1,events:null,animate:!1,ignoreHideAll:!1,focus:!1,preventScroll:!1,display:"block"},hide:{delay:null,timeout:null,events:null,destroy:!1,remove:!1,animate:!1,cancelShowDelay:!0},toggle:{events:null},position:{type:"t",offsetX:0,offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",
opacity:.5,cls:null,animateShow:!1,animateHide:!1,preventScroll:!1},callback:{scope:null,contentchange:null,beforeshow:null,show:null,beforehide:null,hide:null,render:null,lifetime:null,targetchange:null,button:null}},u=function(a,c){a&&!B(a)&&(c=a,a=null);c=c||{};var d=this,e={},q=ca(),v=new ha,l=y({},m,p(u.defaults),p(u[a]),p(c),!0,!0),k=l.callback.scope||e,w,C,A,x={bindSelfOnRender:!1,target:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,hideTimeout:null,hideDelay:null,showDelay:null,dynamicTarget:!1,
dynamicTargetEl:null,images:0,position:null,destroyDelay:null};c=null;y(e,v.getApi(),{getElem:function(){return w},getInstanceId:function(){return q},getCfg:function(){return y({},l)},getGroup:function(){return l.group?B(l.group)?[l.group]:l.group:[""]},setTarget:function(a){if(!a)return e;var b=!1,c=x.target;x.target?(d.setHandlers("unbind","_target"),b=!0):x.dynamicTarget&&(b=!0);var f=B(a);f&&"#"!=a.substr(0,1)?(x.dynamicTarget=!0,x.target=null):(f&&(a=U(a).shift()),x.dynamicTarget=!1,x.target=
a);b&&(d.setHandlers("bind","_target"),d.trigger("targetchange",e,a,c));return e},getTarget:function(){return x.dynamicTarget?x.dynamicTargetEl:x.target},isEnabled:function(){return x.enabled},isVisible:function(){return x.visible},isHideAllIgnored:function(){return l.show.ignoreHideAll},isFrozen:function(){return x.frozen},enable:function(){x.enabled=!0;return e},disable:function(){d.hide();x.enabled=!1;return e},freeze:function(){x.frozen=!0;return e},unfreeze:function(){x.frozen=!1;return e},toggle:function(a,
b){return a&&a.stopPropagation&&x.dynamicTarget&&x.visible&&d.isDynamicTargetChanged(a)?d.show(a):d[x.visible?"hide":"show"](a,b)},show:function(a,b){var c=a&&a.stopPropagation?null:e,q=l.show,h=null;e.isEnabled()||(l.debug&&console.log("show: not enabled",e.getTarget()),h="disabled");!h&&x.visible&&x.hideTimeout&&(window.clearTimeout(x.hideTimeout),x.hideTimeout=pa(d.hide,d,null,l.hide.timeout),l.debug&&console.log("show: hide timeout was set",e.getTarget()),h="hidetimeout");!h&&x.hideDelay&&(window.clearTimeout(x.hideDelay),
x.hideDelay=null,x.visible=!0,l.debug&&console.log("show: hide delay was set; already shown",e.getTarget()),h="hidedelay");!h&&x.frozen&&(l.debug&&console.log("show: frozen",e.getTarget()),h="frozen");x.destroyDelay&&(window.clearTimeout(x.destroyDelay),x.destroyDelay=null);var v=!1;a&&a.stopPropagation&&x.dynamicTarget&&(v=d.changeDynamicTarget(a));!h&&x.visible&&(v?l.render.fn?d.hide(null,!0):(d.reposition(a),h="reposition"):(l.debug&&console.log("show: already shown",w),h="visible"));h||(w?v&&
d.changeDynamicContent():d.render());h||!1!==d.trigger("beforeshow",e,a)||(l.debug&&console.log("show: beforeshow return false",e.getTarget()),h="beforeshow");a&&a.stopPropagation&&l.events.show&&(l.events.show[a.type]||l.events.show["*"])&&(c=l.events.show[a.type]||l.events.show["*"],c.process?c=c.process(e,a,"show",h):(c.stopPropagation&&a.stopPropagation(),c.preventDefault&&a.preventDefault(),c=c.returnValue));if(h)return h;Da(w);x.visible=!0;q.single&&f.hideAll(d);d.toggleTitleAttribute(!1);q.delay&&
!b?x.showDelay=pa(d.showAfterDelay,d,[a],q.delay):d.showAfterDelay(a,b);return c},hide:function(a,b,c){x.hideTimeout=null;var f=a&&a.stopPropagation?null:e,h=null;!x.visible&&x.hideDelay&&b&&(window.clearTimeout(x.hideDelay),x.hideDelay=null,x.visible=!0);w&&x.visible&&d.isEnabled()||(l.debug&&console.log("hide: elem/visible/enabled: ",w,x.visible,d.isEnabled()),h=w?x.visible?"disabled":"hidden":"noelem");x.showDelay&&!h&&(l.hide.cancelShowDelay||c?(window.clearTimeout(x.showDelay),x.showDelay=null,
x.visible=!1,l.debug&&console.log("hide: cancelShowDelay: ",d.getTarget()),h="cancel"):(l.debug&&console.log("hide: show delay was set",d.getTarget()),h="delay"));x.frozen&&!h&&(l.debug&&console.log("hide: frozen",d.getTarget()),h="frozen");h||!1!==d.trigger("beforehide",e,a)||(l.debug&&console.log("hide: beforehide returned false",d.getTarget()),h="beforehide");a&&a.stopPropagation&&l.events.hide&&(l.events.hide[a.type]||l.events.hide["*"])&&(c=l.events.hide[a.type]||l.events.hide["*"],c.process?
f=c.process(e,a,"hide",h):(c.stopPropagation&&a.stopPropagation(),c.preventDefault&&a.preventDefault(),f=c.returnValue));if(h)return f;Da(w);x.visible=!1;d.toggleTitleAttribute(!0);x.dynamicTarget&&d.resetDynamicTarget();l.hide.delay&&!b?x.hideDelay=pa(d.hideAfterDelay,d,[a],l.hide.delay):d.hideAfterDelay(a,b);return f},setPositionType:function(a){a&&(B(a)?(l.position.get=a,l.position.type=!1):(l.position.get=null,l.position.type=a));a=l.position.type;!1===a?x.position=!1:l.position.get&&"m"!=a?x.position=
"fn":(a=a.substr(0,1),x.position="w"==a?"window":"m"==a?"mouse":"target");C&&(C.remove(),w&&C.render())},getPosition:function(a){if(!w)return null;var b,c=l.position;switch(x.position){case !1:return null;case "target":b=d.getTargetPosition(a);break;case "mouse":b=d.getMousePosition(a);break;case "window":b=d.getWindowPosition(a);break;case "fn":b=c.get.call(k,e,a)}if(!1!==c.screenX||!1!==c.screenY)b=d.correctScreenPosition(b,c.screenX,c.screenY);return b},reposition:function(a){a&&(a=aa(a));if(a=
d.getPosition(a))void 0!=a.x&&b(w,{left:a.x+"px"}),void 0!=a.y&&b(w,{top:a.y+"px"}),void 0==a.x&&void 0==a.y&&b(w,a)},getContentElem:function(){return w?l.selector.content?U(l.selector.content,w).shift()||w:w:null},setContent:function(a,b){b=b||"";if(!w)return l.content.value=a,e;l.content.prepare&&(a=l.content.prepare(e,b,a));var c=e.getContentElem(),f=x.rendered&&!l.selector.content&&C,h=f&&C.getEl();if(f&&h)try{w.removeChild(h)}catch(q){}if(B(a))c.innerHTML=a;else for(var v in a){var k=l.selector[v];
k&&(k=U(k,c).shift())&&(k.innerHTML=a[v])}if(f&&h)try{w.appendChild(h)}catch(p){}c=U("img",c);x.images=c.length;v=-1;for(f=c.length;++v<f;I(c[v],"load",d.onImageLoad));d.trigger("contentchange",e,a,b);d.onContentChange();return e},readContent:function(){var a=e.getTarget(),b;a&&(b=l.content.attr?z(a,l.content.attr):z(a,"tooltip")||z(a,"title")||z(a,"alt"));b&&d.setContent(b,"attribute");return e},loadContent:function(a){L(w,l.cls.loading);a=y({},l.ajax,a,!0,!0);d.trigger("beforeajax",e,a);return $a(a).done(d.onAjaxLoad)},
destroy:function(){d.trigger("destroy",e);Z(window,"resize",d.onWindowResize);Z(window,"scroll",d.onWindowScroll);d.destroyElem();C&&(C.destroy(),C=null);d.setHandlers("unbind");v.destroy();A=x=e=d=v=null},setFocus:function(){var a=l.show.focus,b;if(!0===a)if(a=U("input",w).concat(U("textarea",w)),0<a.length)a[0].focus();else{if(l.buttons)for(b in l.buttons){(b=U(l.buttons[b],w).shift())&&b.focus();break}}else(b=U(a,w).shift())&&b.focus()}},!0,!1);y(d,e,{init:function(){f.register(d);l.modal&&(l.overlay.enabled=
!0);d.setPositionType();d.setTarget(l.target);if(l.target&&l.useHref){var a=z(d.getTarget(),"href");"#"==a.substr(0,1)?l.render.el=a:l.ajax.url=a}if(l.pointer.size||l.pointer.el)C=new h(d,l.pointer);l.render.lazy||d.render();d.setHandlers("bind")},setHandlers:function(a,b){for(var c=["show","hide","toggle"],f="bind"==a?I:Z,h="bind"==a?Sb:Tb,q,v,k,p,m,s,r,u,O,C;q=c.shift();)if(v=l[q].events,!1!==v){if(B(v)||K(v))x.dynamicTarget?(m={},m[v]=l.target,v={_html:m}):v={_target:v};for(k in v){if(b)if("_self"==
b){if("_self"!=k&&"_overlay"!=k&&">"!=k.substr(0,1))continue}else if(k!=b)continue;if("_self"!=k&&"_overlay"!=k&&">"!=k.substr(0,1)||w){if(r=v[k]){switch(k){case "_target":u=[d.getTarget()];break;case "_self":u=[w];break;case "_window":u=[window];break;case "_document":u=[window.document];break;case "_html":u=[window.document.documentElement];break;case "_overlay":u=[A];break;default:u=">"==k.substr(0,1)?U(k.substr(1),w):U(k)}if(u&&u.length)if(B(r)&&(r=[r]),K(r))for(m=0,s=r.length;m<s;m++)for(O=-1,
C=u.length;++O<C;f(u[O],r[m],e[q]));else for(p in r)for(O=-1,C=u.length;++O<C;h(u[O],r[p],p,e[q]));}}else x.bindSelfOnRender=!0}}},resetDynamicTarget:function(){var a=x.dynamicTargetEl;a&&(d.setHandlers("unbind","_target"),d.trigger("targetchange",e,null,a))},isDynamicTargetChanged:function(a){var b=l.target;a=a.target;for(var c=x.dynamicTargetEl;a&&!hb(a,b);)a=a.parentNode;return a?!c||c!==a:!1},changeDynamicTarget:function(a){var b=l.target;a=a.target;for(var c=x.dynamicTargetEl;a&&!hb(a,b);)a=
a.parentNode;if(!a||c&&c===a)return!1;c&&d.setHandlers("unbind","_target");x.dynamicTargetEl=a;d.setHandlers("bind","_target");d.trigger("targetchange",e,a,c);return!0},showAfterDelay:function(a,b){x.showDelay=null;if(x.visible){"mouse"==x.position&&I(window.document.documentElement,"mousemove",d.onMouseMove);var c=l.position;(c.resize||c.screenX||c.screenY)&&I(window,"resize",d.onWindowResize);(c.scroll||c.screenX||c.screenY)&&I(window,"scroll",d.onWindowScroll);if(b||!1!==d.trigger("afterdelay",
e,a)){l.hide.remove&&d.appendElem();l.position.manual||d.reposition(a);A&&(l.overlay.animateShow?d.animate("show",null,!0):A.style.display="");if(l.show.preventScroll){var c=l.show.preventScroll,f,h;!0===c&&(c="body");c=U(c);f=-1;for(h=c.length;++f<h;I(c[f],"mousewheel",d.onPreventScroll)&&I(c[f],"touchmove",d.onPreventScroll));}l.show.animate&&!b?d.animate("show").done(function(){d.showAfterAnimation(a)}):Y(function(){d.showAfterAnimation(a)})}else x.visible=!1,l.debug&&console.log("showAfterDelay: afterdelay returned false",
e.getTarget())}else l.debug&&console.log("showAfterDelay: already hidden",d.getTarget())},showAfterAnimation:function(a){x.visible?(R(w,l.cls.hidden),L(w,l.cls.visible),l.render.keepVisible||(w.style.display=l.show.display||"block"),l.hide.timeout&&(x.hideTimeout=pa(d.hide,d,null,l.hide.timeout)),l.show.focus&&pa(d.setFocus,d,null,20),d.trigger("show",e,a)):l.debug&&console.log("showAfterAnimation: already hidden",d.getTarget())},hideAfterDelay:function(a,b){x.hideDelay=null;if(x.visible)l.debug&&
console.log("hideAfterDelay: already shown again",d.getTarget());else{"mouse"==x.position&&Z(window.document.documentElement,"mousemove",d.onMouseMove);var c=l.position;(c.resize||c.screenX||c.screenY)&&Z(window,"resize",d.onWindowResize);(c.scroll||c.screenX||c.screenY)&&Z(window,"scroll",d.onWindowScroll);if(b||!1!==d.trigger("afterhidedelay",e,a)){if(l.show.preventScroll){var c=l.show.preventScroll,f,h;!0===c&&(c="body");c=U(c);f=-1;for(h=c.length;++f<h;Z(c[f],"mousewheel",d.onPreventScroll)&&
Z(c[f],"touchmove",d.onPreventScroll));}A&&(l.overlay.animateShow?d.animate("hide",null,!0).done(function(){A.style.display="none"}):A.style.display="none");l.hide.animate&&!b?d.animate("hide").done(function(){d.hideAfterAnimation(a)}):Y(function(){d.hideAfterAnimation(a)})}else x.visible=l.cls.hidden?!Pa(w,l.cls.hidden):!(0>=w.offsetWidth||0>=w.offsetHeight),l.debug&&console.log("hideAfterDelay: afterhdelay returned false",d.getTarget())}},hideAfterAnimation:function(a){x.visible?l.debug&&console.log("hideAfterAnimation: already shown again",
d.getTarget()):(R(w,l.cls.visible),L(w,l.cls.hidden),l.render.keepVisible||(w.style.display="none"),d.trigger("hide",e,a),a=l.render.lifetime,null!==a&&(0===a?d.destroyElem():x.destroyDelay=pa(d.destroyElem,d,null,a)),w&&l.hide.destroy&&Y(function(){H(w,l.instanceName,null);d.destroy()}),w&&l.hide.remove&&Y(function(){d.removeElem()}))},render:function(){if(w)l.debug&&console.log("element already rendered",w);else{var a=l.render,c=l.cls;if(a.fn){var f=a.fn.call(k,e);a[B(f)?"tpl":"el"]=f}a.el?B(a.el)?
(w=U(a.el).shift(),a.keepInDOM=!0):w=a.el:(f=window.document.createElement("div"),f.innerHTML=a.tpl,w=f.firstChild);w||(w=window.document.createElement("div"));a.id&&w.setAttribute("id",a.id);l.render.keepVisible||(w.style.display="none");L(w,c.dialog);L(w,c.hidden);a.style&&b(w,a.style);l.overlay.enabled&&(A=window.document.createElement("div"),b(A,{display:"none",position:"fixed",left:0,top:0,right:0,bottom:0,opacity:l.overlay.opacity,backgroundColor:l.overlay.color}),I(A,"click",d.onOverlayClick),
a.zIndex&&b(A,{zIndex:a.zIndex}),l.overlay.cls&&L(A,l.overlay.cls));l.hide.remove?w.parentNode&&w.parentNode.removeChild(w):d.appendElem();a.zIndex&&b(w,{zIndex:a.zIndex});a=l.content;if(!1!==a.value)if(a.value)d.setContent(a.value);else if(a.fn)d.setContent(a.fn.call(k,e));else d[l.ajax.url?"loadContent":"readContent"]();C&&C.render();if(l.buttons)for(var h in l.buttons)if(a=U(l.buttons[h],w).shift())H(a,"metaphorjsTooltip-button-id",h),I(a,"click",d.onButtonClick),I(a,"keyup",d.onButtonKeyup);x.bindSelfOnRender&&
(d.setHandlers("bind","_self"),x.bindSelfOnRender=!1);x.rendered=!0;d.trigger("render",e)}},animate:function(a,b,c){var e,f;e=c?"show"==a?l.overlay.animateShow:l.overlay.animateHide:l[a].animate;E(e)&&(e=e(d,b));f=e.skipDisplayChange||!1;Fa(e)?e=a:B(e)&&(e=[e]);return ea(w,e,function(){if("show"==a&&!f){var b=new N;Y(function(){c?A.style.display="":w.style.display=l.show.display||"block";b.resolve()});return b}},!1)},toggleTitleAttribute:function(a){var b=e.getTarget(),c;b&&(!1===a?(H(b,"tmp-title",
z(b,"title")),b.removeAttribute("title")):(c=H(b,"tmp-title"))&&b.setAttribute("title",c))},changeDynamicContent:function(){l.content.fn?d.setContent(l.content.fn.call(k,e)):l.content.attr&&d.readContent()},getDialogSize:function(){var a=l.cls.hidden?Pa(w,l.cls.hidden):!!(0>=w.offsetWidth||0>=w.offsetHeight),c,d=w.style.left;a&&(b(w,{left:"-1000px"}),w.style.display=l.show.display);c={width:Ma(w),height:Na(w)};a&&(b(w,{left:d}),w.style.display="none");return c},getTargetSize:function(){var a=d.getTarget();
return a?{width:Ma(a),height:Na(a)}:null},getTargetPosition:function(a,b){var c=d.getTarget();if(!c)return null;var e=d.getDialogSize(),c=Sa(c),f=d.getTargetSize(),n={};b=b||l.position.type;var h=b.substr(0,1),q=b.substr(1),v=l.position.offsetX,k=l.position.offsetY,m=C?C.getDialogPositionOffset():null;switch(h){case "t":n.y=c.top-e.height-k;break;case "r":n.x=c.left+f.width+v;break;case "b":n.y=c.top+f.height+k;break;case "l":n.x=c.left-e.width-v}switch(q){case "t":n.y=c.top+k;break;case "r":n.x=
c.left+f.width-e.width-v;break;case "b":n.y=c.top+f.height-e.height-k;break;case "l":n.x=c.left+v;break;case "rc":n.x=c.left+f.width+v;break;case "lc":n.x=c.left-e.width-v;break;case "":switch(h){case "t":case "b":n.x=c.left+f.width/2-e.width/2;break;case "r":case "l":n.y=c.top+f.height/2-e.height/2}}m&&(n.x+=m.x,n.y+=m.y);return n},getMousePosition:function(a){if(!a)return null;var b=d.getDialogSize(),c={},f=l.position.type.substr(1),h=l.position.offsetX,q=l.position.offsetY,v=l.position.axis,m=
C?C.getDialogPositionOffset():null;switch(f){case "":c=l.position.get.call(k,e,a);break;case "t":c.y=a.pageY-b.height-q;c.x=a.pageX-b.width/2;break;case "r":c.y=a.pageY-b.height/2;c.x=a.pageX+h;break;case "b":c.y=a.pageY+q;c.x=a.pageX-b.width/2;break;case "l":c.y=a.pageY-b.height/2;c.x=a.pageX-b.width-h;break;case "rt":c.y=a.pageY-b.height-q;c.x=a.pageX+h;break;case "rb":c.y=a.pageY+q;c.x=a.pageX+h;break;case "lt":c.y=a.pageY-b.height-q;c.x=a.pageX-b.width-h;break;case "lb":c.y=a.pageY+q,c.x=a.pageX-
b.width-h}m&&(c.x+=m.x,c.y+=m.y);v&&(a=d.getTargetPosition(a,f))&&("x"==v?c.y=a.y:c.x=a.x);return c},getWindowPosition:function(){var a=d.getDialogSize(),b={},c=l.position.type.substr(1),e=l.position.offsetX,f=l.position.offsetY,n=Aa(),h=Ba(),q=Ma(window),v=Na(window);switch(c){case "c":b.y=v/2-a.height/2+n;b.x=q/2-a.width/2+h;break;case "t":b.y=n+f;b.x=q/2-a.width/2+h;break;case "r":b.y=v/2-a.height/2+n;b.x=q-a.width+h-e;break;case "b":b.y=v-a.height+n-f;b.x=q/2-a.width/2+h;break;case "l":b.y=v/
2-a.height/2+n;b.x=h+e;break;case "rt":b.y=n+f;b.x=q-a.width+h-e;break;case "rb":b.y=v-a.height+n-f;b.x=q-a.width+h-e;break;case "lt":b.y=n+f;b.x=h+e;break;case "lb":b.y=v-a.height+n-f,b.x=h+e}return b},correctScreenPosition:function(a,b,c){var e=d.getDialogSize(),f=Aa(),n=Ba(),h=Ma(window),q=Na(window);c&&a.y+e.height>q+f-c&&(a.y=q+f-c-e.height);b&&a.x+e.width>h+n-b&&(a.x=h+n-b-e.width);c&&a.y<f+c&&(a.y=f+c);b&&a.x<n+b&&(a.x=n+b);return a},onMouseMove:function(a){d.reposition(aa(a))},onWindowResize:function(a){d.reposition(aa(a))},
onWindowScroll:function(a){d.reposition(aa(a))},onPreventScroll:function(a){aa(a).preventDefault()},onOverlayClick:function(a){return l.modal?(a=aa(a),a.preventDefault(),a.stopPropagation(),!1):null},onButtonClick:function(a){var b=aa(a).target;(b=H(b,"metaphorjsTooltip-button-id"))&&d.trigger("button",e,b,a)},onButtonKeyup:function(a){if(13==a.keyCode||32==a.keyCode){var b=H(a.target,"metaphorjsTooltip-button-id");b&&d.trigger("button",e,b,aa(a))}},onAjaxLoad:function(a){R(w,l.cls.loading);d.setContent(a,
"ajax")},onImageLoad:function(){x.images--;d.onContentChange()},onContentChange:function(){x.visible&&d.reposition()},removeElem:function(){A&&A.parentNode&&Y(function(){x.visible||A.parentNode.removeChild(A)});w&&w.parentNode&&Y(function(){x.visible||w.parentNode.removeChild(w)})},appendElem:function(){var a=window.document.body,a=l.render.appendTo||a;A&&a&&a.appendChild(A);w&&a&&a.appendChild(w)},destroyElem:function(){d.setHandlers("unbind","_self");x.bindSelfOnRender=!0;C&&C.remove();A&&(A.parentNode.removeChild(A),
A=null);w&&(l.render.keepInDOM||w.parentNode.removeChild(w),w=null);d.trigger("lifetime",e)}},!0,!1);delete l.callback.scope;for(var D in l.callback)e.on(D,l.callback[D],k);d.init();return e};y(u,{defaults:{}});return u}();P({$class:"DialogComponent",$extends:bc,dialog:null,dialogPreset:null,dialogCfg:null,hidden:!0,initComponent:function(){this.$super();this._createDialog()},_getDialogCfg:function(){return y({},this.dialogCfg,{render:{el:this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=
new kc(this.dialogPreset,this._getDialogCfg());this.dialog.on("show",this.onDialogShow,this);this.dialog.on("hide",this.onDialogHide,this);this.dialog.on("beforeshow",this.onBeforeDialogShow,this);this.dialog.on("beforehide",this.onBeforeDialogHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},onRenderingFinished:function(){this.rendered=!0;this.afterRender();this.trigger("afterrender",this)},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},onBeforeDialogShow:function(){this.rendered||
this.render();this.template.setAnimation(!0);this.hidden=!1},onDialogShow:function(){this.onShow();this.trigger("show",this)},onBeforeDialogHide:function(){},onDialogHide:function(){this.template.setAnimation(!1);this.hidden=!0;this.onHide();this.trigger("hide",this)},onDialogDestroy:function(){this.destroying||(this.dialog=null,this.$destroy())},destroy:function(){this.destroying=!0;this.dialog&&this.dialog.destroy();this.$super()}});var lc=/^((https?|ftp):\/\/|)(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+;=]|:|@)|\/|\?)*)?$/i,
mc=function(){var b=0,a={},c=function(a,b){var c=0;switch(b.nodeName.toLowerCase()){case "select":return Xa(b,function(a){a.selected&&c++}),c;case "input":if(/radio|checkbox/i.test(b.type)){if(b.form)Xa(b.form,function(a){a.type==b.type&&a.name==b.name&&a.checked&&c++});else{var d,e,f;if(Ta(b))d=b.ownerDocument;else for(d=b;d.parentNode;)d=d.parentNode;d=U("input[name="+b.name+"]",d);e=0;for(f=d.length;e<f;e++)d[e].checked&&c++}return c}}return a.length},d=function(a,b){if(!b)return void 0==a||""===
a;switch(b.nodeName.toLowerCase()){case "select":var d=wa(b);return!d||0==d.length;case "input":if(/radio|checkbox/i.test(b.type))return 0==c(a,b)}return 0==X(a).length},e=function(a,b){if(E(b))return a;K(b)||(b=[b]);var c,d=b.length;for(c=-1;++c<d;a=a.replace(new RegExp("\\{"+c+"\\}","g"),b[c]));return a},f={};y(f,{required:function(a,b,c){return!1===c?!0:!d(a,b)},regexp:function(a,b,c){c=c instanceof RegExp?c:new RegExp(c);return d(a,b)||c.test(a)},notregexp:function(a,b,c){c=c instanceof RegExp?
c:new RegExp(c);return d(a,b)||!c.test(a)},minlength:function(a,b,e){return d(a,b)||(b?c(X(a),b)>=e:a.toString().length>=e)},maxlength:function(a,b,e){return d(a,b)||(b?c(X(a),b)<=e:a.toString().length<=e)},rangelength:function(a,b,e){var f=b?c(X(a),b):a.toString().length;return d(a,b)||f>=e[0]&&f<=e[1]},min:function(a,b,c){return d(a,b)||parseInt(a,10)>=c},max:function(a,b,c){return d(a,b)||parseInt(a,10)<=c},range:function(a,b,c){a=parseInt(a,10);return d(a,b)||a>=c[0]&&a<=c[1]},email:function(a,
b){return d(a,b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a)},
url:function(a,b){return d(a,b)||lc.test(a)},date:function(a,b){return d(a,b)||!/Invalid|NaN/.test(new Date(a))},dateiso:function(a,b){return d(a,b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return d(a,b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return d(a,b)||/^\d+$/.test(a)},creditcard:function(a,b){if(d(a,b))return!0;if(/[^0-9-]+/.test(a))return!1;var c=0,e=!1,f;a=a.replace(/\D/g,"");for(var h=a.length-1;0<=h;h--)f=a.charAt(h),f=parseInt(f,
10),e&&9<(f*=2)&&(f-=9),c+=f,e=!e;return 0==c%10},accept:function(a,b,c){c=B(c)?c.replace(/,/g,"|"):"png|jpe?g|gif";return d(a,b)||a.match(new RegExp(".("+c+")$","i"))},equalto:function(a,b,c,d){c=(b=d.getValidator().getField(c))?b.getElem():c;return a==wa(c)},notequalto:function(a,b,c,d){c=(b=d.getValidator().getField(c))?b.getElem():c;return a!=wa(c)},zxcvbn:function(a,b,c){return zxcvbn(a).score>=parseInt(c)}});var h={required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",
url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:"Please enter no more than {0} characters.",minlength:"Please enter at least {0} characters.",rangelength:"Please enter a value between {0} and {1} characters long.",
range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."},k={allowSubmit:!0,alwaysCheck:!1,alwaysDisplayState:!1,data:null,ignore:null,disabled:!1,cls:{valid:"",error:"",ajax:""},errorBox:{cls:"",fn:null,tag:"",position:"after",elem:null,enabled:!0},callback:{scope:null,destroy:null,statechange:null,errorchange:null,submit:null,check:null,beforeAjax:null,afterAjax:null,displaystate:null},rules:{},
messages:{}},p=function(a){if(!a)return{};var b=function(b,c,d){var e=a[b],f=!1;if(void 0!==e){switch(d){case "string":f=B(e);break;case "function":f=E(e);break;case "boolean":f=Fa(e)}f&&(a[b]={},a[b][c]=e)}};b("errorBox","enabled","boolean");b("errorBox","tag","string");b("errorBox","fn","function");return a},m=function(a,b,c){b=b||{};var d,e;this._observable=new ha;y(this,this._observable.getApi());this.cfg=d=y({},k,p(t.fieldDefaults),p(b),!0,!0);this.input=sa.get(a);this.input.onChange(this.onInputChange,
this);this.input.onKey(13,this.onInputSubmit,this);this.elem=a;this.vldr=c;this.callbackScope=e=d.callback.scope;this.enabled=!a.disabled;this.id=z(a,"name")||z(a,"id");this.data=b.data;this.rules={};d.messages=y({},h,t.messages,d.messages,!0,!0);b=c.getVldId();a.setAttribute("data-validator",b);this.input.radio&&this.initRadio();for(var f in d.callback)if(d.callback[f])this.on(f,d.callback[f],e);d.rules&&this.setRules(d.rules,!1);this.readRules();this.prev=this.input.getValue();d.disabled&&this.disable()};
y(m.prototype,{vldr:null,elem:null,rules:null,cfg:null,callbackScope:null,input:null,enabled:!0,valid:null,dirty:!1,id:null,prev:"",error:null,errorRule:null,pending:null,rulesNum:0,displayState:!1,data:null,checking:!1,checkTmt:null,errorBox:null,customError:!1,getValidator:function(){return this.vldr},initRadio:function(){var a=this.input.radio,b=this.vldr.getVldId(),c,d;c=0;for(d=a.length;c<d;c++)a[c].setAttribute("data-validator",b)},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,
a[c],!1);b?this.check(!1):this.setValidState(null);return this},setRule:function(a,b,c){var d=this.rules;c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check(!1):this.setValidState(null);return this},setMessage:function(a,b){this.cfg.messages[a]=b;return this},setMessages:function(a){for(var b in a)this.setMessage(b,a[b]);return this},getMessages:function(){return y({},this.cfg.messages)},readRules:function(){var a=
this.elem,b=a.className,c={},d,e;for(e in f)f.hasOwnProperty(e)&&(d=z(a,e)||z(a,"data-validate-"+e),void 0!=d&&!1!==d&&("minlength"!=e&&"maxlength"!=e||-1!=parseInt(d,10))&&(c[e]=d,(d=z(a,"data-message-"+e))&&this.setMessage(e,d)));if(d=z(a,"remote"))c.remote=d;if(b)for(b=b.split(" "),e=0,d=b.length;e<d;e++)if(a=X(b[e]),f[a]||"remote"==a)c[a]=!0;for(e in c)this.setRule(e,c[e],!1)},getRules:function(){return this.rules},hasRule:function(a){return this.rules[a]?!0:!1},getValue:function(){return this.input.getValue()},
getUserData:function(){return this.data},setUserData:function(a){var b=this.data;this.data=a;return b},isEmpty:function(){return d(this.getValue(),this.elem)},enable:function(){this.enabled=!0;this.vldr.reset();return this},disable:function(){this.enabled=!1;!1===this.valid&&(this.setValidState(!0),this.doDisplayState());return this},enableDisplayState:function(){this.displayState=!0},disableDisplayState:function(){this.displayState=!1},isDisplayStateEnabled:function(){return this.displayState},toggleErrorBox:function(a){var b=
this.cfg,c=b.errorBox.enabled;b.errorBox.enabled=a;!c&&a&&a.displayState&&!1===this.valid()&&this.doDisplayState()},isEnabled:function(){return this.enabled},getElem:function(){return this.elem},getName:function(){return this.id},getError:function(){return this.error},getErrorRule:function(){return this.errorRule},isValid:function(){return this.isEnabled()?this.customError?!1:!0===this.valid&&!this.pending||0===this.rulesNum:!0},getExactValidState:function(){return this.valid},setCustomError:function(a,
b){this.customError=a?!0:!1;this.setValidState(a?!1:!0);this.setError(!0===a?null:a,b);this.doDisplayState()},reset:function(){this.abort();this.dirty=!1;this.prev="";this.setValidState(null);this.setError(null);this.doDisplayState();return this},abort:function(){this.pending&&(this.pending.abort(),this.pending=null);return this},check:function(a){var b=this.rules,c=this.cfg,d=this.elem;if(!this.isEnabled())return!0;if(this.customError)return!1;if(0==this.rulesNum&&!1!==this.valid)return!0;if(this.checking)return this.checkTmt||
(this.checkTmt=setTimeout(A(this.checkTimeout,this),100)),!0===this.valid;this.checking=!0;if(!(!0===a||b.equalTo||b.notEqualTo||this.dirty||null===this.valid||c.alwaysCheck))return this.pending||this.doDisplayState(),this.checking=!1,!0===this.valid;var h=!0,k=!1,m=this.getValue(),p,r;for(r in b)if("remote"==r){if(this.dirty||c.alwaysCheck||null===this.valid||!0===a)if(m||b[r].checkEmpty)k=!0}else if(!0!==(p=(E(b[r])?b[r]:f[r]).call(this.callbackScope,m,d,b[r],this))){h=!1;this.setError(e(p||c.messages[r]||
"",b[r]),r);break}k=k&&h;h&&this.setError(null);k?this.ajaxCheck():(this.setValidState(h),this.doDisplayState());this.checking=this.dirty=!1;this.trigger("check",this,this.valid);return!0===this.valid&&!k},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,d=a.cls.valid,e=this.elem;this.displayState||a.alwaysDisplayState||(b=null);null===this.valid&&(b=null);c&&(!1===b?L(e,c):R(e,c));d&&(!0===b?L(e,d):R(e,d));c=this.getErrorBox();d=this.error;c&&(!1===b&&d&&(c.innerHTML=state.error),
c.style.display=!1===b&&d&&a.errorBox.enabled?"block":"none");this.trigger("displaystate",this,b,this.error)},getErrorBox:function(){var a=this.cfg.errorBox;return a.tag||a.fn||a.selector?(!this.errorBox&&a.enabled&&this.createErrorBox(),this.errorBox):null},destroy:function(){this.trigger("destroy",this);this.elem.removeAttribute("data-validator");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this.input.destroy();this.input=null;this._observable.destroy();this.elem=this.rules=
this.errorBox=this.cfg=this.vldr=this._observable=null},isPending:function(){return null!==this.pending},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("statechange",this,a))},setError:function(a,b){if(this.error!=a||this.errorRule!=b)this.error=a,this.errorRule=b,this.trigger("errorchange",this,a,b)},checkTimeout:function(){this.checkTmt=null;this.checking||this.check(!1)},onInputChange:function(a){this.prev!==a&&(this.dirty=!0,this.customError=!1,this.abort(),this.pending||
this.check(!1),this.prev=this.input.getValue())},onInputSubmit:function(a){a=aa(a);if(!(a.isDefaultPrevented&&a.isDefaultPrevented()||!1!==this.trigger("submit",this,a)))return a.preventDefault(),!1},createErrorBox:function(){var a=this.cfg.errorBox,b=a.tag,c=a.cls,d=a.fn,e=a.position,a=a.elem;d?this.errorBox=d.call(this.callbackScope,this):a?this.errorBox=a:(this.errorBox=window.document.createElement(b),this.errorBox.className=c,b=(b=this.input.radio)?b[b-1]:this.elem,"appendParent"==e?b.parentNode.appendChild(this.errorBox):
"before"==e?b.parentNode.insertBefore(this.errorBox,b):b.parentNode.insertBefore(this.errorBox,b.nextSibling))},ajaxCheck:function(){var a=this.elem,b=this.rules.remote,c=this.getValue(),d=this.cfg,b=y({},B(b)?{url:b}:b,!0);b.data=b.data||{};b.data[b.paramName||z(a,"name")||z(a,"id")]=c;b.handler||(b.dataType="text");b.cache=!1;d.cls.ajax&&L(a,d.cls.ajax);this.trigger("beforeAjax",this,b);this.pending=$a(b);this.pending.done(A(this.onAjaxSuccess,this));this.pending.fail(A(this.onAjaxError,this))},
onAjaxSuccess:function(a){var b=this.rules,c=this.cfg;this.pending=null;var d=!0;b.remote.handler?(a=b.remote.handler.call(this.callbackScope,this,a),!0!==a&&(this.setError(e(a||c.messages.remote||"",b.remote),"remote"),d=!1)):a?(this.setError(a,"remote"),d=!1):this.setError(null);c.cls.ajax&&R(this.elem,c.cls.ajax);this.setValidState(d);this.doDisplayState();this.trigger("afterAjax",this)},onAjaxError:function(a,b){var c=this.cfg;c.cls.ajax&&R(this.elem,c.cls.ajax);this.pending=null;"abort"!=b&&
"abort"!=a&&(this.setValidState(!1),this.doDisplayState(),this.trigger("afterAjax",this))}},!0,!1);var u={alwaysCheck:!1,alwaysDisplayState:!1,disabled:!1,value:null,elem:null,errorBox:null,errorField:null,data:null,cls:{valid:"",error:""},fields:[],rules:{},messages:{},callback:{scope:null,destroy:null,statechange:null,errorchange:null,displaystate:null}},r=function(a,b){a=a||{};var c,d;this._observable=new ha;this._vldr=b;y(this,this._observable.getApi());this.cfg=c=y({},u,t.groupDefaults,a,!0,
!0);this.callbackScope=d=c.callback.scope;this.data=a.data;this.el=a.elem;this.fields={};this.rules={};c.messages=y({},h,t.messages,c.messages,!0,!0);var e;if(c.callback)for(e in c.callback)if(c.callback[e])this.on(e,c.callback[e],d);c.rules&&this.setRules(c.rules,!1);if(c.fields)for(e=0,d=a.fields.length;e<d;e++)this.add(b.getField(c.fields[e]));this.enabled=!c.disabled};y(r.prototype,{fields:null,rules:null,cfg:null,callbackScope:null,vldr:null,enabled:!1,invalid:null,valid:null,displayState:!1,
rulesNum:0,error:null,data:null,errorBox:null,el:null,enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},isValid:function(){return!this.enabled||0===this.invalid&&!0===this.valid},getExactValidState:function(){return this.valid},reset:function(){this.invalid=0;this.setValidState(null);this.setError(null);this.doDisplayState();return this},getUserData:function(){return this.data},getName:function(){return this.cfg.name},
setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check():this.setValidState(null);return this},setRule:function(a,b,c){var d=this.rules;c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check():this.setValidState(null);return this},getRules:function(){return y({},this.rules)},hasRule:function(a){return this.rules[a]?!0:!1},setError:function(a){var b=this.cfg;this.error!=
a&&(b.errorField?(this.vldr.getField(b.errorField).setError(a),this.error=null):(this.error=a,this.trigger("errorchange",this,a)))},getError:function(){return this.error},getFields:function(){return this.fields},enableDisplayState:function(){this.displayState=!0;return this},disableDisplayState:function(){this.displayState=!1;return this},check:function(){var a=this.cfg,b=this.fields,c=this.rules;if(!this.enabled||0==this.rulesNum)return this.setValidState(null),this.doDisplayState(),!0;this.countInvalid();
if(0<this.invalid)return this.setValidState(null),this.doDisplayState(),!0;var d={},h=!0,k=null,m;if(a.value){for(m in b)d[m]=b[m].getValue();k=a.value.call(this.callbackScope,d,this)}for(m in c)if(!0!==(b=(E(c[m])?c[m]:f[m]).call(this.callbackScope,k,null,c[m],this,d))){h=!1;b||a.messages[m]?this.setError(e(b||a.messages[m]||"",c[m])):this.setError(null);break}h&&this.setError(null);this.setValidState(h);this.doDisplayState();return!0===this.valid},doDisplayState:function(){var a=this.valid,b=this.cfg;
this.displayState||b.alwaysDisplayState||(a=null);if(b.errorBox){var c=this.getErrorBox();null!==a?c&&(c.innerHTML=this.error||"",c.style.display=!1===this.valid?"block":"none"):c&&(c.style.display="none")}c=b.cls.error;b=b.cls.valid;a=this.valid;c&&(!1===a?L(this.el,c):R(this.el,c));b&&(!0===a?L(this.el,b):R(this.el,b));this.trigger("displaystate",this,this.valid)},getErrorBox:function(){var a=this.cfg,b=this.fields,c=a.errorBox;if(b[c])return b[c].getErrorBox();this.errorBox||(E(a.errorBox)?this.errorBox=
a.errorBox.call(this.callbackScope,this):this.errorBox=a.errorBox);return this.errorBox},destroy:function(){var a=this.fields,b;for(b in a)a[b]&&this.setFieldEvents(a[b],"un");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this._observable.destroy();this.cfg=this.fields=this.rules=this.vldr=this._observable=null},add:function(a){var b=this.fields,c=a.getName();b[c]||(b[c]=a,this.setFieldEvents(a,"on"))},setFieldEvents:function(a,b){a[b]("statechange",this.onFieldStateChange,this)},
remove:function(a){var b=this.fields,c=a.getName();b[c]&&(delete b[c],this.setFieldEvents(a,"un"));return this},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("statechange",this,a))},countInvalid:function(){var a=this.fields;this.invalid=0;for(var b in a)this.invalid+=a[b].isValid()?0:1},onFieldStateChange:function(a,b){this.trigger("fieldstatechange",this,a,b);this.check()}},!0,!1);var s={form:null,all:{},fields:{},rules:{},cls:{valid:"",error:"",checking:""},groups:{},callback:{scope:null,
destroy:null,reset:null,beforesubmit:null,submit:null,statechange:null,check:null,displaystate:null,displaystatechange:null}},t=function(c,d,e){var f=c.nodeName.toLowerCase();this.vldId=++b;a[this.vldId]=this;c.setAttribute("data-validator",this.vldId);this.el=c;d&&!B(d)&&(e=d,d=null);this._observable=new ha;this.cfg=c=y({},s,t.defaults,t[d],e,!0,!0);this.callbackScope=d=c.callback.scope;this.isForm="form"==f;this.isField=/input|select|textarea/.test(f);this.fields={};this.groups={};y(this,this._observable.getApi());
this._observable.createEvent("submit",!1);this._observable.createEvent("beforesubmit",!1);this.onRealSubmitClickDelegate=A(this.onRealSubmitClick,this);this.resetDelegate=A(this.reset,this);this.onSubmitClickDelegate=A(this.onSubmitClick,this);this.onFormSubmitDelegate=A(this.onFormSubmit,this);delete c.callback.scope;var h,k;for(k in c.callback)this.on(k,c.callback[k],d);this.initFields();f=this.fields;for(h in c.rules)f[h]&&f[h].setRules(c.rules[h],!1);c.rules=null;for(h in c.groups)this.addGroup(h,
c.groups[h]);this.initForm("bind");delete c.rules;delete c.fields;delete c.groups;this.enabled=!0};y(t.prototype,{vldId:null,el:null,cfg:null,enabled:!1,invalid:null,pending:0,grps:0,outside:!0,submitted:!1,displayState:!1,isForm:!1,isField:!1,submitButton:null,hidden:null,callbackScope:null,preventFormSubmit:!1,_observable:null,fields:null,groups:null,getVldId:function(){return this.vldId},getElem:function(){return this.el},getGroup:function(a){return this.groups[a]||null},getField:function(a){return this.fields[a]||
null},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},enableDisplayState:function(){var a=this.fields,b=this.groups,c;if(!0!==this.displayState){this.displayState=!0;for(c in a)a[c].enableDisplayState();for(c in b)b[c].enableDisplayState();this.trigger("displaystatechange",this,!0)}return this},disableDisplayState:function(){var a=this.groups,b=this.fields,c;if(!1!==this.displayState){this.displayState=!1;for(c in b)b[c].disableDisplayState();
for(c in a)a[c].disableDisplayState();this.trigger("displaystatechange",this,!1)}return this},isDisplayStateEnabled:function(){return this.displayState},isValid:function(){return!1===this.enabled?!0:0===this.invalid&&0===this.pending&&0===this.grps&&!0===this.outside},getErrors:function(a){var b=!0==a?[]:{},c,d,e,f=[this.fields,this.groups],h;if(!this.isEnabled())return b;for(e=0;2>e;e++)for(d in h=f[e],h)null===h[d].getExactValidState()&&h[d].check(),h[d].isValid()||(c=h[d].getError())&&(a?b.push(c):
b[d]=c);return b},check:function(){var a=this.fields,b=this.groups;if(!this.isEnabled())return!0;var c=this.isValid(),d;for(d in a)a[d].check();for(d in b)b[d].check();this.outside=!1!==this.trigger("check",this);a=this.isValid();c!=a&&(this.doDisplayState(),this.trigger("statechange",this,!1));return a},add:function(a,b){if(!fb(a)||null!==z(a,"data-no-validate")||null!==z(a,"data-validator"))return this;var c=z(a,"name")||z(a,"id"),d=this.cfg,e=this.fields;if(!c)return this;c=d.fields&&d.fields[c]?
d.fields[c]:b||{};B(c)&&(c={rules:[c]});c=y({},d.all||{},c,!0,!0);if(c.ignore)return this;c.callback||(c.callback={scope:this.callbackScope});d=new m(a,c,this);c=d.getName();if(e[c])return this;e[c]=d;this.setFieldEvents(d,"on");this.displayState&&d.enableDisplayState();this.isEnabled()&&null!==this.invalid&&d.check();return this},addGroup:function(a,b){var c=this.groups;c[a]||(b.name=a,c[a]=new r(b,this),this.setGroupEvents(c[a],"on"),this.isEnabled()&&null!==this.invalid&&c[a].check())},focusInvalid:function(){var a=
this.fields,b;for(b in a)if(!a[b].isValid()){a[b].getElem().focus();break}},reset:function(){var a=this.fields,b=this.groups,c;this.submitted=!1;this.disableDisplayState();for(c in b)b[c].reset();for(c in a)a[c].reset();this.pending=0;this.invalid=null;this.grps=0;this.outside=!1;this.doDisplayState();this.trigger("reset",this);return this},submit:function(){var a=this.el;if(this.isForm)if(E(a.submit))!1!==this.trigger("beforesubmit",this)&&!1!==this.trigger("submit",this)&&a.submit();else this.onSubmit();
else this.onSubmit()},setFieldEvents:function(a,b){a[b]("statechange",this.onFieldStateChange,this);a[b]("beforeAjax",this.onBeforeAjax,this);a[b]("afterAjax",this.onAfterAjax,this);a[b]("submit",this.onFieldSubmit,this);a[b]("destroy",this.onFieldDestroy,this);a[b]("errorchange",this.onFieldErrorChange,this)},setGroupEvents:function(a,b){a[b]("statechange",this.onGroupStateChange,this)},initFields:function(){var a=this.el,b,c;if(this.isField)return this.add(a),this;a=U("input, textarea, select",
a);b=-1;for(c=a.length;++b<c;this.add(a[b]));return this},initForm:function(a){var b=this.el,c=b.getElementsByTagName("input"),d=U(".submit",b),e=U(".reset",b);a="bind"==a?I:Z;var f,h,k,m;f=0;for(h=c.length;f<h;f++)m=c[f],k=m.type,"submit"==k?a(m,"click",this.onRealSubmitClickDelegate):"reset"==k&&a(m,"click",this.resetDelegate);f=-1;for(h=d.length;++f<h;"submit"!=d[f].type&&a(d[f],"click",this.onSubmitClickDelegate));f=-1;for(h=e.length;++f<h;"reset"!=e[f].type&&a(e[f],"click",this.resetDelegate));
this.isForm&&a(b,"submit",this.onFormSubmitDelegate)},onRealSubmitClick:function(a){a=aa(a||window.event);this.submitButton=a.target||a.srcElement;this.preventFormSubmit=!1;return this.onSubmit(a)},onSubmitClick:function(a){this.preventFormSubmit=!1;return this.onSubmit(aa(a||window.event))},onFormSubmit:function(a){a=aa(a);if(!this.isValid()||this.preventFormSubmit)return a.preventDefault(),!1},onFieldSubmit:function(a,b){this.preventFormSubmit=!1;this.enableDisplayState();this.submitted=!0;return this.onSubmit(b)},
onSubmit:function(a){this.enableDisplayState();this.isForm||(a&&a.preventDefault(),a&&a.stopPropagation());if(this.pending)return a&&a.preventDefault(),!1;var b=this.submitButton?!0:!1;this.isForm&&(this.hidden&&(this.el.removeChild(this.hidden),this.hidden=null),this.submitButton&&/input|button/.test(this.submitButton.nodeName)&&(this.hidden=window.document.createElement("input"),this.hidden.type="hidden",this.hidden.setAttribute("name",this.submitButton.name),this.hidden.value=this.submitButton.value,
this.el.appendChild(this.hidden)));this.submitButton=null;if(!this.isValid()&&(this.check(),this.onFieldStateChange(),this.pending))return a&&a.preventDefault(),!1;if(!1===this.trigger("beforesubmit",this)||!this.isValid())return a&&(a.preventDefault(),a.stopPropagation()),this.pending||(this.focusInvalid(),this.submitted=!1),this.trigger("failedsubmit",this,b),!1;this.pending||(this.submitted=!1);a=this.trigger("submit",this);this.preventFormSubmit=!a;return this.isForm?a:!1},onFieldDestroy:function(a){a=
a.getElem();a=z(a,"name")||z(a,"id");delete this.fields[a]},onFieldErrorChange:function(a,b){this.trigger("fielderrorchange",this,a,b)},onFieldStateChange:function(a,b){var c=this.invalid,d=this.fields;this.invalid=0;for(var e in d)this.invalid+=d[e].isValid()?0:1;a&&this.trigger("fieldstatechange",this,a,b);if(null===c||null!==c&&this.invalid!==c)this.doDisplayState(),this.trigger("statechange",this,this.isValid())},onGroupStateChange:function(){var a=this.groups,b=this.grps;this.grps=0;for(var c in a)this.grps+=
a[c].isValid()?0:1;if(null===b||null!==b&&this.grps!==b)this.doDisplayState(),this.trigger("statechange",this,this.isValid())},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,a=a.cls.valid,d=this.el;if(this.isField||!this.displayState)b=null;null===this.invalid&&(b=null);c&&(!1===b?L(d,c):R(d,c));a&&(!0===b?L(d,a):R(d,a));this.trigger("displaystate",this,b)},onBeforeAjax:function(){this.pending++;this.cfg.cls.ajax&&L(this.el,this.cfg.cls.ajax)},onAfterAjax:function(){var a=
this.fields,b=this.cfg;this.pending=0;for(var c in a)this.pending+=a[c].isPending()?1:0;this.doDisplayState();b.cls.ajax&&R(this.el,b.cls.ajax);this.submitted&&0==this.pending&&(this.submitted=!1,this.isValid()?this.submit():this.focusInvalid())},destroy:function(){var b=this.groups,c=this.fields,d;this.reset();this.trigger("destroy",this);delete a[this.vldId];for(d in b)b.hasOwnProperty(d)&&b[d]&&(this.setGroupEvents(b[d],"un"),b[d].destroy());for(d in c)c.hasOwnProperty(d)&&c[d]&&(this.setFieldEvents(c[d],
"un"),c[d].destroy());this._observable.destroy();this._observable=null;this.initForm("unbind");this.cfg=this.el=this.groups=this.fields=null}},!0,!1);t.defaults={};t.messages={};t.fieldDefaults={};t.groupDefaults={};t.addMethod=function(a,b,c){f[a]||(f[a]=b,c&&(t.messages[a]=c))};t.getValidator=function(b){b=z(b,"data-validator");return a[b]||null};return t}();D.registerAttribute("mjs-validate",250,function(b,a,c,d){c=c||"ValidatorComponent";var e=za(c);e?new e(a,b,d):ja(Error("Class '"+c+"' not found"))});
P({$class:"ValidatorComponent",node:null,scope:null,validator:null,scopeState:null,fields:null,formName:null,$init:function(b,a,c){this.node=b;this.scope=a;this.scopeState={};this.fields=[];this.validator=this.createValidator();this.formName=z(b,"name")||z(b,"id")||"$form";this.initScope();this.initScopeState();this.initValidatorEvents();c.once("rendered",this.validator.check,this.validator);c.on("destroy",this.$destroy,this);a.$on("destroy",this.$destroy,this)},createValidator:function(){var b=this.node,
a={},c;if(c=ba(b).submit)a.callback=a.callback||{},a.callback.submit=function(a,b){return function(){try{return a(b)}catch(c){ja(c)}}}(Kb(c),this.scope);return new mc(b,a)},initValidatorEvents:function(){var b=this.validator;b.on("fieldstatechange",this.onFieldStateChange,this);b.on("statechange",this.onFormStateChange,this);b.on("displaystatechange",this.onDisplayStateChange,this);b.on("fielderrorchange",this.onFieldErrorChange,this);b.on("reset",this.onFormReset,this)},initScope:function(){this.scope[this.formName]=
this.scopeState},initScopeState:function(){var b=this.node,a=this.scopeState,c=this.fields,d,e,f;b.elements?d=b.elements:(d=[],Xa(b,function(a){fb(a)&&d.push(a)}));b=-1;for(f=d.length;++b<f;)e=d[b],(e=z(e,"name")||z(e,"id"))&&!a[e]&&(c.push(e),a[e]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null});a.$$validator=this.validator;a.$invalid=!1;a.$pristine=!0;a.$submit=A(this.validator.onSubmit,this.validator);a.$reset=A(this.validator.reset,this.validator)},onDisplayStateChange:function(b,
a){if(a){a=this.scopeState;var c,d,e,f=this.fields;c=0;for(d=f.length;c<d;c++)e=a[f[c]],e.$real&&(a[f[c]]=e.$real);a.$invalid=!b.isValid();a.$pristine=!1;this.scope.$check()}else this.onFormReset(b)},onFieldErrorChange:function(b,a,c){this.onFieldStateChange(b,a,a.isValid())},onFormReset:function(b){b=this.scopeState;var a,c,d,e=this.fields;a=0;for(c=e.length;a<c;a++)d=b[e[a]],d.$error=null,d.$errorMessage=null,d.$invalid=null,d.$pristine=!0;b.$invalid=!1;b.$pristine=!0;this.scope.$check()},onFormStateChange:function(b,
a){var c=this.scopeState;c.$invalid=!1===a&&b.isDisplayStateEnabled();c.$pristine=!1;this.scope.$check()},onFieldStateChange:function(b,a,c){var d=this.scopeState,e=a.getName();b=b.isDisplayStateEnabled();a={$error:a.getErrorRule(),$errorMessage:a.getError(),$invalid:!1===c,$pristine:null===a.getExactValidState()};b?d[e]=a:d[e].$real=a;this.scope.$check()},destroy:function(){this.destroyed||this.validator.destroy();this.scope&&delete this.scope[this.formName]}});J("plugin.ListAnimatedMove",P({$init:function(b){b.$implement({getNodePositions:function(a,
b,d){for(var e=[],f,h,k,p={};a.firstChild;)a.removeChild(a.firstChild);f=0;for(h=b.length;f<h;f++)d&&d[f]&&(k=d[f].el.cloneNode(!0),a.appendChild(k)),k=b[f].el.cloneNode(!0),a.appendChild(k),e.push(k);f=0;for(h=e.length;f<h;f++)a=e[f],(d=b[f].renderer)&&(p[d.id]={left:a.offsetLeft,top:a.offsetTop});return p},calculateTranslates:function(a,b,d){var e=this.parentEl,f=e.parentNode,h=e.cloneNode(!0),k=e.offsetWidth,p=[],m=0,u=0,r;r=h.style;r.position="absolute";r.left="-10000px";r.visibility="hidden";
r.width=k+"px";f.insertBefore(h,e);r.width=k-(h.offsetWidth-k)+"px";b=this.getNodePositions(h,b);d=this.getNodePositions(h,a,d);e=this.getNodePositions(h,a);f.removeChild(h);f=0;for(h=a.length;f<h;f++)k=a[f].el,r=a[f].renderer,r=r.id,0==f&&(m=k.offsetLeft,u=k.offsetTop),p.push([{left:e[r].left-m-(d[r].left-m),top:e[r].top-u-(d[r].top-u)},b[r]?{left:b[r].left-m-(d[r].left-m),top:b[r].top-u-(d[r].top-u)}:null]);return p},moveAnimation:function(a,b,d,e,f){var h=a.style;f.done(function(){if(d){var a=
Ja();h[a.transform]="translateX("+d.left+"px) translateY("+d.top+"px)"}});return ea(a,"move",e,!1,V,function(a,d,e){0==d&&"start"!=e&&b&&(a=Ja(),h[a.transform]="translateX("+b.left+"px) translateY("+b.top+"px)")})}})}}));J("plugin.Observable",P({$mixins:[Ua],$init:function(b){b.$implement({$$observable:this.$$observable,on:this.on,once:this.once,un:this.un,trigger:this.trigger})}}));J("plugin.SrcDeferred",P({directive:null,scrollEl:null,scrollDelegate:null,resizeDelegate:null,position:null,sw:null,
sh:null,checkVisibility:!0,$init:function(b){this.directive=b;b.$intercept("onChange",this.onChange,this,"instead")},$beforeHostInit:function(b,a){this.scrollEl=qb(a);this.scrollDelegate=A(this.onScroll,this);this.resizeDelegate=A(this.onResize,this);I(this.scrollEl,"scroll",this.scrollDelegate);I(window,"resize",this.resizeDelegate)},isVisible:function(){if(!this.checkVisibility)return!0;var b=this.scrollEl,a=Aa(b),c=Ba(b),d=this.sw,e=this.sh,f;this.position||(this.position=xb(this.directive.node,
b));d||(d=this.sw=Gb(b),e=this.sh=Hb(b));b=this.position.top;f=this.position.left;return b>a&&b<a+e&&f>c&&f<c+d},onScroll:function(){this.directive.queue.add(this.changeIfVisible,this)},onResize:function(){this.sw=this.position=null;this.directive.queue.add(this.changeIfVisible,this)},onChange:function(){this.directive.queue.add(this.changeIfVisible,this)},changeIfVisible:function(){if(this.isVisible())return this.stopWatching(),this.directive.doChange()},stopWatching:function(){this.scrollEl&&(Z(this.scrollEl,
"scroll",this.scrollDelegate),Z(window,"resize",this.resizeDelegate),this.scrollEl=null,this.checkVisibility=!1)},$beforeHostDestroy:function(){this.stopWatching()}}));J("plugin.SrcSize",P({directive:null,width:null,height:null,origOnChange:null,$init:function(b){this.directive=b;this.origOnChange=b.$intercept("onSrcChanged",this.onSrcChanged,this,"after")},$afterHostInit:function(b,a){var c=ba(a,b).preloadSize,d=a.style;"attr"!=c&&(c=la(c)(b));var e="attr"==c?parseInt(z(a,"width"),10):c.width,c=
"attr"==c?parseInt(z(a,"height"),10):c.height;if(e||c)d.display="block";e&&(d.width=e+"px");c&&(d.height=c+"px")},onSrcChanged:function(){var b=this.directive,a=b.node.style;b.onSrcChanged=this.origOnChange;a.removeProperty?(a.removeProperty("width"),a.removeProperty("height"),a.removeProperty("display")):(a.removeAttribute("width"),a.removeAttribute("height"),a.removeAttribute("display"));this.$destroy()}}))})();
