(function(){var L={lib:{},cmp:{},view:{}},B=function(b){return"function"==typeof b},Jb=Object.prototype.toString,Z=function(){var b={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(a){if(!a){if(null===a)return 6;if(void 0===a)return 7}var c=b[Jb.call(a)];return void 0===c?-1:1==c&&isNaN(a)?8:c}}(),z=function(b){return"string"==typeof b||b===""+b},sa=function(b){if(null===
b||"object"!=typeof b)return!1;b=Z(b);return 2<b||-1==b},$a=function(b,a){var c={};b||(b="undefined"!=typeof global?global:window);this.register=function(d,e){var f;f=d;var g=f.split("."),h,p=g.pop();h=g.join(".");var n=g.length,u,r=b;if(c[h])f=[c[h],p,f];else{if(0<n)for(h=0;h<n;h++){u=g[h];if(a&&0==h)if(u==a){r=b;continue}else f=a+"."+f;void 0===r[u]&&(r[u]={});r=r[u]}else a&&(f=a+"."+f);f=[r,p,f]}g=f[0];p=f[1];sa(g)&&void 0===g[p]&&(g[p]=e,c[f[2]]=e);return e};this.exists=function(a){return void 0!==
c[a]};this.get=function(d,e){if(void 0!==c[d])return c[d];if(a&&void 0!==c[a+"."+d])return c[a+"."+d];if(!e){var f=d.split("."),g,h=f.length,p,n=b;for(g=0;g<h;g++)if(p=f[g],a&&0==g&&p==a)n=b;else{if(void 0===n[p])return;n=n[p]}n&&(c[d]=n);return n}};this.add=function(b,e){a&&0!==b.indexOf(a)&&(b=a+"."+b);void 0===c[b]&&(c[b]=e);return e};this.remove=function(a){delete c[a]};this.normalize=function(b){return b&&a&&0!==b.indexOf(a)?a+"."+b:b}};$a.prototype={register:null,exists:null,get:null,add:null,
remove:null,normalize:null};var ha=Array.prototype.slice,ya=function(b,a,c,d){setTimeout(function(){b.apply(a,c||[])},d||0)},aa=function(b){var a=b.stack||Error().stack;if("undefined"!=typeof console&&console.log)ya(function(){console.log(b);a&&console.log(a)});else throw b;},F=function(){},qb=function(b){b||(b=new $a);var a=function(){this.supr&&this.supr!==F&&this.supr.apply(this,arguments)},c=function(a,b){return f(function(){},a,b)},d=function(a,b,c){return function(){var d,e=this.supr;this.supr=
a.prototype[b]||("__construct"==b?a:F)||F;d=c.apply(this,arguments);this.supr=e;return d}},e=function(a,b,c){for(var e in b)b.hasOwnProperty(e)&&(a[e]=!B(b[e])||!B(c.prototype[e])&&c.prototype[e]?b[e]:d(c,e,b[e]))},f=function(b,c,d){var f=function(){};f.prototype=b.prototype;f=new f;c.__construct=d||a;var r=function(){if(!(this instanceof r))return r.instantiate.apply(null,arguments);this.__construct.apply(this,arguments);this.initialize&&this.initialize.apply(this,arguments)};e(f,c,b);f.constructor=
r;r.prototype=f;r.prototype.getClass=function(){return r.className};r.prototype.getParentClass=function(){return r.parentClass};r.instantiate=function(){var a=function(){},b;a.prototype=r.prototype;a=new a;b=r.prototype.constructor.apply(a,arguments);return sa(b)?b:a};r.extend=function(a,b,c,d){return g(a,r,b,c,d)};return r},g=function(a,d,e,g,r,t){null===a&&(a="");B(a)?(r=e,z(d)?(r=g,g=e):(g=d,e=a,d=null),a=null):z(a)||(r=d,g=a,a=e=d=null);z(d)||B(d)||(r=g,g=e,e=d,d=null);B(e)||(r=g,g=e,e=null);
g=g||{};var m=d&&z(d)?b.get(d):d;if(d&&!m)throw Error(d+" not found");d=m?f(m,g,e):c(g,e);d.isMetaphorClass=!0;d.parent=m;d.parentClass=m?m.className:null;d.className=b.normalize(a);if(r)for(var l in r)r.hasOwnProperty(l)&&(d[l]=r[l]);a&&(t?b.add(a,d):b.register(a,d));r&&r.alias&&b.add(r.alias,d);return d};this.factory=function(a){var c=b.get(a),d=ha.call(arguments,1);if(!c)throw Error(a+" not found");return c.instantiate.apply(this,d)};this.isSubclassOf=function(a,c){var d=a,e=b.get;c=z(c)?b.normalize(c):
c.getClass?c.getClass():c.className;for(z(a)&&(d=e(b.normalize(a)));d;){if(d.className==c)return!0;d=d.getParentClass?e(d.getParentClass()):d.parent}return!1};this.isInstanceOf=function(a,c){var d=z(c)?b.get(c):c;return d?a instanceof d:!1};this.define=g;this.defineCache=function(a,b,c,d,e){return g(a,b,c,d,e,!0)};this.extend=function(a,b,c,d){return g(null,a,b,c,d)}};qb.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,defineCache:null,extend:null};var ba=new $a(L,"MetaphorJs"),
Sa=new qb(ba),I=Sa.define,x=Function.prototype.bind?function(b,a){return b.bind(a)}:function(b,a){return function(){return b.apply(a,arguments)}},ta=function(b){return"object"==typeof b&&3===Z(b)&&!b.nodeType},za=function(b){return!0===b||!1===b},ab=function(b){return null===b},y=function(){return function a(){var c=!1,d=!1,e=ha.call(arguments),f=e.shift(),g,h,p;za(e[e.length-1])&&(c=e.pop());za(e[e.length-1])&&(d=c,c=e.pop());for(;e.length;)if(g=e.shift())for(h in g)if(g.hasOwnProperty(h)&&void 0!==
(p=g[h]))if(d)if(f[h]&&ta(f[h])&&ta(p))a(f[h],p,c,d);else{if(!0===c||void 0==f[h])ta(p)?(f[h]={},a(f[h],p,c,!0)):f[h]=p}else if(!0===c||void 0==f[h])f[h]=p;return f}}(),W=function(){var b=["0","0","0"];return function(){for(var a=b.length,c;a;){a--;c=b[a].charCodeAt(0);if(57==c)return b[a]="A",b.join("");if(90==c)b[a]="0";else return b[a]=String.fromCharCode(c+1),b.join("")}b.unshift("0");return b.join("")}}(),X=function(){this.events={}};X.prototype={createEvent:function(b,a){b=b.toLowerCase();var c=
this.events;c[b]||(c[b]=new bb(b,a));return c[b]},getEvent:function(b){b=b.toLowerCase();return this.events[b]},on:function(b,a,c,d){b=b.toLowerCase();var e=this.events;e[b]||(e[b]=new bb(b));return e[b].on(a,c,d)},once:function(b,a,c,d){d=d||{};d.limit=1;return this.on(b,a,c,d)},un:function(b,a,c){b=b.toLowerCase();var d=this.events;d[b]&&d[b].un(a,c)},hasListener:function(b,a,c){b=b.toLowerCase();var d=this.events;return d[b]?d[b].hasListener(a,c):!1},removeAllListeners:function(b){var a=this.events;
a[b]&&a[b].removeAllListeners()},trigger:function(){var b=arguments[0],a=this.events,b=b.toLowerCase();if(!a[b])return null;b=a[b];return b.trigger.apply(b,ha.call(arguments,1))},suspendEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].suspend()},suspendAllEvents:function(){var b=this.events,a;for(a in b)b[a].suspend()},resumeEvent:function(b){b=b.toLowerCase();var a=this.events;a[b]&&a[b].resume()},resumeAllEvents:function(){var b=this.events,a;for(a in b)b[a].resume()},destroyEvent:function(b){var a=
this.events;a[b]&&(a[b].removeAllListeners(),a[b].destroy(),delete a[b])},destroy:function(b){var a=this.events;if(b)b=b.toLowerCase(),a[b]&&(a[b].destroy(),delete a[b]);else{for(var c in a)a[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var b="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),a={},c,d=-1,e=b.length;++d<e;c=b[d],a[c]=x(this[c],this));this.api=a}return this.api}};
var bb=function(b,a){this.name=b;this.listeners=[];this.map={};this.hash=W();this.uni="$$"+b+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=void 0===a?null:a};bb.prototype={getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(b,a,c){if(!b)return null;a=a||null;c=c||{};var d=this.uni,e=a||b;if(e[d]&&!c.allowDupes)return null;var f=++this.lid,g=c.first||!1;e[d]=f;b={fn:b,scope:a,uniScope:e,id:f,called:0,limit:c.limit||0,start:c.start||1,count:0,
append:c.append,prepend:c.prepend};g?this.listeners.unshift(b):this.listeners.push(b);this.map[f]=b;return f},once:function(b,a,c){c=c||{};c.once=!0;return this.on(b,a,c)},un:function(b,a){var c=-1,d=this.uni,e=this.listeners,f;f=b==parseInt(b)?b:(a||b)[d];if(!f)return!1;for(var g=0,h=e.length;g<h;g++)if(e[g].id==f){c=g;delete e[g].uniScope[d];break}if(-1==c)return!1;e.splice(c,1);delete this.map[f];return!0},hasListener:function(b,a){var c=this.listeners,d;if(b){a=a||b;d=B(b)?a[this.uni]:b;if(!d)return!1;
for(var e=0,f=c.length;e<f;e++)if(c[e].id==d)return!0;return!1}return 0<c.length},removeAllListeners:function(){var b=this.listeners,a=this.uni,c,d;c=0;for(d=b.length;c<d;c++)delete b[c].uniScope[a];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(b,a){var c;b.append||b.prepend?(c=ha.call(a),b.prepend&&(c=b.prepend.concat(c)),b.append&&(c=c.concat(b.append))):c=a;return c},trigger:function(){var b=this.listeners,a=this.returnResult;
if(this.suspended||0==b.length)return null;for(var c="all"==a?[]:null,d,e,b="first"==a?[b[0]]:ha.call(b);d=b.shift();)if(d&&this.map[d.id]&&(d.count++,!(d.count<d.start))){e=d.fn.apply(d.scope,this._prepareArgs(d,arguments));d.called++;d.called==d.limit&&this.un(d.id);"all"==a&&c.push(e);if("first"==a)return e;"last"==a&&(c=e);if(!1==a&&!1===e)break}if(a)return c}};var P=function(b){return"object"==typeof b&&5===Z(b)},J=function(){return String.prototype.trim?function(b){return z(b)?b.trim():b}:function(b){return z(b)?
b.replace(/^\s\s*/,"").replace(/\s\s*$/,""):b}}(),cb=function(b){return b===window||b&&b.document&&b.location&&b.alert&&b.setInterval},rb=function(){var b=function(a,c){if(a===c)return!0;if(null===a||null===c)return!1;if(a!==a&&c!==c)return!0;var d=typeof a,e;if(d==typeof c&&"object"==d)if(P(a)){if(!P(c))return!1;if((d=a.length)==c.length){for(e=0;e<d;e++)if(!b(a[e],c[e]))return!1;return!0}}else{if(10===Z(a))return 10===Z(c)&&a.getTime()==c.getTime();if(9===Z(a)&&9===Z(c))return a.toString()==c.toString();
if(cb(a)||cb(c)||P(c))return!1;d={};for(e in a)if("$"!=e.charAt(0)&&!B(a[e])){if(!b(a[e],c[e]))return!1;d[e]=!0}for(e in c)if(!d.hasOwnProperty(e)&&"$"!=e.charAt(0)&&void 0!==c[e]&&!B(c[e]))return!1;return!0}return!1};return b}(),sb=function(){var b=function(a,c){if(cb(a))throw Error("Cannot copy window object");if(c){if(a===c)throw Error("Objects are identical");if(P(a))for(var d=c.length=0,e=a.length;d<e;d++)c.push(b(a[d]));else{for(d in c)delete c[d];for(d in a)a.hasOwnProperty(d)&&("$"==d.charAt(0)||
B(a[d])?c[d]=a[d]:c[d]=b(a[d]))}}else(c=a)&&(P(a)?c=b(a,[]):10===Z(a)?c=new Date(a.getTime()):9===Z(a)?c=new RegExp(a.source):ta(a)&&(c=b(a,{})));return c};return b}(),ua=function(b){b=Z(b);return 3>b&&-1<b},db=function(){var b=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,a=Function,c=function(a,b,c,d){for(;c&&!c.$isRoot;)if(c=c.$parent)try{return 4==arguments.length?b.call(null,c,d,F,b):b.call(null,c,F,b)}catch(e){}null!==a&&aa(a)},d=function(a,b){return function(){var d=ha.call(arguments);d.push(c);d.push(a);
d=a.apply(null,d);return b&&(void 0===d||"number"==typeof d&&isNaN(d))?(d=ha.call(arguments),d.unshift(a),d.unshift(null),c.apply(null,d)):d}},e={},f=0,g={},h=0,p={},n=0,u=function(){1E3<=f&&(e={});1E3<=h&&(g={});1E3<=n&&(p={})};return{createGetter:function(c){try{return e[c]?e[c]:(f++,e[c]=d(new a("____","$$interceptor","$$itself","".concat("try {","return ",c.replace(b,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }")),!0))}catch(g){return aa(g),F}},createSetter:function(c){try{if(!g[c]){h++;
var e=c.replace(b,"$1____.$3");return g[c]=d(new a("____","$$$$","$$interceptor","$$itself","".concat("try {",e," = $$$$",";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____, $$$$); }")))}return g[c]}catch(f){return aa(f),F}},createFunc:function(c){try{return p[c]?p[c]:(n++,p[c]=d(new a("____","$$interceptor","$$itself","".concat("try {",c.replace(b,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }"))))}catch(e){return aa(e),F}},resetCache:u,
enableResetCacheInterval:function(){setTimeout(u,1E4)}}}(),Ka=db.createGetter,Kb=db.createSetter,eb=function(){var b=function(a){if(!z(a))return!0;var b=a.substr(0,1),c=a.length-1;return'"'!=b&&"'"!=b||a.indexOf(b,1)!=c?!1:a.substring(1,c)},a,c=function(c,d,f,n,u,r){a||(a=new X);var t=W(),m;r&&(this.namespace=r,this.nsGet=r.get);this.origCode=d;z(d)||(n=f,f=d,d=null,m="object");z(c)&&(n=f,f=d,d=c,c=null);d&&c&&(m=c.hasOwnProperty(d)?"attr":"expr");d&&!c&&(m="expr");if(f)a.on(t,f,n||this,{append:[u],
allowDupes:!0});if("expr"==m){d=this._processInputPipes(d,c);d=this._processPipes(d,c);if(this.inputPipes||this.pipes)d=e(c,d),m=c.hasOwnProperty(d)?"attr":"expr";if(this.staticValue=b(d))m="static"}this.userData=u;this.code=d;this.id=t;this.type=m;this.obj=c;"expr"==m&&(this.getterFn=Ka(d));this.curr=this._getValue();this.currCopy=ua(this.curr)?this.curr:sb(this.curr)};c.prototype={namespace:null,nsGet:null,staticValue:null,origCode:null,code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,
itv:null,curr:null,currCopy:null,prev:null,unfiltered:null,pipes:null,inputPipes:null,lastSetValue:null,userData:null,_indexArrayItems:function(a){var b="$$"+this.id,c,d,e;if(a)for(c=0,d=a.length;c<d;c++)e=a[c],!e||ua(e)||e[b]||(e[b]=W())},_processInputPipes:function(a,b){if(-1==a.indexOf(">>"))return a;for(var c=0,d=a.length,e=[],f,t,m,l=a;c<d&&-1!=(f=a.indexOf(">>",c));)t=a.charAt(f-1),m=a.charAt(f+2),"\\"!=t&&"'"!=t&&'"'!=t&&"'"!=m&&'"'!=m&&(c=J(a.substring(c,f)).split(":"),l=a.substr(f+2),this._addPipe(e,
c,b,this.onInputParamChange)),c=f+2;e.length&&(this.inputPipes=e);return J(l)},_addPipe:function(a,b,c,e){var f=b.shift(),r=null,t=[],m;this.nsGet&&(r=this.nsGet("filter."+f,!0));r||(r=window[f]||c[f]);if(B(r)){f=-1;for(m=b.length;++f<m;t.push(d(c,b[f],e,this,null,this.namespace)));a.push([r,b,t])}},_processPipes:function(a,b){if(-1==a.indexOf("|"))return a;for(var c=0,d=a.length,e=[],f,t,m,l=!1,s=a;c<d;)if(-1!=(f=a.indexOf("|",c)))t=a.charAt(f-1),m=a.charAt(f+1),"|"!=t&&"'"!=t&&'"'!=t&&"|"!=m&&"'"!=
m&&'"'!=m&&(l?(c=J(a.substring(c,f)).split(":"),this._addPipe(e,c,b)):(l=!0,s=J(a.substring(0,f)))),c=f+1;else{l&&(c=J(a.substr(c)).split(":"),this._addPipe(e,c,b,this.onPipeParamChange));break}e.length&&(this.pipes=e);return s},_getValue:function(){var a;switch(this.type){case "static":a=this.staticValue;break;case "attr":a=this.obj[this.code];break;case "expr":a=this.getterFn(this.obj);break;case "object":a=this.obj}P(a)&&(this.inputPipes||this._indexArrayItems(a),a=a.slice());this.unfiltered=a;
return a=this._runThroughPipes(a,this.pipes)},_runThroughPipes:function(a,b){if(b){var c,d,e,r=b.length,t=this.obj,m,l;for(c=0;c<r;c++){e=b[c][1];d=[];m=-1;for(l=e.length;++m<l;d.push(f(e[m],t)));d.unshift(t);d.unshift(a);a=b[c][0].apply(null,d)}}return a},subscribe:function(b,c,d){a.on(this.id,b,c,d)},unsubscribe:function(b,c){return a.un(this.id,b,c)},hasPipes:function(){return null!==this.pipes},hasInputPipes:function(){return null!=this.inputPipes},getValue:function(){return this._getValue()},
getUnfilteredValue:function(){return this.unfiltered||this.curr},getPrevValue:function(){return this.prev},getPrescription:function(a,b){var c;b=b||this._getValue();var d=b,e=a.length,f=d.length,t=Array(e+1);c=Array(e+1);var m,l,s,k=0;if(e==f&&0==e)c=[];else{for(m=0;m<=e;m++)t[m]=Array(f+1),c[m]=Array(f+1),t[m][0]=m,c[m][0]="D";for(m=0;m<=f;m++)t[0][m]=m,c[0][m]="I";for(m=1;m<=e;m++)for(l=1;l<=f;l++)s=rb(a[m-1],d[l-1])?0:1,t[m][l-1]<t[m-1][l]&&t[m][l-1]<t[m-1][l-1]+s?(t[m][l]=t[m][l-1]+1,c[m][l]=
"I"):t[m-1][l]<t[m-1][l-1]+s?(t[m][l]=t[m-1][l]+1,c[m][l]="D"):(t[m][l]=t[m-1][l-1]+s,c[m][l]=1==s?"R":"-");d=[];m=e;l=f;do e=c[m][l],d.push(e),"-"!=e&&k++,"R"==e||"-"==e?(m--,l--):"D"==e?m--:l--;while(0!=m||0!=l);c=d.reverse()}return c},getMovePrescription:function(a,b,c){var d=c=c||this._getValue();c=this.getPrescription(a,c);var e=[],f,t,m,l={},s,k;f=0;for(t=a.length;f<t;f++)(m=b(a[f]))&&(l[m]=f);s=0;var v={};f=0;for(t=c.length;f<t;f++)a=c[f],"D"!=a&&(m=b(d[s]),void 0!=m&&!0!==v[m]&&void 0!==(k=
l[m])?(e.push(k),v[m]=!0):e.push(a),s++);return e},setValue:function(a){var b=this.type;this.lastSetValue=a;a=this._runThroughPipes(a,this.inputPipes);"attr"==b?this.obj[this.code]=a:"expr"==b?(this.setterFn||(this.setterFn=Kb(this.code)),this.setterFn(this.obj,a)):"object"==b&&(this.obj=a)},onInputParamChange:function(){this.setValue(this.lastSetValue)},onPipeParamChange:function(){this.check()},check:function(){var b=this._getValue(),c=this.currCopy;return rb(c,b)?!1:(this.curr=b,this.prev=c,this.currCopy=
ua(b)?b:sb(b),a.trigger(this.id,b,c),!0)},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(b,c){var d=this.id;b&&a.un(d,b,c);return a.hasListener(d)?!1:(this.destroy(),!0)},destroy:function(){var b=this.pipes,c=this.inputPipes,d,e,f,r,t;
this.itv&&this.clearInterval();if(b)for(d=-1,e=b.length;++d<e;)for(t=b[d][2],f=-1,r=t.length;++f<r;)t[f].unsubscribeAndDestroy(this.check,this);if(c)for(d=-1,e=c.length;++d<e;)for(t=c[d][2],f=-1,r=t.length;++f<r;)t[f].unsubscribeAndDestroy(this.onInputParamChange,this);this.obj&&delete this.obj.$$watchers[this.origCode];delete this.id;delete this.curr;delete this.prev;delete this.unfiltered;delete this.obj;delete this.pipes;delete this.inputPipes;delete this.origCode;delete this.code;delete this.getterFn;
delete this.setterFn;delete this.lastSetValue;delete this.staticValue;delete this.userData;delete this.namespace;delete this.nsGet;a.destroyEvent(this.id)}};var d=function(a,b,d,f,u,r){b=e(a,J(b));return a?(a.$$watchers||(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof c&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof c)this[a].destroy(),delete this[a]}}),
a.$$watchers[b]?a.$$watchers[b].subscribe(d,f,{append:[u],allowDupes:!0}):a.$$watchers[b]=new c(a,b,d,f,u,r),a.$$watchers[b]):new c(a,b,d,f,u,r)},e=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},f=function(a,c){var d;return(d=b(a))?d:Ka(a)(c)};c.create=d;c.unsubscribeAndDestroy=function(a,b,c,d){b=J(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,d)&&delete a[b]};c.normalizeExpr=e;c.eval=f;return c}(),
ja=function(b){this.$$observable=new X;this.$$historyWatchers={};y(this,b,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)};ja.prototype={$app:null,$parent:null,$root:null,$isRoot:!1,$$observable:null,$$watchers:null,$$historyWatchers:null,$$checking:!1,$$destroyed:!1,$new:function(){return new ja({$parent:this,$root:this.$root,$app:this.$app})},$newIsolated:function(){return new ja({$app:this.$app})},
$on:function(b,a,c){return this.$$observable.on(b,a,c)},$un:function(b,a,c){return this.$$observable.un(b,a,c)},$watch:function(b,a,c){return eb.create(this,b,a,c,null)},$unwatch:function(b,a,c){return eb.unsubscribeAndDestroy(this,b,a,c)},$watchHistory:function(b,a){this.$$historyWatchers[a]||(this.$$historyWatchers[a]=b,L.history.on("change-"+a,this.$$onHistoryChange,this))},$unwatchHistory:function(b){this.$$historyWatchers[b]||(delete this.$$historyWatchers[b],L.history.un("change-"+b,this.$$onHistoryChange,
this))},$get:function(b){for(var a=this;a;){if(void 0!==a[b])return a[b];a=a.$parent}},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$$onHistoryChange:function(b,a,c){this.$$historyWatchers[c]&&(a=this.$$historyWatchers[c],this[a]=b,this.$check())},$check:function(){var b;this.$$checking||(this.$$checking=!0,this.$$watchers&&(b=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",b))},$destroy:function(){var b;
this.$$observable.trigger("destroy");this.$$observable.destroy();delete this.$$observable;delete this.$app;delete this.$root;delete this.$parent;this.$$watchers&&(this.$$watchers.$destroyAll(),delete this.$$watchers);for(b in this.$$historyWatchers)this.$unwatchHistory(b);delete this.$$historyWatchers;this.$$destroyed=!0}};var ga=function(b){if(b&&void 0!=!b.length&&b!==""+b){for(var a=[],c=-1,d=b.length>>>0;++c!==d;a[c]=b[c]);return a}return b?[b]:[]},ea=function(b){if(!b||!b.then)return!1;var a,
c;return"object"!=(c=typeof b)&&"function"!=c?!1:B(a=b.then)?a:!1},La=ba.get,K=function(){var b=/^[\w[:#.][\w\]*^|=!]*$/,a=/=([^\]]+)/,c=/ *, */,d=/(\([^)]*)\+/,e=/(\[[^\]]+)~/,f=/(~|>|\+)/,g=/ +/,h=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,p=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,n=/\D/,u=/[^(]*\(([^)]*)\)/,r=/\(.*/,t=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,m=document,l=!!m.getElementsByClassName,s=!!m.querySelectorAll,
k={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=a.nextSibling)&&1!=a.nodeType;);return!!a},root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,b){var c=a.nodeIndex||0,d=b[3]=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.firstChild;c++;do if(1==f.nodeType&&(f.nodeIndex=++c)&&a===f&&(c+d)%e)return 0;while(f=f.nextSibling);return 1},"nth-last-child":function(a,b){var c=a.nodeIndexLast||
0,d=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.lastChild;c++;do if(1==f.nodeType&&(f.nodeLastIndex=c++)&&a===f&&(c+d)%e)return 0;while(f=f.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!=a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},lang:function(a,b){return a.lang!==b&&m.documentElement.lang!==b},enabled:function(a){return a.disabled||
"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},v={},q=function(a){return v[a]||(v[a]=new RegExp("(^| +)"+a+"($| +)"))},A={"":function(a,b){return null!==a.getAttribute(b)},"=":function(a,b,c){var d;return(d=a.getAttribute(b))&&d===c},"&=":function(a,b,c){var d;return(d=a.getAttribute(b))&&q(c).test(d)},"^=":function(a,b,c){var d;return(d=a.getAttribute(b)+"")&&!d.indexOf(c)},"$=":function(a,b,c){var d;return(d=a.getAttribute(b)+"")&&d.indexOf(c)==
d.length-c.length},"*=":function(a,b,c){var d;return(d=a.getAttribute(b)+"")&&-1!=d.indexOf(c)},"|=":function(a,b,c){var d;return(d=a.getAttribute(b)+"")&&(d===c||!!d.indexOf(c+"-"))},"!=":function(a,b,c){var d;return!(d=a.getAttribute(b))||!q(c).test(d)}},C=function(C,V){V=V||m;var G=[],v=null,q,ca,x,E,z,y,B;if(s)try{G=ga(V.querySelectorAll(C.replace(a,'="$1"')))}catch(D){v=!0}if(!s||v)if(b.test(C))switch(v=0,C.charAt(0)){case "#":v=C.slice(1);G=m.getElementById(v);G.id!==v&&(G=m.all[v]);G=G?[G]:
[];break;case ".":q=C.slice(1);if(l)G=ga((G=V.getElementsByClassName(q)).length?G:[]);else{q=" "+q+" ";ca=V.getElementsByTagName("*");for(x=0;E=ca[x++];)-1!=(" "+E.className+" ").indexOf(q)&&(G[v++]=E);G=v?G:[]}break;case ":":ca=V.getElementsByTagName("*");x=0;z=C.replace(u,"$1");for(y=C.replace(r,"");E=ca[x++];)k[y]&&!k[y](E,z)&&(G[v++]=E);G=v?G:[];break;case "[":ca=V.getElementsByTagName("*");x=0;E=t.exec(C);q=E[1];B=E[2]||"";for(z=E[3];E=ca[x++];)A[B]&&(A[B](E,q,z)||"class"===q&&A[B](E,"className",
z))&&(G[v++]=E);G=v?G:[];break;default:G=ga((G=V.getElementsByTagName(C)).length?G:[])}else{for(var F=C.split(c),H=F.length-1,O=!!H,P,R,N,Q,I,J,K,L,U,M,S,T;v=F[H--];){R=(P=v.replace(d,"$1%").replace(e,"$1&").replace(f," $1 ").split(g)).length;x=0;Q=" ";for(ca=[V];N=P[x++];)if(" "!==N&&">"!==N&&"~"!==N&&"+"!==N&&ca){N=N.match(h);I=N[1]||"*";J=N[2];K=N[3]?" "+N[3]+" ":"";q=N[4];B=N[5]||"";y=N[7];z="nth-child"===y||"nth-last-child"===y?p.exec("even"===N[8]&&"2n"||"odd"===N[8]&&"2n%1"||!n.test(N[8])&&
"0n%"+N[8]||N[8]):N[8];L=[];v=U=0;for(S=x==R;M=ca[U++];)switch(Q){case " ":T=M.getElementsByTagName(I);for(M=0;E=T[M++];)J&&E.id!==J||K&&-1==(" "+E.className+" ").indexOf(K)||!(!q||A[B]&&(A[B](E,q,N[6])||"class"===q&&A[B](E,"className",N[6])))||E.yeasss||(k[y]?k[y](E,z):y)||(S&&(E.yeasss=1),L[v++]=E);break;case "~":for(I=I.toLowerCase();(M=M.nextSibling)&&!M.yeasss;)1!=M.nodeType||"*"!==I&&M.nodeName.toLowerCase()!==I||J&&M.id!==J||K&&-1==(" "+M.className+" ").indexOf(K)||!(!q||A[B]&&(A[B](E,q,N[6])||
"class"===q&&A[B](E,"className",N[6])))||M.yeasss||(k[y]?k[y](M,z):y)||(S&&(M.yeasss=1),L[v++]=M);break;case "+":for(;(M=M.nextSibling)&&1!=M.nodeType;);!M||M.nodeName.toLowerCase()!==I.toLowerCase()&&"*"!==I||J&&M.id!==J||K&&-1==(" "+E.className+" ").indexOf(K)||!(!q||A[B]&&(A[B](E,q,N[6])||"class"===q&&A[B](E,"className",N[6])))||M.yeasss||(k[y]?k[y](M,z):y)||(S&&(M.yeasss=1),L[v++]=M);break;case ">":for(T=M.getElementsByTagName(I),x=0;E=T[x++];)E.parentNode!==M||J&&E.id!==J||K&&-1==(" "+E.className+
" ").indexOf(K)||!(!q||A[B]&&(A[B](E,q,N[6])||"class"===q&&A[B](E,"className",N[6])))||E.yeasss||(k[y]?k[y](E,z):y)||(S&&(E.yeasss=1),L[v++]=E)}ca=L}else Q=N;if(O){if(!ca.concat){L=[];for(M=0;E=ca[M];)L[M++]=E;ca=L}G=ca.concat(1==G.length?G[0]:G)}else G=ca}for(v=G.length;v--;)G[v].yeasss=G[v].nodeIndex=G[v].nodeIndexLast=null}return G};C.is=function(a,b){var c=C(b,a.parentNode),d,e;d=-1;for(e=c.length;++d<e;)if(c[d]===a)return!0;return!1};return C}(),tb=function(){var b=document.createTextNode("");
return z(b.textContent)?"textContent":"nodeValue"}(),la=eb.create,ub=function(){var b=/\\{/g,a=new X,c=function(a,b,c,h,p){return!b||!b.indexOf||-1==b.indexOf("{{")&&-1==b.indexOf("{[")?null:new d(a,b,c,h,p)},d=function(a,b,c,d,p){this.id=W();this.origin=b;this.scope=a;this.parent=c;this.isRoot=!c;this.data=d;this.lang=a.$app?a.$app.lang:null;if(!0===p||!1===p)this.recursive=p;this.watchers=[];this.children=[];this.dataChangeDelegate=x(this.doDataChange,this);this.processed=this.processText(b);this.render()};
d.prototype={id:null,parent:null,isRoot:null,scope:null,origin:"",processed:null,text:null,watchers:null,children:null,data:null,recursive:!1,dataChangeDelegate:null,changeTmt:null,lang:null,subscribe:function(b,c){return a.on(this.id,b,c)},unsubscribe:function(b,c){return a.un(this.id,b,c)},getString:function(){null===this.text&&this.render();var a=this.text;return-1!=a.indexOf("\\{")?a.replace(b,"{"):a},render:function(){var a=this.processed,b,c,h;this.children.length||this.createChildren();h=this.children;
b=-1;for(c=h.length;++b<c;a=a.replace("---"+b+"---",h[b]instanceof d?h[b].getString():h[b]));return this.text=a},processText:function(a){for(var b=0,c=a.length,d,p,n="";b<c;)if(-1!=(d=a.indexOf("{{",b))&&-1!=(p=a.indexOf("}}",d+2))&&"\\"!=a.substr(d-1,1))n+=a.substring(b,d),p!=d+2&&(n+=this.watcherMatch(a.substring(d+2,p))),b=p+2;else{b!==c&&(n+=a.substring(b));break}b=0;a=n;c=a.length;for(n="";b<c;)if(-1!=(d=a.indexOf("{[",b))&&-1!=(p=a.indexOf("]}",d+2))&&"\\"!=a.substr(d-1,1))n+=a.substring(b,
d),p!=d+2&&(n+=this.watcherMatch(a.substring(d+2,p),!0)),b=p+2;else{b!==c&&(n+=a.substring(b));break}return n},watcherMatch:function(a,b){var c=this.watchers;if(b){a=J(a);var d=a.split("|"),p=J(d[0]);"."!=p.substr(0,1)&&(d[0]="'"+p+"'");1==d.length&&d.push("l");a=d.join(" | ")}c.push(la(this.scope,a,this.onDataChange,this,null,ba));return"---"+(c.length-1)+"---"},onDataChange:function(){this.changeTmt||(this.changeTmt=setTimeout(this.dataChangeDelegate,0))},doDataChange:function(){this.destroyChildren();
this.triggerChange();this.changeTmt=null},triggerChange:function(){this.text=null;this.isRoot?a.trigger(this.id,this,this.data):this.parent.triggerChange()},createChildren:function(){var a=this.watchers,b=this.children,d=this.scope,h=this.recursive,p,n,u;p=-1;for(n=a.length;++p<n;)u=a[p].getLastResult(),b.push(h&&c(d,u,this,null,!0)||u)},destroyChildren:function(){var a=this.children,b,c;b=-1;for(c=a.length;++b<c;)a[b]instanceof d&&a[b].destroy();this.children=[]},destroyWatchers:function(){var a=
this.watchers,b,c;b=-1;for(c=a.length;++b<c;a[b].unsubscribeAndDestroy(this.onDataChange,this));this.watchers=[]},destroy:function(){this.destroyChildren();this.destroyWatchers();a.destroyEvent(this.id);delete this.watchers;delete this.children;delete this.origin;delete this.processed;delete this.text;delete this.scope;delete this.data;delete this.dataChangeDelegate;delete this.lang;this.changeTmt&&clearTimeout(this.changeTmt);delete this.changeTmt}};d.create=c;return d}(),Lb=function(b){var a={},
c,d,e=b.attributes;b=0;for(c=e.length;b<c;b++)d=e[b],a[d.name]=d.value;return a},O=function(){var b={};return function(a,c,d){a=a._mjsid||(a._mjsid=W());var e=b[a];return void 0!==d?(e||(e=b[a]={}),e[c]=d):e?e[c]:void 0}}(),H=function(){var b=[],a=!1,c="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)},d=function(){a=!0;var e=b.shift();c(function(){e[0].apply(e[1],e[2]);b.length?d():a=!1},0)},e=function(c,e,f){f=f||[];b.push([c,e,f]);a||d()},f=function(a,b){return function(c){try{b.resolve(a(c))}catch(d){b.reject(d)}}},
g=function(a,b){if(a instanceof g)return a;if(!(this instanceof g))return new g(a,b);var c;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(c=ea(a))a instanceof g?a.then(x(this.resolve,this),x(this.reject,this)):(new g(c,a)).then(x(this.resolve,this),x(this.reject,this));else if(B(a))try{a.call(b,x(this.resolve,this),x(this.reject,this))}catch(d){this.reject(d)}else this.resolve(a)};g.prototype={_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,
_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(a,b){var c;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(c=ea(a)){a instanceof g?a.then(x(this._processResolveValue,this),x(this._processRejectReason,
this)):(new g(c,a)).then(x(this._processResolveValue,this),x(this._processRejectReason,this));return}}catch(d){0==this._state&&this._doReject(d);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)e(b[0],b[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;
this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,b;b=a.shift();)e(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b){var c=new g,d=this._state;
0==d||0!=this._wait?(a&&B(a)?this._fulfills.push([f(a,c),null]):this._fulfills.push([c.resolve,c]),b&&B(b)?this._rejects.push([f(b,c),null]):this._rejects.push([c.reject,c])):1==d?a&&B(a)?e(f(a,c),null,[this._value]):c.resolve(this._value):2==d&&(b&&B(b)?e(f(b,c),null,[this._reason]):c.reject(this._reason));return c},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)try{b[0].call(b[1]||null,this._value)}catch(c){aa(c)}},done:function(a,b){var c=this._state;
if(1==c&&0==this._wait)try{a.call(b||null,this._value)}catch(d){aa(d)}else 0==c&&this._dones.push([a,b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)try{b[0].call(b[1]||null,this._reason)}catch(c){aa(c)}},fail:function(a,b){var c=this._state;if(2==c&&0==this._wait)try{a.call(b||null,this._reason)}catch(d){aa(d)}else 0==c&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:x(this.then,this),done:x(this.done,
this),fail:x(this.fail,this),always:x(this.always,this)}},after:function(a){var b=this;if(ea(a)){b._wait++;var c=function(){b._wait--;0==b._wait&&0!=b._state&&(1==b._state?b._callResolveHandlers():b._callRejectHandlers())};B(a.done)?a.done(c):a.then(c)}return b}};g.fcall=function(a,b,c){return g.resolve(a.apply(b,c||[]))};g.resolve=function(a){var b=new g;b.resolve(a);return b};g.reject=function(a){var b=new g;b.reject(a);return b};g.all=function(a){if(!a.length)return g.resolve(null);var b=new g,
c=a.length,d=Array(c),e=c,f,m,l=function(a,c){d[c]=a;e--;0==e&&b.resolve(d)};for(f=0;f<c;f++)(function(c){m=a[f];m instanceof g?m.done(function(a){l(a,c)}).fail(b.reject,b):ea(m)||B(m)?(new g(m)).done(function(a){l(a,c)}).fail(b.reject,b):l(m,c)})(f);return b};g.when=function(){return g.all(arguments)};g.allResolved=function(a){if(!a.length)return g.resolve(null);var b=new g,c=a.length,d=[],e=c,f,m,l=function(a){d.push(a);s()},s=function(){e--;0==e&&b.resolve(d)};for(f=0;f<c;f++)m=a[f],m instanceof
g?m.done(l).fail(s):ea(m)||B(m)?(new g(m)).done(l).fail(s):l(m);return b};g.race=function(a){if(!a.length)return g.resolve(null);var b=new g,c=a.length,d,e;for(d=0;d<c&&(e=a[d],e instanceof g?e.done(b.resolve,b).fail(b.reject,b):ea(e)||B(e)?(new g(e)).done(b.resolve,b).fail(b.reject,b):b.resolve(e),b.isPending());d++);return b};g.waterfall=function(a){if(!a.length)return g.resolve(null);for(var b=a.shift(),b=B(b)?g.fcall(b):g.resolve(c),c;c=a.shift();)ea(c)?b=b.then(function(a){return function(){return a}}(c)):
B(c)?b=b.then(c):b.resolve(c);return b};g.counter=function(a){var b=new g;b.countdown=function(){a--;0==a&&b.resolve()};return b};return g}(),Y=ba.add,gb=function(){var b=[],a=[],c=!1,d=!1,e=function(a,b){return a.priority<b.priority?-1:a.priority>b.priority?1:0};return{registerAttributeHandler:function(a,d,e){La("attr."+a,!0)||(b.push({priority:d,name:a,handler:Y("attr."+a,e)}),c=!1)},getAttributeHandlers:function(){c||(b.sort(e),c=!0);return b},registerTagHandler:function(b,c,e){La("tag."+b,!0)||
(a.push({priority:c,name:b,handler:Y("tag."+b,e)}),d=!1)},getTagHandlers:function(){d||(a.sort(e),d=!0);return a}}}(),Mb=gb.getAttributeHandlers,Ta=Array.prototype.indexOf;Ta||(Ta=Array.prototype.indexOf=function(b,a){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;c=+a||0;Infinity===Math.abs(c)&&(c=0);if(c>=e)return-1;for(c=Math.max(0<=c?c:e-Math.abs(c),0);c<e;){if(c in d&&d[c]===b)return c;c++}return-1});var hb=function(){var b=
null,a=ub.create,c=function(a,b,c,d,e,g){var l=[];if(a&&!0!==a){if(a.nodeType){g.countdown+=1;f(a,c,d,e,g);return}l=ha.call(a)}l.length||(l=ga(b.childNodes));b=l.length;g.countdown+=b;for(a=-1;++a<b;f(l[a],c,d,e,g));},d=function(a,b){if(b)if(b.nodeType)a.push(b);else if(P(b))for(var c=-1,e=b.length;++c<e;d(a,b[c]));},e={script:!0,template:!0,"mjs-template":!0,style:!0},f=function(a,b,d,f,g){if(a){var m;m=a.nodeName;g||(g={countdown:1});if(!m||!e[m.toLowerCase()])if(m=b.call(d,a),!1!==m){if(ea(m)){m.done(function(e){!1!==
e&&c(e,a,b,d,f,g);0==--g.countdown&&f&&f.call(d)});return}c(m,a,b,d,f,g)}0==--g.countdown&&f&&f.call(d)}},g=new X,h=function(a,b,c){this.id=W();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof ja&&b.$on("destroy",this.destroy,this);if(c)c.on("destroy",this.destroy,this)};h.prototype={id:null,el:null,scope:null,texts:null,parent:null,destroyed:!1,_observable:null,on:function(a,b,c){return g.on(a+"-"+this.id,b,c)},un:function(a,b,c){return g.un(a+"-"+this.id,b,c)},createChild:function(a){return new h(a,
this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,c,d){var e=a.$isolateScope?b.$newIsolated():a.$breakScope?b.$new():b,f=b.$app;c=f.inject(a,null,{$scope:e,$node:c,$attrValue:d,$renderer:this},[e,c,d,this]);f&&a.$registerBy&&c&&(ea(c)?c.done(function(c){f.registerCmp(c,b,a.$registerBy)}):f.registerCmp(c,b,a.$registerBy));return a.$stopRenderer?!1:c},processNode:function(c){var e=c.nodeType,f=this.texts,g=this.scope,t,m;if(3==e){if(t=null!==c.parentNode.getAttribute("mjs-recursive"),
e=a(g,c[tb],null,f.length,t))e.subscribe(this.onTextChange,this),f.push({node:c,tr:e}),this.renderText(f.length-1)}else if(1==e){b||(b=Mb());var e=[],l=[],s,k,h;m="tag."+c.tagName.toLowerCase();if(m=La(m,!0)){k=this.runHandler(m,g,c);if(!1===k)return!1;ea(k)?e.push(k):d(l,k)}s=Lb(c);m=0;for(t=b.length;m<t;m++)if(h=b[m].name,void 0!==(k=s[h])){c.removeAttribute(h);k=this.runHandler(b[m].handler,g,c,k);delete s[h];if(!1===k)return!1;ea(k)?e.push(k):d(l,k)}if(e.length){var q=new H;H.all(e).done(function(a){d(l,
a);q.resolve(l)});return q}t=void 0!==s["mjs-recursive"];delete s["mjs-recursive"];for(m in s)if(e=a(g,s[m],null,f.length,t))c.removeAttribute(m),e.subscribe(this.onTextChange,this),f.push({node:c,attr:m,tr:e}),this.renderText(f.length-1);return l.length?l:!0}return!0},process:function(){f(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1})},onProcessingFinished:function(){g.trigger("rendered-"+this.id,this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=
this.texts[a];var b=a.tr.getString(),c=a.attr;c?("value"==c?a.node.value=b:"class"==c?a.node.className=b:"src"==c&&(a.node.src=b),a.node.setAttribute(c,b)):a.node[tb]=b},destroy:function(){var a=this.texts,b,c;if(!this.destroyed){this.destroyed=!0;b=-1;for(c=a.length;++b<c;a[b].tr.destroy());this.parent&&this.parent.un("destroy",this.destroy,this);delete this.texts;delete this.el;delete this.scope;delete this.parent;g.trigger("destroy-"+this.id)}}};return h}(),vb=function(){var b,a=function(){this.store=
{}};a.prototype={store:null,getApi:function(){return{value:x(this.value,this),constant:x(this.constant,this),factory:x(this.factory,this),service:x(this.service,this),provider:x(this.provider,this),resolve:x(this.resolve,this),inject:x(this.inject,this)}},instantiate:function(a,b,e,f){return a.instantiate?a.instantiate.apply(null,e):f?(b=function(){},b.prototype=a.prototype,b=new b,a=a.apply(b,e),sa(a)||!1===a?a:b):a.apply(b,e)},inject:function(a,b,e,f,g){e=e||{};f=f||[];var h=this;if(B(a))if(a.inject)f=
ha.call(a.inject),f.push(a),a=f;else return h.instantiate(a,b,f,g);a=ha.call(a);f=[];var p=a.pop(),n,u;n=-1;for(u=a.length;++n<u;f.push(h.resolve(a[n],e)));return H.all(f).then(function(a){return h.instantiate(p,b,a,g)})},value:function(a,b){this.store[a]={type:1,value:b}},constant:function(a,b){var e=this.store;e[a]||(e[a]={type:2,value:b})},factory:function(a,b,e,f){za(e)&&(f=e,e=null);this.store[a]={type:3,singleton:f,fn:b,context:e}},service:function(a,b,e){this.store[a]={type:4,singleton:e,fn:b}},
provider:function(a,b){this.store[a+"Provider"]={name:a,type:5,fn:b,instance:null}},resolve:function(a,d){var e=this.store,f,g,h;if(void 0!==d[a])return d[a];if(g=e[a]){f=g.type;if(1==f||2==f)return g.value;if(3==f)h=this.inject(g.fn,g.context,d);else if(4==f)h=this.inject(g.fn,null,d,null,!0);else if(5==f)return g.instance||(g.instance=H.resolve(this.inject(g.fn,null,d)).done(function(a){g.instance=a;e[g.name]={type:3,fn:a.$get,context:a}})),g.instance;g.singleton&&(g.type=1,g.value=h,3==f&&ea(h)&&
h.done(function(a){g.value=a}));return d[a]=h}if(e[a+"Provider"])return this.resolve(a+"Provider",d),this.resolve(a,d);if(this===b)throw"Could not provide value for "+a;return b.resolve(a)},destroy:function(){delete this.store;delete this.scope}};a.global=function(){return b};b=new a;return a}(),Nb=function(){var b=function(a,b){"pt_BR"==b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;
case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1==
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0==a||1==a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1==a?0:2<=a&&4>=a?1:2;case "ga":return 1==a?0:2==a?1:2;case "lt":return 1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1==a%100?0:2==a%100?1:3==a%100||4==a%100?2:3;
case "mk":return 1==a%10?0:1;case "mt":return 1==a?0:0==a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0==a?0:1==a%10&&11!=a%100?1:2;case "pl":return 1==a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1==a?0:2==a?1:8==a||11==a?2:3;case "ro":return 1==a?0:0==a||0<a%100&&20>a%100?1:2;case "ar":return 0==a?0:1==a?1:2==a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},a=function(a){this.store={};a&&(this.locale=a)};a.prototype={store:null,locale:"en",setLocale:function(a){this.locale=
a},set:function(a,b){var c=this.store;void 0===c[a]&&(c[a]=b)},load:function(a){y(this.store,a,!1,!1)},get:function(a){return this.store[a]||(this===c?"-- "+a+" --":c.get(a))},plural:function(a,c){var f=this.get(a),g=b(c,this.locale);return P(f)?f[g]:ta(f)?f[c]?f[c]:1==c&&void 0!=f.one?f.one:0>c&&void 0!=f.negative?f.negative:f.other:f}};var c=new a;a.global=function(){return c};return a}();I("MetaphorJs.cmp.Base",{destroyed:!1,_observable:null,initialize:function(b){b=b||{};this.$$observable=new X;
y(this,this.$$observable.getApi(),!0,!1);if(b.callback){var a=b.callback,c=a.scope||this;delete a.scope;for(var d in a)if(a.hasOwnProperty(d))this.on(d,a[d],c);delete b.callback}y(this,b,!0,!1)},destroy:function(){if(!this.destroyed){if(!1===this.trigger("beforedestroy",this))return!1;this.onDestroy();this.destroyed=!0;this.trigger("destroy",this);this.$$observable.destroy();delete this.$$observable}},onDestroy:F});I("MetaphorJs.cmp.App","MetaphorJs.cmp.Base",{lang:null,scope:null,renderer:null,cmpListeners:null,
components:null,initialize:function(b,a){var c=a instanceof ja?a:new ja(a),d,e;c.$app=this;this.supr();d=new vb;e=new X;this.lang=new Nb;y(this,d.getApi(),!0,!1);this.destroyProvider=x(d.destroy,d);y(this,e.getApi(),!0,!1);this.destroyObservable=x(e.destroy,e);this.scope=c;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",c.$root);this.value("$lang",this.lang);this.renderer=new hb(b,c);d=ha.call(arguments);
d[1]=c;this.initApp.apply(this,d)},initApp:F,run:function(){this.renderer.process()},getParentCmp:function(b){b=b.parentNode;for(var a;b;){if(a=b.getAttribute("cmp-id"))return this.getCmp(a);b=b.parentNode}return null},onAvailable:function(b,a,c){var d=this.cmpListeners,e=this.components;d[b]||(d[b]=new H);a&&d[b].done(a,c);e[b]&&d[b].resolve(e[b]);return d[b]},getCmp:function(b){return this.components[b]||null},registerCmp:function(b,a,c){var d=this,e=b[c];c=function(){delete d.cmpListeners[e];delete d.components[e]};
d.components[e]=b;d.cmpListeners[e]&&d.cmpListeners[e].resolve(b);if(b.on)b.on("destroy",c);a.$on("$destroy",c)},destroy:function(){var b;this.destroyObservable();this.destroyProvider();this.renderer.destroy();this.scope.$destroy();for(b in this)this.hasOwnProperty(b)&&delete this[b]}});var ka=document.documentElement,Ma=function(){var b=function(a){return a===window?!0:3==a.nodeType?a.parentElement?b(a.parentElement):!0:a===ka?!0:ka.contains(a)};return b}(),va=function(b){var a=document.createDocumentFragment();
if(z(b)){var c=document.createElement("div");c.innerHTML=b;b=c.childNodes}if(b.nodeType)a.appendChild(b);else for(var c=-1,d=b.length>>>0;++c!==d;a.appendChild(b[0]));return a},Ua=function(b){var a,c,d;if(P(b)){d=[];a=0;for(c=b.length;a<c;a++)d.push(Ua(b[a]));return d}if(b)switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0)}return null},wb=function(){var b=["Moz","Webkit","ms","O","Khtml"],a="animationDelay",
c="animationDuration",d="transitionDelay",e="transitionDuration",f="transform",g=null,h=null;(function(){var h=document.createElement("div"),n=!1,u,r,t;if(void 0!==h.style.animationName)n=!0;else for(r=0,t=b.length;r<t;r++)if(u=b[r],void 0!==h.style[u+"AnimationName"]){n=!0;a=u+"AnimationDelay";c=u+"AnimationDuration";d=u+"TransitionDelay";e=u+"TransitionDuration";f=u+"Transform";break}n&&("ontransitionend"in window?g="transitionend":"onwebkittransitionend"in window&&(g="webkitTransitionEnd"));return n})()&&
(h={animationDelay:a,animationDuration:c,transitionDelay:d,transitionDuration:e,transform:f,transitionend:g});return function(){return h}}(),Ob=function(){var b=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},a=function(a,c,d){var e,f,g=c.length;for(e=0;e<g;e++)f=b(c[e])+b(d[e]),a=Math.max(f,a);return a},c=wb(),d=c?c.animationDuration:null,e=c?c.animationDelay:null,f=c?c.transitionDuration:null,g=c?c.transitionDelay:null;return function(b){if(!c)return 0;var p=
window.getComputedStyle?window.getComputedStyle(b,null):b.style;b=0;var n=(p[d]||"").split(","),u=(p[e]||"").split(","),r=(p[f]||"").split(","),p=(p[g]||"").split(",");b=Math.max(b,a(b,n,u));return b=Math.max(b,a(b,r,p))}}(),Na=function(){var b={};return function(a){return b[a]||(b[a]=new RegExp(a))}}(),U=function(b,a){a&&(b.className=b.className.replace(Na("(?:^|\\s)"+a+"(?!\\S)"),""))},ma=function(b){var a=O(b,"mjsAnimationQueue"),c,d;if(P(a)&&a.length){if(a=a[0])a.stages&&(c=a.position,d=a.stages,
U(b,d[c]),U(b,d[c]+"-active")),a.deferred&&a.deferred.reject(a.el)}else B(a)?a(b):"stop"==a&&$(b).stop(!0,!0);O(b,"mjsAnimationQueue",null)},Oa=function(b,a){return a?Na("(?:^|\\s)"+a+"(?!\\S)").test(b.className):!1},R=function(b,a){a&&!Oa(b,a)&&(b.className+=" "+a)},ia=function(){var b,a;if("undefined"!=typeof window){var c=window;b=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame;a=c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||
c.webkitCancelRequestAnimationFrame;if(b)return function(c){var e=b(c);return function(){a(e)}}}return function(a){var b=setTimeout(a,0);return function(){clearTimeout(b)}}}(),D=function(b,a,c){b.attachEvent?b.attachEvent("on"+a,c):b.addEventListener(a,c,!1)},S=function(b,a,c){b.detachEvent?b.detachEvent("on"+a,c):b.removeEventListener(a,c,!1)},T=function(){var b={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},a=0,c=wb(),d=!!c,e=function(a,b,c){var d=
function(){(new Date).getTime()-b>=c?a():ia(d)};ia(d)},f=function p(a,b,d,g,m,l,s,k){var v=function(){var b=O(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==s?!1:(m.reject(a),!0)},q=function(){c.transitionend&&S(a,c.transitionend,q);if(!v()){var e=d;d++;if(d==b.length){m.resolve(a);O(a,"mjsAnimationQueue").shift();var l=O(a,"mjsAnimationQueue");l.length?(l=l[0],f(l.el,l.stages,0,l.start,l.deferred,!1,l.id,l.step)):O(a,"mjsAnimationQueue",null)}else O(a,"mjsAnimationQueue")[0].position=d,p(a,
b,d,null,m,!1,s,k);U(a,b[e]);U(a,b[e]+"-active")}},A=function(){v()||(R(a,b[d]+"-active"),H.resolve(k&&k(a,d,"active")).done(function(){if(!v()){var b=Ob(a);b?c.transitionend?D(a,c.transitionend,q):e(q,(new Date).getTime(),b):ia(q)}}))},C=function(){v()||(R(a,b[d]),H.waterfall([k&&k(a,d,"start"),function(){return g?g(a):null}]).done(function(){!v()&&ia(A)}))};l?ia(C):C()},g=function(c,e,g,r,t,m){var l=new H,s=O(c,"mjsAnimationQueue")||[],k=++a,v=c.getAttribute("mjs-animate"),q,A,C,w,V,G,fb;e=e||v;
r&&null===v&&(e=null);if(e){z(e)?"["==e.substr(0,1)?q=(new Function("","return "+e))():(q=b[e],e=t&&t.get("animate."+e,!0)):B(e)?A=e:P(e)&&(z(e[0])?q=e:(C=e[0],w=e[1]));ta(e)&&(q=e.stages,A=e.fn,C=e.before,w=e.after,V=e.options?y({},e.options):{},G=e.context||null,fb=e.duration||null,g=g||V.start);if(d&&q)return s.push({el:c,stages:q,start:g,step:m,deferred:l,position:0,id:k}),O(c,"mjsAnimationQueue",s),1==s.length&&f(c,q,0,g,l,!0,k,m),l;V=V||{};g&&(V.start=function(){g(c)});V.complete=function(){l.resolve(c)};
fb&&(V.duration=fb);if(A&&B(A))return C&&y(c.style,C,!0,!1),g&&g(c),O(c,"mjsAnimationQueue",A.call(G,c,function(){l.resolve(c)})),l;if(window.jQuery){e=$(c);C&&e.css(C);O(c,"mjsAnimationQueue","stop");if(A&&z(A))return e[A](V),l;if(w)return e.animate(w,V),l}}g?(A=g(c),ea(A)?A.done(function(){l.resolve(c)}):l.resolve(c)):l.resolve(c);return l};g.addAnimationType=function(a,c){b[a]=c};g.stop=ma;g.prefixes=c;g.cssAnimations=d;return g}(),Pb=function(){return"undefined"!=typeof JSON?function(b){return JSON.parse(b)}:
function(b){return(new Function("return "+b))()}}(),xb=function(b,a){var c,d;if(!b||!z(b))return null;try{d=new DOMParser,c=d.parseFromString(b,a||"text/xml")}catch(e){c=void 0}if(!c||c.getElementsByTagName("parsererror").length)throw"Invalid XML: "+b;return c},Pa=function(){var b=/#.*$/,a=/([?&])_=[^&]*/,c=/\?/,d=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,e=/^(?:GET|HEAD)$/i,f=function(a,b,c){var d,e;if(ua(a)&&c)b.push(encodeURIComponent(c)+"="+encodeURIComponent(""+a));else if(P(a)&&
c)for(d=0,e=a.length;d<e;d++)f(a[d],b,c+"["+d+"]");else if(sa(a))for(d in a)a.hasOwnProperty(d)&&f(a[d],b,c?c+"["+d+"]":d)},g=function(d,l){d.replace(b,"");if(!1===l.cache){var k=(new Date).getTime();return a.test(d)?d.replace(a,"$1_="+k):d+(c.test(d)?"&":"?")+"_="+k}!l.data||window.FormData&&l.data instanceof window.FormData||(z(l.data)?k=l.data:(k=[],f(l.data,k,null),k=k.join("&").replace(/%20/g,"+")),l.data=k,e.test(l.method)&&(d+=(c.test(d)?"&":"?")+l.data,l.data=null));return d},h={xml:"application/xml, text/xml",
html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},p={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},n=
{},u=new X,r=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},t=function(a,b,c){var d,e;if(!sa(a)&&!B(a)&&c)d=document.createElement("input"),d.setAttribute("type","hidden"),d.setAttribute("name",c),d.setAttribute("value",a),b.appendChild(d);else if(P(a)&&c)for(d=0,e=a.length;d<e;d++)t(a[d],b,c+"["+d+"]");else if(sa(a))for(d in a)a.hasOwnProperty(d)&&t(a[d],b,c?c+"["+d+"]":d)},m=function(a){for(var b,
c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],null!==b.getAttribute("name"))if(c="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT","FILE"===c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},l=function(a,b,c){var d=b?b.dataType:null;b=b?b.selector:null;if(!z(a))return a;c=c||"";if("xml"===
d||!d&&0<=c.indexOf("xml"))return a=xb(J(a)),b?K(b,a):a;if("html"===d)return a=xb(a,"text/html"),b?K(b,a):a;if("fragment"==d){c=document.createDocumentFragment();d=document.createElement("div");for(d.innerHTML=a;d.firstChild;)c.appendChild(d.firstChild);return c}if("json"===d||!d&&0<=c.indexOf("json"))return Pb(J(a));("script"===d||!d&&0<=c.indexOf("javascript"))&&r(a);return a+""},s=function(a){var b=d.exec((window?window.location.href:"").toLowerCase())||[],c=d.exec(a.url.toLowerCase());this._opt=
a;!0!==a.crossDomain&&(a.crossDomain=!(!c||c[1]===b[1]&&c[2]===b[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(b[3]||("http:"===b[1]?"80":"443"))));b=new H;"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||window&&window.FormData||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):m(a.form));a.url=g(a.url,a);c=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new A(a,b,this):
new v(a,b,this):new q(a,b,this);this._deferred=b;this._transport=c;b.done(function(a){u.trigger("success",a)});b.fail(function(a){u.trigger("error",a)});b.always(function(){u.trigger("end")});u.trigger("start");a.timeout&&(this._timeout=setTimeout(x(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===u.trigger("beforeSend",a,c)&&(this._promise=H.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,c)&&(this._promise=H.reject());this._promise||(ya(c.send,c),b.abort=x(this.abort,
this),b.always(this.destroy,this),this._promise=b)};s.prototype={_jsonpName:null,_transport:null,_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);t(this._opt.data,a,null);document.body.appendChild(a);
this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,b=a.jsonpParam||"callback",d=a.jsonpCallback||"jsonp_"+W();a.url+=(c.test(a.url)?"&":"?")+b+"="+d;this._jsonpName=d;"undefined"!=typeof window&&(window[d]=x(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=x(this.jsonpCallback,this));return d},jsonpCallback:function(a){var b;try{b=this.processResponseData(a)}catch(c){this._deferred?this._deferred.reject(c):aa(c)}this._deferred&&this._deferred.resolve(b)},processResponseData:function(a,
b){var c=this._opt;a=l(a,c,b);u.hasListener("processResponse")&&(a=u.trigger("processResponse",a,this._deferred));c.processResponse&&(a=c.processResponse.call(c.callbackScope,a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred,d;if(this._opt.jsonp)if(a){try{r(a)}catch(e){c.reject(e)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else{try{d=this.processResponseData(a,b)}catch(f){c.reject(f)}c.resolve(d)}},destroy:function(){this._timeout&&
clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.destroy();delete this._transport;delete this._opt;delete this._deferred;delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}};var k=function(a,b){b=b||{};a&&!z(a)?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),
!b.url))throw"Must provide url";y(b,n,!1,!0);y(b,p,!1,!0);b.method=b.method?b.method.toUpperCase():b.form?b.form.getAttribute("method").toUpperCase()||"GET":"GET";return(new s(b)).promise()};k.setup=function(a){y(n,a,!0,!0)};k.on=function(){u.on.apply(u,arguments)};k.un=function(){u.un.apply(u,arguments)};k.get=function(a,b){b=b||{};b.method="GET";return k(a,b)};k.post=function(a,b){b=b||{};b.method="POST";return k(a,b)};k.load=function(a,b,c){c=c||{};z(b)||(c=b);c.dataType="fragment";return k(b,
c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};k.loadScript=function(a){return k(a,{transport:"script"})};k.submit=function(a,b){b=b||{};b.form=a;return k(null,b)};var v=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&D(d,"progress",x(a.progress,
a.callbackScope));a.uploadProgress&&d.upload&&D(d.upload,"progress",x(a.uploadProgress,a.callbackScope));d.onreadystatechange=x(this.onReadyStateChange,this)};v.prototype={_xhr:null,_deferred:null,_ajax:null,setHeaders:function(){var a=this._opt,b=this._xhr,c;if(a.xhrFields)for(c in a.xhrFields)b[c]=a.xhrFields[c];a.data&&a.contentType&&b.setRequestHeader("Content-Type",a.contentType);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.setRequestHeader("Accept",a.dataType&&h[a.dataType]?h[a.dataType]+
", */*; q=0.01":h._default);for(c in a.headers)b.setRequestHeader(c,a.headers[c])},onReadyStateChange:function(){var a=this._xhr,b=this._deferred;if(0===a.readyState)a.onreadystatechange=F,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=F;var c;a:{try{c=!a.status&&location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse(z(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||
""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=F;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this.setHeaders(),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}};var q=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};q.prototype={_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");
a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);D(a,"load",x(this.onLoad,this));D(a,"error",x(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;
delete this._ajax;delete this._deferred}};var A=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};A.prototype={_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+W(),c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);D(a,"load",x(this.onLoad,this));D(a,"error",x(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},
onLoad:function(){var a=this._el;this._opt&&!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}};return k}(),Aa=function(){var b=new X,a={},c=function(b){if(!a[b]){var c=
document.getElementById(b),d;c&&(d=c.tagName.toLowerCase(),"script"==d?(d=document.createElement("div"),d.innerHTML=c.innerHTML,a[b]=va(d.childNodes)):a[b]="content"in c?c.content:va(c.childNodes))}return a[b]},d=function(b){return a[b]?a[b]:a[b]=Pa(b,{dataType:"fragment"}).then(function(c){return a[b]=c})},e=function(a){y(this,a,!0,!1);this.id=W();this.tpl&&(this.tpl=J(this.tpl));this.url&&(this.url=J(this.url));a=this.node;var b=this.tpl||this.url;a&&a.removeAttribute("mjs-include");a||(this.deferRendering=
!0);if(b){if(a&&a.firstChild&&O(a,"mjs-transclude",va(a.childNodes)),"."!=b.substr(0,1)||this.replace||(this.ownRenderer=!0,this._watcher=la(this.scope,b,this.onChange,this,null,ba)),this.replace&&(this.ownRenderer=!1),this.initPromise=this.resolveTemplate(),this.deferRendering&&this.ownRenderer||this.initPromise.done(this.applyTemplate,this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();
this.scope instanceof ja&&this.scope.$on("destroy",this.onScopeDestroy,this)};e.prototype={_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,parentRenderer:null,deferRendering:!1,replace:!1,doRender:function(){this._renderer||(this._renderer=new hb(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){b.trigger("rendered-"+this.id,this)},
on:function(a,c,d){return b.on(a+"-"+this.id,c,d)},un:function(a,c,d){return b.un(a+"-"+this.id,c,d)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.initPromise)return this.initPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,b=a.url,e=a._watcher?a._watcher.getLastResult():a.tpl||b,p=new H;(new H(function(a){b?a(c(e)||
d(b)):a(c(e)||va(e))})).done(function(b){a._fragment=b;p.resolve(a.ownRenderer?!1:a.node)}).fail(p.reject,p);return p},onChange:function(){this._renderer&&(this._renderer.destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var a=this.node;a.firstChild;)a.removeChild(a.firstChild);this.replace?a.parentNode.replaceChild(Ua(this._fragment),a):a.appendChild(Ua(this._fragment));this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=
this.node,b=new H;this._initial?(this.doApplyTemplate(),b.resolve()):(T(a,"leave",null,!0).done(this.doApplyTemplate,this).done(b.resolve,b),T(a,"enter",null,!0));this._initial=!1;return b},onParentRendererDestroy:function(){this._renderer.destroy();this.destroy();delete this._renderer},onScopeDestroy:function(){this.destroy();delete this._renderer},destroy:function(){delete this.node;delete this.scope;delete this.initPromise;this._watcher&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),
delete this._watcher);delete this.tpl}};e.getTemplate=c;e.loadTemplate=d;return e}();I("MetaphorJs.cmp.Component","MetaphorJs.cmp.Base",{id:null,originalId:!1,node:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,initialize:function(b){this.supr(b);this.scope||(this.scope=new ja);b.as&&(this.scope[b.as]=this);this.node&&(this.id=this.node.getAttribute("id"))&&(this.originalId=!0);this.id=this.id||"cmp-"+W();this.node||
this._createNode();this.initComponent.apply(this,arguments);this.scope.$app&&this.scope.$app.registerCmp(this,this.scope,"id");var a=this.template,c=this.templateUrl;a&&a instanceof Aa?a instanceof Aa&&(this.template.node=this.node):this.template=a=new Aa({scope:this.scope,node:this.node,deferRendering:!a,ownRenderer:!0,tpl:a,url:c});if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(a.initPromise?a.initPromise.done(this.render,
this):this.render())},_createNode:function(){this.node=document.createElement(this.tag||"div")},_initElement:function(){var b=this.node;b.setAttribute("id",this.id);b.setAttribute("cmp-id",this.id);this.hidden&&(b.style.display="none")},render:function(){this.rendered||(this.trigger("render",this),this.template.on("rendered",this.onRenderingFinished,this),this.template.startRendering())},onRenderingFinished:function(){this.renderTo?this.renderTo.appendChild(this.node):Ma(this.node)||document.body.appendChild(this.node);
this.rendered=!0;this.afterRender();this.trigger("afterrender",this)},show:function(){if(this.hidden){if(!1===this.trigger("beforeshow",this))return!1;this.node.style.display="block";this.hidden=!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("beforehide",this))return!1;this.node.style.display="none";this.hidden=!0;this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},
getEl:function(){return this.node},initComponent:F,afterRender:F,onShow:F,onHide:F,onParentRendererDestroy:function(){this.destroy()},onDestroy:function(){this.template&&(this.template.destroy(),delete this.template);this.destroyEl?Ma(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"));this.destroyScope&&this.scope&&this.scope.$destroy();delete this.scope;delete this.node;this.supr()}});var Ba=function(b,a,
c,d,e){var f=!1!==a;a=a||{};e=e||[];c=c||a.scope;d=d||a.node;a.scope=a.scope||c;a.node=a.node||d;var g=z(b)?La(b):b;if(!g)throw"Component "+b+" not found";c&&g.$isolateScope&&(a.scope=c=c.$newIsolated());var h,p=[];b=g.template||a.template||null;var n=g.templateUrl||a.templateUrl||null,u=c?c.$app:null,r=vb.global(),t=u?u.inject:r.inject,m=u?u:r,l=d?d.getAttribute("mjs-cloak"):null,s={$node:d||null,$scope:c||null,$config:a||null,$args:e||null};if(g.resolve)for(h in g.resolve)(function(b){var f=new H,
l;p.push(f.done(function(c){s[b]=c;a[b]=c;e.push(c)}));l=g.resolve[h];B(l)?f.resolve(l(c,d)):z(l)?f.resolve(t.resolve(l)):f.resolve(t.call(m,l,null,y({},s,a,!1,!1)))})(h);f&&(b||n)&&(a.template=new Aa({scope:c,node:d,deferRendering:!0,ownRenderer:!0,tpl:b,url:n}),p.push(a.template.initPromise),d&&d.firstChild&&O(d,"mjs-transclude",va(d.childNodes)));f&&e.unshift(a);var k;p.length?(k=new H,H.all(p).done(function(){k.resolve(t.call(m,g,null,y({},s,a,!1,!1),e))})):k=H.resolve(t.call(m,g,null,y({},s,
a,!1,!1),e));d&&k.isPending()&&null!==l&&(l?R(d,l):d.style.visibility="hidden",k.then(function(){l?U(d,l):d.style.visibility=""}));d&&k.then(function(){U(d,"mjs-cloak")});return k},Ca=function(){return!1},Va=function(){return!0},Qa=function(b){if(b instanceof Qa)return b;if(!(this instanceof Qa))return new Qa(b);for(var a in b)if(!this[a])try{this[a]=b[a]}catch(c){}this.originalEvent=b;this.type=b.type;!this.target&&b.srcElement&&(this.target=b.srcElement);var d,e=b.button;void 0===this.pageX&&null!==
b.clientX&&(d=this.target?this.target.ownerDocument||document:document,a=d.documentElement,d=d.body,this.pageX=b.clientX+(a&&a.scrollLeft||d&&d.scrollLeft||0)-(a&&a.clientLeft||d&&d.clientLeft||0),this.pageY=b.clientY+(a&&a.scrollTop||d&&d.scrollTop||0)-(a&&a.clientTop||d&&d.clientTop||0));this.which||void 0===e||(this.which=e&1?1:e&2?3:e&4?2:0);this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?Va:Ca;this.timeStamp=b&&b.timeStamp||(new Date).getTime()};Qa.prototype=
{isDefaultPrevented:Ca,isPropagationStopped:Ca,isImmediatePropagationStopped:Ca,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=Va;b.returnValue=!1;b&&b.preventDefault&&b.preventDefault()},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=Va;b&&b.stopPropagation&&b.stopPropagation()},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=Va;b&&b.stopImmediatePropagation&&b.stopImmediatePropagation();this.stopPropagation()}};
var da=function(b){return new Qa(b)},Da=function(){var b=window,a=b.history,c=b.location,d=new X,e={},f={},g={locationChange:[],beforeLocationChange:[]},h=!1,p=/(?:(\w+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/,n=!!a.pushState,u="onhashchange"in b,r=n&&(navigator.vendor||"").match(/Opera/);y(e,d.getApi());var t=function(a){var b=c.protocol+"//"+c.hostname;c.port&&(b+=":"+c.port);a=a.replace(b,"");n||(a=encodeURIComponent(a));"?"==a.substr(0,1)&&(a=c.pathname+
a);r&&(a=a.replace("?","#"));return a},m=function(a){a=(""+a).match(p);var b,c;if(!n||r)c=a[6],"!"==c.substr(0,1)&&(b=c.substr(1));b||(b=a[4],a[5]&&(b+=a[5]));return b},l=function(a){c.hash=a?"!"+a:""},s=function(){var a;n?a=c.pathname+c.search+c.hash:(a=c.hash.substr(1))?("!"==a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a)):a=c.pathname+c.search;return a},k=function(a,b){var c=f[a].extractor;return B(c)?c(b,a):(c=b.match(c))?c.pop():null},v=function(){var a=s();q("locationChange",!1,a);var b,
c,d;for(b in f)c=f[b].value,d=k(b,a),f[b].value=d,d!=c&&e.trigger("change-"+b,d,c,b,a)},q=function(a,b,c){c=c||s();for(var d,f=-1,l=g[a].length;++f<l;)if(d=g[a][f].call(null,c),b&&!1===d)return!1;return e.trigger(a,c)},A=function(){if(n)a.origPushState=a.pushState,a.origReplaceState=a.replaceState,D(b,"popstate",v),a.pushState=function(b,c,d){if(!1===q("beforeLocationChange",!0,d))return!1;a.origPushState(b,c,t(d));v()},a.replaceState=function(b,c,d){if(!1===q("beforeLocationChange",!0,d))return!1;
a.origReplaceState(b,c,t(d));v()};else if(u)a.replaceState=a.pushState=function(a,b,c){if(!1===q("beforeLocationChange",!0,c))return!1;ya(l,null,[t(c)])},D(b,"hashchange",v);else{var d=null,f=!1;b.onIframeHistoryChange=function(a){f||ya(function(){l(a);v()})};var k=function(a){var b=d.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');
b.close()};a.pushState=function(a,b,c){if(!1===q("beforeLocationChange",!0,c))return!1;k(t(c))};a.replaceState=function(a,b,c){if(!1===q("beforeLocationChange",!0,c))return!1;a=t(c);d.contentWindow.hashValue=a};var s=function(){d=document.createElement("iframe");d.src="about:blank";d.style.display="none";document.body.appendChild(d);f=!0;k(t(c.hash.substr(1)));f=!1};h?s():D(b,"load",s)}D(document.documentElement,"click",function(d){d=da(d||b.event);for(var e=d.target,f;e&&"a"!=e.nodeName.toLowerCase();)e=
e.parentNode;if(e){if(e=(f=e.getAttribute("href"))&&"#"!=f.substr(0,1)&&!e.getAttribute("target"))e=f.match(p),e=e[1]&&c.protocol!=e[1]||e[2]&&c.hostname!=e[2]?!1:e[2]||e[3]?c.port==e[3]:!0;if(e&&m(f)!=m(c))return a.pushState(null,null,m(f)),d.preventDefault(),d.stopPropagation(),!1}return null});a.initPushState=F;e.initPushState=F};D(b,"load",function(){h=!0});a.initPushState=A;a.onBeforeChange=function(a){g.beforeLocationChange.push(a)};a.onChange=function(a){g.locationChange.push(a)};e.pushUrl=
function(b){a.pushState(null,null,b)};e.replaceUrl=function(b){a.replaceState(null,null,b)};e.currentUrl=function(){return s()};e.initPushState=function(){return A()};e.getParam=function(a){return f[a]?f[a].value:null};e.addParam=function(a,b){f[a]||(b?B(b)||(b=z(b)?Na(b):b):b=Na(a+"=([^&]+)"),f[a]={name:a,value:null,extractor:b},f[a].value=k(a,s()))};return e}(),yb=Da.currentUrl,Qb=/-./g,Rb=function(b){return b.replace(Qb,function(a){return a.charAt(1).toUpperCase()})},Sb=function(){return document.documentElement.dataset?
function(b){return b.dataset}:function(b){var a;if(void 0!==(a=O(b,"data")))return a;a=b.attributes;var c={},d,e;d=0;for(e=a.length;d<e;d++)c[Rb(a[d].name)]=a[d].value;a=c;O(b,"data",a);return a}}(),na=function(b,a,c){var d=O(b,"config"),e;if(d)return d;d={};if(c||null!==(c=b.getAttribute("mjs-config")))for(e in b.removeAttribute("mjs-config"),a=c?Ka(c)(a||{}):{},a)d[e]=a[e];a=Sb(b);for(e in a)c=a[e],d[e]=""===c?!0:c;O(b,"config",d);return d};I("MetaphorJs.cmp.View",{route:null,node:null,scope:null,
cmp:null,id:null,currentComponent:null,watchable:null,defaultCmp:null,initialize:function(b){y(this,b,!0,!1);b=this.node;var a=na(b,this.scope);y(this,a,!0,!1);b&&b.firstChild&&O(b,"mjs-transclude",va(b.childNodes));this.id||(this.id=W());this.scope.$app.registerCmp(this,this.scope,"id");this.route?(Da.initPushState(),Da.on("locationChange",this.onLocationChange,this),this.onLocationChange()):this.cmp&&(this.watchable=la(this.scope,this.cmp,this.onCmpChange,this,null,ba),this.onCmpChange())},onCmpChange:function(){var b=
this.watchable.getLastResult()||this.defaultCmp;this.clearComponent();b&&this.setComponent(b)},onLocationChange:function(){var b=yb(),a=this.route,c,d,e,f,g;d=0;for(e=a.length;d<e;d++){f=a[d];if(f.reg&&(g=b.match(f.reg))){this.changeRouteComponent(f,g);return}f["default"]&&!c&&(c=f)}this.clearComponent();c?this.setRouteComponent(c,[]):this.defaultCmp&&this.setComponent(this.defaultCmp)},changeRouteComponent:function(b,a){ma(this.node);this.clearComponent();this.setRouteComponent(b,a)},clearComponent:function(){var b=
this,a=b.node;b.currentComponent&&T(a,"leave",null,!0).done(function(){b.currentComponent.destroy();for(b.currentComponent=null;a.firstChild;)a.removeChild(a.firstChild)})},setRouteComponent:function(b,a){var c=this,d=c.node,e=b.params;T(d,"enter",function(){var f=a||[],g={destroyEl:!1,node:d,scope:b.$isolateScope?c.scope.$newIsolated():c.scope.$new()},h,p;b.as&&(g.as=b.as);b.template&&(g.template=b.template);f.shift();if(e)for(h=-1,p=e.length;++h<p;g[e[h]]=f[h]);return Ba(b.cmp||"MetaphorJs.cmp.Component",
g,g.scope,d,null,f).done(function(a){c.currentComponent=a})},!0)},setComponent:function(b){var a=this,c=a.node;T(c,"enter",function(){var d=sa(b)?b:{},e=(z(b)?b:null)||"MetaphorJs.cmp.Component",f=d.scope||a.scope.$new();d.destroyEl=!1;return Ba(e,d,f,c).done(function(b){a.currentComponent=b})},!0)},destroy:function(){this.clearComponent();this.route&&(Da.un("locationchange",this.onLocationChange,this),delete this.route);this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),
delete this.watchable);delete this.scope;delete this.currentComponent}});var Q=gb.registerAttributeHandler;Q("mjs-app",100,Ca);var ib=function(b){var a=b.nodeName.toLowerCase();b=b.type;return"input"!=a&&"textarea"!=a&&"select"!=a||"submit"==b||"reset"==b||"button"==b?!1:!0},oa=function(){var b=/\r/,a={option:function(a){var b=a.getAttribute("value")||a.value;return void 0!=b?b:J(a.innerText||a.textContent)},select:function(a){for(var b,e=a.options,f=a.selectedIndex,g=(a="select-one"===a.type||0>
f)?null:[],h=a?f+1:e.length,p,n=0>f?h:a?f:0;n<h;n++)if(b=e[n],p=b.disabled||b.parentNode.disabled,(b.selected||n===f)&&!p){b=oa(b);if(a)return b;g.push(b)}return g},radio:function(a){return ab(a.getAttribute("value"))?"on":a.value},checkbox:function(a){return ab(a.getAttribute("value"))?"on":a.value}};return function(c){var d,e;if((d=a[c.type]||a[c.nodeName.toLowerCase()])&&void 0!==(e=d(c,"value")))return e;e=c.value;return z(e)?e.replace(b,""):null==e?"":e}}(),jb=function(){var b={select:function(a,
b){for(var d,e,f=a.options,g=ga(b),h=f.length,p,n=-1;h--;)e=f[h],(p=g?-1!=Ta.call(g,e.value):!1)?(e.setAttribute("selected","selected"),d=!0):e.removeAttribute("selected"),p||ab(e.getAttribute("mjs-default-option"))||(n=h);d||(a.selectedIndex=n);return g}};b.radio=b.checkbox=function(a,b){if(P(b)){var d;d=oa(a);d=b?-1!=Ta.call(b,d):!1;return a.checked=d}};return function(a,c){if(1===a.nodeType){null===c?c="":1===Z(c)&&(c+="");var d=b[a.type]||b[a.nodeName.toLowerCase()];d&&void 0!==d(a,c,"value")||
(a.value=c)}}}(),Tb=function(){var b=document.createElement("div");return z(b.textContent)?"textContent":"innerText"}(),pa=I("MetaphorJs.view.AttributeHandler",{watcher:null,scope:null,node:null,expr:null,autoOnChange:!0,initialize:function(b,a,c){var d;c=J(c);this.node=a;this.expr=c;this.scope=b;this.watcher=la(b,c,this.onChange,this,null,ba);if(this.autoOnChange&&void 0!=(d=this.watcher.getLastResult()))this.onChange(d,void 0);b.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){this.destroy()},
onChange:function(){},destroy:function(){delete this.node;delete this.scope;this.watcher&&(this.watcher.unsubscribeAndDestroy(this.onChange,this),delete this.watcher)}}),kb=navigator.userAgent.toLowerCase(),Ub=function(){var b=parseInt((/android (\d+)/.exec(kb)||[])[1],10)||!1;return function(){return b}}(),lb=function(){var b=parseInt((/msie (\d+)/.exec(kb)||[])[1],10);isNaN(b)&&(b=parseInt((/trident\/.*; rv:(\d+)/.exec(kb)||[])[1],10)||!1);return function(){return b}}(),zb=function(){var b={};return function(a){if(void 0===
b[a]){if("input"==a&&9==lb())return b[a]=!1;var c=document.createElement("div");b[a]=!!("on"+a in c)}return b[a]}}(),Ea=function(b,a,c,d){var e=na(b);this.el=b;this.cb=a;this.scb=d;this.cbContext=c;this.inputType=a=e.type||b.type.toLowerCase();this.listeners=[];c=b.type?b.type.toLowerCase():"";this.submittable="input"==b.nodeName.toLowerCase()&&"radio"!=c&&"checkbox"!=c;"radio"==a?this.initRadioInput():"checkbox"==a?this.initCheckboxInput():this.initTextInput()};Ea.prototype={el:null,inputType:null,
cb:null,scb:null,cbContext:null,listeners:[],radio:null,submittable:!1,destroy:function(){var b=this.inputType,a=this.listeners,c=this.radio,d=this.el,e,f,g,h;e=0;for(f=a.length;e<f;e++)if("radio"==b)for(g=0,h=c.length;g<h;g++)S(c[g],a[e][0],a[e][1]);else S(d,a[e][0],a[e][1]);delete this.radio;delete this.el;delete this.cb;delete this.cbContext},initRadioInput:function(){var b,a,c;this.radio=b=K("input[name="+this.el.name+"]");this.onRadioInputChangeDelegate=x(this.onRadioInputChange,this);this.listeners.push(["click",
this.onRadioInputChangeDelegate]);a=0;for(c=b.length;a<c;a++)D(b[a],"click",this.onRadioInputChangeDelegate)},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=x(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate]);D(this.el,"click",this.onCheckboxInputChangeDelegate)},initTextInput:function(){var b=!1,a=this,c=a.el,d=a.listeners,e;if(!Ub()){var f=function(){b=!0},g=function(){b=!1;h()};d.push(["compositionstart",f]);d.push(["compositionend",
g]);D(c,"compositionstart",f);D(c,"compositionend",g)}var h=a.onTextInputChangeDelegate=function(){if(!b)a.onTextInputChange()};if(zb("input"))d.push(["input",h]),D(c,"input",h);else{var p=function(a){e||(e=window.setTimeout(function(){h(a);e=null},0))},f=function(b){b=b||window.event;var c=b.keyCode;if(13==c&&a.submittable&&a.scb)return a.scb.call(a.cbContext,b);91===c||15<c&&19>c||37<=c&&40>=c||p(b)};d.push(["keydown",f]);D(c,"keydown",f);zb("paste")&&(d.push(["paste",p]),d.push(["cut",p]),D(c,
"paste",p),D(c,"cut",p))}d.push(["change",h]);D(c,"change",h)},processValue:function(b){switch(this.inputType){case "number":b=parseInt(b,10),isNaN(b)&&(b=0)}return b},onTextInputChange:function(){var b=this.getValue();this.cb&&this.cb.call(this.cbContext,b)},onCheckboxInputChange:function(){var b=this.el;this.cb&&this.cb.call(this.cbContext,b.checked?b.getAttribute("value")||!0:!1)},onRadioInputChange:function(b){b=b||window.event;b=b.target||b.srcElement;this.cb&&this.cb.call(this.cbContext,b.value)},
setValue:function(b){var a=this.inputType,c,d;if("radio"==a)for(a=this.radio,c=0,d=a.length;c<d;c++)a[c].checked=a[c].value==b;else"checkbox"==a?(a=this.el,a.checked=!0===b||b==a.value):jb(this.el,b)},getValue:function(){var b=this.inputType,a,c;if("radio"==b){b=this.radio;a=0;for(c=b.length;a<c;a++)if(b[a].checked)return b[a].value;return null}return"checkbox"==b?this.el.checked?this.el.getAttribute("value")||!0:!1:this.processValue(oa(this.el))}};Ea.getValue=oa;Ea.setValue=jb;Q("mjs-bind",1E3,I(null,
pa,{isInput:!1,input:null,lockInput:null,recursive:!1,textRenderer:null,initialize:function(b,a,c){this.isInput=ib(a);this.recursive=null!==a.getAttribute("mjs-recursive");this.lockInput=null!==a.getAttribute("mjs-lock-input");a.removeAttribute("mjs-recursive");a.removeAttribute("mjs-lock-input");this.isInput&&(this.input=new Ea(a,this.onInputChange,this));this.recursive?(this.scope=b,this.node=a,this.textRenderer=new ub(b,"{{"+c+"}}",null,null,!0),this.textRenderer.subscribe(this.onTextRendererChange,
this),this.onTextRendererChange(),b instanceof ja&&b.$on("destroy",this.onScopeDestroy,this)):this.supr(b,a,c)},onInputChange:function(){if(this.lockInput)this.onChange()},onTextRendererChange:function(){this.updateElement(this.textRenderer.getString())},onChange:function(){var b=this.watcher.getLastResult();this.updateElement(b)},updateElement:function(b){this.isInput?this.input.setValue(b):this.node[Tb]=b},destroy:function(){this.textRenderer&&(this.textRenderer.destroy(),delete this.textRenderer);
this.input&&(this.input.destroy(),delete this.input);this.supr()}}));Q("mjs-bind-html",1E3,I(null,"attr.mjs-bind",{updateElement:function(b){this.node.innerHTML=b}}));(function(){var b=function(a,b,d,e){if(null!==d){if(d==Oa(a,b))return;d=!d}else d=Oa(a,b);d?e?T(a,[b+"-remove"],null,!0).done(function(){U(a,b)}):U(a,b):e?T(a,[b+"-add"],null,!0).done(function(){R(a,b)}):R(a,b)};Q("mjs-class",1E3,I(null,pa,{initial:!0,onChange:function(){var a=this.node,c=this.watcher.getLastResult(),d=this.watcher.getPrevValue(),
e;ma(a);if(z(c))d&&b(a,d,!1,!1),b(a,c,null,!this.initial);else if(P(c))for(e=-1,d=c.length;++e<d;b(a,c[e],!0,!this.initial));else for(e in c)b(a,e,c[e]?!0:!1,!this.initial);this.initial=!1}}))})();Q("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(b,a,c){b&&(b[c]=a)}]);(function(){var b=function(a,b,d,e){var f,g,h,p,n,u=na(b,a);d=d.split(" ");h=0;for(p=d.length;h<p;h++)n=d[h],""!=n&&"as"!=n&&(f?g=n:f=n);e=y({scope:a,node:b,as:g,parentRenderer:e,destroyScope:!0},u,!1,!1);Ba(f,e,a,b);
return!1};b.$breakScope=!0;Q("mjs-cmp",200,b)})();Q("mjs-config",50,function(b,a,c){na(a,b,c)});var fa=function(b){b=b||{};this._queue=[];this._map={};this.id="$$"+W();for(var a in b)this[a]=b[a]};fa.REPLACE=1;fa.ONCE=2;fa.MULTIPLE=3;fa.ONCE_EVER=3;fa.prototype={_queue:null,_map:null,_nextRequested:!1,_running:!1,length:0,id:null,async:!0,auto:!0,thenable:!1,stack:!1,context:null,mode:fa.MULTIPLE,add:function(b,a,c,d,e,f){var g=this.id,h=b[g]||W();a={id:h,fn:b,context:a,args:c,async:f};d=d||this.mode;
b[g]=h;if(d==fa.ONCE_EVER&&b[g])return b[g];if(this._map[h])if(d==fa.REPLACE)this.remove(h);else if(d==fa.ONCE)return h;this._queue[e?"unshift":"push"](a);this._map[h]=a;this.length=this._queue.length;this.auto&&this.next();return h},append:function(b,a,c,d,e){return this.add(b,a,c,d,!1,e)},prepend:function(b,a,c,d,e){return this.add(b,a,c,d,!0,e)},remove:function(b){var a=this._queue,c,d;c=0;for(d=a.length;c<d;c++)if(a[c].id==b){a.splice(c,1);break}delete this._map[b]},next:function(){var b=this,
a;if(b._running)b._nextRequested=!0;else if(b._nextRequested=!1,a=b._queue[b.stack?"pop":"shift"](),b.length=b._queue.length,a)if(b._running=!0,delete b._map[a.id],b.async||a.async){var c=0;1===Z(a.async)?c=a.async:1===Z(b.async)&&(c=b.async);ya(function(){try{b._processResult(a.fn.apply(a.context||b.context,a.args||[]))}catch(c){throw aa(c),b._finish(),c;}},null,null,c)}else try{b._processResult(a.fn.apply(a.context||b.context,a.args||[]))}catch(d){throw aa(d),b._finish(),d;}},_processResult:function(b){var a=
this;a.thenable&&ea(b)?b.then(function(){a._finish()},function(){a._finish()}):a._finish();return b},_finish:function(){this._running=!1;(this.auto||this._nextRequested)&&this.next()},destroy:function(){delete this._queue;delete this._map;delete this.context;this._running=this._nextRequested=!1;this.next=F}};var qa=function(){return window.getComputedStyle?function(b,a,c){if(b===window)return a?c?0:null:{};b=getComputedStyle(b,null);a=a?b[a]:b;return c?parseFloat(a)||0:a}:function(b,a,c){b=b.currentStyle||
b.style||{};a=a?b[a]:b;return c?parseFloat(a)||0:a}}(),mb=function(){var b=/(auto|scroll)/,a,c=function(a){a=qa(a);return a.overflow+a.overflowY+a.overflowY};return function(d){a||(a=document.body);for(;d&&d!==a;){if(b.test(c(d)))return d;d=d.parentNode}return window}}(),Ab=function(b){var a,c=b?"pageYOffset":"pageXOffset",d=b?"scrollTop":"scrollLeft";b=document;var e=b.body,f=b.documentElement;a=void 0!==window[c]?function(){return window[c]}:f.clientHeight?function(){return f[d]}:function(){return e[d]};
return function(b){return b&&b!==window?b&&1==b.nodeType&&b!==e&&b!==f?b[d]:a():a()}},Fa=Ab(!0),Ga=Ab(!1),Ra=function(b){var a={top:0,left:0};if(!Ma(b)||b===window)return a;b.getBoundingClientRect&&(a=b.getBoundingClientRect());return{top:a.top+Fa()-ka.clientTop,left:a.left+Ga()-ka.clientLeft}},Bb=function(b,a){var c,d,e={top:0,left:0};if(b===window||b===ka)return e;if("fixed"==qa(b,"position"))d=b.getBoundingClientRect();else{if(a)return e=Ra(b),c=Ra(a),e={left:e.left-c.left,top:e.top-c.top},0>e.left&&
(e.left=0),0>e.top&&(e.top=0),e;for(c=b.offsetParent||ka;c&&c!=ka&&"static"==qa(c,"position");)c=c.offsetParent;c=c||ka;d=Ra(b);c!==ka&&(e=Ra(c));e.top+=qa(c,"borderTopWidth",!0);e.left+=qa(c,"borderLeftWidth",!0)}return{top:d.top-e.top-qa(b,"marginTop",!0),left:d.left-e.left-qa(b,"marginLeft",!0)}},wa=function(b,a,c){if(!(this instanceof wa))return new wa(b,a,c);this.commonInit(b,a,c);this.init(b,a,c);this.queue.add(this.render,this,[ga(this.watcher.getLastResult())])};wa.prototype={id:null,observable:null,
model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,trackBy:null,trackByWatcher:null,animateMove:!1,animate:!1,trackByFn:null,griDelegate:null,queue:null,buffered:!1,itemSize:null,itemsOffsite:1,bufferState:null,scrollOffset:0,horizontal:!1,bufferEventDelegate:null,topStub:null,botStub:null,commonInit:function(b,a,c){a.removeAttribute("mjs-include");this.parseExpr(c);this.tpl=a;this.renderers=[];this.prevEl=a.previousSibling;this.nextEl=a.nextSibling;this.parentEl=
a.parentNode;this.node=a;this.scope=b;this.queue=new fa({async:!1,auto:!0,thenable:!0,stack:!1,context:this,mode:fa.ONCE});b=na(a,b);this.animateMove=!b.buffered&&b.animateMove&&T.cssAnimations;this.animate=!b.buffered&&(null!==a.getAttribute("mjs-animate")||b.animate);a.removeAttribute("mjs-animate");this.id=b.id||W();b.observable&&(this.observable=new X,y(this,this.observable.getApi(),!0,!1));this.parentEl.removeChild(a);b.buffered&&this.initBuffering(b)},init:function(b,a){var c=O(a,"config")||
{};this.watcher=la(b,this.model,this.onChange,this,null,ba);(this.trackBy=c.trackBy)&&"$"!=this.trackBy?this.trackByWatcher=la(b,this.trackBy,this.onChangeTrackBy,this,null,ba):"$"==this.trackBy||this.watcher.hasInputPipes()||(this.trackBy="$$"+this.watcher.id);this.griDelegate=x(this.scopeGetRawIndex,this)},triggerIf:function(){this.observable&&this.trigger.apply(null,arguments)},render:function(b){var a=this.renderers,c=this.tpl,d=this.parentEl,e=this.nextEl,f=this.buffered,g=document.createDocumentFragment(),
h,p,n;p=0;for(n=b.length;p<n;p++)h=c.cloneNode(!0),a.push(this.createItem(h,b,p)),f||(g.appendChild(h),a[p].attached=!0);f?(this.getScrollOffset(),this.updateScrollBuffer()):(this.doUpdate(),d.insertBefore(g,e));this.triggerIf("render",this)},doUpdate:function(b,a,c,d){var e=this.renderers;b=b||0;var f=e.length;a=a||f-1;var g=this.watcher.getLastResult(),h=this.getTrackByFunction();for(a>f-1&&(a=f-1);b<=a;b++)c&&e[b].action!=c||this.renderItem(b,e,g,h,d)},renderItem:function(b,a,c,d,e){c=c||this.watcher.getLastResult();
a=a||this.renderers;d=d||this.getTrackByFunction();var f=a[b],g=f.scope;a=a.length-1;var h=!(b%2);e&&f.rendered||(g.$index=b,g.$first=0===b,g.$last=b===a,g.$even=h,g.$odd=!h,g.$trackId=d(c[b]),g.$getRawIndex=this.griDelegate,f.renderer?g.$check():(f.renderer=new hb(f.el,g),f.renderer.process(),f.rendered=!0))},createItem:function(b,a,c){var d=this.itemName,e=this.scope.$new();e[d]=this.getListItem(a,c);return{index:c,action:"enter",el:b,scope:e,attached:!1,rendered:!1}},onChange:function(b,a){this.queue.prepend(this.applyChanges,
this,[a],fa.REPLACE)},applyChanges:function(b){var a=this,c=a.renderers,d=a.tpl,e=0,f=ga(a.watcher.getLastResult()),g=null,h=a.animateMove,p=a.animate,n=[],u=a.itemName,r=c.slice(),t=!1,m,l,s,k,v,q;b=a.watcher.getMovePrescription(b,a.getTrackByFunction(),f);s=0;for(k=b.length;s<k;s++)m=b[s],1===Z(m)?(l=m,m=c[l],l!=e&&null===g&&(g=s),m.action="move",m.scope[u]=a.getListItem(f,s),t=h,n.push(m),c[l]=null,e++):(null===g&&(g=s),v=a.createItem(d.cloneNode(!0),f,s),n.push(v));a.renderers=n;if(p){a.doUpdate(g,
null,"enter");t&&(q=a.calculateTranslates(n,r,c));var d=[],A=new H,C=new H,w=new H,x=H.counter(n.length),e=function(){x.countdown();return A};s=0;for(k=c.length;s<k;s++)if(v=c[s])v.scope.$destroy(),ma(v.el),d.push(T(v.el,"leave",null,!1,ba).done(function(a){a.style.visibility="hidden"}));s=0;for(k=n.length;s<k;s++)v=n[s],ma(v.el),"enter"==v.action?d.push(T(v.el,"enter",e,!1,ba)):d.push(a.moveAnimation(v.el,t?q[s][0]:null,t?q[s][1]:null,e,C));x.done(function(){ia(function(){C.resolve();a.applyDomPositions(c);
t||a.doUpdate(g,null,"move");ia(function(){A.resolve()});a.triggerIf("change",a)})});H.all(d).always(function(){ia(function(){a.doUpdate(g||0);a.removeOldElements(c);if(t)for(a.doUpdate(g,null,"move"),s=0,k=n.length;s<k;s++)v=n[s],v.el.style[T.prefixes.transform]=null,v.el.style[T.prefixes.transform]="";w.resolve()})});return w}a.buffered?(a.getScrollOffset(),a.removeOldElements(c),a.queue.append(a.updateScrollBuffer,a,[!0])):(a.applyDomPositions(),a.doUpdate(g||0),a.removeOldElements(c));a.triggerIf("change",
a)},removeOldElements:function(b){var a,c,d,e=this.parentEl;a=0;for(c=b.length;a<c;a++)(d=b[a])&&d.attached&&(d.attached=!1,e.removeChild(d.el))},applyDomPositions:function(b){var a=this.renderers,c=this.parentEl,d=this.prevEl,d=d?d.nextSibling:c.firstChild,e,f,g,h,p;f=0;for(g=a.length;f<g;f++)p=a[f],h=p.el,(e=b&&b[f]?b[f].el.nextSibling:0<f?a[f-1].el.nextSibling||d:d)&&h.nextSibling!==e?c.insertBefore(h,e):e||c.appendChild(h),p.attached=!0},getListItem:function(b,a){return b[a]},onChangeTrackBy:function(b){this.trackByFn=
null;this.trackBy=b},getTrackByFunction:function(){var b;this.trackByFn||((b=this.trackBy)&&"$"!=b?B(b)?this.trackByFn=b:this.trackByFn=function(a){return a&&!ua(a)?a[b]:void 0}:this.trackByFn=function(a){return ua(a)?a:void 0});return this.trackByFn},scopeGetRawIndex:function(b){if(void 0===b)return-1;var a=this.watcher.getUnfilteredValue(),c=this.getTrackByFunction(),d,e;d=0;for(e=a.length;d<e;d++)if(c(a[d])===b)return d;return-1},getNodePositions:function(b,a,c){for(var d=[],e,f,g,h={};b.firstChild;)b.removeChild(b.firstChild);
e=0;for(f=a.length;e<f;e++)c&&c[e]&&(g=c[e].el.cloneNode(!0),b.appendChild(g)),g=a[e].el.cloneNode(!0),b.appendChild(g),d.push(g);e=0;for(f=d.length;e<f;e++)b=d[e],(c=a[e].renderer)&&(h[c.id]={left:b.offsetLeft,top:b.offsetTop});return h},calculateTranslates:function(b,a,c){var d=this.parentEl,e=d.parentNode,f=d.cloneNode(!0),g=d.offsetWidth,h=[],p=0,n=0,u;u=f.style;u.position="absolute";u.left="-10000px";u.visibility="hidden";u.width=g+"px";e.insertBefore(f,d);u.width=g-(f.offsetWidth-g)+"px";a=
this.getNodePositions(f,a);c=this.getNodePositions(f,b,c);d=this.getNodePositions(f,b);e.removeChild(f);e=0;for(f=b.length;e<f;e++)g=b[e].el,u=b[e].renderer,u=u.id,0==e&&(p=g.offsetLeft,n=g.offsetTop),h.push([{left:d[u].left-p-(c[u].left-p),top:d[u].top-n-(c[u].top-n)},a[u]?{left:a[u].left-p-(c[u].left-p),top:a[u].top-n-(c[u].top-n)}:null]);return h},moveAnimation:function(b,a,c,d,e){var f=b.style;e.done(function(){c&&(f[T.prefixes.transform]="translateX("+c.left+"px) translateY("+c.top+"px)")});
return T(b,"move",d,!1,ba,function(b,c,d){0==c&&"start"!=d&&a&&(f[T.prefixes.transform]="translateX("+a.left+"px) translateY("+a.top+"px)")})},initScrollParent:function(b){this.scrollEl=mb(this.parentEl)},initScrollStubs:function(b){var a=this.parentEl,c=this.prevEl,d,e,f={fontSize:0,lineHeight:0,padding:0,paddingTop:0,paddingLeft:0,paddingBottom:0,paddingRight:0,margin:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0};this.topStub=d=document.createElement(b.stub||"div");this.botStub=b=document.createElement(b.stub||
"div");R(d,"mjs-buffer-top");R(b,"mjs-buffer-bottom");for(e in f)d.style[e]=f[e],b.style[e]=f[e];a.insertBefore(d,c?c.nextSibling:a.firstChild);a.insertBefore(b,this.nextEl);this.prevEl=d;this.nextEl=b},initBuffering:function(b){this.buffered=!0;this.itemSize=b.itemSize;this.itemsOffsite=b.itemsOffsite||5;this.horizontal=b.horizontal||!1;this.initScrollParent(b);this.initScrollStubs(b);this.bufferEventDelegate=x(this.bufferUpdateEvent,this);D(this.scrollEl,"scroll",this.bufferEventDelegate);D(window,
"resize",this.bufferEventDelegate)},getScrollOffset:function(){var b=Bb(this.topStub,this.scrollEl);return this.scrollOffset=this.horizontal?b.left:b.top},getBufferState:function(b){var a=this.scrollEl,c=this.horizontal,d=document.documentElement,d=a===window?window[c?"innerWidth":"innerHeight"]||d[c?"clientWidth":"clientHeight"]:a[c?"offsetWidth":"offsetHeight"],e=c?Ga(a):Fa(a),a=this.itemSize,c=this.itemsOffsite,f=b?this.getScrollOffset():this.scrollOffset;b=this.renderers.length;var g,e=Math.max(0,
e+f),f=Math.ceil(e/a);0>f&&(f=0);e=f;g=d=f+Math.ceil(d/a);f=f>c?f-c:0;g+=c;g>b-1&&(g=b-1);return f>g?this.bufferState:this.bufferState={first:f,last:g,viewFirst:e,viewLast:d,ot:f*a,ob:(b-g-1)*a}},updateStubs:function(b){var a=this.horizontal;this.topStub.style[a?"width":"height"]=b.ot+"px";this.botStub.style[a?"width":"height"]=b.ob+"px"},bufferUpdateEvent:function(){this.queue.add(this.updateScrollBuffer,this)},updateScrollBuffer:function(b){var a=this,c=a.bufferState,d=a.parentEl,e=a.renderers,
f=a.botStub,g=a.getBufferState(!1),h=new H,p,n,u,r;if(!g)return null;c&&g.first==c.first&&g.last==c.last||a.triggerIf("bufferchange",a,g,c);ia(function(){if(b||!c||g.last<c.first||g.first>c.last){if(c)for(n=c.first,u=c.last;n<=u;n++)(r=e[n])&&r.attached&&(d.removeChild(r.el),r.attached=!1);p=document.createDocumentFragment();n=g.first;for(u=g.last;n<=u;n++)if(r=e[n])r.rendered||a.renderItem(n),p.appendChild(r.el),r.attached=!0;d.insertBefore(p,f)}else{if(c.first<g.first)for(n=c.first,u=g.first;n<
u;n++)(r=e[n])&&r.attached&&(d.removeChild(r.el),r.attached=!1);else if(c.first>g.first){p=document.createDocumentFragment();n=g.first;for(u=c.first;n<u;n++)if(r=e[n])r.rendered||a.renderItem(n),p.appendChild(r.el),r.attached=!0;d.insertBefore(p,e[c.first].el)}if(c.last<g.last){p=document.createDocumentFragment();n=c.last+1;for(u=g.last;n<=u;n++)if(r=e[n])r.rendered||a.renderItem(n),p.appendChild(r.el),r.attached=!0;d.insertBefore(p,f)}else if(c.last>g.last)for(n=g.last+1,u=c.last;n<=u;n++)(r=e[n])&&
r.attached&&(d.removeChild(r.el),r.attached=!1)}a.updateStubs(g);a.triggerIf("bufferupdate",a);a.onBufferStateChange(g,c);h.resolve()});return h},scrollTo:function(b){var a=this.itemSize,c=this.scrollEl||mb(this.parentEl),d=this.horizontal,e=d?"scrollLeft":"scrollTop",f=new H,g;this.buffered&&this.queue.append(function(){ia(function(){g=a*b;c===window?window.scrollTo(d?g:Ga(),d?Fa():g):c[e]=g;f.resolve()});return f});return f},onBufferStateChange:function(b,a){},parseExpr:function(b){b=b.split(" ");
var a,c,d,e,f;a=0;for(c=b.length;a<c;a++)if(f=b[a],""!=f&&"in"!=f)if(e){d=b.slice(a).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"},destroy:function(){var b=this.renderers,a=this.parentEl,c,d;c=0;for(d=b.length;c<d;c++)b[c].renderer.destroy();delete this.renderers;delete this.tpl;delete this.prevEl;delete this.nextEl;delete this.parentEl;this.trackByWatcher&&(this.trackByWatcher.unsubscribeAndDestroy(),delete this.trackByWatcher);this.buffered&&(a.removeChild(this.topStub),a.removeChild(this.botStub),
S(this.scrollEl,"scroll",this.bufferEventDelegate),S(window,"resize",this.bufferEventDelegate),delete this.bufferEventDelegate);delete this.topStub;delete this.botStub;this.queue.destroy();delete this.queue;this.watcher.unsubscribeAndDestroy(this.onChange,this);delete this.watcher;this.observable&&(this.trigger("destroy",this),this.observable.destroy(),delete this.observable)}};wa.$stopRenderer=!0;wa.$registerBy="id";Q("mjs-each",100,wa);var nb=db.createFunc;(function(){var b="click dblclick mousedown mouseup mouseover mouseout mousemove keydown keyup keypress submit focus blur copy cut paste enter".split(" "),
a,c;a=0;for(c=b.length;a<c;a++)(function(a){var b=a;"enter"==b&&(b="keyup");Q("mjs-"+a,1E3,function(c,g,h){var p=nb(h);g.removeAttribute("mjs-"+a);D(g,b,function(b){b=da(b||window.event);if("enter"==a&&13!=b.keyCode)return null;c.$event=b;p(c);delete c.$event;c.$root.$check();b.preventDefault();return!1})})})(b[a])})();Q("mjs-show",500,I(null,pa,{initial:!0,initialize:function(b,a,c){this.supr(b,a,c)},runAnimation:function(b){var a=this.node.style,c=function(){a.display=b?"":"none"};this.initial?
c():T(this.node,b?"show":"hide",function(){b&&(a.display="")},!0).done(c)},onChange:function(){var b=this.watcher.getLastResult();this.runAnimation(b);this.initial=!1}}));Q("mjs-hide",500,I(null,"attr.mjs-show",{onChange:function(){var b=this.watcher.getLastResult();this.runAnimation(!b);this.initial=!1}}));Q("mjs-if",500,I(null,pa,{parentEl:null,prevEl:null,el:null,initial:!0,initialize:function(b,a,c){this.parentEl=a.parentNode;this.prevEl=a.previousSibling;this.supr(b,a,c)},onScopeDestroy:function(){delete this.prevEl;
delete this.parentEl;this.supr()},onChange:function(){var b=this,a=b.watcher.getLastResult(),c=b.parentEl,d=b.node,e=function(){b.prevEl?c.insertBefore(d,b.prevEl?b.prevEl.nextSibling:null):c.appendChild(d)},f=function(){c.removeChild(d)};a?Ma(d)||(b.initial?e():T(d,"enter",e,!0)):Ma(d)&&(b.initial?f():T(d,"leave",null,!0).done(f));b.initial=!1}}));Q("mjs-ignore",0,Ca);Q("mjs-include",900,function(b,a,c,d){b=new Aa({scope:b,node:a,url:c,parentRenderer:d});return b.ownRenderer?!1:b.initPromise});Q("mjs-init",
250,function(b,a,c){a.removeAttribute("mjs-init");nb(c)(b)});Q("mjs-model",1E3,I(null,pa,{inProg:!1,input:null,binding:null,autoOnChange:!1,initialize:function(b,a,c){var d=na(a,b);this.node=a;this.input=new Ea(a,this.onInputChange,this);this.binding=d.binding||"both";this.supr(b,a,c);b=this.input.getValue();a=this.watcher.getLastResult();if(a!=b)if("input"!=this.binding&&void 0!=a)this.onChange(a);else if("scope"!=this.binding&&void 0!=b)this.onInputChange(b)},onInputChange:function(b){var a=this.scope;
"scope"!=this.binding&&(b&&z(b)&&-1!=b.indexOf("\\{")&&(b=b.replace(/\\{/g,"{")),this.watcher.getLastResult()!=b&&(this.watcher.setValue(b),this.inProg=!0,a instanceof ja?a.$root.$check():this.watcher.checkAll(),this.inProg=!1))},destroy:function(){this.input.destroy();delete this.input;this.supr()},onChange:function(){var b=this.watcher.getLastResult(),a;"input"==this.binding||this.inProg||((a=lb())&&8>a?ya(this.input.setValue,this.input,[b]):this.input.setValue(b))}}));Q("mjs-options",100,I(null,
pa,{model:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,initialize:function(b,a,c){this.parseExpr(c);this.node=a;this.scope=b;for(this.defOption=a.options.length?a.options[0]:null;a.firstChild;)a.removeChild(a.firstChild);this.defOption&&this.defOption.setAttribute("mjs-default-option","");try{this.watcher=la(b,this.model,this.onChange,this,null,ba)}catch(d){aa(d)}this.render(ga(this.watcher.getValue()))},onChange:function(){this.render(ga(this.watcher.getValue()))},
renderOption:function(b,a,c){var d=this.groupEl||this.fragment,e=lb();c.item=b;c.$index=a;b=this.getterFn(c);void 0!=b.group&&(b.group=""+b.group);b.group!==this.prevGroup&&(b.group?(this.groupEl=d=document.createElement("optgroup"),d.setAttribute("label",b.group),b.disabledGroup&&d.setAttribute("disabled","disabled"),this.fragment.appendChild(d)):(d=this.fragment,this.groupEl=null));this.prevGroup=b.group;a=document.createElement("option");a.setAttribute("value",b.value);a.text=b.name;e&&9>e&&(a.innerHTML=
b.name);b.disabled&&a.setAttribute("disabled","disabled");d.appendChild(a)},render:function(b){var a=this.node,c=oa(a),d=this.defOption,e=this.scope.$new(),f,g;this.fragment=document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;a.firstChild;)a.removeChild(a.firstChild);f=0;for(g=b.length;f<g;f++)this.renderOption(b[f],f,e);d&&a.insertBefore(d,a.firstChild);e.$destroy();a.appendChild(this.fragment);this.fragment=null;jb(a,c)},parseExpr:function(b){var a=b.indexOf(" in "),c;-1==a?(c=
b,b="{name: .item, value: .$index}"):(c=b.substr(a+4),b=b.substr(0,a));this.model=c;this.getterFn=Ka(b)}}));(function(){var b="selected checked disabled readonly open required".split(" "),a,c;a=0;for(c=b.length;a<c;a++)(function(a){Q("mjs-"+a,1E3,I(null,pa,{onChange:function(b){b?this.node.setAttribute(a,a):this.node.removeAttribute(a)}}))})(b[a])})();var Vb=function(){var b={},a=0;return function(c){if(b[c])return H.resolve(c);1E3<a&&(b={},a=0);var d=document.createElement("img"),e=d.style,f=new H;
D(d,"load",function(){b[c]=!0;a++;document.body.removeChild(d);f.resolve(c)});e.position="absolute";e.visibility="hidden";e.left="-10000px";e.top="0";d.src=c;document.body.appendChild(d);return f}}(),Cb=document.body,Wb=function(){var b;return function(){if(void 0===b){var a=document.createElement("div"),c=document.createElement("div");c.style&&window.getComputedStyle?(a.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",a.appendChild(c),c.style.cssText=
"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",c.innerHTML="",Cb.appendChild(a),c="4px"===window.getComputedStyle(c,null).width,Cb.removeChild(a),b=c):b=!1}return b}}(),Wa=function(b,a){var c=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,d=["Top","Right","Bottom","Left"],e=b?"inner"==b?"padding":"":"content";return function(b,g){if(b===window)return b.document.documentElement["client"+
a];if(9===b.nodeType){var h=b.documentElement;return Math.max(b.body["scroll"+a],h["scroll"+a],b.body["offset"+a],h["offset"+a],h["client"+a])}a:{var p=a.toLowerCase(),n=e||(!0===g?"margin":"border"),h=qa(b),u=!0,r="width"===p?b.offsetWidth:b.offsetHeight,t="border-box"===h.boxSizing;if(0>=r||null==r){r=b.style[p];if(c.test(r)){h=r;break a}u=t&&(Wb()||r===b.style[p]);r=parseFloat(r)||0}n=n||(t?"border":"content");p=n===(u?"border":"content")?4:"width"===p?1:0;for(t=0;4>p;p+=2)"margin"===n&&(t+=parseFloat(h[n+
d[p]])),u?("content"===n&&(t-=parseFloat(h["padding"+d[p]])),"margin"!==n&&(t-=parseFloat(h["border"+d[p]+"Width"]))):(t+=parseFloat(h["padding"+d[p]]),"padding"!==n&&(t+=parseFloat(h["border"+d[p]+"Width"])));h=r+t}return h}},Xb=Wa("","Width"),Yb=Wa("","Height");Q("mjs-src",1E3,I(null,pa,{scrollEl:null,scrollDelegate:null,resizeDelegate:null,position:null,sw:null,sh:null,queue:null,checkVisibility:!0,usePreload:!0,initialize:function(b,a,c){var d=na(a,b);d.deferred?(this.scrollEl=mb(a),this.scrollDelegate=
x(this.onScroll,this),this.resizeDelegate=x(this.onResize,this),D(this.scrollEl,"scroll",this.scrollDelegate),D(window,"resize",this.resizeDelegate)):this.checkVisibility=!1;d.noPreload&&(this.usePreload=!1);this.queue=new fa({auto:!0,async:!0,mode:fa.ONCE});this.supr(b,a,c)},isVisible:function(){if(!this.checkVisibility)return!0;var b=this.scrollEl,a=Fa(b),c=Ga(b),d=this.sw,e=this.sh,f;this.position||(this.position=Bb(this.node,b));d||(d=this.sw=Xb(b),e=this.sh=Yb(b));b=this.position.top;f=this.position.left;
return b>a&&b<a+e&&f>c&&f<c+d},onScroll:function(){this.queue.add(this.changeIfVisible,this)},onResize:function(){this.sw=this.position=null;this.queue.add(this.changeIfVisible,this)},onChange:function(){this.queue.add(this.changeIfVisible,this)},changeIfVisible:function(){var b=this;if(b.isVisible()){var a=b.watcher.getLastResult();b.stopWatching();b.usePreload?Vb(a).done(function(){b&&b.node&&ia(function(){b.node.src=a;b.node.setAttribute("src",a)})}):(b.node.src=a,b.node.setAttribute("src",a))}},
stopWatching:function(){this.scrollEl&&(S(this.scrollEl,"scroll",this.scrollDelegate),S(window,"resize",this.resizeDelegate),delete this.scrollDelegate,delete this.resizeDelegate,delete this.scrollEl,this.queue.destroy(),delete this.queue,this.checkVisibility=!1)},destroy:function(){this.stopWatching();this.supr()}}));var Db=function(b){var a;a:{for(var c=b,d;c;){d=O(c,"mjs-transclude");if(void 0!==d){a=d;break a}c=c.parentNode}a=void 0}if(a){b.firstChild&&O(b,"mjs-transclude",va(b.childNodes));c=
b.parentNode;d=b.nextSibling;a=Ua(a);var e=ga(a.childNodes);c.removeChild(b);c.insertBefore(a,d);return e}return null};Q("mjs-transclude",1E3,function(b,a){return Db(a)});Q("mjs-view",200,function(b,a,c){a.removeAttribute("mjs-view");Ba(c||"MetaphorJs.cmp.View",{scope:b,node:a},b,a);return!1});var Eb=gb.registerTagHandler;Eb("mjs-include",900,function(b,a,c,d){return(new Aa({scope:b,node:a,tpl:a.getAttribute("src"),parentRenderer:d,replace:!0})).initPromise});Eb("mjs-transclude",900,function(b,a){return Db(a)});
var Fb=function(){var b=function(a,b,c){if(B(b))return b(a,c);if(""===b||void 0===b)return!0;if(void 0!==a){if(za(a))return a===b;if(b instanceof RegExp)return b.test(""+a);if("strict"==c)return""+a===""+b;if(!0===c||null===c||void 0===c)return-1!=""+a.indexOf(b);if(!1===c)return-1==""+a.indexOf(b)}return!1},a=function(a,c,f){if(ua(a))return void 0===c.$?!0:b(a,c.$,f);var g,h;for(g in c)if("$"==g)for(h in a){if(b(a[h],c.$,f))return!0}else if(b(a[g],c[g],f))return!0;return!1},c=function(b,c,f){ta(c)||
(c={$:c});var g=[],h,p;h=-1;for(p=b.length;++h<p;)a(b[h],c,f)&&g.push(b[h]);return g};c.compare=a;return c}();Y("filter.filter",function(b,a,c,d){return Fb(b,c,d)});Y("filter.join",function(b,a,c){c=c||", ";return b&&b.length?(P(b)||(b=ga(b)),b.join(c)):""});Y("filter.l",function(b,a){return a.$app.lang.get(b)});Y("filter.limitTo",function(b,a,c){a=z(b);if(!P(b)&&!a)return b;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);if(a)return c?0<=c?b.slice(0,c):b.slice(c,b.length):"";a=[];var d;
c>b.length?c=b.length:c<-b.length&&(c=-b.length);0<c?d=0:(d=b.length+c,c=b.length);for(;d<c;d++)a.push(b[d]);return a});Y("filter.linkify",function(b,a,c){return b?b.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(c?' target="'+c+'"':"")+">$1</a>"):""});Y("filter.lowercase",function(b){return b.toLowerCase()});var Zb={};Y("filter.moment",function(b,a,c){c=Zb[c]||c;return moment(b).format(c)});var $b={};Y("filter.numeral",function(b,a,c){c=$b[c]||
c;return numeral(b).format(c)});Y("filter.p",function(b,a,c){return a.$app.lang.plural(b,parseInt(c,10)||0)});var Gb=function(b,a,c){c||(c="asc");b=b.slice();b.sort(function(b,c){var f=typeof b,g=b,h=c;if(f!=typeof c)return 0;"object"==f&&(B(a)?(g=a(b),h=a(c)):(g=b[a],h=c[a]));if("number"==typeof g)return g-h;g=(""+g).toLowerCase();h=(""+h).toLowerCase();return g===h?0:g>h?1:-1});return"desc"==c?b.reverse():b};Y("filter.sortBy",function(b,a,c,d){return Gb(b,c,d)});Y("filter.split",function(b,a,c,
d){d=d||void 0;c=c||"/\\n|,/";if(!b)return[];b=""+b;"/"==c.substr(0,1)&&"/"==c.substr(c.length-1)&&(c=Na(c.substring(1,c.length-1)));b=b.split(c,d);a=-1;for(c=b.length;++a<c;b[a]=J(b[a]));return b});Y("filter.toArray",function(b){return ga(b)});Y("filter.ucfirst",function(b){return b.substr(0,1).toUpperCase()+b.substr(1)});Y("filter.uppercase",function(b){return b.toUpperCase()});var Hb=function(b){var a=!1,c=!0,d=window,e=d.document,f=e.documentElement,g=function(c){if("readystatechange"!=c.type||
"complete"==e.readyState)S("load"==c.type?d:e,c.type,g),!a&&(a=!0)&&b.call(d,c.type||c)},h=function(){try{f.doScroll("left")}catch(a){setTimeout(h,50);return}g("poll")};if("complete"==e.readyState)b.call(d,"lazy");else{if(e.createEventObject&&f.doScroll){try{c=!d.frameElement}catch(p){}c&&h()}D(e,"DOMContentLoaded",g);D(e,"readystatechange",g);D(d,"load",g)}},Ib=function(b,a,c,d){b.removeAttribute("mjs-app");try{var e=Ba(a||"MetaphorJs.cmp.App",!1,c,b,[b,c]);return!1!==d?e.done(function(a){a.run();
return a}):e}catch(f){return aa(f),H.reject(f)}};(function(){Hb(function(){var b=K("[mjs-app]"),a,c,d;a=-1;for(c=b.length;++a<c;)d=b[a],Ib(d,d.getAttribute("mjs-app"),null,!0)})})();var ra=Sa.factory,Xa=function(){var b={},a={};return I("MetaphorJs.data.Model",{type:null,fields:null,record:null,store:null,plain:!1,lastAjaxResponse:null,initialize:function(a){this.fields={};y(this,{record:{load:null,save:null,"delete":null,id:null,data:null,success:null,extra:{}},store:{load:null,save:null,"delete":null,
id:null,data:null,total:null,start:null,limit:null,success:null,extra:{}}},!1,!0);y(this,a,!0,!0);this.plain=!this.type},isPlain:function(){return this.plain},getRecordProp:function(a,b){return this.getProp("record",a,b)},setRecordProp:function(a,b){this.record[a]=b},getStoreProp:function(a,b){return this.getProp("store",a,b)},setStoreProp:function(a,b){this.store[a]=b},getProp:function(a,b,e){a=this[a];return a[b]&&a[b][e]||a[e]||this[e]||null},setProp:function(a,b){return this[a]=b},_makeRequest:function(a,
b,e,f,g){var h=this,p=h[a],n=y({},z(p[b])||B(p[b])?{url:p[b]}:p[b]),u=h.getProp(a,b,"id"),r=h.getProp(a,b,"data"),t=h.getProp(a,b,"url"),m=h.getProp(a,b,"json");if(!n)if(t)n={url:t};else throw a+"."+b+" not defined";if(z(n)||B(n))n={url:n};if(!n.url){if(!t)throw a+"."+b+" url not defined";n.url=t}n.data=y({},n.data,h.extra,p.extra,p[b]?p[b].extra:{},g,!0,!0);if(B(n.url)){e=n.url(n.data);var l=new H;e.then(function(e){"record"==a?h._processRecordResponse(b,e,l):"store"==a&&h._processStoreResponse(b,
e,l)});return l}n.method||(n.method="load"==b?"GET":"POST");e&&(n.data[u]=e);f&&(r?n.data[r]=f:n.data=f);m&&n.data&&"GET"!=n.method&&(n.data=JSON.stringify(n.data));n.callbackScope=h;"record"==a?n.processResponse=function(a,c){h.lastAjaxResponse=a;h._processRecordResponse(b,a,c)}:"store"==a&&(n.processResponse=function(a,c){h.lastAjaxResponse=a;h._processStoreResponse(b,a,c)});return Pa(n)},_processRecordResponse:function(a,b,e){var f=this.getRecordProp(a,"id"),g=this.getRecordProp(a,"data"),f=(g=
g?b[g]:b)&&g[f]||b[f];this._getSuccess("record",a,b)?e.resolve({id:f,data:g}):e.reject(b)},_processStoreResponse:function(a,b,e){var f=this.getStoreProp(a,"data"),g=this.getStoreProp(a,"total"),f=f?b[f]:b,g=g?b[g]:null;this._getSuccess("store",a,b)?e.resolve({data:f,total:g}):e.reject(b)},_getSuccess:function(a,b,e){return(a=this.getProp(a,b,"success"))&&void 0!=e[a]?e[a]:!0},loadRecord:function(a){return this._makeRequest("record","load",a)},saveRecord:function(a,b,e){return this._makeRequest("record",
a.getId()?"save":"create",a.getId(),y({},a.storeData(a.getData(b)),e))},deleteRecord:function(a){return this._makeRequest("record","delete",a.getId())},loadStore:function(a,b){return this._makeRequest("store","load",null,null,b)},saveStore:function(a,b){return this._makeRequest("store","save",null,b)},deleteRecords:function(a,b){return this._makeRequest("store","delete",b)},getFields:function(){return this.fields},restoreField:function(a,b,e){var f=this.fields[b];if(f){switch(z(f)?f:f.type){case "int":e=
parseInt(e);break;case "bool":case "boolean":z(e)?(e=e.toLowerCase(),e=!("off"===e||"no"===e||"0"===e||"false"==e||"null"==e)):e=e?!0:!1;break;case "double":case "float":e=parseFloat(e);break;case "date":f.parseFn?e=f.parseFn(e,f.format):Date.parse?e=Date.parse(e,f.format):("timestamp"==f.format&&(e=1E3*parseInt(e)),e=new Date(e))}f.restore&&(e=f.restore.call(a,e,b))}return this.onRestoreField(a,b,e)},onRestoreField:function(a,b,e){return e},storeField:function(a,b,e){var f=this.fields[b];if(f){switch(z(f)?
f:f.type){case "bool":case "boolean":e=e?"1":"0";break;case "date":e=f.formatFn?f.formatFn(e,f.format):Date.format?Date.format(e,f.format):"timestamp"==f.format?e.getTime()/1E3:e.format?e.format(f.format):e.toString();break;default:e=e.toString()}f.store&&(e=f.store.call(a,e,b))}return this.onStoreField(a,b,e)},onStoreField:function(a,b,e){return e}},{create:function(a,d){return"MetaphorJs.data.Model"==a?ra(a,d):d?ra(a,d):b[a]?b[a]:b[a]=ra(a)},addToCache:function(b){var d=b.getClass(),e=b.getId();
"MetaphorJs.data.Record"!=d&&(a[d]||(a[d]={}),a[d][e]=b)},getFromCache:function(b,d){return a[b]&&a[b][d]?a[b][d]:null},removeFromCache:function(b,d){a[b]&&a[b][d]&&delete a[b][d]}})}(),ac=Sa.isInstanceOf,Ha=I("MetaphorJs.data.Record","MetaphorJs.cmp.Base",{id:null,data:null,orig:null,modified:null,loaded:!1,dirty:!1,destroyed:!1,model:null,standalone:!0,stores:null,initialize:function(b,a,c){var d=arguments.length;1==d?(c=b,a=b=null):2==d&&(c=a,a=null);this.data={};this.orig={};this.stores=[];this.modified=
{};c=c||{};this.supr(c);z(this.model)?this.model=ra(this.model):ac(this.model,"MetaphorJs.data.Model")||(this.model=ra("MetaphorJs.data.Model",this.model));this.id=b;a?this.importData(a):!1!==c.autoLoad&&b&&this.load();"MetaphorJs.data.Record"!=this.getClass()&&Xa.addToCache(this)},isLoaded:function(){return this.loaded},isStandalone:function(){return this.standalone},isDirty:function(){return this.dirty},getModel:function(){return this.model},attachStore:function(b){b=b.getId();-1==this.stores.indexOf(b)&&
this.stores.push(b)},detachStore:function(b){b=b.getId();var a;this.destroyed||-1==(a=this.stores.indexOf(b))||(this.stores.splice(a,1),0!=this.stores.length||this.standalone||this.destroy())},setDirty:function(b){this.dirty!=b&&(this.dirty=!!b,this.trigger("dirtychange",this,b))},importData:function(b){var a={},c;if(b){for(c in b)a[c]=this.model.restoreField(this,c,b[c]);this.data=a}this.orig=y({},this.data);this.modified={};this.loaded=!0;this.setDirty(!1)},storeData:function(b){var a={},c;for(c in b)a[c]=
this.model.storeField(this,c,b[c]);return a},getId:function(){return this.id},getData:function(b){if(b){var a={},c,d;b=z(b)?[b]:b;c=0;for(d=b.length;c<d;c++)a[b[c]]=this.data[b[c]];return a}return y({},this.data)},getChanged:function(){return y({},this.modified)},isChanged:function(b){return this.modified[b]||!1},get:function(b){return this.data[b]},setId:function(b){!this.id&&b&&(this.id=b)},set:function(b,a){var c=this.data[b];a=this.model.restoreField(this,b,a);this.data[b]=a;c!=a&&(this.modified[b]=
!0,this.setDirty(!0),this.trigger("change",this,b,a,c),this.trigger("change-"+b,this,b,a,c))},revert:function(){this.dirty&&(this.data=y({},this.orig),this.modified={},this.setDirty(!1))},load:function(){var b=this;b.trigger("beforeload",b);return b.model.loadRecord(b.id).done(function(a){b.setId(a.id);b.importData(a.data);b.trigger("load",b)}).fail(function(){b.trigger("failedload",b)})},save:function(b,a){var c=this;c.trigger("beforesave",c);return c.model.saveRecord(c,b,a).done(function(a){c.setId(a.id);
c.importData(a.data);c.trigger("save",c)}).fail(function(a){c.trigger("failedsave",c)})},"delete":function(){var b=this;b.trigger("beforedelete",b);return b.model.deleteRecord(b).done(function(){b.trigger("delete",b);b.destroy()}).fail(function(){b.trigger("faileddelete",b)})},reset:function(){this.id=null;this.data={};this.orig={};this.modified={};this.dirty=this.loaded=!1;this.trigger("reset",this)},destroy:function(){this.destroyed||(this.destroyed=!0,this.trigger("destroy",this),this.stores=this.model=
this.modified=this.orig=this.data=null,Xa.removeFromCache(this.getClass(),this.id),this.supr())}});(function(){var b={};return I("MetaphorJs.data.Store","MetaphorJs.cmp.Base",{id:null,autoLoad:!1,clearOnLoad:!0,model:null,extraParams:null,loaded:!1,loading:!1,local:!1,items:null,current:null,map:null,currentMap:null,length:0,currentLength:0,maxLength:0,totalLength:0,start:0,pageSize:null,pages:null,filtered:!1,sorted:!1,filterBy:null,filterOpt:null,sortBy:null,sortDir:null,publicStore:!1,idProp:null,
initialize:function(a,c,d){this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=!1;this.extraParams=this.extraParams||{};a&&!z(a)&&(d=c,c=a,a=null);c=c||{};a&&(c.url=a);this.supr(c);this.id=this.id||W();this.publicStore&&(b[this.id]=this);this.initModel(c);this.createEvent("beforeload",!1);!this.local&&this.autoLoad?this.load():d&&(P(d)?this._loadArray(d):this._loadAjaxData(d));this.local&&(this.loaded=!0)},initModel:function(a){z(this.model)?this.model=ra(this.model):this.model instanceof
Xa||(this.model=ra("MetaphorJs.data.Model",this.model));a.url&&(this.model.store.load=a.url);this.idProp=this.model.getStoreProp("load","id")},getId:function(){return this.id},isLoaded:function(){return this.loaded},isLocal:function(){return this.local},setLocal:function(a){this.local=!!a},isLoading:function(){return this.loading},isFiltered:function(){return this.filtered},isSorted:function(){return this.sorted},getLength:function(a){return a?this.length:this.currentLength},getTotalLength:function(){return this.totalLength||
this.currentLength},getPagesCount:function(){return null!==this.pageSize?parseInt(this.totalLength/this.pageSize):1},setParam:function(a,b){this.extraParams[a]=b},getParam:function(a){return this.extraParams[a]},setStart:function(a){this.start=a},setPageSize:function(a){this.pageSize=a},getAjaxData:function(){return this.ajaxData},hasDirty:function(a){if(this.model.isPlain())return!1;var b=!1;this.each(function(a){return a.isDirty()?(b=!0,!1):!0},null,a);return b},getDirty:function(a){var b=[];if(this.model.isPlain())return b;
this.each(function(a){a.isDirty()&&b.push(a)},null,a);return b},getModel:function(){return this.model},_loadAjaxData:function(a,b){var d=this;b=b||{};if(b.silent||!1!==d.trigger("beforeload",d))d.ajaxData=a,d.model._processStoreResponse("load",a,{resolve:function(a){d._onModelLoadSuccess(a,b)},reject:function(a){d._onModelLoadFail(a,b)}})},_loadArray:function(a,b){b=b||{};(b.silent||!1!==this.trigger("beforeload",this))&&P(a)&&(this._load(a,b),this.totalLength=this.length)},_load:function(a,b){var d=
b.prepend;b=b||{};for(var e=0;e<a.length;e++)d?this.insert(e,a[e],!0,!0):this.add(a[e],!0,!0);this.loaded=!0;this.loading=!1;this.trigger("loadingend",this);this.onLoad();b.skipUpdate||this.update();b.silent||this.trigger("load",this)},load:function(a,b){var d=this,e=d.model.store,f=e.start,e=e.limit,g=d.pageSize;b=b||{};if(d.local)return null;a=y({},d.extraParams,a||{});null===g||a[f]||a[e]||(f&&(a[f]=d.start),e&&(a[e]=g));if(!b.silent&&!1===d.trigger("beforeload",d))return null;d.loading=!0;d.trigger("loadingstart",
d);return d.model.loadStore(d,a).done(function(a){d.ajaxData=d.model.lastAjaxResponse;d._onModelLoadSuccess(a,b)}).fail(function(a){d.ajaxData=d.model.lastAjaxResponse;d._onModelLoadFail(a,b)})},_onModelLoadSuccess:function(a,b){b=b||{};if(!b.noopOnEmpty||a.data.length)!b.prepend&&!b.append&&this.clearOnLoad&&0<this.length&&this.clear(!0),this.totalLength=parseInt(a.total),this._load(a.data,b)},_onModelLoadFail:function(a,b){this.onFailedLoad();b.silent||this.trigger("failedload",this,a)},onLoad:F,
onFailedLoad:F,save:function(a){var b=this,d={},e=0;if(b.local)return null;if(b.model.isPlain())throw Error("Cannot save plain store");b.each(function(a){a.isDirty()&&(d[a.getId()]=a.storeData(a.getData()),e++)});if(!e)throw Error("Nothing to save");return a||!1!==b.trigger("beforesave",b,d)?b.model.saveStore(b,d).done(function(d){b._onModelSaveSuccess(d,a)}).fail(function(d){b._onModelSaveFail(d,a)}):null},_onModelSaveSuccess:function(a,b){var d,e,f,g=a.data;if(g&&g.length)for(d=0,e=g.length;d<e;d++)f=
this.getRecordId(g[d]),(f=this.getById(f))&&f.importData(g[d]);this.onSave();b||this.trigger("save",this)},_onModelSaveFail:function(a,b){this.onFailedSave(a);b||this.trigger("failedsave",this)},onSave:F,onFailedSave:F,deleteById:function(a,b,d){var e=this,f,g,h;if(e.local)return null;if(!a||P(a)&&!a.length)throw Error("Record id required");P(a)||(a=[a]);f=0;for(g=a.length;f<g;f++)h=e.getById(a[f]),e.remove(h,b,d),h instanceof Ha&&h.destroy();return b||!1!==e.trigger("beforedelete",e,a)?e.model.deleteRecords(e,
a).done(function(){e.totalLength-=a.length;e.onDelete();b||e.trigger("delete",e,a)}).fail(function(){e.onFailedDelete();b||e.trigger("faileddelete",e,a)}):null},onDelete:F,onFailedDelete:F,deleteAt:function(a,b,d){var e=this.getAt(a);if(!e)throw Error("Record not found at "+a);return this["delete"](e,b,d)},"delete":function(a,b,d){return this.deleteById(this.getRecordId(a),b,d)},deleteRecords:function(a,b,d){var e=[],f,g;f=0;for(g=a.length;f<g;f++)e.push(this.getRecordId(a[f]));return this.deleteById(e,
b,d)},loadOr:function(a,b,d){this.local||this.isLoading()||(this.isLoaded()?a&&a.call(b||this):this.load(null,d))},addPrevPage:function(a){a=a||{};a.append=!1;a.prepend=!0;a.noopOnEmpty=!0;return this.loadPrevPage(a)},addNextPage:function(a){a=a||{};a.append=!0;a.prepend=!1;a.noopOnEmpty=!0;if(!this.local&&(!this.totalLength||this.length<this.totalLength))return this.load({start:this.length,limit:this.pageSize},a)},loadNextPage:function(a){if(!this.local&&(!this.totalLength||this.length<this.totalLength))return this.start+=
this.pageSize,this.load(null,a)},loadPrevPage:function(a){if(!this.local&&0<this.start)return this.start-=this.pageSize,0>this.start&&(this.start=0),this.load(null,a)},loadPage:function(a,b){if(!this.local)return this.start=parseInt(a,10),0>this.start&&(this.start=0),this.load(null,b)},getRecordId:function(a){return a instanceof Ha?a.getId():a[this.idProp]||null},getRecordData:function(a){return this.model.isPlain()?a:a.data},processRawDataItem:function(a){if(a instanceof Ha||this.model.isPlain())return a;
var b=this.model.type,d=this.getRecordId(a),e;d&&(e=Xa.getFromCache(b,d));e||(e=ra(b,d,a,{model:this.model,standalone:!1}));return e},bindRecord:function(a,b){b[a]("change",this.onRecordChange,this);b[a]("destroy",this.onRecordDestroy,this);b[a]("dirtychange",this.onRecordDirtyChange,this);return b},onRecordDirtyChange:function(a){this.trigger("update",this,a)},onRecordChange:function(a,b,d,e){this.trigger("update",this,a)},onRecordDestroy:function(a){this.remove(a)},shift:function(a,b,d){return this.removeAt(0,
a,b,d)},unshift:function(a,b,d){return this.insert(0,a,b,d)},pop:function(a,b,d){return this.removeAt(this.length-1,a,b,d)},addMany:function(a,b,d){var e,f,g=this.length;e=0;for(f=a.length;e<f;e++)this.insert(g+e,a[e],!0,!0);d||this.update();0<f&&!b&&this.trigger("add",a)},add:function(a,b,d){return this.insert(this.length,a,b,d)},onAdd:F,removeAt:function(a,b,d,e){e||(a=this.items.indexOf(this.current[a]));if(a<this.length&&0<=a)return this.length--,e=this.items[a],this.items.splice(a,1),a=this.getRecordId(e),
void 0!=a&&(delete this.map[a],delete this.currentMap[a]),this.onRemove(e,a),d||this.update(),b||this.trigger("remove",e,a),e instanceof Ha?(this.bindRecord("un",e),e.detachStore(this),e.destroyed?void 0:e):e},onRemove:F,insertMany:function(a,b,d,e){var f,g;f=0;for(g=b.length;f<g;f++)this.insert(a+f,b[f],!0,!0);0<g&&!e&&this.update();0<g&&!d&&this.trigger("add",b)},insert:function(a,b,d,e){var f,g=!1;b=this.processRawDataItem(b);f=this.getRecordId(b);this.map[f]&&(this.suspendAllEvents(),this.removeId(f),
this.resumeAllEvents());a>=this.length?(this.items.push(b),g=!0):this.items.splice(a,0,b);this.length++;this.maxLength&&this.length>this.maxLength&&(g?this.pop(d,!0):this.shift(d,!0));void 0!=f&&(this.map[f]=b);b instanceof Ha&&(b.attachStore(this),this.bindRecord("on",b));this.onAdd(a,b);e||this.update();d||this.trigger("add",[b]);return b},replace:function(a,b,d,e){var f;f=this.items.indexOf(a);this.removeAt(f,!0,!0,!0);this.insert(f,b,!0,!0);e||this.update();d||this.trigger("replace",a,b);return b},
onReplace:F,remove:function(a,b,d){return this.removeAt(this.indexOf(a,!0),b,d,!0)},removeId:function(a,b,d){return this.removeAt(this.indexOfId(a,!0),b,d,!0)},contains:function(a,b){return-1!=this.indexOf(a,b)},containsId:function(a,b){return b?void 0!==this.map[a]:void 0!==this.currentMap[a]},clear:function(a){var b=this.getRange();this._reset();this.onClear();a||this.trigger("clear",b)},onClear:F,reset:function(){this._reset();this.start=0},_reset:function(a){var b,d;if(!a)for(a=0,b=this.items.length;a<
b;a++)d=this.items[a],d instanceof Ha&&(this.bindRecord("un",d),d.detachStore(this));this.totalLength=this.currentLength=this.length=0;this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=this.local},getAt:function(a,b){return b?this.items[a]||void 0:this.current[a]||void 0},getById:function(a,b){return b?this.map[a]||void 0:this.currentMap[a]||void 0},indexOf:function(a,b){return b?this.items.indexOf(a):this.current.indexOf(a)},indexOfId:function(a,b){return this.indexOf(this.getById(a,
b),b)},each:function(a,b,d){d=d?this.items.slice():this.current.slice();for(var e=0,f=d.length;e<f&&!1!==a.call(b,d[e],e,f);e++);},eachId:function(a,b,d){var e=this;e.each(function(d,g,h){return a.call(b,e.getRecordId(d),g,h)},null,d)},collect:function(a,b){var d=[],e=!this.model.isPlain();this.each(function(b){(b=e?b.get(a):b[a])&&d.push(b)},null,b);return d},first:function(a){return a?this.items[0]:this.current[0]},last:function(a){return a?this.items[this.length-1]:this.current[this.current-1]},
getRange:function(a,b,d){d=d?this.items:this.current;var e=[];if(1>d.length)return e;a=a||0;b=Math.min(void 0==b?this.length-1:b,this.length-1);if(a<=b)for(;a<=b;a++)e.push(d[a]);else for(;a>=b;a--)e.push(d[a]);return e},findBy:function(a,b,d,e){a=this.findIndexBy(a,b,d,e);return-1==a?void 0:this.getAt(a,e)},findIndexBy:function(a,b,d,e){e=e?this.items:this.current;d=d||0;for(var f=e.length;d<f;d++)if(a.call(b,e[d],this.getRecordId(e[d])))return d;return-1},find:function(a,b,d,e){var f=!this.model.isPlain(),
g;return this.findIndexBy(function(e){g=f?e.get(a):e[a];return d?g===b:g==b},this,0,e)},findExact:function(a,b,d){return this.find(a,b,!0,d)},findBySet:function(a,b){var d=null,e,f;this.each(function(b){e=!0;for(f in a)if(a[f]!=b[f]){e=!1;break}return e?(d=b,!1):!0},null,b);return d},update:function(){var a=this,b=a.filtered,d=a.sorted;a.currentLength=a.length;a.currentMap=a.map;a.current=a.items;if(b){var e=a.filterBy,f=a.filterOpt,g,h;a.current=g=[];a.currentMap=h={};a.each(function(b){Fb.compare(b.data,
e,f)&&(g.push(b),h[a.getRecordId(b)]=b)},null,!0);a.currentLength=a.current.length}if(d){var p=a.sortBy,n=!a.model.isPlain();a.current=Gb(a.current,function(a){return n?a.get(p):a[p]},a.sortDir)}a.trigger("update",a)},filter:function(a,b){this.filtered=!0;this.filterBy=a;this.filterOpt=b;this.update()},clearFilter:function(){this.filtered&&(this.filterOpt=this.filterBy=null,this.update())},sort:function(a,b){this.sorted=!0;this.sortBy=a;this.sortDir=b;this.update()},clearSorting:function(){this.sorted=
!1;this.sortDir=this.sortBy=null;this.update()},onDestroy:function(){delete b[this.id];this.clear();this.supr()}},{lookupStore:function(a){return b[a]||null},eachStore:function(a,c){for(var d in b)if(!1===a.call(c||window,b[d]))break}})})();I("MetaphorJs.data.FirebaseStore","MetaphorJs.data.Store",{firebase:null,initialize:function(b){this.firebase=z(b)?new Firebase(b):b;this.firebase.on("child_added",x(this.onChildAdded,this));this.firebase.on("child_removed",x(this.onChildRemoved,this));this.firebase.on("child_changed",
x(this.onChildChanged,this));this.firebase.on("child_moved",x(this.onChildMoved,this));this.supr()},initModel:F,ref:function(){return this.firebase.ref?this.firebase.ref():this.firebase},load:function(){if(!this.loaded)this.firebase.once("value",x(this.onSnapshotLoaded,this))},onSnapshotLoaded:function(b){var a=this;b.forEach(function(b){a.add(b,!0,!0)});a.update();a.loaded=!0;a.trigger("load",a)},onChildAdded:function(b,a){if(this.loaded){var c=this.indexOfId(a,!0);this.insert(c+1,b)}},onChildRemoved:function(b){this.loaded&&
this.removeId(b.name())},onChildChanged:function(b,a){if(this.loaded){var c=this.getById(b.name(),!0);this.replace(c,b)}},onChildMoved:function(b,a){},getRecordId:function(b){return b.name()},getRecordData:function(b){return b.val()},processRawDataItem:function(b){return b},bindRecord:F});var ob=I(null,wa,function(b,a,c){if(!(this instanceof ob))return new ob(b,a,c);this.supr(b,a,c)},{store:null,pullNext:!1,pullNextDelegate:null,init:function(b,a,c){this.store=c=Ka(this.model)(b);this.watcher=la(c,
".current",this.onChange,this,null,ba);this.trackByFn=x(c.getRecordId,c);this.griDelegate=x(c.indexOfId,c);this.bindStore(c,"on");b=na(a,b);!b.buffered&&b.pullNext&&this.initPullNext(b)},bindStore:function(b,a){b[a]("update",this.onStoreUpdate,this);b[a]("clear",this.onStoreUpdate,this);b[a]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},getListItem:function(b,a){return this.store.getRecordData(b[a])},onStoreDestroy:function(){this.onStoreUpdate();this.watcher.unsubscribeAndDestroy(this.onChange,
this);delete this.watcher},initBuffering:function(b){this.supr(b);this.pullNext=b.pullNext||!1},initPullNext:function(b){this.pullNext=!0;this.itemSize=b.itemSize;this.initScrollParent();this.getScrollOffset();this.pullNextDelegate=x(this.pullNextEvent,this);D(this.scrollEl,"scroll",this.pullNextDelegate);D(window,"resize",this.pullNextDelegate)},pullNextEvent:function(){this.queue.append(this.updateStoreOnScroll,this)},updateStoreOnScroll:function(){var b=this.bufferState,a=this.getBufferState(),
c=this.store.getLength();b&&a.first==b.first&&a.last==b.last||this.triggerIf("bufferchange",this,a,b);c-a.last<(a.last-a.first)/3&&!this.store.loading&&(this.store.addNextPage(),this.triggerIf("pull",this))},onBufferStateChange:function(b,a){var c=this.store.getLength();this.supr(b,a);this.pullNext&&c-b.last<(b.last-b.first)/3&&!this.store.loading&&(this.store.addNextPage(),this.triggerIf("pull",this))},destroy:function(){this.bindStore(this.store,"un");delete this.store;this.pullNext&&!this.buffered&&
(S(this.scrollEl,"scroll",this.pullNextDelegate),S(window,"resize",this.pullNextDelegate));this.supr()}},{$stopRenderer:!0,$registerBy:"id"});Q("mjs-each-in-store",100,ob);var pb=K.is,xa=function(b){return b.substr(0,1).toUpperCase()+b.substr(1)},Ia=Wa("outer","Width"),Ja=Wa("outer","Height"),Ya={},bc=function(b,a,c,d){var e=a+"-"+c,f=function(b){b=da(b);return pb(b.target,a)?d(b):null};Ya[e]||(Ya[e]=[]);Ya[e].push({el:b,ls:f,fn:d});D(b,c,f)},cc=function(b,a,c,d){var e,f;if(f=Ya[a+"-"+c])for(a=-1,
e=f.length;++a<e;)f[a].el===b&&f[a].fn===d&&S(b,c,f[a].ls)},dc=function(){var b=function(a,b){var c=a.style,d;for(d in b)c[d]=b[d]},a={t:"b",r:"l",b:"t",l:"r"},c={t:"top",r:"right",b:"bottom",l:"left"},d={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]},e=document.all&&!window.XMLHttpRequest,f=function(){var a={},b={};return{register:function(c){var d=c.getInstanceId(),e=c.getGroup(),f,k,g;a[d]=c;f=0;for(k=e.length;f<k;f++)g=e[f],b[g]||(b[g]={}),b[g][d]=!0;c.on("destroy",this.unregister,this)},unregister:function(b){b=
b.getInstanceId();delete a[b]},hideAll:function(c){var d=c.getInstanceId();c=c.getGroup();var e,f,k,g;e=0;for(f=c.length;e<f;e++)for(g in k=c[e],k=b[k],k)a[g]?g==d||a[g].isHideAllIgnored()||a[g].hide(null,!0,!0):delete k[g]}}}(),g=function(f,h,t){var m,l=this,s,k={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"},v=h.size,q=h.width||2*v;y(l,{init:function(){h.border&&l.createInner()},getEl:function(){return m},getDialogPositionOffset:function(){var b=
(l.detectPointerPosition()||"").substr(0,1),c=(f.getCfg().position.type||"").replace(/(w|m|c)/,"").substr(0,1),d={x:0,y:0};b==a[c]&&(d["t"==b||"b"==b?"y":"x"]="b"==b||"r"==b?-v:v);return d},createInner:function(){var a=y({},h);a.size=v-2*h.border;a.width=q-4*h.border;delete a.border;delete a.borderColor;delete a.borderCls;delete a.offset;s=new g(f,a,h.border)},detectPointerPosition:function(){if(h.position)return h.position;var b=(f.getCfg().position.type||"").replace(/(w|m|c)/,"").substr(0,1);return b?
a[b]:null},detectPointerDirection:function(a){return h.direction?h.direction:a},getBorders:function(b,l,f){var k={},s=b.substr(0,1);b=l.substr(0,1);var g=l.substr(1);l=e?"dotted":"solid";k["border"+xa(c[a[s]])]=v+"px solid "+f;k["border"+xa(c[s])]="0 "+l+" transparent";g?(k["border"+xa(c[g])]="0 solid transparent",k["border"+xa(c[a[g]])]=q+"px "+l+" transparent"):(f=Math.floor(q/2),k["border"+xa(c[d[b][0]])]=f+"px "+l+" transparent",k["border"+xa(c[d[b][1]])]=f+"px "+l+" transparent");return k},getOffsets:function(b,
d){var e={},l=b.substr(0,1),f="t"==l||"b"==l?"r":"b";if(!v)switch(document.body.appendChild(m),l){case "t":case "b":v=Ja(m);q=Ia(m);break;case "l":case "r":q=Ja(m),v=Ia(m)}e[c[l]]=t?"auto":-v+"px";e[c[f]]="auto";if(t){var l=d.substr(0,1),k=d.substr(1);e[c[a[f]]]=k?"l"==k||"t"==k?t+"px":-q-t+"px":Math.floor(-q/2)+"px";e[c[a[l]]]=-(v+2*t)+"px"}else{switch(b){case "t":case "r":case "b":case "l":l=d!=b?"l"==d||"t"==d?h.offset:-q+h.offset:-q/2+h.offset;break;case "bl":case "tl":case "lt":case "rt":l=h.offset;
break;default:l=-q-h.offset}e["margin"+xa(c[a[f]])]=l+"px";switch(b){case "t":case "r":case "b":case "l":l="50%";break;case "tr":case "rb":case "br":case "lb":l="100%";break;default:l=0}e[c[a[f]]]=l}return e},render:function(){if(!m){var a=l.detectPointerPosition();if(a)if(h.el){if(z(h.el)){var c=document.createElement("div");c.innerHTML=h.el;m=c.firstChild}else m=h.el;b(m,{position:"absolute"});b(m,l.getOffsets(a));R(m,h.cls);f.getElem().appendChild(m)}else{c=l.detectPointerDirection(a);m=document.createElement("div");
var d=document.createComment(" ");m.appendChild(d);b(m,k);b(m,l.getBorders(a,c,h.borderColor||h.color));b(m,l.getOffsets(a,c));R(m,h.borderCls||h.cls);s&&(s.render(),m.appendChild(s.getEl()));t||f.getElem().appendChild(m)}}},destroy:function(){l.remove();s=l=null},remove:function(){s&&s.remove();m&&(m.parentNode.removeChild(m),m=null)}},!0,!1);l.init();return l},h=function(a){if(!a)return{};var b=function(b,c,d){var e=a[b],f=!1;if(void 0!==e){switch(d){case "string":f=z(e);break;case "function":f=
B(e);break;case "number":f=1===Z(e)||e==parseInt(e);break;case "dom":f=e&&(e.tagName||e.nodeName)?!0:!1;break;case "jquery":(f=e&&e.jquery?!0:!1)&&(e=e.get(0));break;case "boolean":if(!0===e||!1===e)f=!0;break;default:!0===d&&!0===e&&(f=!0),!1===d&&!1===e&&(f=!0)}f&&(a[b]={},a[b][c]=e)}};b("content","value","string");b("content","value","boolean");b("content","fn","function");b("ajax","url","string");b("cls","dialog","string");b("render","tpl","string");b("render","fn","function");b("render","el",
"dom");b("render","el","jquery");b("show","events",!1);b("show","events","string");b("hide","events",!1);b("hide","events","string");b("toggle","events",!1);b("toggle","events","string");b("position","type","string");b("position","type",!1);b("position","get","function");b("overlay","enabled","boolean");b("pointer","position","string");b("pointer","size","number");return a},p={target:null,debug:!1,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},ajax:{url:null,data:null,
dataType:"text",method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",fn:null,el:null,zIndex:null,lazy:!0,style:null,appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{click:{preventDefault:!0,stopPropagation:!0,returnValue:!1,process:null}}},show:{delay:null,single:!1,events:null,animate:!1,ignoreHideAll:!1,focus:!1,preventScroll:!1},hide:{delay:null,timeout:null,events:null,destroy:!1,animate:!1,
cancelShowDelay:!0},toggle:{events:null},position:{type:"t",offsetX:0,offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1,preventScroll:!1},callback:{scope:null,contentchange:null,beforeshow:null,show:null,beforehide:null,hide:null,render:null,lifetime:null,targetchange:null,
button:null}},n=function(a,c){a&&!z(a)&&(c=a,a=null);c=c||{};var d=this,e={},l=W(),s=new X,k=y({},p,h(n.defaults),h(n[a]),h(c),!0,!0),v=k.callback.scope||e,q,A,C,w={bindSelfOnRender:!1,target:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,hideTimeout:null,hideDelay:null,showDelay:null,dynamicTarget:!1,dynamicTargetEl:null,images:0,position:null,destroyDelay:null};c=null;y(e,s.getApi(),{getElem:function(){return q},getInstanceId:function(){return l},getCfg:function(){return y({},k)},getGroup:function(){return k.group?
z(k.group)?[k.group]:k.group:[""]},setTarget:function(a){if(!a)return e;var b=!1,c=w.target;w.target?(d.setHandlers("unbind","_target"),b=!0):w.dynamicTarget&&(b=!0);z(a)?(w.dynamicTarget=!0,w.target=null):(w.dynamicTarget=!1,w.target=a);b&&(d.setHandlers("bind","_target"),d.trigger("targetchange",e,a,c));return e},getTarget:function(){return w.dynamicTarget?w.dynamicTargetEl:k.target},isEnabled:function(){return w.enabled},isVisible:function(){return w.visible},isHideAllIgnored:function(){return k.show.ignoreHideAll},
isFrozen:function(){return w.frozen},enable:function(){w.enabled=!0;return e},disable:function(){d.hide();w.enabled=!1;return e},freeze:function(){w.frozen=!0;return e},unfreeze:function(){w.frozen=!1;return e},toggle:function(a,b){return a&&a.stopPropagation&&w.dynamicTarget&&w.visible&&d.isDynamicTargetChanged(a)?d.show(a):d[w.visible?"hide":"show"](a,b)},show:function(a,b){var c=a&&a.stopPropagation?null:e,l=k.show;if(!e.isEnabled())return k.debug&&console.log("show: not enabled",e.getTarget()),
c;a&&a.stopPropagation&&k.events.show&&k.events.show[a.type]&&(c=k.events.show[a.type],c.process?c=c.process(e,a):(c.stopPropagation&&a.stopPropagation(),c.preventDefault&&a.preventDefault(),c=c.returnValue));if(w.visible&&w.hideTimeout)return window.clearTimeout(w.hideTimeout),w.hideTimeout=window.setTimeout(d.hide,k.hide.timeout),k.debug&&console.log("show: hide timeout was set",e.getTarget()),c;if(w.hideDelay)return window.clearTimeout(w.hideDelay),w.hideDelay=null,w.visible=!0,k.debug&&console.log("show: hide delay was set; already shown",
e.getTarget()),c;if(w.frozen)return k.debug&&console.log("show: frozen",e.getTarget()),c;w.destroyDelay&&(window.clearTimeout(w.destroyDelay),w.destroyDelay=null);var g=!1;a&&a.stopPropagation&&w.dynamicTarget&&(g=d.changeDynamicTarget(a));if(w.visible)if(g)if(k.render.fn)d.hide(null,!0);else return d.reposition(a),c;else return k.debug&&console.log("show: already shown",q),c;q?g&&d.changeDynamicContent():d.render();if(!1===d.trigger("beforeshow",e,a))return k.debug&&console.log("show: beforeshow return false",
e.getTarget()),c;ma(q);w.visible=!0;l.single&&f.hideAll(d);d.toggleTitleAttribute(!1);l.delay&&!b?w.showDelay=window.setTimeout(function(){d.showAfterDelay(a)},l.delay):d.showAfterDelay(a,b);return c},hide:function(a,b,c){w.hideTimeout=null;var l=a&&a.stopPropagation?null:e;a&&a.stopPropagation&&k.events.hide&&k.events.hide[a.type]&&(l=k.events.hide[a.type],l.process?l=l.process(e,a):(l.stopPropagation&&a.stopPropagation(),l.preventDefault&&a.preventDefault(),l=l.returnValue));!w.visible&&w.hideDelay&&
b&&(window.clearTimeout(w.hideDelay),w.hideDelay=null,w.visible=!0);if(!q||!w.visible||!d.isEnabled())return k.debug&&console.log("hide: elem/visible/enabled: ",q,w.visible,d.isEnabled()),l;if(w.showDelay)return k.hide.cancelShowDelay||c?(window.clearTimeout(w.showDelay),w.showDelay=null,w.visible=!1,k.debug&&console.log("hide: cancelShowDelay: ",d.getTarget())):k.debug&&console.log("hide: show delay was set",d.getTarget()),l;if(w.frozen)return k.debug&&console.log("hide: frozen",d.getTarget()),l;
if(!1===d.trigger("beforehide",e,a))return k.debug&&console.log("hide: beforehide returned false",d.getTarget()),l;ma(q);w.visible=!1;d.toggleTitleAttribute(!0);w.dynamicTarget&&d.resetDynamicTarget();k.hide.delay&&!b?w.hideDelay=window.setTimeout(function(){d.hideAfterDelay(a)},k.hide.delay):d.hideAfterDelay(a,b);return l},setPositionType:function(a){a&&(z(a)?(k.position.get=a,k.position.type=!1):(k.position.get=null,k.position.type=a));a=k.position.type;!1===a?w.position=!1:k.position.get&&"m"!=
a?w.position="fn":(a=a.substr(0,1),w.position="w"==a?"window":"m"==a?"mouse":"target");A&&(A.remove(),q&&A.render())},getPosition:function(a){if(!q)return null;var b,c=k.position;switch(w.position){case !1:return null;case "target":b=d.getTargetPosition(a);break;case "mouse":b=d.getMousePosition(a);break;case "window":b=d.getWindowPosition(a);break;case "fn":b=c.get.call(v,e,a)}if(!1!==c.screenX||!1!==c.screenY)b=d.correctScreenPosition(b,c.screenX,c.screenY);return b},reposition:function(a){a&&(a=
da(a));if(a=d.getPosition(a))void 0!=a.x&&b(q,{left:a.x+"px"}),void 0!=a.y&&b(q,{top:a.y+"px"}),void 0==a.x&&void 0==a.y&&b(q,a)},getContentElem:function(){return q?k.selector.content?K(k.selector.content,q).shift()||q:q:null},setContent:function(a,b){b=b||"";if(!q)return k.content.value=a,e;k.content.prepare&&(a=k.content.prepare(e,b,a));var c=e.getContentElem(),l=w.rendered&&!k.selector.content&&A,f=l&&A.getEl();if(l&&f)try{q.removeChild(f)}catch(g){}if(z(a))c.innerHTML=a;else for(var s in a){var h=
k.selector[s];h&&(h=K(h,c).shift())&&(h.innerHTML=a[s])}if(l&&f)try{q.appendChild(f)}catch(v){}c=K("img",c);w.images=c.length;s=-1;for(l=c.length;++s<l;D(c[s],"load",d.onImageLoad));d.trigger("contentchange",e,a,b);d.onContentChange();return e},readContent:function(){var a=e.getTarget(),b;a&&(b=k.content.attr?a.getAttribute(k.content.attr):a.getAttribute("tooltip")||a.getAttribute("title")||a.getAttribute("alt"));b&&d.setContent(b,"attribute");return e},loadContent:function(a){R(q,k.cls.loading);
a=y({},k.ajax,a,!0,!0);d.trigger("beforeajax",e,a);return Pa(a).done(d.onAjaxLoad)},destroy:function(){d.trigger("destroy",e);S(window,"resize",d.onWindowResize);S(window,"scroll",d.onWindowScroll);d.destroyElem();A&&(A.destroy(),A=null);d.setHandlers("unbind");s.destroy();C=w=e=d=s=null},setFocus:function(){var a=k.show.focus,b;if(!0===a)if(a=K("input",q).concat(K("textarea",q)),0<a.length)a[0].focus();else{if(k.buttons)for(b in k.buttons){(b=K(k.buttons[b],q).shift())&&b.focus();break}}else(b=K(a,
q).shift())&&b.focus()}},!0,!1);y(d,e,{init:function(){f.register(d);k.modal&&(k.overlay.enabled=!0);d.setPositionType();d.setTarget(k.target);if(k.pointer.size||k.pointer.el)A=new g(d,k.pointer);k.render.lazy||d.render();d.setHandlers("bind")},setHandlers:function(a,b){for(var c=["show","hide","toggle"],l="bind"==a?D:S,f="bind"==a?bc:cc,g,s,h,v,n,p,r,A,u,x;g=c.shift();)if(s=k[g].events,!1!==s){if(z(s)||P(s))w.dynamicTarget?(n={},n[s]=k.target,s={_html:n}):s={_target:s};for(h in s){if(b)if("_self"==
b){if("_self"!=h&&"_overlay"!=h&&">"!=h.substr(0,1))continue}else if(h!=b)continue;if("_self"!=h&&"_overlay"!=h&&">"!=h.substr(0,1)||q){if(r=s[h]){switch(h){case "_target":A=[d.getTarget()];break;case "_self":A=[q];break;case "_window":A=[window];break;case "_document":A=[document];break;case "_html":A=[document.documentElement];break;case "_overlay":A=[C];break;default:A=">"==h.substr(0,1)?K(h.substr(1),q):K(h)}if(A&&A.length)if(z(r)&&(r=[r]),P(r))for(n=0,p=r.length;n<p;n++)for(u=-1,x=A.length;++u<
x;l(A[u],r[n],e[g]));else for(v in r)for(u=-1,x=A.length;++u<x;f(A[u],r[v],v,e[g]));}}else w.bindSelfOnRender=!0}}},resetDynamicTarget:function(){var a=w.dynamicTargetEl;a&&(d.setHandlers("unbind","_target"),d.trigger("targetchange",e,null,a))},isDynamicTargetChanged:function(a){var b=k.target;a=a.target;for(var c=w.dynamicTargetEl;a&&!pb(a,b);)a=a.parentNode;return a?!c||c!==a:!1},changeDynamicTarget:function(a){var b=k.target;a=a.target;for(var c=w.dynamicTargetEl;a&&!pb(a,b);)a=a.parentNode;if(!a||
c&&c===a)return!1;c&&d.setHandlers("unbind","_target");w.dynamicTargetEl=a;d.setHandlers("bind","_target");d.trigger("targetchange",e,a,c);return!0},showAfterDelay:function(a,b){w.showDelay=null;if(w.visible){k.position.manual||d.reposition(a);"mouse"==w.position&&D(document.documentElement,"mousemove",d.onMouseMove);var c=k.position;(c.resize||c.screenX||c.screenY)&&D(window,"resize",d.onWindowResize);(c.scroll||c.screenX||c.screenY)&&D(window,"scroll",d.onWindowScroll);if(b||!1!==d.trigger("afterdelay",
e,a)){C&&(k.overlay.animateShow?d.animate("show",null,!0):C.style.display="");if(k.show.preventScroll){var c=k.show.preventScroll,l,f;!0===c&&(c="body");c=K(c);l=-1;for(f=c.length;++l<f;D(c[l],"mousewheel",d.onPreventScroll)&&D(c[l],"touchmove",d.onPreventScroll));}k.show.animate&&!b?d.animate("show").done(function(){d.showAfterAnimation(a)}):d.showAfterAnimation(a)}else w.visible=!1,k.debug&&console.log("showAfterDelay: afterdelay returned false",e.getTarget())}else k.debug&&console.log("showAfterDelay: already hidden",
d.getTarget())},showAfterAnimation:function(a){w.visible?(U(q,k.cls.hidden),R(q,k.cls.visible),k.render.keepVisible||(q.style.display=""),k.hide.timeout&&(w.hideTimeout=window.setTimeout(d.hide,k.hide.timeout)),k.show.focus&&window.setTimeout(d.setFocus,20),d.trigger("show",e,a)):k.debug&&console.log("showAfterAnimation: already hidden",d.getTarget())},hideAfterDelay:function(a,b){w.hideDelay=null;if(w.visible)k.debug&&console.log("hideAfterDelay: already shown again",d.getTarget());else{"mouse"==
w.position&&S(document.documentElement,"mousemove",d.onMouseMove);var c=k.position;(c.resize||c.screenX||c.screenY)&&S(window,"resize",d.onWindowResize);(c.scroll||c.screenX||c.screenY)&&S(window,"scroll",d.onWindowScroll);if(b||!1!==d.trigger("afterhidedelay",e,a)){if(k.show.preventScroll){var c=k.show.preventScroll,l,f;!0===c&&(c="body");c=K(c);l=-1;for(f=c.length;++l<f;S(c[l],"mousewheel",d.onPreventScroll)&&S(c[l],"touchmove",d.onPreventScroll));}C&&(k.overlay.animateShow?d.animate("hide",null,
!0).done(function(){C.style.display="none"}):C.style.display="none");k.hide.animate&&!b?d.animate("hide").done(function(){d.hideAfterAnimation(a)}):d.hideAfterAnimation(a)}else w.visible=k.cls.hidden?!Oa(q,k.cls.hidden):!(0>=q.offsetWidth||0>=q.offsetHeight),k.debug&&console.log("hideAfterDelay: afterhdelay returned false",d.getTarget())}},hideAfterAnimation:function(a){w.visible?k.debug&&console.log("hideAfterAnimation: already shown again",d.getTarget()):(U(q,k.cls.visible),R(q,k.cls.hidden),k.render.keepVisible||
(q.style.display="none"),d.trigger("hide",e,a),a=k.render.lifetime,null!==a&&(0===a?d.destroyElem():w.destroyDelay=window.setTimeout(d.destroyElem,a)),q&&k.hide.destroy&&window.setTimeout(function(){O(q,k.instanceName,null);d.destroy()},0))},render:function(){if(q)k.debug&&console.log("element already rendered",q);else{var a=k.render,c=k.cls;if(a.fn){var l=a.fn.call(v,e);a[z(l)?"tpl":"el"]=l}a.el?z(a.el)?(q=K(a.el).shift(),a.keepInDOM=!0):q=a.el:(l=document.createElement("div"),l.innerHTML=a.tpl,
q=l.firstChild);q||(q=document.createElement("div"));a.id&&q.setAttribute("id",a.id);k.render.keepVisible||(q.style.display="none");R(q,c.dialog);R(q,c.hidden);a.style&&b(q,a.style);k.overlay.enabled&&(C=document.createElement("div"),b(C,{display:"none",position:"fixed",left:0,top:0,right:0,bottom:0,opacity:k.overlay.opacity,backgroundColor:k.overlay.color}),document.body.appendChild(C),D(C,"click",d.onOverlayClick),a.zIndex&&b(C,{zIndex:a.zIndex}),k.overlay.cls&&R(C,k.overlay.cls));a.appendTo?a.appendTo.appendChild(q):
!1!==a.appendTo&&document.body.appendChild(q);a.zIndex&&b(q,{zIndex:a.zIndex});a=k.content;if(!1!==a.value)if(a.value)d.setContent(a.value);else if(a.fn)d.setContent(a.fn.call(v,e));else d[k.ajax.url?"loadContent":"readContent"]();A&&A.render();if(k.buttons)for(var f in k.buttons)if(a=K(k.buttons[f],q).shift())O(a,"metaphorjsTooltip-button-id",f),D(a,"click",d.onButtonClick),D(a,"keyup",d.onButtonKeyup);w.bindSelfOnRender&&(d.setHandlers("bind","_self"),w.bindSelfOnRender=!1);w.rendered=!0;d.trigger("render",
e)}},animate:function(a,b,c){var e,l;e=c?"show"==a?k.overlay.animateShow:k.overlay.animateHide:k[a].animate;B(e)&&(e=e(d,b));l=e.skipDisplayChange||!1;za(e)?e=a:z(e)&&(e=[e]);return T(q,e,function(){"show"!=a||l||(c?C.style.display="":q.style.display="")})},toggleTitleAttribute:function(a){var b=e.getTarget(),c;b&&(!1===a?(O(b,"tmp-title",b.getAttribute("title")),b.removeAttribute("title")):(c=O(b,"tmp-title"))&&b.setAttribute("title",c))},changeDynamicContent:function(){k.content.fn?d.setContent(k.content.fn.call(v,
e)):k.content.attr&&d.readContent()},getDialogSize:function(){var a=k.cls.hidden?Oa(q,k.cls.hidden):!!(0>=q.offsetWidth||0>=q.offsetHeight),c,d=q.style.left;a&&(b(q,{left:"-1000px"}),q.style.display="");c={width:Ia(q),height:Ja(q)};a&&(b(q,{left:d}),q.style.display="none");return c},getTargetSize:function(){var a=d.getTarget();return a?{width:Ia(a),height:Ja(a)}:null},getTargetPosition:function(a,b){var c=d.getTarget();if(!c)return null;var e=d.getDialogSize(),c=Ra(c),l=d.getTargetSize(),f={};b=b||
k.position.type;var g=b.substr(0,1),s=b.substr(1),h=k.position.offsetX,q=k.position.offsetY,v=A?A.getDialogPositionOffset():null;switch(g){case "t":f.y=c.top-e.height-q;break;case "r":f.x=c.left+l.width+h;break;case "b":f.y=c.top+l.height+q;break;case "l":f.x=c.left-e.width-h}switch(s){case "t":f.y=c.top+q;break;case "r":f.x=c.left+l.width-e.width-h;break;case "b":f.y=c.top+l.height-e.height-q;break;case "l":f.x=c.left+h;break;case "rc":f.x=c.left+l.width+h;break;case "lc":f.x=c.left-e.width-h;break;
case "":switch(g){case "t":case "b":f.x=c.left+l.width/2-e.width/2;break;case "r":case "l":f.y=c.top+l.height/2-e.height/2}}v&&(f.x+=v.x,f.y+=v.y);return f},getMousePosition:function(a){if(!a)return null;var b=d.getDialogSize(),c={},l=k.position.type.substr(1),f=k.position.offsetX,g=k.position.offsetY,s=k.position.axis,h=A?A.getDialogPositionOffset():null;switch(l){case "":c=k.position.get.call(v,e,a);break;case "t":c.y=a.pageY-b.height-g;c.x=a.pageX-b.width/2;break;case "r":c.y=a.pageY-b.height/
2;c.x=a.pageX+f;break;case "b":c.y=a.pageY+g;c.x=a.pageX-b.width/2;break;case "l":c.y=a.pageY-b.height/2;c.x=a.pageX-b.width-f;break;case "rt":c.y=a.pageY-b.height-g;c.x=a.pageX+f;break;case "rb":c.y=a.pageY+g;c.x=a.pageX+f;break;case "lt":c.y=a.pageY-b.height-g;c.x=a.pageX-b.width-f;break;case "lb":c.y=a.pageY+g,c.x=a.pageX-b.width-f}h&&(c.x+=h.x,c.y+=h.y);s&&(a=d.getTargetPosition(a,l))&&("x"==s?c.y=a.y:c.x=a.x);return c},getWindowPosition:function(){var a=d.getDialogSize(),b={},c=k.position.type.substr(1),
e=k.position.offsetX,l=k.position.offsetY,f=Fa(),g=Ga(),s=Ia(window),h=Ja(window);switch(c){case "c":b.y=h/2-a.height/2+f;b.x=s/2-a.width/2+g;break;case "t":b.y=f+l;b.x=s/2-a.width/2+g;break;case "r":b.y=h/2-a.height/2+f;b.x=s-a.width+g-e;break;case "b":b.y=h-a.height+f-l;b.x=s/2-a.width/2+g;break;case "l":b.y=h/2-a.height/2+f;b.x=g+e;break;case "rt":b.y=f+l;b.x=s-a.width+g-e;break;case "rb":b.y=h-a.height+f-l;b.x=s-a.width+g-e;break;case "lt":b.y=f+l;b.x=g+e;break;case "lb":b.y=h-a.height+f-l,b.x=
g+e}return b},correctScreenPosition:function(a,b,c){var e=d.getDialogSize(),l=Fa(),f=Ga(),k=Ia(window),g=Ja(window);c&&a.y+e.height>g+l-c&&(a.y=g+l-c-e.height);b&&a.x+e.width>k+f-b&&(a.x=k+f-b-e.width);c&&a.y<l+c&&(a.y=l+c);b&&a.x<f+b&&(a.x=f+b);return a},onMouseMove:function(a){d.reposition(da(a))},onWindowResize:function(a){d.reposition(da(a))},onWindowScroll:function(a){d.reposition(da(a))},onPreventScroll:function(a){da(a).preventDefault()},onOverlayClick:function(a){return k.modal?(a=da(a),a.preventDefault(),
a.stopPropagation(),!1):null},onButtonClick:function(a){var b=da(a).target;(b=O(b,"metaphorjsTooltip-button-id"))&&d.trigger("button",e,b,a)},onButtonKeyup:function(a){if(13==a.keyCode||32==a.keyCode){var b=O(a.target,"metaphorjsTooltip-button-id");b&&d.trigger("button",e,b,da(a))}},onAjaxLoad:function(a){U(q,k.cls.loading);d.setContent(a,"ajax")},onImageLoad:function(){w.images--;d.onContentChange()},onContentChange:function(){w.visible&&d.reposition()},destroyElem:function(){d.setHandlers("unbind",
"_self");w.bindSelfOnRender=!0;A&&A.remove();C&&(C.parentNode.removeChild(C),C=null);q&&(k.render.keepInDOM||q.parentNode.removeChild(q),q=null);d.trigger("lifetime",e)}},!0,!1);delete k.callback.scope;for(var x in k.callback)e.on(x,k.callback[x],v);k.target&&k.useHref&&(x=k.target.getAttribute("href"),"#"==x.substr(0,1)?k.render.el=x:k.ajax.url=x);d.init();return e};y(n,{defaults:{}});return n}();I("MetaphorJs.cmp.Dialog","MetaphorJs.cmp.Component",{dialog:null,dialogPreset:null,dialogCfg:null,initComponent:function(){this.supr();
this._createDialog();this._oldShow=this.show;this._oldHide=this.hide},_getDialogCfg:function(){return y({},this.dialogCfg,{render:{el:this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=new dc(this.dialogPreset,this._getDialogCfg());this.dialog.on("show",this._oldShow,this);this.dialog.on("hide",this._oldHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},onDialogDestroy:function(){this.destroying||
(delete this.dialog,this.destroy())},onDestroy:function(){this.destroying=!0;this.dialog&&this.dialog.destroy();delete this.dialog;delete this.dialogCfg;delete this.dialogPreset;this.supr();this.destroying=!1}});var Za=function(b,a,c){var d,e=b.childNodes;if(!1!==a.call(c,b))for(b=-1,d=e.length>>>0;++b!==d;Za(e[b],a,c));},ec=function(){var b=0,a={},c=function(a,b){var c=0;switch(b.nodeName.toLowerCase()){case "select":return Za(b,function(a){a.selected&&c++}),c;case "input":if(/radio|checkbox/i.test(b.type))return Za(b.form,
function(a){a.type==b.type&&a.name==b.name&&a.checked&&c++}),c}return a.length},d=function(a,b){if(!b)return void 0==a||""===a;switch(b.nodeName.toLowerCase()){case "select":var d=oa(b);return!d||0==d.length;case "input":if(/radio|checkbox/i.test(b.type))return 0==c(a,b)}return 0==J(a).length},e=function(a,b){if(B(b))return a;P(b)||(b=[b]);var c,d=b.length;for(c=-1;++c<d;a=a.replace(new RegExp("\\{"+c+"\\}","g"),b[c]));return a},f={};y(f,{required:function(a,b,c){return!1===c?!0:!d(a,b)},regexp:function(a,
b,c){c=c instanceof RegExp?c:new RegExp(c);return d(a,b)||c.test(a)},notregexp:function(a,b,c){c=c instanceof RegExp?c:new RegExp(c);return d(a,b)||!c.test(a)},minlength:function(a,b,e){return d(a,b)||(b?c(J(a),b)>=e:a.toString().length>=e)},maxlength:function(a,b,e){return d(a,b)||(b?c(J(a),b)<=e:a.toString().length<=e)},rangelength:function(a,b,e){var f=b?c(J(a),b):a.toString().length;return d(a,b)||f>=e[0]&&f<=e[1]},min:function(a,b,c){return d(a,b)||parseInt(a,10)>=c},max:function(a,b,c){return d(a,
b)||parseInt(a,10)<=c},range:function(a,b,c){a=parseInt(a,10);return d(a,b)||a>=c[0]&&a<=c[1]},email:function(a,b){return d(a,b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a)},
url:function(a,b){return d(a,b)||/^((https?|ftp):\/\/|)(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a,b){return d(a,b)||!/Invalid|NaN/.test(new Date(a))},dateiso:function(a,b){return d(a,b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return d(a,b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return d(a,b)||/^\d+$/.test(a)},creditcard:function(a,b){if(d(a,b))return!0;if(/[^0-9-]+/.test(a))return!1;var c=0,e=!1,f;a=a.replace(/\D/g,"");for(var g=a.length-1;0<=g;g--)f=a.charAt(g),f=parseInt(f,10),e&&9<(f*=2)&&(f-=9),c+=f,e=!e;return 0==
c%10},accept:function(a,b,c){c=z(c)?c.replace(/,/g,"|"):"png|jpe?g|gif";return d(a,b)||a.match(new RegExp(".("+c+")$","i"))},equalto:function(a,b,c,d){c=(b=d.getValidator().getField(c))?b.getElem():c;return a==oa(c)},notequalto:function(a,b,c,d){c=(b=d.getValidator().getField(c))?b.getElem():c;return a!=oa(c)},zxcvbn:function(a,b,c){return zxcvbn(a).score>=parseInt(c)}});var g={required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",
date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:"Please enter no more than {0} characters.",minlength:"Please enter at least {0} characters.",rangelength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",
max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."},h={allowSubmit:!0,alwaysCheck:!1,alwaysDisplayState:!1,data:null,ignore:null,disabled:!1,cls:{valid:"",error:"",ajax:""},errorBox:{cls:"",fn:null,tag:"",position:"after",elem:null,enabled:!0},callback:{scope:null,destroy:null,statechange:null,errorchange:null,submit:null,check:null,beforeAjax:null,afterAjax:null,displaystate:null},rules:{},messages:{}},p=function(a){if(!a)return{};var b=
function(b,c,d){var e=a[b],f=!1;if(void 0!==e){switch(d){case "string":f=z(e);break;case "function":f=B(e);break;case "boolean":f=za(e)}f&&(a[b]={},a[b][c]=e)}};b("errorBox","enabled","boolean");b("errorBox","tag","string");b("errorBox","fn","function");return a},n=function(a,b,c){b=b||{};var d,e;this._observable=new X;y(this,this._observable.getApi());this.cfg=d=y({},h,p(m.fieldDefaults),p(b),!0,!0);this.input=new Ea(a,this.onInputChange,this,this.onInputSubmit);this.elem=a;this.vldr=c;this.callbackScope=
e=d.callback.scope;this.enabled=!a.disabled;this.id=a.getAttribute("name")||a.getAttribute("id");this.data=b.data;this.rules={};d.messages=y({},g,m.messages,d.messages,!0,!0);b=c.getVldId();a.setAttribute("data-validator",b);this.input.radio&&this.initRadio();for(var f in d.callback)if(d.callback[f])this.on(f,d.callback[f],e);d.rules&&this.setRules(d.rules,!1);this.readRules();this.prev=this.input.getValue();d.disabled&&this.disable()};n.prototype={vldr:null,elem:null,rules:null,cfg:null,callbackScope:null,
input:null,enabled:!0,valid:null,dirty:!1,id:null,prev:"",error:null,errorRule:null,pending:null,rulesNum:0,displayState:!1,data:null,checking:!1,checkTmt:null,errorBox:null,customError:!1,getValidator:function(){return this.vldr},initRadio:function(){var a=this.input.radio,b=this.vldr.getVldId(),c,d;c=0;for(d=a.length;c<d;c++)a[c].setAttribute("data-validator",b)},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check(!1):this.setValidState(null);return this},
setRule:function(a,b,c){var d=this.rules;c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check(!1):this.setValidState(null);return this},setMessage:function(a,b){this.cfg.messages[a]=b;return this},setMessages:function(a){for(var b in a)this.setMessage(b,a[b]);return this},getMessages:function(){return y({},this.cfg.messages)},readRules:function(){var a=this.elem,b=a.className,c={},d,e;for(e in f)f.hasOwnProperty(e)&&
(d=a.getAttribute(e)||a.getAttribute("data-validate-"+e),void 0!=d&&!1!==d&&("minlength"!=e&&"maxlength"!=e||-1!=parseInt(d,10))&&(c[e]=d,(d=a.getAttribute("data-message-"+e))&&this.setMessage(e,d)));if(d=a.getAttribute("remote"))c.remote=d;if(b)for(b=b.split(" "),e=0,d=b.length;e<d;e++)if(a=J(b[e]),f[a]||"remote"==a)c[a]=!0;for(e in c)this.setRule(e,c[e],!1)},getRules:function(){return this.rules},hasRule:function(a){return this.rules[a]?!0:!1},getValue:function(){return this.input.getValue()},getUserData:function(){return this.data},
setUserData:function(a){var b=this.data;this.data=a;return b},isEmpty:function(){return d(this.getValue(),this.elem)},enable:function(){this.enabled=!0;this.vldr.reset();return this},disable:function(){this.enabled=!1;!1===this.valid&&(this.setValidState(!0),this.doDisplayState());return this},enableDisplayState:function(){this.displayState=!0},disableDisplayState:function(){this.displayState=!1},isDisplayStateEnabled:function(){return this.displayState},toggleErrorBox:function(a){var b=this.cfg,
c=b.errorBox.enabled;b.errorBox.enabled=a;!c&&a&&a.displayState&&!1===this.valid()&&this.doDisplayState()},isEnabled:function(){return this.enabled},getElem:function(){return this.elem},getName:function(){return this.id},getError:function(){return this.error},getErrorRule:function(){return this.errorRule},isValid:function(){return this.isEnabled()?this.customError?!1:!0===this.valid&&!this.pending||0===this.rulesNum:!0},getExactValidState:function(){return this.valid},setCustomError:function(a,b){this.customError=
a?!0:!1;this.setValidState(a?!1:!0);this.setError(!0===a?null:a,b);this.doDisplayState()},reset:function(){this.abort();this.dirty=!1;this.prev="";this.setValidState(null);this.setError(null);this.doDisplayState();return this},abort:function(){this.pending&&(this.pending.abort(),this.pending=null);return this},check:function(a){var b=this.rules,c=this.cfg,d=this.elem;if(!this.isEnabled())return!0;if(this.customError)return!1;if(0==this.rulesNum&&!1!==this.valid)return!0;if(this.checking)return this.checkTmt||
(this.checkTmt=setTimeout(x(this.checkTimeout,this),100)),!0===this.valid;this.checking=!0;if(!(!0===a||b.equalTo||b.notEqualTo||this.dirty||null===this.valid||c.alwaysCheck))return this.pending||this.doDisplayState(),this.checking=!1,!0===this.valid;var g=!0,h=!1,m=this.getValue(),n,p;for(p in b)if("remote"==p){if(this.dirty||c.alwaysCheck||null===this.valid||!0===a)if(m||b[p].checkEmpty)h=!0}else if(!0!==(n=(B(b[p])?b[p]:f[p]).call(this.callbackScope,m,d,b[p],this))){g=!1;this.setError(e(n||c.messages[p]||
"",b[p]),p);break}h=h&&g;g&&this.setError(null);h?this.ajaxCheck():(this.setValidState(g),this.doDisplayState());this.checking=this.dirty=!1;this.trigger("check",this,this.valid);return!0===this.valid&&!h},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,d=a.cls.valid,e=this.elem;this.displayState||a.alwaysDisplayState||(b=null);null===this.valid&&(b=null);c&&(!1===b?R(e,c):U(e,c));d&&(!0===b?R(e,d):U(e,d));c=this.getErrorBox();d=this.error;c&&(!1===b&&d&&(c.innerHTML=state.error),
c.style.display=!1===b&&d&&a.errorBox.enabled?"block":"none");this.trigger("displaystate",this,b,this.error)},getErrorBox:function(){var a=this.cfg.errorBox;return a.tag||a.fn||a.selector?(!this.errorBox&&a.enabled&&this.createErrorBox(),this.errorBox):null},destroy:function(){this.trigger("destroy",this);this.elem.removeAttribute("data-validator");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this.input.destroy();delete this.input;this._observable.destroy();delete this._observable;
delete this.vldr;delete this.cfg;delete this.errorBox;delete this.rules;delete this.elem},isPending:function(){return null!==this.pending},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("statechange",this,a))},setError:function(a,b){if(this.error!=a||this.errorRule!=b)this.error=a,this.errorRule=b,this.trigger("errorchange",this,a,b)},checkTimeout:function(){this.checkTmt=null;this.checking||this.check(!1)},onInputChange:function(a){this.prev!==a&&(this.dirty=!0,this.customError=
!1,this.abort(),this.pending||this.check(!1),this.prev=this.input.getValue())},onInputSubmit:function(a){a=da(a);if(!(a.isDefaultPrevented&&a.isDefaultPrevented()||!1!==this.trigger("submit",this,a)))return a.preventDefault(),!1},createErrorBox:function(){var a=this.cfg.errorBox,b=a.tag,c=a.cls,d=a.fn,e=a.position,a=a.elem;d?this.errorBox=d.call(this.callbackScope,this):a?this.errorBox=a:(this.errorBox=document.createElement(b),this.errorBox.className=c,b=(b=this.input.radio)?b[b-1]:this.elem,"appendParent"==
e?b.parentNode.appendChild(this.errorBox):"before"==e?b.parentNode.insertBefore(this.errorBox,b):b.parentNode.insertBefore(this.errorBox,b.nextSibling))},ajaxCheck:function(){var a=this.elem,b=this.rules.remote,c=this.getValue(),d=this.cfg,b=y({},z(b)?{url:b}:b,!0);b.data=b.data||{};b.data[b.paramName||a.getAttribute("name")||a.getAttribute("id")]=c;b.handler||(b.dataType="text");b.cache=!1;d.cls.ajax&&R(a,d.cls.ajax);this.trigger("beforeAjax",this,b);this.pending=Pa(b);this.pending.done(x(this.onAjaxSuccess,
this));this.pending.fail(x(this.onAjaxError,this))},onAjaxSuccess:function(a){var b=this.rules,c=this.cfg;this.pending=null;var d=!0;b.remote.handler?(a=b.remote.handler.call(this.callbackScope,this,a),!0!==a&&(this.setError(e(a||c.messages.remote||"",b.remote),"remote"),d=!1)):a?(this.setError(a,"remote"),d=!1):this.setError(null);c.cls.ajax&&U(this.elem,c.cls.ajax);this.setValidState(d);this.doDisplayState();this.trigger("afterAjax",this)},onAjaxError:function(a,b){var c=this.cfg;c.cls.ajax&&U(this.elem,
c.cls.ajax);this.pending=null;"abort"!=b&&"abort"!=a&&(this.setValidState(!1),this.doDisplayState(),this.trigger("afterAjax",this))}};var u={alwaysCheck:!1,alwaysDisplayState:!1,disabled:!1,value:null,elem:null,errorBox:null,errorField:null,data:null,cls:{valid:"",error:""},fields:[],rules:{},messages:{},callback:{scope:null,destroy:null,statechange:null,errorchange:null,displaystate:null}},r=function(a,b){a=a||{};var c,d;this._observable=new X;this._vldr=b;y(this,this._observable.getApi());this.cfg=
c=y({},u,m.groupDefaults,a,!0,!0);this.callbackScope=d=c.callback.scope;this.data=a.data;this.el=a.elem;this.fields={};this.rules={};c.messages=y({},g,m.messages,c.messages,!0,!0);var e;if(c.callback)for(e in c.callback)if(c.callback[e])this.on(e,c.callback[e],d);c.rules&&this.setRules(c.rules,!1);if(c.fields)for(e=0,d=a.fields.length;e<d;e++)this.add(b.getField(c.fields[e]));this.enabled=!c.disabled};r.prototype={fields:null,rules:null,cfg:null,callbackScope:null,vldr:null,enabled:!1,invalid:null,
valid:null,displayState:!1,rulesNum:0,error:null,data:null,errorBox:null,el:null,enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},isValid:function(){return!this.enabled||0===this.invalid&&!0===this.valid},getExactValidState:function(){return this.valid},reset:function(){this.invalid=0;this.setValidState(null);this.setError(null);this.doDisplayState();return this},getUserData:function(){return this.data},getName:function(){return this.cfg.name},
setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check():this.setValidState(null);return this},setRule:function(a,b,c){var d=this.rules;c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check():this.setValidState(null);return this},getRules:function(){return y({},this.rules)},hasRule:function(a){return this.rules[a]?!0:!1},setError:function(a){var b=this.cfg;this.error!=
a&&(b.errorField?(this.vldr.getField(b.errorField).setError(a),this.error=null):(this.error=a,this.trigger("errorchange",this,a)))},getError:function(){return this.error},getFields:function(){return this.fields},enableDisplayState:function(){this.displayState=!0;return this},disableDisplayState:function(){this.displayState=!1;return this},check:function(){var a=this.cfg,b=this.fields,c=this.rules;if(!this.enabled||0==this.rulesNum)return this.setValidState(null),this.doDisplayState(),!0;this.countInvalid();
if(0<this.invalid)return this.setValidState(null),this.doDisplayState(),!0;var d={},g=!0,h=null,m;if(a.value){for(m in b)d[m]=b[m].getValue();h=a.value.call(this.callbackScope,d,this)}for(m in c)if(!0!==(b=(B(c[m])?c[m]:f[m]).call(this.callbackScope,h,null,c[m],this,d))){g=!1;b||a.messages[m]?this.setError(e(b||a.messages[m]||"",c[m])):this.setError(null);break}g&&this.setError(null);this.setValidState(g);this.doDisplayState();return!0===this.valid},doDisplayState:function(){var a=this.valid,b=this.cfg;
this.displayState||b.alwaysDisplayState||(a=null);if(b.errorBox){var c=this.getErrorBox();null!==a?c&&(c.innerHTML=this.error||"",c.style.display=!1===this.valid?"block":"none"):c&&(c.style.display="none")}c=b.cls.error;b=b.cls.valid;a=this.valid;c&&(!1===a?R(this.el,c):U(this.el,c));b&&(!0===a?R(this.el,b):U(this.el,b));this.trigger("displaystate",this,this.valid)},getErrorBox:function(){var a=this.cfg,b=this.fields,c=a.errorBox;if(b[c])return b[c].getErrorBox();this.errorBox||(B(a.errorBox)?this.errorBox=
a.errorBox.call(this.callbackScope,this):this.errorBox=a.errorBox);return this.errorBox},destroy:function(){var a=this.fields,b;for(b in a)a[b]&&(this.setFieldEvents(a[b],"un"),delete a[b]);this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this._observable.destroy();delete this._observable;delete this.vldr;delete this.rules;delete this.fields;delete this.cfg},add:function(a){var b=this.fields,c=a.getName();b[c]||(b[c]=a,this.setFieldEvents(a,"on"))},setFieldEvents:function(a,b){a[b]("statechange",
this.onFieldStateChange,this)},remove:function(a){var b=this.fields,c=a.getName();b[c]&&(delete b[c],this.setFieldEvents(a,"un"));return this},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("statechange",this,a))},countInvalid:function(){var a=this.fields;this.invalid=0;for(var b in a)this.invalid+=a[b].isValid()?0:1},onFieldStateChange:function(a,b){this.trigger("fieldstatechange",this,a,b);this.check()}};var t={form:null,all:{},fields:{},rules:{},cls:{valid:"",error:"",checking:""},
groups:{},callback:{scope:null,destroy:null,reset:null,beforesubmit:null,submit:null,statechange:null,check:null,displaystate:null,displaystatechange:null}},m=function(c,d,e){var f=c.nodeName.toLowerCase();this.vldId=++b;a[this.vldId]=this;c.setAttribute("data-validator",this.vldId);this.el=c;d&&!z(d)&&(e=d,d=null);this._observable=new X;this.cfg=c=y({},t,m.defaults,m[d],e,!0,!0);this.callbackScope=d=c.callback.scope;this.isForm="form"==f;this.isField=/input|select|textarea/.test(f);this.fields={};
this.groups={};y(this,this._observable.getApi());this._observable.createEvent("submit",!1);this._observable.createEvent("beforesubmit",!1);this.onRealSubmitClickDelegate=x(this.onRealSubmitClick,this);this.resetDelegate=x(this.reset,this);this.onSubmitClickDelegate=x(this.onSubmitClick,this);this.onFormSubmitDelegate=x(this.onFormSubmit,this);delete c.callback.scope;var g,h;for(h in c.callback)this.on(h,c.callback[h],d);this.initFields();f=this.fields;for(g in c.rules)f[g]&&f[g].setRules(c.rules[g],
!1);c.rules=null;for(g in c.groups)this.addGroup(g,c.groups[g]);this.initForm("bind");delete c.rules;delete c.fields;delete c.groups;this.enabled=!0};m.prototype={vldId:null,el:null,cfg:null,enabled:!1,invalid:null,pending:0,grps:0,outside:!0,submitted:!1,displayState:!1,isForm:!1,isField:!1,submitButton:null,hidden:null,callbackScope:null,preventFormSubmit:!1,_observable:null,fields:null,groups:null,getVldId:function(){return this.vldId},getElem:function(){return this.el},getGroup:function(a){return this.groups[a]||
null},getField:function(a){return this.fields[a]||null},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},enableDisplayState:function(){var a=this.fields,b=this.groups,c;if(!0!==this.displayState){this.displayState=!0;for(c in a)a[c].enableDisplayState();for(c in b)b[c].enableDisplayState();this.trigger("displaystatechange",this,!0)}return this},disableDisplayState:function(){var a=this.groups,b=this.fields,c;if(!1!==
this.displayState){this.displayState=!1;for(c in b)b[c].disableDisplayState();for(c in a)a[c].disableDisplayState();this.trigger("displaystatechange",this,!1)}return this},isDisplayStateEnabled:function(){return this.displayState},isValid:function(){return!1===this.enabled?!0:0===this.invalid&&0===this.pending&&0===this.grps&&!0===this.outside},getErrors:function(a){var b=!0==a?[]:{},c,d,e,f=[this.fields,this.groups],g;if(!this.isEnabled())return b;for(e=0;2>e;e++)for(d in g=f[e],g)null===g[d].getExactValidState()&&
g[d].check(),g[d].isValid()||(c=g[d].getError())&&(a?b.push(c):b[d]=c);return b},check:function(){var a=this.fields,b=this.groups;if(!this.isEnabled())return!0;var c=this.isValid(),d;for(d in a)a[d].check();for(d in b)b[d].check();this.outside=!1!==this.trigger("check",this);a=this.isValid();c!=a&&(this.doDisplayState(),this.trigger("statechange",this,!1));return a},add:function(a,b){if(!ib(a)||null!==a.getAttribute("data-no-validate")||null!==a.getAttribute("data-validator"))return this;var c=a.getAttribute("name")||
a.getAttribute("id"),d=this.cfg,e=this.fields;if(!c)return this;c=d.fields&&d.fields[c]?d.fields[c]:b||{};z(c)&&(c={rules:[c]});c=y({},d.all||{},c,!0,!0);if(c.ignore)return this;c.callback||(c.callback={scope:this.callbackScope});d=new n(a,c,this);c=d.getName();if(e[c])return this;e[c]=d;this.setFieldEvents(d,"on");this.displayState&&d.enableDisplayState();this.isEnabled()&&null!==this.invalid&&d.check();return this},addGroup:function(a,b){var c=this.groups;c[a]||(b.name=a,c[a]=new r(b,this),this.setGroupEvents(c[a],
"on"),this.isEnabled()&&null!==this.invalid&&c[a].check())},focusInvalid:function(){var a=this.fields,b;for(b in a)if(!a[b].isValid()){a[b].getElem().focus();break}},reset:function(){var a=this.fields,b=this.groups,c;this.submitted=!1;this.disableDisplayState();for(c in b)b[c].reset();for(c in a)a[c].reset();this.pending=0;this.invalid=null;this.grps=0;this.outside=!1;this.doDisplayState();this.trigger("reset",this);return this},submit:function(){var a=this.el;if(this.isForm)if(B(a.submit))!1!==this.trigger("beforesubmit",
this)&&!1!==this.trigger("submit",this)&&a.submit();else this.onSubmit();else this.onSubmit()},setFieldEvents:function(a,b){a[b]("statechange",this.onFieldStateChange,this);a[b]("beforeAjax",this.onBeforeAjax,this);a[b]("afterAjax",this.onAfterAjax,this);a[b]("submit",this.onFieldSubmit,this);a[b]("destroy",this.onFieldDestroy,this)},setGroupEvents:function(a,b){a[b]("statechange",this.onGroupStateChange,this)},initFields:function(){var a=this.el,b,c;if(this.isField)return this.add(a),this;a=K("input, textarea, select",
a);b=-1;for(c=a.length;++b<c;this.add(a[b]));return this},initForm:function(a){var b=this.el,c=b.getElementsByTagName("input"),d=K(".submit",b),e=K(".reset",b);a="bind"==a?D:S;var f,g,h,m;f=0;for(g=c.length;f<g;f++)m=c[f],h=m.type,"submit"==h?a(m,"click",this.onRealSubmitClickDelegate):"reset"==h&&a(m,"click",this.resetDelegate);f=-1;for(g=d.length;++f<g;"submit"!=d[f].type&&a(d[f],"click",this.onSubmitClickDelegate));f=-1;for(g=e.length;++f<g;"reset"!=e[f].type&&a(e[f],"click",this.resetDelegate));
this.isForm&&a(b,"submit",this.onFormSubmitDelegate)},onRealSubmitClick:function(a){a=da(a||window.event);this.submitButton=a.target||a.srcElement;this.preventFormSubmit=!1;return this.onSubmit(a)},onSubmitClick:function(a){this.preventFormSubmit=!1;return this.onSubmit(da(a||window.event))},onFormSubmit:function(a){a=da(a);if(!this.isValid()||this.preventFormSubmit)return a.preventDefault(),!1},onFieldSubmit:function(a,b){this.preventFormSubmit=!1;this.enableDisplayState();this.submitted=!0;return this.onSubmit(b)},
onSubmit:function(a){this.enableDisplayState();if(this.pending)return a&&a.preventDefault(),!1;var b=this.submitButton?!0:!1;this.isForm&&(this.hidden&&(this.el.removeChild(this.hidden),this.hidden=null),this.submitButton&&/input|button/.test(this.submitButton.nodeName)&&(this.hidden=document.createElement("input"),this.hidden.type="hidden",this.hidden.setAttribute("name",this.submitButton.name),this.hidden.value=this.submitButton.value,this.el.appendChild(this.hidden)));this.submitButton=null;if(!this.isValid()&&
(this.check(),this.onFieldStateChange(),this.pending))return a&&a.preventDefault(),!1;if(!1===this.trigger("beforesubmit",this)||!this.isValid())return a&&(a.preventDefault(),a.stopPropagation()),this.pending||(this.focusInvalid(),this.submitted=!1),this.trigger("failedsubmit",this,b),!1;this.pending||(this.submitted=!1);a=this.trigger("submit",this);this.preventFormSubmit=!a;return a},onFieldDestroy:function(a){a=a.getElem();a=a.getAttribute("name")||a.getAttribute("id");delete this.fields[a]},onFieldStateChange:function(a,
b){var c=this.invalid,d=this.fields;this.invalid=0;for(var e in d)this.invalid+=d[e].isValid()?0:1;a&&this.trigger("fieldstatechange",this,a,b);if(null===c||null!==c&&this.invalid!==c)this.doDisplayState(),this.trigger("statechange",this,this.isValid())},onGroupStateChange:function(){var a=this.groups,b=this.grps;this.grps=0;for(var c in a)this.grps+=a[c].isValid()?0:1;if(null===b||null!==b&&this.grps!==b)this.doDisplayState(),this.trigger("statechange",this,this.isValid())},doDisplayState:function(){var a=
this.cfg,b=this.isValid(),c=a.cls.error,a=a.cls.valid,d=this.el;if(this.isField||!this.displayState)b=null;null===this.invalid&&(b=null);c&&(!1===b?R(d,c):U(d,c));a&&(!0===b?R(d,a):U(d,a));this.trigger("displaystate",this,b)},onBeforeAjax:function(){this.pending++;this.cfg.cls.ajax&&R(this.el,this.cfg.cls.ajax)},onAfterAjax:function(){var a=this.fields,b=this.cfg;this.pending=0;for(var c in a)this.pending+=a[c].isPending()?1:0;this.doDisplayState();b.cls.ajax&&U(this.el,b.cls.ajax);this.submitted&&
0==this.pending&&(this.submitted=!1,this.isValid()?this.submit():this.focusInvalid())},destroy:function(){var b=this.groups,c=this.fields,d;this.reset();this.trigger("destroy",this);delete a[this.vldId];for(d in b)b.hasOwnProperty(d)&&b[d]&&(this.setGroupEvents(b[d],"un"),b[d].destroy(),delete b[d]);for(d in c)c.hasOwnProperty(d)&&c[d]&&(this.setFieldEvents(c[d],"un"),c[d].destroy(),delete c[d]);this._observable.destroy();delete this._observable;this.initForm("unbind");delete this.fields;delete this.groups;
delete this.el;delete this.cfg}};m.defaults={};m.messages={};m.fieldDefaults={};m.groupDefaults={};m.addMethod=function(a,b,c){f[a]||(f[a]=b,c&&(m.messages[a]=c))};m.getValidator=function(b){b=b.getAttribute("data-validator");return a[b]||null};return m}();I("MetaphorJs.view.Validator",{node:null,scope:null,validator:null,scopeState:null,initialize:function(b,a){this.node=b;this.scope=a;this.scopeState={};this.validator=this.createValidator();this.initScope();this.initScopeState();this.initValidatorEvents();
this.validator.check()},createValidator:function(){var b=this.node,a={},c;if(c=b.getAttribute("mjs-validator-submit"))a.callback=a.callback||{},a.callback.submit=function(a,b){return function(){try{return a(b)}catch(c){aa(c)}}}(nb(c),this.scope),b.removeAttribute("mjs-validator-submit");return new ec(b,a)},initValidatorEvents:function(){var b=this.validator;b.on("fieldstatechange",this.onFieldStateChange,this);b.on("statechange",this.onFormStateChange,this);b.on("displaystatechange",this.onDisplayStateChange,
this);b.on("reset",this.onFormReset,this)},initScope:function(){var b=this.scope,a=this.node,a=a.getAttribute("name")||a.getAttribute("id")||"$form";b[a]=this.scopeState},initScopeState:function(){var b=this.node,a=this.scopeState,c,d,e;b.elements?c=b.elements:(c=[],Za(b,function(a){ib(a)&&c.push(a)}));b=-1;for(e=c.length;++b<e;)d=c[b],(d=d.getAttribute("name")||d.getAttribute("id"))&&!a[d]&&(a[d]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null});a.$invalid=!1;a.$pristine=!0;a.$submit=
x(this.validator.onSubmit,this.validator);a.$reset=x(this.validator.reset,this.validator)},onDisplayStateChange:function(b,a){if(a){a=this.scopeState;var c,d;for(c in a)d=a[c],d.$real&&(a[c]=d.$real);a.$invalid=!b.isValid();a.$pristine=!1;this.scope.$check()}else this.onFormReset(b)},onFormReset:function(b){b=this.scopeState;var a,c;for(a in b)c=b[a],c.$error=null,c.$errorMessage=null,c.$invalid=null,c.$pristine=!0;b.$invalid=!1;b.$pristine=!0;this.scope.$check()},onFormStateChange:function(b,a){var c=
this.scopeState;c.$invalid=!1===a&&b.isDisplayStateEnabled();c.$pristine=!1;this.scope.$check()},onFieldStateChange:function(b,a,c){var d=this.scopeState,e=a.getName();b=b.isDisplayStateEnabled();a={$error:a.getErrorRule(),$errorMessage:a.getError(),$invalid:!1===c,$pristine:null===a.getExactValidState()};b?d[e]=a:d[e].$real=a;this.scope.$check()}});Q("mjs-validate",250,function(b,a,c){c=c||"MetaphorJs.view.Validator";var d=La(c);d?new d(a,b):aa(Error("Class '"+c+"' not found"))});var fc=Da.pushUrl;
L.onReady=Hb;L.initApp=Ib;L.ns=ba;L.cs=Sa;L.resolveComponent=Ba;L.animate=T;L.stopAnimation=ma;L.ajax=Pa;L.select=K;L.bind=x;L.extend=y;L.trim=J;L.pushUrl=fc;L.currentUrl=yb;L.history=Da;L.lib.Promise=H;L.lib.Observable=X})();
