'use strict';(function(){function A(h){return"function"==typeof h}function y(h){return"string"==typeof h||h===""+h}function P(h){return"object"==typeof h&&5===W(h)}function Da(h){if(null===h||"object"!=typeof h)return!1;h=W(h);return 2<h||-1==h}function pa(h){return"object"==typeof h&&3===W(h)&&!h.nodeType&&h.constructor===Object}function va(h){return!0===h||!1===h}function G(){}function Nb(h,a,b,c,d,e){d=d||"before";return function(){var f,g;if("instead"==d)return a.apply(b||c,arguments);"before"==
d?(f=a.apply(b||c,arguments),g=!1!==f?h.apply(c||b,arguments):null):(g=h.apply(c||b,arguments),f=a.apply(b||c,arguments));return e?f:g}}function x(h,a){return h.getAttribute?h.getAttribute(a):null}function rb(h){return h===window||h&&h.document&&h.location&&h.alert&&h.setInterval}function wa(h){h=W(h);return 3>h&&-1<h}function xa(){return!1}function fa(h,a,b,c){return setTimeout(function(){h.apply(a,b||[])},c||0)}function X(h){var a=h.stack||Error().stack;if("undefined"!=typeof console&&console.log)fa(function(){console.log(h);
a&&console.log(a)});else throw h;}function Y(h){if(h&&void 0!=!h.length&&h!==""+h){for(var a=[],b=-1,c=h.length>>>0;++b!==c;a[b]=h[b]);return a}return h?[h]:[]}function Z(h){if(!h)return!1;var a,b;return"object"!=(b=typeof h)&&"function"!=b?!1:A(a=h.then)?a:!1}function $a(h){return null===h}function sb(h){var a={},b,c,d=h.attributes;h=0;for(b=d.length;h<b;h++)c=d[h],a[c.name]=c.value;return a}function da(h){var a=window.document.createDocumentFragment(),b,c;y(h)&&(b=window.document.createElement("div"),
b.innerHTML=h,h=b.childNodes);if(!h)return a;if(h.nodeType)a.appendChild(h);else if(h.item)for(b=-1,c=h.length>>>0;++b!==c;a.appendChild(h[0]));else for(b=-1,c=h.length;++b!==c;a.appendChild(h[b]));return a}function F(h,a){a&&(h.className=h.className.replace(Ka("(?:^|\\s)"+a+"(?!\\S)"),""))}function Pa(h,a){return a?Ka("(?:^|\\s)"+a+"(?!\\S)").test(h.className):!1}function Q(h,a){a&&!Pa(h,a)&&(h.className+=" "+a)}function tb(h,a){var b,c;if(!h||!y(h))return null;try{c=new DOMParser,b=c.parseFromString(h,
a||"text/xml")}catch(d){b=void 0}if(!b||b.getElementsByTagName("parsererror").length)throw"Invalid XML: "+h;return b}function Qa(){return!0}function S(h){return new La(h)}function Ob(h){return h.replace(Pb,function(a){return a.charAt(1).toUpperCase()})}function U(h,a,b){var c=I(h,"config"),d;if(c)return c;c={};if(b||null!==(b=x(h,"mjs-config")))for(d in h.removeAttribute("mjs-config"),a=b?aa(b)(a||{}):{},a)c[d]=a[d];a=Qb(h);for(d in a)b=a[d],c[d]=""===b?!0:b;I(h,"config",c);return c}function Ma(h,
a,b,c,d){var e=!1!==a;a=a||{};d=d||[];b=b||a.scope;c=c||a.node;a.scope=a.scope||b;a.node=a.node||c;var f=y(h)?ya(h):h;if(!f)throw"Component "+h+" not found";b&&f.$isolateScope&&(a.scope=b=b.$newIsolated());var g,k=[];h=f.template||a.template||null;var l=f.templateUrl||a.templateUrl||null,m=b?b.$app:null,p=ub.global(),q=m?m.inject:p.inject,n=m?m:p,u=c?x(c,"mjs-cloak"):null,s={$node:c||null,$scope:b||null,$config:a||null,$args:d||null};if(f.resolve)for(g in f.resolve)(function(e){var l=new D,m;k.push(l.done(function(b){s[e]=
b;a[e]=b;d.push(b)}));m=f.resolve[g];A(m)?l.resolve(m(b,c)):y(m)?l.resolve(q.resolve(m)):l.resolve(q.call(n,m,null,v({},s,a,!1,!1)));l.fail(X)})(g);e&&(h||l)&&(a.template=new Fa({scope:b,node:c,deferRendering:!0,ownRenderer:!0,shadow:f.$shadow,tpl:h,url:l}),k.push(a.template.initPromise),c&&c.firstChild&&I(c,"mjs-transclude",da(c.childNodes)));e&&d.unshift(a);var t;k.length?(t=new D,D.all(k).done(function(){t.resolve(q.call(n,f,null,v({},s,a,!1,!1),d))})):t=D.resolve(q.call(n,f,null,v({},s,a,!1,!1),
d));c&&t.isPending()&&null!==u&&(u?Q(c,u):c.style.visibility="hidden",t.then(function(){u?F(c,u):c.style.visibility=""}));c&&t.then(function(){F(c,"mjs-cloak")});return t}function bb(h){var a=h.nodeName.toLowerCase();h=h.type;return"input"!=a&&"textarea"!=a&&"select"!=a||"submit"==h||"reset"==h||"button"==h?!1:!0}function wb(h,a){var b;a:{for(var c=h,d;c;){d=I(c,"mjs-transclude");if(void 0!==d){b=d;break a}c=c.parentNode}b=void 0}if(b){h.firstChild&&I(h,"mjs-transclude",da(h.childNodes));c=h.parentNode;
d=h.nextSibling;b=cb(b);var e=Y(b.childNodes);a?(c.removeChild(h),c.insertBefore(b,d)):h.appendChild(b);return e}return null}function xb(h,a,b){b||(b="asc");h=h.slice();h.sort(function(b,d){var e=typeof b,f=b,g=d;if(e!=typeof d)return 0;"object"==e&&(A(a)?(f=a(b),g=a(d)):(f=b[a],g=d[a]));if("number"==typeof f)return f-g;f=(""+f).toLowerCase();g=(""+g).toLowerCase();return f===g?0:f>g?1:-1});return"desc"==b?h.reverse():h}function Rb(h,a){var b=!1,c=!0,d=a||window,e,f,g=function(a){if("readystatechange"!=
a.type||"complete"==f.readyState)T("load"==a.type?d:f,a.type,g),!b&&(b=!0)&&h.call(d,a.type||a)},k=function(){try{e.doScroll("left")}catch(a){setTimeout(k,50);return}g("poll")};f=d.document;e=f.documentElement;if("complete"==f.readyState)h.call(d,"lazy");else{if(f.createEventObject&&e.doScroll){try{c=!d.frameElement}catch(l){}c&&k()}C(f,"DOMContentLoaded",g);C(f,"readystatechange",g);C(d,"load",g)}}function Sb(h,a,b,c){try{var d=Ma(a||"MetaphorJs.App",!1,b,h,[h,b]);return!1!==c?d.done(function(a){a.run()}):
d}catch(e){return X(e),D.reject(e)}}function za(h){var a={top:0,left:0},b=window.document.documentElement;if(!Na(h)||h===window)return a;h.getBoundingClientRect&&(a=h.getBoundingClientRect());return{top:a.top+Aa()-b.clientTop,left:a.left+Ba()-b.clientLeft}}function db(h,a){var b,c,d={top:0,left:0},e=window.document.documentElement;if(h===window||h===e)return d;if("fixed"==qa(h,"position"))c=h.getBoundingClientRect();else{if(a)return d=za(h),e=za(a),d={left:d.left-e.left,top:d.top-e.top},0>d.left&&
(d.left=0),0>d.top&&(d.top=0),d;b=window.document.documentElement;for(c=h.offsetParent||b;c&&c!=b&&"static"==qa(c,"position");)c=c.offsetParent;b=c||b;c=za(h);b!==e&&(d=za(b));d.top+=qa(b,"borderTopWidth",!0);d.left+=qa(b,"borderLeftWidth",!0)}return{top:c.top-d.top-qa(h,"marginTop",!0),left:c.left-d.left-qa(h,"marginLeft",!0)}}function ja(h,a,b){if(h){var c=h.style,d;"string"==typeof a?(h={},h[a]=b):h=a;for(d in h)c[d]=h[d]}}function ra(h){return h.substr(0,1).toUpperCase()+h.substr(1)}function Tb(h,
a,b,c){var d=a+"-"+b,e=function(b){b=S(b);return eb(b.target,a)?c(b):null};Ra[d]||(Ra[d]=[]);Ra[d].push({el:h,ls:e,fn:c});C(h,b,e)}function Ub(h,a,b,c){var d,e;if(e=Ra[a+"-"+b])for(a=-1,d=e.length;++a<d;)e[a].el===h&&e[a].fn===c&&T(h,b,e[a].ls)}function Sa(h,a,b){var c,d=h.childNodes;if(!1!==a.call(b,h))for(h=-1,c=d.length>>>0;++h!==c;Sa(d[h],a,b));}var sa={},Vb=Object.prototype.toString,W=function(){var h={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,
"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(a){if(!a){if(null===a)return 6;if(void 0===a)return 7}var b=h[Vb.call(a)];return void 0===b?-1:1==b&&isNaN(a)?8:b}}(),yb=function(){var h,a=function(a){var c={},d=[];0==arguments.length&&(a=!0);return{addFinder:function(a,b,c){d[c?"unshift":"push"]({fn:a,context:b})},add:function(d,f,g){if(c[d]&&!1===c[d].rewritable)return c[d];c[d]={rewritable:"undefined"!=typeof g?g:a,value:f};return f},get:function(a){if(c[a])return c[a].value;
if(d.length){var b,g,k;b=0;for(g=d.length;b<g;b++)if(k=d[b].fn.call(d[b].context,a,this),void 0!==k)return this.add(a,k,!0)}},remove:function(a){var b=c[a];b&&!0===b.rewritable&&delete c[a];return b?b.value:void 0},exists:function(a){return!!c[a]},eachEntry:function(a,b){for(var d in c)a.call(b,c[d].value,d)},destroy:function(){this===h&&(h=null);this.remove=this.exists=this.destroy=this.get=this.add=a=c=null}}};a.global=function(){h||(h=new a(!0));return h};return a}(),fb=function(){var h=function(b,
c,d){d=d||new yb(!1);var e=c?c.length:null;b||(b="undefined"!=typeof global?global:window);var f=function(a){return a&&c&&a.substr(0,e)!=c?c+"."+a:a},g=function(a,g){a=f(a);if(d.exists(a))return d.get(a);if(!g){var e=a.split("."),p,h=e.length,n,u=b;for(p=0;p<h;p++)if(n=e[p],c&&0==p&&n==c)u=b;else{if(void 0===u[n])return;u=u[n]}u&&d.add(a,u);return u}};this.register=function(a,g){var e;e=f(a);var p=e.split("."),h,n=p.pop();h=p.join(".");var u=p.length,s,t=b;if(d[h])e=[d[h],n,e];else{if(0<u)for(h=0;h<
u;h++)s=p[h],c&&0==h&&s==c?t=b:(void 0===t[s]&&(t[s]={}),t=t[s]);e=[t,n,e]}p=e[0];n=e[1];Da(p)&&void 0===p[n]&&(p[n]=g,d.add(e[2],g));return g};this.exists=function(a){return void 0!==g(a,!0)};this.get=g;this.add=function(a,b){a=f(a);d.add(a,b);return b};this.remove=function(a){a=f(a);d.remove(a)};this.normalize=f;this.makeAlias=function(a,b){a=f(a);b=f(b);var c=d.get(a);void 0!==c&&d.add(b,c)};this.destroy=function(){var b;this===a&&(a=null);d.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});
d.destroy();d=null;for(b in this)this[b]=null}};h.prototype.register=null;h.prototype.exists=null;h.prototype.get=null;h.prototype.add=null;h.prototype.remove=null;h.prototype.normalize=null;h.prototype.makeAlias=null;h.prototype.destroy=null;var a;h.global=function(){a||(a=new h);return a};return h}(),ea=Array.prototype.slice,v=function(){return function a(){var b=!1,c=!1,d=ea.call(arguments),e=d.shift(),f,g,k;va(d[d.length-1])&&(b=d.pop());va(d[d.length-1])&&(c=b,b=d.pop());for(;d.length;)if(f=
d.shift())for(g in f)if(f.hasOwnProperty(g)&&void 0!==(k=f[g]))if(c)if(e[g]&&pa(e[g])&&pa(k))a(e[g],k,b,c);else{if(!0===b||void 0==e[g])pa(k)?(e[g]={},a(e[g],k,b,!0)):e[g]=k}else if(!0===b||void 0==e[g])e[g]=k;return e}}(),zb=function(h,a){var b=function(){},c;b.prototype=h.prototype;b=new b;c=h.apply(b,a);return Da(c)||!1===c?c:b},Wb=function(){var h=function(){this.$super&&this.$super!==G&&this.$super.apply(this,arguments)},a=function(a,b,c){var $super=a.prototype[b]||("$constructor"==b?a:G)||G;
return function(){var a,b=this.$super;this.$super=$super;a=c.apply(this,arguments);this.$super=b;return a}},b=function(b,c,d,e){var m,p,h,n=d.prototype;for(m in c)c.hasOwnProperty(m)&&(h=n[m],p=c[m],b[m]=!A(p)||h&&!A(h)?p:a(d,m,p));e||(b.$plugins=null,b.$pluginMap=null,n.$beforeInit?(b.$beforeInit=n.$beforeInit.slice(),b.$afterInit=n.$afterInit.slice(),b.$beforeDestroy=n.$beforeDestroy.slice(),b.$afterDestroy=n.$afterDestroy.slice()):(b.$beforeInit=[],b.$afterInit=[],b.$beforeDestroy=[],b.$afterDestroy=
[]))},c=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("$beforeInit"==c?a.$beforeInit.push(b[c]):"$afterInit"==c?a.$afterInit.push(b[c]):"$beforeDestroy"==c?a.$beforeDestroy.push(b[c]):"$afterDestroy"==c?a.$afterDestroy.push(b[c]):a[c]||(a[c]=b[c]))},d=function(a){a||(a=new fb);var g=function(b){return function(){var c=[],d=[],g=arguments,k,e,l,m,h,v;if(!this)throw"Must instantiate via new: "+b;this.$plugins=[];(k=this.$constructor.apply(this,arguments))&&P(k)&&(g=k);l=this.$plugins;h=this.$pluginMap=
{};k=-1;for(e=this.$beforeInit.length;++k<e;c.push([this.$beforeInit[k],this]));k=-1;for(e=this.$afterInit.length;++k<e;d.push([this.$afterInit[k],this]));if(l&&l.length)for(k=0,e=l.length;k<e;k++){m=l[k];if(y(m)&&(v=m,m=a.get(m,!0),!m))throw v+" not found";m=new m(this,g);h[m.$class]=m;m.$beforeHostInit&&c.push([m.$beforeHostInit,m]);m.$afterHostInit&&d.push([m.$afterHostInit,m]);l[k]=m}k=-1;for(e=c.length;++k<e;c[k][0].apply(c[k][1],g));this.$init&&this.$init.apply(this,g);k=-1;for(e=d.length;++k<
e;d[k][0].apply(d[k][1],g));}},k=function(){};v(k.prototype,{$class:null,$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$constructor:G,$init:G,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},$intercept:function(a,b,c,d,g){var k=this[a];this[a]=Nb(k,b,c||this,this,d,g);return k},$implement:function(a){var c=this.constructor;c&&c.$parent&&b(this,a,c.$parent)},$hasPlugin:function(b){return!!this.$pluginMap[a.normalize(b)]},
$getPlugin:function(b){return this.$pluginMap[a.normalize(b)]||null},$destroy:function(){var a=this.$beforeDestroy,b=this.$afterDestroy,c=this.$plugins,d,g,k;if(!this.$destroyed){this.$destroyed=!0;d=-1;for(g=a.length;++d<g;a[d].apply(this,arguments));d=0;for(g=c.length;d<g;d++)c[d].$beforeHostDestroy&&c[d].$beforeHostDestroy.call(c[d],arguments);k=this.destroy.apply(this,arguments);d=-1;for(g=a.length;++d<g;b[d].apply(this,arguments));d=0;for(g=c.length;d<g;d++)c[d].$destroy.apply(c[d],arguments);
if(!1!==k)for(d in this)this.hasOwnProperty(d)&&(this[d]=null);this.$destroyed=!0}},destroy:function(){}});k.$self=k;k.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return zb(this,a)}};k.$override=function(a){var c=this.$self,d=this.$parent;c&&d&&b(c.prototype,a,d)};k.$extend=function(a,b){return l(a,b,this)};k.$destroy=
function(){for(var a in this)this[a]=null};var l=function(d,e,l){d=d||{};var m=d.$class,s=l||d.$extends,t=d.$mixins,Ea,v,r;s?y(s)?l=a.get(s):(l=s,s=l.$class||""):(l=k,s="");if(s&&!l)throw s+" not found";m&&(m=a.normalize(m));d.$class=m;d.$extends=s;d.$mixins=null;Ea=function(){};Ea.prototype=l.prototype;s=new Ea;Ea=null;d.$constructor=d.$constructor||h;b(s,d,l);if(t)for(d=0,Ea=t.length;d<Ea;d++)r=t[d],y(r)&&(r=a.get(r,!0)),c(s,r);t=g(m);s.constructor=t;t.prototype=s;for(v in k)"prototype"!=v&&k.hasOwnProperty(v)&&
(t[v]=k[v]);for(v in l)"prototype"!=v&&l.hasOwnProperty(v)&&(t[v]=l[v]);if(e)for(v in e)"prototype"!=v&&e.hasOwnProperty(v)&&(t[v]=e[v]);t.$parent=l;t.$self=t;m&&a.register(m,t);return t},m=this;m.factory=function(b){var c=a.get(b),d=ea.call(arguments,1);if(!c)throw b+" not found";return c.$instantiate.apply(c,d)};m.isSubclassOf=function(b,c){var d=b,g=a.get;c=y(c)?a.normalize(c):c.prototype.$class;for(y(b)&&(d=g(a.normalize(b)));d&&d.prototype;){if(d.prototype.$class==c)return!0;d=d.$parent}return!1};
m.isInstanceOf=function(b,c){var d=y(c)?a.get(c):c;return d?b instanceof d:!1};m.define=l;m.destroy=function(){m===e&&(e=null);k.$destroy();k=null;a.destroy();d=a=null};m.BaseClass=k};d.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var e;d.global=function(){e||(e=new d(fb.global()));return e};return d}(),B=new fb(sa,"MetaphorJs"),Ga=new Wb(B),w=Ga.define,r=Function.prototype.bind?function(h,a){return h.bind(a)}:function(h,a){return function(){return h.apply(a,
arguments)}},R=function(){var h=["0","0","0"];return function(){for(var a=h.length,b;a;){a--;b=h[a].charCodeAt(0);if(57==b)return h[a]="A",h.join("");if(90==b)h[a]="0";else return h[a]=String.fromCharCode(b+1),h.join("")}h.unshift("0");return h.join("")}}(),Ab=function(){var h=function(a,b,c,d,e){this.name=a;this.listeners=[];this.map={};this.hash=R();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;"object"==typeof b&&null!==b?v(this,b,!0,!1):(this.returnResult=void 0===b?null:b,this.autoTrigger=
c,this.triggerFilter=d,this.filterContext=e)};v(h.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,returnResult:null,autoTrigger:null,lastTrigger:null,triggerFilter:null,filterContext:null,getName:function(){return this.name},destroy:function(){for(var a in this)this[a]=null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var d=this.uni,e=b||a;if(e[d]&&!c.allowDupes)return null;var f=++this.lid,g=c.first||!1;e[d]=f;a={fn:a,context:b,uniContext:e,id:f,called:0,
limit:0,start:1,count:0,append:null,prepend:null};v(a,c,!0,!1);g?this.listeners.unshift(a):this.listeners.push(a);this.map[f]=a;if(this.autoTrigger&&this.lastTrigger&&!this.suspended){var k=this.triggerFilter;this.triggerFilter=function(a){return a.id==f?k?!1!==k(a):!0:!1};this.trigger.apply(this,this.lastTrigger);this.triggerFilter=k}return f},once:function(a,b,c){c=c||{};c.limit=1;return this.on(a,b,c)},un:function(a,b){var c=-1,d=this.uni,e=this.listeners,f;f=a==parseInt(a)?a:(b||a)[d];if(!f)return!1;
for(var g=0,k=e.length;g<k;g++)if(e[g].id==f){c=g;delete e[g].uniContext[d];break}if(-1==c)return!1;e.splice(c,1);delete this.map[f];return!0},hasListener:function(a,b){var c=this.listeners,d;if(a){b=b||a;d=A(a)?b[this.uni]:a;if(!d)return!1;for(var e=0,f=c.length;e<f;e++)if(c[e].id==d)return!0;return!1}return 0<c.length},removeAllListeners:function(){var a=this.listeners,b=this.uni,c,d;c=0;for(d=a.length;c<d;c++)delete a[c].uniContext[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=
!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){var c;a.append||a.prepend?(c=ea.call(b),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append))):c=b;return c},trigger:function(){var a=this.listeners,b=this.returnResult,c=this.triggerFilter,d=this.filterContext,e;if(this.suspended)return null;this.autoTrigger&&(this.lastTrigger=ea.call(arguments));if(0==a.length)return null;for(var f="all"==b||"merge"==b?[]:null,g,a="first"==b?[a[0]]:ea.call(a);g=a.shift();)if(g&&this.map[g.id]&&
(e=this._prepareArgs(g,arguments),!c||!1!==c.call(d,g,e,this))&&(g.count++,!(g.count<g.start)))if(e=g.fn.apply(g.context,e),g.called++,g.called==g.limit&&this.un(g.id),"all"==b)f.push(e);else if("merge"==b&&e)f=f.concat(e);else{if("first"==b||"nonempty"==b&&e)return e;if("last"==b)f=e;else if(!1==b&&!1===e)return!1}if(b)return f}},!0,!1);return h}(),ka=function(){var h=function(){this.events={}};v(h.prototype,{createEvent:function(a,b,c,d,e){a=a.toLowerCase();var f=this.events;f[a]||(f[a]=new Ab(a,
b,c,d,e));return f[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,b,c,d){a=a.toLowerCase();var e=this.events;e[a]||(e[a]=new Ab(a));return e[a].on(b,c,d)},once:function(a,b,c,d){d=d||{};d.limit=1;return this.on(a,b,c,d)},un:function(a,b,c){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(b,c)},hasListener:function(a,b,c){var d=this.events;if(a)return a=a.toLowerCase(),d[a]?d[a].hasListener(b,c):!1;for(a in d)if(d[a].hasListener())return!0;return!1},removeAllListeners:function(a){var b=
this.events;b[a]&&b[a].removeAllListeners()},trigger:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return null;a=b[a];return a.trigger.apply(a,ea.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},
destroyEvent:function(a){var b=this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(){var a=this.events,b;for(b in a)this.destroyEvent(b);for(b in this)this[b]=null},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),b={},c,d=-1,e=a.length;++d<e;c=a[d],b[c]=r(this[c],this));this.api=b}return this.api}},!0,!1);return h}(),
L=function(){return String.prototype.trim?function(h){return y(h)?h.trim():h}:function(h){return y(h)?h.replace(/^\s\s*/,"").replace(/\s\s*$/,""):h}}(),gb=function(h,a,b){var c=h.length,d=a.length,e=0,f=0,g=!1,k=!1,l=[],m;if(!d)return[h];for(;e<c;e++)if(m=h.charAt(e),"\\"==m)e++;else if('"'==m)g=!g;else if("'"==m)k=!k;else if(!g&&!k&&(1==d&&m==a||1<d&&h.substring(e,e+d)==a)){if(h.substr(e-1,d)!=a&&h.substr(e+1,d)!=a||b)l.push(h.substring(f,e).replace("\\"+a,a)),f=e+d;e+=d-1}l.push(h.substring(f).replace("\\"+
a,a));return l},Bb=function(){return function a(b,c){if(b===c)return!0;if(null===b||null===c)return!1;if(b!==b&&c!==c)return!0;var d=typeof b,e;if(d==typeof c&&"object"==d)if(P(b)){if(!P(c))return!1;if((d=b.length)==c.length){for(e=0;e<d;e++)if(!a(b[e],c[e]))return!1;return!0}}else{if(10===W(b))return 10===W(c)&&b.getTime()==c.getTime();if(9===W(b)&&9===W(c))return b.toString()==c.toString();if(rb(b)||rb(c)||P(c))return!1;d={};for(e in b)if("$"!=e.charAt(0)&&!A(b[e])){if(!a(b[e],c[e]))return!1;d[e]=
!0}for(e in c)if(!d.hasOwnProperty(e)&&"$"!=e.charAt(0)&&void 0!==c[e]&&!A(c[e]))return!1;return!0}return!1}}(),Cb=function(){var h="undefined"!=typeof window?window:null,a="undefined"!=typeof global?global:null;return function c(d,e){if(h&&d===h)throw Error("Cannot copy window object");if(a&&d===a)throw Error("Cannot copy global object");if(e){if(d===e)throw Error("Objects are identical");if(P(d))for(var f=e.length=0,g=d.length;f<g;f++)e.push(c(d[f]));else{for(f in e)delete e[f];for(f in d)d.hasOwnProperty(f)&&
("$"==f.charAt(0)||A(d[f])?e[f]=d[f]:e[f]=c(d[f]))}}else(e=d)&&(P(d)?e=c(d,[]):10===W(d)?e=new Date(d.getTime()):9===W(d)?e=new RegExp(d.source):pa(d)&&(e=c(d,{})));return e}}(),Xb=function(){var h=Object.prototype.toString,a=Function.prototype.toString,b=/^\[object .+?Constructor\]$/,c=RegExp("^"+String(h).replace(/[.*+?^${}()|[\]\/\\]/g,"\\$&").replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return function(d){var e=typeof d;return"function"==e?!("prototype"in d)||c.test(a.call(d)):
d&&"object"==e&&b.test(h.call(d))||!1}}(),hb=function(){var h=/(^|[^a-z0-9_$\]\)'"])(\.)([^0-9])/ig,a=Function,b=function(a,b){return function(b){var c=ea.call(arguments);c.push(null);c.push(a);c=a.apply(null,c);return void 0===c||"number"==typeof c&&isNaN(c)?void 0:c}},c={},d=0,e={},f=0,g={},k=0,l=function(){1E3<=d&&(c={});1E3<=f&&(e={});1E3<=k&&(g={})};return{createGetter:function(g){try{return c[g]?c[g]:(d++,c[g]=b(new a("____","$$interceptor","$$itself","".concat("try {","return ",g.replace(h,
"$1____.$3"),";} catch (thrownError) { return undefined; }")),!0))}catch(k){return X(k),G}},createSetter:function(c){try{if(!e[c]){f++;var d=c.replace(h,"$1____.$3");return e[c]=b(new a("____","$$$$","$$interceptor","$$itself","".concat("try {",d," = $$$$",";} catch (thrownError) { return undefined; }")))}return e[c]}catch(g){return X(g),G}},createFunc:function(c){try{return g[c]?g[c]:(k++,g[c]=b(new a("____","$$interceptor","$$itself","".concat("try {",c.replace(h,"$1____.$3"),";} catch (thrownError) { return undefined; }"))))}catch(d){return X(d),
G}},resetCache:l,enableResetCacheInterval:function(){setTimeout(l,1E4)}}}(),aa=hb.createGetter,Yb=hb.createSetter,ib=function(){var h=Object.observe&&Xb(Object.observe),a=function(a){if(!y(a))return!0;var b=a.substr(0,1),c=a.length-1;return'"'!=b&&"'"!=b||a.indexOf(b,1)!=c?!1:a.substring(1,c)},b,c=function(c,d,f,m,p,h){b||(b=new ka);var n=R(),u;h&&(this.namespace=h,this.nsGet=h.get);this.origCode=d;y(d)||(m=f,f=d,d=null,u="object");y(c)&&(m=f,f=d,d=c,c=null);d&&c&&(u=c.hasOwnProperty(d)?"attr":"expr");
d&&!c&&(u="expr");if(f)b.on(n,f,m||this,{append:[p],allowDupes:!0});if("expr"==u){d=this._parsePipes(d,c,!0);d=this._parsePipes(d,c,!1);if(this.inputPipes||this.pipes)d=e(c,d),u=c.hasOwnProperty(d)?"attr":"expr";if(this.staticValue=a(d))u="static"}this.userData=p;this.code=d;this.id=n;this.type=u;this.obj=c;"expr"==u&&(this.getterFn=aa(d));"static"!=u||this.pipes?(this.curr=this.curr||this._getValue(),this.currCopy=wa(this.curr)?this.curr:Cb(this.curr)):(this.check=xa,this.curr=this.prev=this.staticValue)};
v(c.prototype,{namespace:null,nsGet:null,staticValue:null,origCode:null,code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,currCopy:null,prev:null,unfiltered:null,pipes:null,inputPipes:null,lastSetValue:null,userData:null,obsrvDelegate:null,obsrvChanged:!1,_indexArrayItems:function(a){var b="$$"+this.id,c,d,e;if(a)for(c=0,d=a.length;c<d;c++)e=a[c],!e||wa(e)||e[b]||(e[b]=R())},_parsePipes:function(a,b,c){var d=c?">>":"|",e=c?"inputPipes":"pipes",f=c?this.onInputParamChange:
this.onPipeParamChange;if(-1==a.indexOf(d))return a;a=gb(a,d);c=c?a.pop():a.shift();var d=[],h,u,s;u=0;for(s=a.length;u<s;u++)h=gb(L(a[u]),":"),this._addPipe(d,h,b,f);d.length&&(this[e]=d);return L(c)},_addPipe:function(a,b,c,e){var f=b.shift(),h=null,n=[],u=!1,s;"!"==f.substr(0,1)&&(f=f.substr(1),u=!0);this.nsGet&&(h=this.nsGet("filter."+f,!0));h||(h=("undefined"!=typeof window?window[f]:null)||c[f]);if(A(h)){f=-1;for(s=b.length;++f<s;n.push(d(c,b[f],e,this,null,this.namespace)));a.push([h,b,n,u])}},
_getValue:function(){var a;switch(this.type){case "static":a=this.staticValue;break;case "attr":a=this.obj[this.code];break;case "expr":a=this.getterFn(this.obj);break;case "object":a=this.obj}P(a)&&(this.inputPipes||this._indexArrayItems(a),a=a.slice());this.unfiltered=a;return a=this._runThroughPipes(a,this.pipes)},_runThroughPipes:function(a,b){if(b){var c,d,e,h=b.length,n=this.obj,u,s,t;for(c=0;c<h;c++){e=b[c][1];u=b[c][3];d=[];s=-1;for(t=e.length;++s<t;d.push(f(e[s],n)));d.unshift(n);d.unshift(a);
a=b[c][0].apply(null,d);u&&(a=!a)}}return a},subscribe:function(a,c,d){b.on(this.id,a,c,d)},unsubscribe:function(a,c){return b.un(this.id,a,c)},hasPipes:function(){return null!==this.pipes},hasInputPipes:function(){return null!=this.inputPipes},getValue:function(){return this._getValue()},getUnfilteredValue:function(){return this.unfiltered||this.curr},getPrevValue:function(){return this.prev},getPrescription:function(a,b){var c;b=b||this._getValue();var d=a||[],e=b||[],f=d.length,h=e.length,u=Array(f+
1);c=Array(f+1);var s,t,v,r=0;if(f==h&&0==f)c=[];else{for(s=0;s<=f;s++)u[s]=Array(h+1),c[s]=Array(h+1),u[s][0]=s,c[s][0]="D";for(s=0;s<=h;s++)u[0][s]=s,c[0][s]="I";for(s=1;s<=f;s++)for(t=1;t<=h;t++)v=Bb(d[s-1],e[t-1])?0:1,u[s][t-1]<u[s-1][t]&&u[s][t-1]<u[s-1][t-1]+v?(u[s][t]=u[s][t-1]+1,c[s][t]="I"):u[s-1][t]<u[s-1][t-1]+v?(u[s][t]=u[s-1][t]+1,c[s][t]="D"):(u[s][t]=u[s-1][t-1]+v,c[s][t]=1==v?"R":"-");d=[];s=f;t=h;do f=c[s][t],d.push(f),"-"!=f&&r++,"R"==f||"-"==f?(s--,t--):"D"==f?s--:t--;while(0!=
s||0!=t);c=d.reverse()}return c},getMovePrescription:function(a,b,c){c=c||this._getValue();var d=a||[],e=c||[];a=this.getPrescription(a||[],c||[]);c=[];var f,h,u,s={},t,v;f=0;for(h=d.length;f<h;f++)(u=b(d[f]))&&(s[u]=f);t=0;var r={};f=0;for(h=a.length;f<h;f++)d=a[f],"D"!=d&&(u=b(e[t]),void 0!=u&&!0!==r[u]&&void 0!==(v=s[u])?(c.push(v),r[u]=!0):c.push(d),t++);return c},setValue:function(a){var c=this.type;this.lastSetValue=a;a=this._runThroughPipes(a,this.inputPipes);"attr"==c?this.obj[this.code]=
a:"expr"==c?(this.setterFn||(this.setterFn=Yb(this.code)),this.setterFn(this.obj,a)):"object"==c&&(this.obj=a)},onInputParamChange:function(a,c,b){this.setValue(this.lastSetValue);b&&this.checkAll()},onPipeParamChange:function(a,c,b){this.check()},onObserverChange:function(a){var c=this.code,b,d,e;b=0;for(d=a.length;b<d;b++)if(e=a[b],e.name==c){this.obsrvChanged=!0;break}},_check:function(a){var c=this._getValue(),d=this.currCopy;return(this.obsrvDelegate?this.obsrvChanged:!Bb(d,c))?(this.curr=c,
this.prev=d,this.currCopy=wa(c)?c:Cb(c),this.obsrvChanged=!1,b.trigger(this.id,c,d,a),!0):!1},check:function(a){return this._check(a)},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var c=this;c.itv&&c.clearInterval();c.itv=setInterval(function(){c.check()},a)},clearInterval:function(){this.itv&&(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,c){var d=this.id;a&&b.un(d,a,c);return b.hasListener(d)?
!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,c=this.inputPipes,d,e,f,h,n;this.itv&&this.clearInterval();if(a)for(d=-1,e=a.length;++d<e;)for(n=a[d][2],f=-1,h=n.length;++f<h;)n[f].unsubscribeAndDestroy(this.check,this);if(c)for(d=-1,e=c.length;++d<e;)for(n=c[d][2],f=-1,h=n.length;++f<h;)n[f].unsubscribeAndDestroy(this.onInputParamChange,this);this.obsrvDelegate&&Object.unobserve(this.obj,this.obsrvDelegate);this.obj&&(this.obj.$$watchers.$codes[this.origCode]=null);b.destroyEvent(this.id);
for(d in this)this.hasOwnProperty(d)&&(this[d]=null)}},!0,!1);var d=function(a,b,d,f,h,q){b=e(a,L(b));return a?(a.$$watchers||(a.$$watchers={$codes:{},$checkAll:function(){var a=this.$codes,c,b=0;for(c in a)a[c]&&a[c].check()&&b++;return b},$destroyAll:function(){var a=this.$codes,c;for(c in a)a[c]&&(a[c].destroy(),a[c]=null)}}),a.$$watchers.$codes[b]?a.$$watchers.$codes[b].subscribe(d,f,{append:[h],allowDupes:!0}):a.$$watchers.$codes[b]=new c(a,b,d,f,h,q),a.$$watchers.$codes[b]):new c(a,b,d,f,h,
q)},e=function(a,c){if(a&&c){if(a.hasOwnProperty(c))return c;var b;if("."==c.charAt(0)&&(b=c.substr(1),a.hasOwnProperty(b)))return b}return c},f=function(c,b){var d;return(d=a(c))?d:aa(c)(b)};c.create=d;c.unsubscribeAndDestroy=function(a,c,b,d){c=L(c);(a=a.$$watchers?a.$$watchers.$codes:null)&&a[c]&&a[c].unsubscribeAndDestroy(b,d)&&(a[c]=null)};c.normalizeExpr=e;c.eval=f;c.usesNativeObserver=function(){return h};return c}(),ma=function(h){this.$$observable=new ka;this.$$historyWatchers={};v(this,
h,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this)):(this.$root=this,this.$isRoot=!0)};v(ma.prototype,{$app:null,$parent:null,$root:null,$isRoot:!1,$level:0,$$observable:null,$$watchers:null,$$historyWatchers:null,$$checking:!1,$$destroyed:!1,$new:function(){return new ma({$parent:this,$root:this.$root,$app:this.$app,$level:this.$level+1})},$newIsolated:function(){return new ma({$app:this.$app,$level:self.$level+1})},
$on:function(h,a,b){return this.$$observable.on(h,a,b)},$un:function(h,a,b){return this.$$observable.un(h,a,b)},$watch:function(h,a,b){return ib.create(this,h,a,b,null)},$unwatch:function(h,a,b){return ib.unsubscribeAndDestroy(this,h,a,b)},$watchHistory:function(h,a){this.$$historyWatchers[a]||(this.$$historyWatchers[a]=h,sa.history.on("change-"+a,this.$$onHistoryChange,this))},$unwatchHistory:function(h){this.$$historyWatchers[h]||(delete this.$$historyWatchers[h],sa.history.un("change-"+h,this.$$onHistoryChange,
this))},$wrap:function(h,a){var b=this,c;"string"==typeof h&&(c=h,h=a[c]);var d=function(){var c=h.apply(a,arguments);b.$check();return c};c&&(a[c]=d);return d},$get:function(h){for(var a=this;a;){if(void 0!==a[h])return a[h];a=a.$parent}},$set:function(h,a){if("string"==typeof h)this[h]=a;else for(var b in h)this[b]=h[b];this.$check()},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$$onHistoryChange:function(h,a,b){this.$$historyWatchers[b]&&(a=this.$$historyWatchers[b],
this[a]=h,this.$check())},$check:function(){var h;this.$$checking||(this.$$checking=!0,this.$$watchers&&(h=this.$$watchers.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",h),0<h&&this.$check())},$destroy:function(){var h,a;this.$$observable.trigger("destroy");this.$$observable.destroy();this.$$watchers&&this.$$watchers.$destroyAll();for(h in this.$$historyWatchers)this.$unwatchHistory(h);for(a in this)this.hasOwnProperty(a)&&(this[a]=null);this.$$destroyed=!0}},
!0,!1);var ha=ib.create,J=B.add,ya=B.get,z=function(){var h=[],a=!1,b=function(a,b){return a.priority<b.priority?-1:a.priority>b.priority?1:0};return w({$class:"Directive",watcher:null,scope:null,node:null,expr:null,autoOnChange:!0,$init:function(a,b,e){var f;e=L(e);this.node=b;this.expr=e;this.scope=a;this.watcher=ha(a,e,this.onChange,this,null,B);if(this.autoOnChange&&void 0!==(f=this.watcher.getLastResult()))this.onChange(f,void 0);a.$on("destroy",this.onScopeDestroy,this)},onScopeDestroy:function(){this.$destroy()},
onChange:function(){},destroy:function(){this.watcher&&this.watcher.unsubscribeAndDestroy(this.onChange,this);this.$super()}},{registerAttribute:function(c,b,e){ya("attr."+c,!0)||(h.push({priority:b,name:c,handler:J("attr."+c,e)}),a=!1)},getAttributes:function(){a||(h.sort(b),a=!0);return h},registerTag:function(a,b){ya("tag."+a,!0)||J("tag."+a,b)}})}(),Db=function(){var h=/\\{/g,a=new ka,b=function(a,b,f,g,k){return!b||!b.indexOf||-1==b.indexOf("{{")&&-1==b.indexOf("{[")?null:new c(a,b,f,g,k)},c=
w({$class:"TextRenderer",id:null,parent:null,isRoot:null,scope:null,origin:"",processed:null,text:null,watchers:null,children:null,data:null,recursive:!1,dataChangeDelegate:null,changeTmt:null,lang:null,$init:function(a,c,b,g,k){this.id=R();this.origin=c;this.scope=a;this.parent=b;this.isRoot=!b;this.data=g;this.lang=a.$app?a.$app.lang:null;if(!0===k||!1===k)this.recursive=k;this.watchers=[];this.children=[];this.dataChangeDelegate=r(this.doDataChange,this);this.processed=this.processText(c);this.render()},
subscribe:function(c,b){return a.on(this.id,c,b)},unsubscribe:function(c,b){return a.un(this.id,c,b)},getString:function(){null===this.text&&this.render();var a=this.text;return-1!=a.indexOf("\\{")?a.replace(h,"{"):a},render:function(){var a=this.processed,b,f,g;this.children.length||this.createChildren();g=this.children;b=-1;for(f=g.length;++b<f;a=a.replace("---"+b+"---",g[b]instanceof c?g[b].getString():g[b]));return this.text=a},processText:function(a){for(var b=0,c=a.length,g,k,l="";b<c;)if(-1!=
(g=a.indexOf("{{",b))&&-1!=(k=a.indexOf("}}",g+2))&&"\\"!=a.substr(g-1,1))l+=a.substring(b,g),k!=g+2&&(l+=this.watcherMatch(a.substring(g+2,k))),b=k+2;else{b!==c&&(l+=a.substring(b));break}b=0;a=l;c=a.length;for(l="";b<c;)if(-1!=(g=a.indexOf("{[",b))&&-1!=(k=a.indexOf("]}",g+2))&&"\\"!=a.substr(g-1,1))l+=a.substring(b,g),k!=g+2&&(l+=this.watcherMatch(a.substring(g+2,k),!0)),b=k+2;else{b!==c&&(l+=a.substring(b));break}return l},watcherMatch:function(a,b){var c=this.watchers;if(b){a=L(a);var g=gb(a,
"|"),k=L(g[0]);"."!=k.substr(0,1)&&(g[0]="'"+k+"'");1==g.length&&g.push("l");a=g.join(" | ")}c.push(ha(this.scope,a,this.onDataChange,this,null,B));return"---"+(c.length-1)+"---"},onDataChange:function(){this.changeTmt||(this.changeTmt=setTimeout(this.dataChangeDelegate,0))},doDataChange:function(){this.destroyChildren();this.triggerChange();this.changeTmt=null},triggerChange:function(){this.text=null;this.isRoot?a.trigger(this.id,this,this.data):this.parent.triggerChange()},createChildren:function(){var a=
this.watchers,c=this.children,f=this.scope,g=this.recursive,k,l,h;k=-1;for(l=a.length;++k<l;)h=a[k].getLastResult(),void 0===h&&(h=""),c.push(g&&b(f,h,this,null,!0)||h)},destroyChildren:function(){var a=this.children,b,f;b=-1;for(f=a.length;++b<f;)a[b]instanceof c&&a[b].$destroy();this.children=[]},destroyWatchers:function(){var a=this.watchers,b,c;b=-1;for(c=a.length;++b<c;a[b].unsubscribeAndDestroy(this.onDataChange,this));this.watchers=[]},destroy:function(){this.destroyChildren();this.destroyWatchers();
a.destroyEvent(this.id);this.changeTmt&&clearTimeout(this.changeTmt)}},{create:b});return c}(),D=function(){var h=[],a=!1,b="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)},c=function(){a=!0;var d=h.shift();b(function(){d[0].apply(d[1],d[2]);h.length?c():a=!1},0)},d=function(b,d,e){e=e||[];h.push([b,d,e]);a||c()},e=function(a,b){return function(c){try{b.resolve(a(c))}catch(d){b.reject(d)}}},f=function(a,b){if(a instanceof f)return a;if(!(this instanceof f))return new f(a,
b);var c;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(c=Z(a))a instanceof f?a.then(r(this.resolve,this),r(this.reject,this)):(new f(c,a)).then(r(this.resolve,this),r(this.reject,this));else if(A(a))try{a.call(b,r(this.resolve,this),r(this.reject,this))}catch(d){this.reject(d)}else this.resolve(a)};v(f.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},
isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,b){var c;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(c=Z(a)){a instanceof f?a.then(r(this._processResolveValue,this),r(this._processRejectReason,this)):(new f(c,a)).then(r(this._processResolveValue,this),r(this._processRejectReason,this));return}}catch(d){0==
this._state&&this._doReject(d);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)d(b[0],b[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();
for(var a=this._rejects,b;b=a.shift();)d(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b){var c=new f,h=this._state;0==h||0!=this._wait?(a&&A(a)?this._fulfills.push([e(a,c),null]):this._fulfills.push([c.resolve,c]),
b&&A(b)?this._rejects.push([e(b,c),null]):this._rejects.push([c.reject,c])):1==h?a&&A(a)?d(e(a,c),null,[this._value]):c.resolve(this._value):2==h&&(b&&A(b)?d(e(b,c),null,[this._reason]):c.reject(this._reason));return c},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)try{b[0].call(b[1]||null,this._value)}catch(c){X(c)}},done:function(a,b){var c=this._state;if(1==c&&0==this._wait)try{a.call(b||null,this._value)}catch(d){X(d)}else 0==c&&this._dones.push([a,
b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)try{b[0].call(b[1]||null,this._reason)}catch(c){X(c)}},fail:function(a,b){var c=this._state;if(2==c&&0==this._wait)try{a.call(b||null,this._reason)}catch(d){X(d)}else 0==c&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:r(this.then,this),done:r(this.done,this),fail:r(this.fail,this),always:r(this.always,this)}},after:function(a){var b=this;if(Z(a)){b._wait++;
var c=function(){b._wait--;0==b._wait&&0!=b._state&&(1==b._state?b._callResolveHandlers():b._callRejectHandlers())};A(a.done)?a.done(c):a.then(c)}return b}},!0,!1);f.fcall=function(a,b,c){return f.resolve(a.apply(b,c||[]))};f.resolve=function(a){var b=new f;b.resolve(a);return b};f.reject=function(a){var b=new f;b.reject(a);return b};f.all=function(a){if(!a.length)return f.resolve(null);var b=new f,c=a.length,d=Array(c),e=c,h,n,u=function(a,c){d[c]=a;e--;0==e&&b.resolve(d)};for(h=0;h<c;h++)(function(c){n=
a[h];n instanceof f?n.done(function(a){u(a,c)}).fail(b.reject,b):Z(n)||A(n)?(new f(n)).done(function(a){u(a,c)}).fail(b.reject,b):u(n,c)})(h);return b};f.when=function(){return f.all(arguments)};f.allResolved=function(a){if(!a.length)return f.resolve(null);var b=new f,c=a.length,d=[],e=c,h,n,u=function(a){d.push(a);s()},s=function(){e--;0==e&&b.resolve(d)};for(h=0;h<c;h++)n=a[h],n instanceof f?n.done(u).fail(s):Z(n)||A(n)?(new f(n)).done(u).fail(s):u(n);return b};f.race=function(a){if(!a.length)return f.resolve(null);
var b=new f,c=a.length,d,e;for(d=0;d<c&&(e=a[d],e instanceof f?e.done(b.resolve,b).fail(b.reject,b):Z(e)||A(e)?(new f(e)).done(b.resolve,b).fail(b.reject,b):b.resolve(e),b.isPending());d++);return b};f.waterfall=function(a){if(!a.length)return f.resolve(null);for(var b=a.shift(),b=A(b)?f.fcall(b):f.resolve(c),c;c=a.shift();)Z(c)?b=b.then(function(a){return function(){return a}}(c)):A(c)?b=b.then(c):b.resolve(c);return b};f.counter=function(a){var b=new f;b.countdown=function(){a--;0==a&&b.resolve()};
return b};return f}(),Ta=Array.prototype.indexOf;Ta||(Ta=Array.prototype.indexOf=function(h,a){var b;if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>0;if(0===d)return-1;b=+a||0;Infinity===Math.abs(b)&&(b=0);if(b>=d)return-1;for(b=Math.max(0<=b?b:d-Math.abs(b),0);b<d;){if(b in c&&c[b]===h)return b;b++}return-1});var Ua=function(){var h=null,a=Db.create,b=function(a,b,c,d,f,h){var n=[];if(a&&!0!==a){if(a.nodeType){h.countdown+=1;e(a,c,d,f,h);return}n=
ea.call(a)}n.length||(n=Y(b.childNodes||b));b=n.length;h.countdown+=b;for(a=-1;++a<b;e(n[a],c,d,f,h));},c=function(a,b){if(b)if(b.nodeType)a.push(b);else if(P(b))for(var d=-1,e=b.length;++d<e;c(a,b[d]));},d={script:!0,template:!0,"mjs-template":!0,style:!0},e=function(a,c,e,f,h){if(a){var q;q=a.nodeName;h||(h={countdown:1});if(!q||!d[q.toLowerCase()])if(q=c.call(e,a),!1!==q){if(Z(q)){q.done(function(d){!1!==d&&b(d,a,c,e,f,h);0==--h.countdown&&f&&f.call(e)});return}b(q,a,c,e,f,h)}0==--h.countdown&&
f&&f.call(e)}},f=new ka;return w({$class:"Renderer",id:null,el:null,scope:null,texts:null,parent:null,$init:function(a,b,c){this.id=R();this.el=a;this.scope=b;this.texts=[];this.parent=c;b instanceof ma&&b.$on("destroy",this.$destroy,this);if(c)c.on("destroy",this.$destroy,this)},on:function(a,b,c){return f.on(a+"-"+this.id,b,c)},once:function(a,b,c){return f.once(a+"-"+this.id,b,c)},un:function(a,b,c){return f.un(a+"-"+this.id,b,c)},createChild:function(a){return new Ua(a,this.scope,this)},getEl:function(){return this.el},
runHandler:function(a,b,c,d){var e=a.$isolateScope?b.$newIsolated():a.$breakScope?b.$new():b,f=b.$app,h={$scope:e,$node:c,$attrValue:d,$renderer:this};c=[e,c,d,this];h=f?f.inject(a,null,h,c):a.$instantiate?a.$instantiate.apply(a,c):a.apply(null,c);f&&a.$registerBy&&h&&(Z(h)?h.done(function(c){f.registerCmp(c,b,a.$registerBy)}):f.registerCmp(h,b,a.$registerBy));if("function"==typeof h)this.on("destroy",h);else if(h&&h.$destroy)this.on("destroy",h.$destroy,h);return a.$stopRenderer?!1:h},processNode:function(b){var d=
b.nodeType,e=this.texts,f=this.scope,p,q;if(3==d){if(p=null!==x(b.parentNode,"mjs-recursive"),d=a(f,b.textContent||b.nodeValue,null,e.length,p))d.subscribe(this.onTextChange,this),e.push({node:b,tr:d}),this.renderText(e.length-1)}else if(1==d){h||(h=z.getAttributes());var d=[],n=[],u,s,t;q="tag."+b.tagName.toLowerCase();if(q=ya(q,!0)){s=this.runHandler(q,f,b);if(!1===s)return!1;Z(s)?d.push(s):c(n,s)}u=sb(b);q=0;for(p=h.length;q<p;q++)if(t=h[q].name,void 0!==(s=u[t])){b.removeAttribute(t);s=this.runHandler(h[q].handler,
f,b,s);u[t]=null;if(!1===s)return!1;Z(s)?d.push(s):c(n,s)}if(d.length){var v=new D;D.all(d).done(function(a){c(n,a);v.resolve(n)});return v}p=void 0!==u["mjs-recursive"];delete u["mjs-recursive"];for(q in u)null!==u[q]&&(d=a(f,u[q],null,e.length,p))&&(b.removeAttribute(q),d.subscribe(this.onTextChange,this),e.push({node:b,attr:q,tr:d}),this.renderText(e.length-1));return n.length?n:!0}return!0},process:function(){this.el.nodeType?e(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1}):
b(null,this.el,this.processNode,this,this.onProcessingFinished,{countdown:0})},onProcessingFinished:function(){f.trigger("rendered-"+this.id,this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.tr.getString(),c=a.attr;c?("value"==c?a.node.value=b:"class"==c?a.node.className=b:"src"==c&&(a.node.src=b),a.node.setAttribute(c,b)):(a.node.textContent=b,a.node.nodeValue=b)},destroy:function(){var a=this.texts,b,c;b=-1;for(c=a.length;++b<c;a[b].tr.$destroy());
this.parent&&this.parent.un("destroy",this.$destroy,this);f.trigger("destroy-"+this.id)}})}(),Zb=function(){var h=function(a,b){"pt_BR"==b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1==
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0==a||1==a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1==a?0:2<=a&&4>=a?1:2;case "ga":return 1==a?0:2==a?1:2;case "lt":return 1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1==a%100?0:2==a%100?1:3==a%100||4==a%100?2:3;
case "mk":return 1==a%10?0:1;case "mt":return 1==a?0:0==a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0==a?0:1==a%10&&11!=a%100?1:2;case "pl":return 1==a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1==a?0:2==a?1:8==a||11==a?2:3;case "ro":return 1==a?0:0==a||0<a%100&&20>a%100?1:2;case "ar":return 0==a?0:1==a?1:2==a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},a=function(a){this.store={};a&&(this.locale=a)};v(a.prototype,{store:null,locale:"en",setLocale:function(a){this.locale=
a},set:function(a,b){var e=this.store;void 0===e[a]&&(e[a]=b)},load:function(a){v(this.store,a,!1,!1)},get:function(a){return this.store[a]||(this===b?"-- "+a+" --":b.get(a))},plural:function(a,b){var e=this.get(a),f=h(b,this.locale);return P(e)?e[f]:pa(e)?e[b]?e[b]:1==b&&void 0!=e.one?e.one:0>b&&void 0!=e.negative?e.negative:e.other:e},destroy:function(){this.store=null}},!0,!1);var b=new a;a.global=function(){return b};return a}(),$b=function(){var h=[],a=function(a){var c,d,e,f;c=0;for(d=h.length;c<
d;c++)e=h[c],e.$destroy?e.$destroy():e.destroy&&e.destroy();h=null;Ga&&Ga.destroy&&(Ga.destroy(),Ga=null);B&&B.destroy&&(B.destroy(),B=null);for(f in sa)sa[f]=null;sa=null;if(a)for(f in window)window.hasOwnProperty(f)&&(window[f]=null)};a.collect=function(a){h.push(a)};return a}();B.register("mixin.Observable",{$$observable:null,$$callbackContext:null,$beforeInit:function(h){this.$$observable=new ka;if(h&&h.callback){var a=h.callback,b=a.context||a.scope,c;a.context=null;a.scope=null;for(c in a)if(a[c])this.$$observable.on(c,
a[c],b||this);h.callback=null;b&&(this.$$callbackContext=b)}},on:function(){var h=this.$$observable;return h.on.apply(h,arguments)},un:function(){var h=this.$$observable;return h.un.apply(h,arguments)},once:function(){var h=this.$$observable;return h.once.apply(h,arguments)},trigger:function(){var h=this.$$observable;return h.trigger.apply(h,arguments)},$beforeDestroy:function(){this.$$observable.trigger("before-destroy",this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.destroy();
this.$$observable=null}});var ub=function(){var h,a=function(){this.store={}};v(a.prototype,{store:null,instantiate:function(a,c,d,e){return a.$instantiate?a.$instantiate.apply(a,d):e?zb(a,d):a.apply(c,d)},inject:function(a,c,d,e,f){d=d||{};e=e||[];var g=this;if(A(a))if(a.inject)e=ea.call(a.inject),e.push(a),a=e;else return g.instantiate(a,c,e,f);a=ea.call(a);e=[];var k=a.pop(),l,h;l=-1;for(h=a.length;++l<h;e.push(g.resolve(a[l],d)));return D.all(e).then(function(a){return g.instantiate(k,c,a,f)})},
value:function(a,c){this.store[a]={type:1,value:c}},constant:function(a,c){var d=this.store;d[a]||(d[a]={type:2,value:c})},factory:function(a,c,d,e){va(d)&&(e=d,d=null);this.store[a]={type:3,singleton:e,fn:c,context:d}},service:function(a,c,d){this.store[a]={type:4,singleton:d,fn:c}},provider:function(a,c){this.store[a+"Provider"]={name:a,type:5,fn:c,instance:null}},resolve:function(a,c,d){var e=this.store,f,g,k;c=c||{};d=d||[];if(void 0!==c[a])return c[a];if(g=e[a]){f=g.type;if(1==f||2==f)return g.value;
if(3==f)k=this.inject(g.fn,g.context,c,d);else if(4==f)k=this.inject(g.fn,null,c,d,!0);else if(5==f)return g.instance||(g.instance=D.resolve(this.inject(g.fn,null,c)).done(function(a){g.instance=a;e[g.name]={type:3,fn:a.$get,context:a}})),g.instance;g.singleton&&(g.type=1,g.value=k,3==f&&Z(k)&&k.done(function(a){g.value=a}));return c[a]=k}if(e[a+"Provider"])return this.resolve(a+"Provider",c),this.resolve(a,c);if(this===h)throw"Could not provide value for "+a;return h.resolve(a)},destroy:function(){this.scope=
this.store=null}},!0,!1);a.global=function(){return h};h=new a;return a}();B.register("mixin.Provider",{$$provider:null,$beforeInit:function(){this.$$provider=new ub},value:function(){var h=this.$$provider;return h.value.apply(h,arguments)},constant:function(){var h=this.$$provider;return h.constant.apply(h,arguments)},factory:function(){var h=this.$$provider;return h.factory.apply(h,arguments)},service:function(){var h=this.$$provider;return h.service.apply(h,arguments)},provider:function(){var h=
this.$$provider;return h.provider.apply(h,arguments)},resolve:function(){var h=this.$$provider;return h.resolve.apply(h,arguments)},inject:function(){var h=this.$$provider;return h.inject.apply(h,arguments)},$afterDestroy:function(){this.$$provider.destroy();this.$$provider=null}});w({$class:"App",$mixins:["mixin.Observable","mixin.Provider"],lang:null,scope:null,renderer:null,cmpListeners:null,components:null,sourceObs:null,$init:function(h,a){var b=a instanceof ma?a:new ma(a),c;$b.collect(this);
h.removeAttribute("mjs-app");b.$app=this;this.$super();this.lang=new Zb;this.scope=b;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",b.$root);this.value("$lang",this.lang);this.renderer=new Ua(h,b);c=ea.call(arguments);c[1]=b;this.initApp.apply(this,c)},initApp:G,run:function(){this.renderer.process()},createSource:function(h,a){var b="source-"+h;this.$$observable.getEvent(b)||this.$$observable.createEvent(b,
a||"nonempty")},registerSource:function(h,a,b){this.on("source-"+h,a,b)},collect:function(h){arguments[0]="source-"+arguments[0];return this.trigger.apply(this,arguments)},getParentCmp:function(h){h=h.parentNode;for(var a;h;){if(a=x(h,"cmp-id"))return this.getCmp(a);h=h.parentNode}return null},onAvailable:function(h,a,b){var c=this.cmpListeners,d=this.components;c[h]||(c[h]=new D);a&&c[h].done(a,b);d[h]&&c[h].resolve(d[h]);return c[h]},getCmp:function(h){return this.components[h]||null},registerCmp:function(h,
a,b){var c=this,d=h[b];b=function(){delete c.cmpListeners[d];delete c.components[d]};c.components[d]=h;c.cmpListeners[d]&&c.cmpListeners[d].resolve(h);if(h.on)h.on("destroy",b);a.$on("$destroy",b)},destroy:function(){this.renderer.$destroy();this.scope.$destroy();this.lang.destroy();this.$super()}});var Na=function(){return function a(b){if(b===window)return!0;if(3==b.nodeType)return b.parentElement?a(b.parentElement):!0;var c=window.document.documentElement;return b===c?!0:c.contains(b)}}(),I=function(){var h=
{};return function(a,b,c){a=a._mjsid||(a._mjsid=R());var d=h[a];return void 0!==c?(d||(d=h[a]={}),d[b]=c):d?d[b]:void 0}}(),cb=function a(b){var c,d,e;if(P(b)){e=[];c=0;for(d=b.length;c<d;c++)e.push(a(b[c]));return e}if(b)switch(b.nodeType){case 1:return b.cloneNode(!0);case 3:return window.document.createTextNode(b.innerText||b.textContent);case 11:return b.cloneNode(!0)}return null},Ca=function(){var a=["Moz","Webkit","ms","O","Khtml"],b="animationDelay",c="animationDuration",d="transitionDelay",
e="transitionDuration",f="transform",g=null,k=null,l=!1;return function(){if(!l){var m=window.document.createElement("div"),p=!1,q,n,u;if(void 0!==m.style.animationName)p=!0;else for(n=0,u=a.length;n<u;n++)if(q=a[n],void 0!==m.style[q+"AnimationName"]){p=!0;b=q+"AnimationDelay";c=q+"AnimationDuration";d=q+"TransitionDelay";e=q+"TransitionDuration";f=q+"Transform";break}p&&("ontransitionend"in window?g="transitionend":"onwebkittransitionend"in window&&(g="webkitTransitionEnd"));k=p?{animationDelay:b,
animationDuration:c,transitionDelay:d,transitionDuration:e,transform:f,transitionend:g}:{};l=!0}return k}}(),Eb=function(){var a=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},b=function(b,c,d){var e,f,g=c.length;for(e=0;e<g;e++)f=a(c[e])+a(d[e]),b=Math.max(f,b);return b},c=!1,d=null,e=null,f=null,g=null;return function(a){!1===c&&(d=(c=Ca())?c.animationDuration:null,e=c?c.animationDelay:null,f=c?c.transitionDuration:null,g=c?c.transitionDelay:null);if(!c)return 0;
var l=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var m=(l[d]||"").split(","),p=(l[e]||"").split(","),q=(l[f]||"").split(","),l=(l[g]||"").split(",");a=Math.max(a,b(a,m,p));return a=Math.max(a,b(a,q,l))}}(),Ka=function(){var a={};return function(b){return a[b]||(a[b]=new RegExp(b))}}(),ta=function(a){var b=I(a,"mjsAnimationQueue"),c,d;if(P(b)&&b.length){if(b=b[0])b.stages&&(c=b.position,d=b.stages,F(a,d[c]),F(a,d[c]+"-active")),b.deferred&&b.deferred.reject(b.el)}else A(b)?
b(a):"stop"==b&&$(a).stop(!0,!0);I(a,"mjsAnimationQueue",null)},H=function(){var a,b;if("undefined"!=typeof window){var c=window;a=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame;b=c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.webkitCancelRequestAnimationFrame;if(a)return function(c){var e=a(c);return function(){b(e)}}}return function(a){var b=setTimeout(a,0);return function(){clearTimeout(b)}}}(),V=function(){var a={show:["mjs-show"],
hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},b=0,c=!1,d=!1,e=function(a,b,c){var d=function(){(new Date).getTime()-b>=c?a():H(d)};H(d)},f=function(){!1===c&&(c=Ca(),d=!!c);return d},g=function m(a,b,c,d,f,k,v,r){var x=function(){var b=I(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==v?!1:(f.reject(a),!0)},y=function(){if(!x()){var d=c;c++;if(c==b.length){f.resolve(a);I(a,"mjsAnimationQueue").shift();var e=I(a,"mjsAnimationQueue");e.length?(e=e[0],g(e.el,e.stages,
0,e.start,e.deferred,!1,e.id,e.step)):I(a,"mjsAnimationQueue",null)}else I(a,"mjsAnimationQueue")[0].position=c,m(a,b,c,null,f,!1,v,r);F(a,b[d]);F(a,b[d]+"-active")}},K=function(){x()||(Q(a,b[c]+"-active"),D.resolve(r&&r(a,c,"active")).done(function(){if(!x()){var b=Eb(a);b?e(y,(new Date).getTime(),b):H(y)}}))},na=function(){x()||(Q(a,b[c]),D.waterfall([r&&r(a,c,"start"),function(){return d?d(a):null}]).done(function(){!x()&&H(K)}))};k?H(na):na()},k=function(c,d,e,k,u,s){var t=new D,r=I(c,"mjsAnimationQueue")||
[],z=++b,w=x(c,"mjs-animate"),ia,K,na,ba,E,Fb,jb;d=d||w;k&&null===w&&(d=null);if(d){y(d)?"["==d.substr(0,1)?ia=(new Function("","return "+d))():(ia=a[d],d=u&&u.get("animate."+d,!0)):A(d)?K=d:P(d)&&(y(d[0])?ia=d:(na=d[0],ba=d[1]));pa(d)&&(ia=d.stages,K=d.fn,na=d.before,ba=d.after,E=d.options?v({},d.options):{},Fb=d.context||null,jb=d.duration||null,e=e||E.start);if(f()&&ia)return r.push({el:c,stages:ia,start:e,step:s,deferred:t,position:0,id:z}),I(c,"mjsAnimationQueue",r),1==r.length&&g(c,ia,0,e,t,
!0,z,s),t;E=E||{};e&&(E.start=function(){e(c)});E.complete=function(){t.resolve(c)};jb&&(E.duration=jb);if(K&&A(K))return na&&v(c.style,na,!0,!1),e&&e(c),I(c,"mjsAnimationQueue",K.call(Fb,c,function(){t.resolve(c)})),t;if(window.jQuery){d=$(c);na&&d.css(na);I(c,"mjsAnimationQueue","stop");if(K&&y(K))return d[K](E),t;if(ba)return d.animate(ba,E),t}}e?(K=e(c),Z(K)?K.done(function(){t.resolve(c)}):t.resolve(c)):t.resolve(c);return t};k.addAnimationType=function(b,c){a[b]=c};k.stop=ta;k.getPrefixes=Ca;
k.getDuration=Eb;k.cssAnimationSupported=f;return k}(),ac=function(){return"undefined"!=typeof JSON?function(a){return JSON.parse(a)}:function(a){return(new Function("return "+a))()}}(),N=function(){var a=/^[\w[:#.][\w\]*^|=!]*$/,b=/=([^\]]+)/,c=/ *, */,d=/(\([^)]*)\+/,e=/(\[[^\]]+)~/,f=/(~|>|\+)/,g=/ +/,k=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,l=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,m=/\D/,p=/[^(]*\(([^)]*)\)/,q=/\(.*/,n=
/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,u=window.document,s=!!u.getElementsByClassName,t=!!u.querySelectorAll,v={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=a.nextSibling)&&1!=a.nodeType;);return!!a},root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,b){var c=a.nodeIndex||0,d=b[3]=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.firstChild;c++;do if(1==f.nodeType&&(f.nodeIndex=
++c)&&a===f&&(c+d)%e)return 0;while(f=f.nextSibling);return 1},"nth-last-child":function(a,b){var c=a.nodeIndexLast||0,d=b[3]?("%"===b[2]?-1:1)*b[3]:0,e=b[1];if(c)return!((c+d)%e);var f=a.parentNode.lastChild;c++;do if(1==f.nodeType&&(f.nodeLastIndex=c++)&&a===f&&(c+d)%e)return 0;while(f=f.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!=a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},
lang:function(a,b){return a.lang!==b&&u.documentElement.lang!==b},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},r={},y=function(a){return r[a]||(r[a]=new RegExp("(^| +)"+a+"($| +)"))},z={"":function(a,b){return null!==x(a,b)},"=":function(a,b,c){var d;return(d=x(a,b))&&d===c},"&=":function(a,b,c){var d;return(d=x(a,b))&&y(c).test(d)},"^=":function(a,b,c){var d;return(d=x(a,b)+"")&&!d.indexOf(c)},"$=":function(a,
b,c){var d;return(d=x(a,b)+"")&&d.indexOf(c)==d.length-c.length},"*=":function(a,b,c){var d;return(d=x(a,b)+"")&&-1!=d.indexOf(c)},"|=":function(a,b,c){var d;return(d=x(a,b)+"")&&(d===c||!!d.indexOf(c+"-"))},"!=":function(a,b,c){var d;return!(d=x(a,b))||!y(c).test(d)}},K=function(K,ba){ba=ba||u;var E=[],r=null,x,y,A,w,B,C,D;if(t)try{E=Y(ba.querySelectorAll(K.replace(b,'="$1"')))}catch(G){r=!0}if(!t||r)if(a.test(K))switch(r=0,K.charAt(0)){case "#":r=K.slice(1);E=u.getElementById(r);E.id!==r&&(E=u.all[r]);
E=E?[E]:[];break;case ".":x=K.slice(1);if(s)E=Y((E=ba.getElementsByClassName(x)).length?E:[]);else{x=" "+x+" ";y=ba.getElementsByTagName("*");for(A=0;w=y[A++];)-1!=(" "+w.className+" ").indexOf(x)&&(E[r++]=w);E=r?E:[]}break;case ":":y=ba.getElementsByTagName("*");A=0;B=K.replace(p,"$1");for(C=K.replace(q,"");w=y[A++];)v[C]&&!v[C](w,B)&&(E[r++]=w);E=r?E:[];break;case "[":y=ba.getElementsByTagName("*");A=0;w=n.exec(K);x=w[1];D=w[2]||"";for(B=w[3];w=y[A++];)z[D]&&(z[D](w,x,B)||"class"===x&&z[D](w,"className",
B))&&(E[r++]=w);E=r?E:[];break;default:E=Y((E=ba.getElementsByTagName(K)).length?E:[])}else{for(var I=K.split(c),N=I.length-1,P=!!N,Q,vb,O,ab,F,H,J,L,T,M,R,S;r=I[N--];){vb=(Q=r.replace(d,"$1%").replace(e,"$1&").replace(f," $1 ").split(g)).length;A=0;ab=" ";for(y=[ba];O=Q[A++];)if(" "!==O&&">"!==O&&"~"!==O&&"+"!==O&&y){O=O.match(k);F=O[1]||"*";H=O[2];J=O[3]?" "+O[3]+" ":"";x=O[4];D=O[5]||"";C=O[7];B="nth-child"===C||"nth-last-child"===C?l.exec("even"===O[8]&&"2n"||"odd"===O[8]&&"2n%1"||!m.test(O[8])&&
"0n%"+O[8]||O[8]):O[8];L=[];r=T=0;for(R=A==vb;M=y[T++];)switch(ab){case " ":S=M.getElementsByTagName(F);for(M=0;w=S[M++];)H&&w.id!==H||J&&-1==(" "+w.className+" ").indexOf(J)||!(!x||z[D]&&(z[D](w,x,O[6])||"class"===x&&z[D](w,"className",O[6])))||w.yeasss||(v[C]?v[C](w,B):C)||(R&&(w.yeasss=1),L[r++]=w);break;case "~":for(F=F.toLowerCase();(M=M.nextSibling)&&!M.yeasss;)1!=M.nodeType||"*"!==F&&M.nodeName.toLowerCase()!==F||H&&M.id!==H||J&&-1==(" "+M.className+" ").indexOf(J)||!(!x||z[D]&&(z[D](w,x,O[6])||
"class"===x&&z[D](w,"className",O[6])))||M.yeasss||(v[C]?v[C](M,B):C)||(R&&(M.yeasss=1),L[r++]=M);break;case "+":for(;(M=M.nextSibling)&&1!=M.nodeType;);!M||M.nodeName.toLowerCase()!==F.toLowerCase()&&"*"!==F||H&&M.id!==H||J&&-1==(" "+w.className+" ").indexOf(J)||!(!x||z[D]&&(z[D](w,x,O[6])||"class"===x&&z[D](w,"className",O[6])))||M.yeasss||(v[C]?v[C](M,B):C)||(R&&(M.yeasss=1),L[r++]=M);break;case ">":for(S=M.getElementsByTagName(F),A=0;w=S[A++];)w.parentNode!==M||H&&w.id!==H||J&&-1==(" "+w.className+
" ").indexOf(J)||!(!x||z[D]&&(z[D](w,x,O[6])||"class"===x&&z[D](w,"className",O[6])))||w.yeasss||(v[C]?v[C](w,B):C)||(R&&(w.yeasss=1),L[r++]=w)}y=L}else ab=O;if(P){if(!y.concat){L=[];for(M=0;w=y[M];)L[M++]=w;y=L}E=y.concat(1==E.length?E[0]:E)}else E=y}for(r=E.length;r--;)E[r].yeasss=E[r].nodeIndex=E[r].nodeIndexLast=null}return E};K.is=function(a,b){var c=K(b,a.parentNode),d,e;d=-1;for(e=c.length;++d<e;)if(c[d]===a)return!0;return!1};return K}(),La=function(a){if(a instanceof La)return a;if(!(this instanceof
La))return new La(a);for(var b in a)if(!this[b])try{this[b]=a[b]}catch(c){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var d,e=a.button;void 0===this.pageX&&null!==a.clientX&&(d=this.target?this.target.ownerDocument||window.document:window.document,b=d.documentElement,d=d.body,this.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0),this.pageY=a.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&
d.clientTop||0));this.which||void 0===e||(this.which=e&1?1:e&2?3:e&4?2:0);this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?Qa:xa;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};v(La.prototype,{isDefaultPrevented:xa,isPropagationStopped:xa,isImmediatePropagationStopped:xa,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Qa;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;
this.isPropagationStopped=Qa;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Qa;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}},!0,!1);var Gb=function(a){function b(){d=null}var c,d;a=function(a){return function(f){var g=S(f||window.event),k=ea.call(arguments,1),l=0,m=0,p=0,q=0,n=0,u=0;g.type="mousewheel";"detail"in g&&(p=-1*g.detail);"wheelDelta"in g&&(p=g.wheelDelta);"wheelDeltaY"in
g&&(p=g.wheelDeltaY);"wheelDeltaX"in g&&(m=-1*g.wheelDeltaX);"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(m=-1*p,p=0);l=0===p?m:p;"deltaY"in g&&(l=p=-1*g.deltaY);"deltaX"in g&&(m=g.deltaX,0===p&&(l=-1*m));if(0!==p||0!==m){q=Math.max(Math.abs(p),Math.abs(m));if(!d||q<d)d=q,"mousewheel"===g.type&&0===q%120&&(d/=40);"mousewheel"===g.type&&0===q%120&&(l/=40,m/=40,p/=40);l=Math[1<=l?"floor":"ceil"](l/d);m=Math[1<=m?"floor":"ceil"](m/d);p=Math[1<=p?"floor":"ceil"](p/d);this.getBoundingClientRect&&(q=this.getBoundingClientRect(),
n=g.clientX-q.left,u=g.clientY-q.top);g.deltaX=m;g.deltaY=p;g.deltaFactor=d;g.offsetX=n;g.offsetY=u;g.deltaMode=0;k.unshift(g,l,m,p);c&&clearTimeout(c);c=setTimeout(b,200);return a.apply(this,k)}}};a.events=function(){var a=window.document;return"onwheel"in a||9<=a.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]};return a}(),C=function(){var a=null,b=null;return function(c,d,e){null===a&&(a=c.attachEvent?"attachEvent":"addEventListener",b=c.attachEvent?"on":"");if("mousewheel"==
d){e=Gb(e);d=Gb.events();var f,g;f=0;for(g=d.length;f<g;f++)c[a](b+d[f],e,!1)}else c[a](b+d,e,!1);return e}}(),Va=function(){var a=/#.*$/,b=/([?&])_=[^&]*/,c=/\?/,d=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,e=/^(?:GET|HEAD)$/i,f=function(a,b,c){var d,e;if(wa(a)&&c)b.push(encodeURIComponent(c)+"="+encodeURIComponent(""+a));else if(P(a)&&c)for(d=0,e=a.length;d<e;d++)f(a[d],b,c+"["+d+"]");else if(Da(a))for(d in a)a.hasOwnProperty(d)&&f(a[d],b,c?c+"["+d+"]":d)},g=function(d,g){d.replace(a,
"");if(!1===g.cache){var k=(new Date).getTime();d=b.test(d)?d.replace(b,"$1_="+k):d+(c.test(d)?"&":"?")+"_="+k}!g.data||window.FormData&&g.data instanceof window.FormData||(y(g.data)?k=g.data:(k=[],f(g.data,k,null),k=k.join("&").replace(/%20/g,"+")),g.data=k,e.test(g.method)&&(d+=(c.test(d)?"&":"?")+g.data,g.data=null));return d},k={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},
l={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},m={},p=new ka,q=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):
b(a))},n=function(a,b,c){var d,e;if(!Da(a)&&!A(a)&&c)d=document.createElement("input"),d.setAttribute("type","hidden"),d.setAttribute("name",c),d.setAttribute("value",a),b.appendChild(d);else if(P(a)&&c)for(d=0,e=a.length;d<e;d++)n(a[d],b,c+"["+d+"]");else if(Da(a))for(d in a)a.hasOwnProperty(d)&&n(a[d],b,c?c+"["+d+"]":d)},u=function(a){for(var b,c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],null!==x(b,"name"))if(c="INPUT"===b.nodeName.toUpperCase()?x(b,"type").toUpperCase():"TEXT","FILE"===
c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},s=function(a,b,c){var d=b?b.dataType:null;b=b?b.selector:null;if(!y(a))return a;c=c||"";if("xml"===d||!d&&0<=c.indexOf("xml"))return a=tb(L(a)),b?N(b,a):a;if("html"===d)return a=tb(a,"text/html"),b?N(b,a):a;if("fragment"==d){c=document.createDocumentFragment();d=document.createElement("div");
for(d.innerHTML=a;d.firstChild;)c.appendChild(d.firstChild);return c}if("json"===d||!d&&0<=c.indexOf("json"))return ac(L(a));("script"===d||!d&&0<=c.indexOf("javascript"))&&q(a);return a+""},t=function(a){var b=d.exec((window?window.location.href:"").toLowerCase())||[],c=d.exec(a.url.toLowerCase());this._opt=a;!0!==a.crossDomain&&(a.crossDomain=!(!c||c[1]===b[1]&&c[2]===b[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(b[3]||("http:"===b[1]?"80":"443"))));b=new D;"iframe"!=a.transport||a.form?a.form&&
(this._form=a.form,"POST"!=a.method||window&&window.FormData||(a.transport="iframe")):(this.createForm(),a.form=this._form);a.form&&"iframe"!=a.transport&&(a.data="POST"==a.method?new FormData(a.form):u(a.form));a.url=g(a.url,a);c=!a.crossDomain&&"script"!=a.transport||a.form?"iframe"==a.transport?new ia(a,b,this):new z(a,b,this):new B(a,b,this);this._deferred=b;this._transport=c;b.done(function(a){p.trigger("success",a)});b.fail(function(a){p.trigger("error",a)});b.always(function(){p.trigger("end")});
p.trigger("start");a.timeout&&(this._timeout=setTimeout(r(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===p.trigger("before-send",a,c)&&(this._promise=D.reject());a.beforeSend&&!1===a.beforeSend.call(a.callbackScope,a,c)&&(this._promise=D.reject());this._promise||(fa(c.send,c),b.abort=r(this.abort,this),b.always(this.destroy,this),this._promise=b)};v(t.prototype,{_jsonpName:null,_transport:null,_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},
abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);n(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,b=a.jsonpParam||"callback",d=a.jsonpCallback||"jsonp_"+R();a.url+=(c.test(a.url)?"&":"?")+b+"="+d;this._jsonpName=d;"undefined"!=
typeof window&&(window[d]=r(this.jsonpCallback,this));"undefined"!=typeof global&&(global[d]=r(this.jsonpCallback,this));return d},jsonpCallback:function(a){var b;try{b=this.processResponseData(a)}catch(c){this._deferred?this._deferred.reject(c):X(c)}this._deferred&&this._deferred.resolve(b)},processResponseData:function(a,b){var c=this._opt;a=s(a,c,b);p.hasListener("process-response")&&(a=p.trigger("process-response",a,this._deferred));c.processResponse&&(a=c.processResponse.call(c.callbackScope,
a,this._deferred));return a},processResponse:function(a,b){var c=this._deferred,d;if(this._opt.jsonp)if(a){try{q(a)}catch(e){c.reject(e)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else{try{d=this.processResponseData(a,b)}catch(f){c.reject(f)}c.resolve(d)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.destroy();
this._form=this._timeout=this._promise=this._deferred=this._opt=this._transport=null;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},!0,!1);var w=function(a,b){b=b||{};a&&!y(a)?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=x(b.form,"action")),!b.url))throw"Must provide url";v(b,m,!1,!0);v(b,l,!1,!0);b.method=b.method?b.method.toUpperCase():b.form?x(b.form,"method").toUpperCase()||"GET":"GET";return(new t(b)).promise()};
w.setup=function(a){v(m,a,!0,!0)};w.on=function(){p.on.apply(p,arguments)};w.un=function(){p.un.apply(p,arguments)};w.get=function(a,b){b=b||{};b.method="GET";return w(a,b)};w.post=function(a,b){b=b||{};b.method="POST";return w(a,b)};w.load=function(a,b,c){c=c||{};y(b)||(c=b);c.dataType="fragment";return w(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};w.loadScript=function(a){return w(a,{transport:"script"})};w.submit=function(a,b){b=b||{};b.form=
a;return w(null,b)};var z=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&C(d,"progress",r(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&C(d.upload,"progress",r(a.uploadProgress,a.callbackScope));d.onreadystatechange=r(this.onReadyStateChange,this)};v(z.prototype,{_xhr:null,_deferred:null,
_ajax:null,setHeaders:function(){var a=this._opt,b=this._xhr,c;if(a.xhrFields)for(c in a.xhrFields)b[c]=a.xhrFields[c];a.data&&a.contentType&&b.setRequestHeader("Content-Type",a.contentType);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.setRequestHeader("Accept",a.dataType&&k[a.dataType]?k[a.dataType]+", */*; q=0.01":k._default);for(c in a.headers)b.setRequestHeader(c,a.headers[c])},onReadyStateChange:function(){var a=this._xhr,b=this._deferred;if(0===a.readyState)a.onreadystatechange=
G,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=G;var c;a:{try{c=!a.status&&location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse(y(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=G;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this.setHeaders(),
this._xhr.send(a.data)}catch(b){this._deferred&&this._deferred.reject(b)}},destroy:function(){this._ajax=this._opt=this._deferred=this._xhr=null}},!0,!1);var B=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};v(B.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);C(a,"load",r(this.onLoad,this));C(a,"error",r(this.onError,this));
document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);this._deferred=this._ajax=this._opt=this._el=null}},!0,!1);var ia=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};v(ia.prototype,{_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=
document.createElement("iframe"),b="frame-"+R(),c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);C(a,"load",r(this.onLoad,this));C(a,"error",r(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},onLoad:function(){var a=this._el;this._opt&&!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=a.body.innerHTML,this._ajax.processResponse(a))},
onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);this._deferred=this._ajax=this._opt=this._el=null}},!0,!1);return w}(),Fa=function(){var a=new ka,b=new yb,c=function(a){var c=b.get(a);"string"==typeof c&&(c=da(c),b.add(a,c));return c},d=function(a){return b.exists(a)?b.get(a):b.add(a,Va(a,{dataType:"fragment"}).then(function(c){return b.add(a,
c)}))};b.addFinder(function(a){a=window.document.getElementById(a);var b;if(a)return b=a.tagName.toLowerCase(),"script"==b?(b=window.document.createElement("div"),b.innerHTML=a.innerHTML,a.parentNode.removeChild(a),da(b.childNodes)):"content"in a?a.content:da(a.childNodes)});return w({$class:"Template",_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,_originalNode:null,_intendedShadow:!1,scope:null,node:null,tpl:null,url:null,ownRenderer:!1,initPromise:null,tplPromise:null,
parentRenderer:null,deferRendering:!1,replace:!1,shadow:!1,animationEnabled:!0,$init:function(b){v(this,b,!0,!1);window.document.documentElement.createShadowRoot||(this._intendedShadow=this.shadow,this.shadow=!1);this.id=R();a.createEvent("rendered-"+this.id,!1,!0);this.tpl&&(this.tpl=L(this.tpl));this.url&&(this.url=L(this.url));var c=this.node;b=this.tpl||this.url;c&&c.removeAttribute("mjs-include");this.shadow&&(this._originalNode=c,this.node=c=c.createShadowRoot());c||(this.deferRendering=!0);
if(b){if(c&&c.firstChild&&!this.shadow&&I(c,"mjs-transclude",da(c.childNodes)),"."==b.substr(0,1)?(c=b.substr(1,1),c=!("."==c||"/"==c)):c=!1,c&&(this._watcher=ha(this.scope,b,this.onChange,this,null,B)),this._watcher&&!this.replace?this.ownRenderer=!0:this.shadow?this.ownRenderer=!0:this.replace&&(this.ownRenderer=!1),this.resolveTemplate(),this._watcher&&this.replace&&(this._watcher.unsubscribeAndDestroy(this.onChange,this),this._watcher=null),this.deferRendering&&this.ownRenderer||this.tplPromise.done(this.applyTemplate,
this),this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this)}else!this.deferRendering&&this.ownRenderer&&this.doRender();this.scope.$on("destroy",this.onScopeDestroy,this)},setAnimation:function(a){this.animationEnabled=a},doRender:function(){this._renderer||(this._renderer=new Ua(this.node,this.scope),this._renderer.on("rendered",this.onRendered,this),this._renderer.process())},onRendered:function(){a.trigger("rendered-"+this.id,this)},on:function(b,
c,d){return a.on(b+"-"+this.id,c,d)},un:function(b,c,d){return a.un(b+"-"+this.id,c,d)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&this.node){this.deferRendering=!1;if(this.tplPromise)return this.tplPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():this.doRender()}return null},resolveTemplate:function(){var a=this,b=a.url,g=a._watcher?a._watcher.getLastResult():a.tpl||b;a._watcher&&!g&&(b=null);a.initPromise=new D;a.tplPromise=
new D;a.ownRenderer&&a.initPromise.resolve(!1);return(new D(function(a,e){g||b?b?a(c(g)||d(b)):a(c(g)||da(g)):e()})).done(function(b){a._fragment=b;a.tplPromise.resolve()}).fail(a.initPromise.reject,a.initPromise).fail(a.tplPromise.reject,a.tplPromise)},onChange:function(){this._renderer&&(this._renderer.$destroy(),this._renderer=null);this.resolveTemplate().done(this.applyTemplate,this)},doApplyTemplate:function(){for(var b=this.node;b.firstChild;)b.removeChild(b.firstChild);this._intendedShadow&&
this.makeTranscludes();if(this.replace){var c=cb(this._fragment),d=I(b,"mjs-transclude"),k=ea.call(c.childNodes);if(d){var l=N("[mjs-transclude], mjs-transclude",c);l.length&&I(l[0],"mjs-transclude",d)}b.parentNode.replaceChild(c,b);this.node=k;this.initPromise.resolve(k)}else b.appendChild(cb(this._fragment)),this.initPromise.resolve(this.node);a.trigger("before-render-"+this.id,this);this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new D;!this._initial&&this.animationEnabled?
(V(a,"leave",null,!0).done(this.doApplyTemplate,this).done(b.resolve,b),V(a,"enter",null,!0)):(this.doApplyTemplate(),b.resolve());this._initial=!1;return b},makeTranscludes:function(){var a=this._fragment,b=N("content",a),c,d,l,m,p,q;p=0;for(q=b.length;p<q;p++)l=window.document.createElement("mjs-transclude"),c=b[p],d=c.nextSibling,(m=x(c,"select"))&&l.setAttribute("select",m),a.removeChild(c),a.insertBefore(l,d)},onParentRendererDestroy:function(){this._renderer.$destroy();this.$destroy()},onScopeDestroy:function(){this.$destroy()},
destroy:function(){this.shadow&&this._originalNode.createShadowRoot();this._watcher&&this._watcher.unsubscribeAndDestroy(this.onChange,this)}},{cache:b})}(),bc=w({$class:"Component",$mixins:["mixin.Observable"],id:null,originalId:!1,node:null,cls:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,as:null,$init:function(a){a=a||{};this.$super(a);v(this,a,!0,!1);this.scope||(this.scope=new ma);this.as&&(this.scope[this.as]=
this);if(this.node){var b=x(this.node,"id");b&&(this.originalId=!0,this.id||(this.id=b))}this.id=this.id||"cmp-"+R();this.node||this._createNode();this.cls&&Q(this.node,this.cls);this.initComponent.apply(this,arguments);this.scope.$app&&this.scope.$app.registerCmp(this,this.scope,"id");var b=this.template,c=this.templateUrl;b&&b instanceof Fa?b instanceof Fa&&(this.template.node=this.node):this.template=b=new Fa({scope:this.scope,node:this.node,deferRendering:!b,ownRenderer:!0,tpl:b,url:c,shadow:this.constructor.$shadow,
animationEnabled:!this.hidden});this.template.on("rendered",this.onRenderingFinished,this);if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this._initElement();this.autoRender&&(b.initPromise?b.initPromise.done(this.render,this):this.render())},_createNode:function(){this.node=window.document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;this.originalId||a.setAttribute("id",this.id);a.setAttribute("cmp-id",this.id);this.hidden&&(a.style.display=
"none")},render:function(){this.rendered||(this.trigger("render",this),this.template.startRendering())},onRenderingFinished:function(){this.renderTo?this.renderTo.appendChild(this.node):Na(this.node)||window.document.body.appendChild(this.node);this.rendered=!0;this.afterRender();this.trigger("after-render",this)},show:function(){if(this.hidden){if(!1===this.trigger("before-show",this))return!1;this.rendered||this.render();this.template.setAnimation(!0);this.node.style.display="block";this.hidden=
!1;this.onShow();this.trigger("show",this)}},hide:function(){if(!this.hidden){if(!1===this.trigger("before-hide",this))return!1;this.template.setAnimation(!1);this.node.style.display="none";this.hidden=!0;this.onHide();this.trigger("hide",this)}},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},initComponent:G,afterRender:G,onShow:G,onHide:G,onParentRendererDestroy:function(){this.$destroy()},
destroy:function(){this.template&&this.template.$destroy();this.destroyEl?Na(this.node)&&this.node.parentNode.removeChild(this.node):(this.node.removeAttribute("cmp-id"),this.originalId||this.node.removeAttribute("id"),this.cls&&F(this.node,this.cls));this.destroyScope&&this.scope&&this.scope.$destroy();this.$super()}}),ca=function(a){a=a||{};this._queue=[];this._map={};this.id="$$"+R();for(var b in a)this[b]=a[b]};ca.REPLACE=1;ca.ONCE=2;ca.MULTIPLE=3;ca.ONCE_EVER=4;v(ca.prototype,{_queue:null,_map:null,
_nextRequested:!1,_running:!1,length:0,id:null,async:!0,auto:!0,thenable:!1,stack:!1,context:null,mode:ca.MULTIPLE,add:function(a,b,c,d,e,f){var g=this.id,k=a[g]||R();b={id:k,fn:a,context:b,args:c,async:f};d=d||this.mode;if(d==ca.ONCE_EVER&&a[g])return a[g];a[g]=k;if(this._map[k])if(d==ca.REPLACE)this.remove(k);else if(d==ca.ONCE)return k;this._queue[e?"unshift":"push"](b);this._map[k]=b;this.length=this._queue.length;this.auto&&this.next();return k},append:function(a,b,c,d,e){return this.add(a,b,
c,d,!1,e)},prepend:function(a,b,c,d,e){return this.add(a,b,c,d,!0,e)},remove:function(a){var b=this._queue,c,d;c=0;for(d=b.length;c<d;c++)if(b[c].id==a){b.splice(c,1);break}delete this._map[a]},isEmpty:function(){return 0==this.length},next:function(){var a=this,b;if(a._running)a._nextRequested=!0;else if(a._nextRequested=!1,b=a._queue[a.stack?"pop":"shift"](),a.length=a._queue.length,b)if(a._running=!0,delete a._map[b.id],a.async||b.async){var c=0;1===W(b.async)?c=b.async:1===W(a.async)&&(c=a.async);
var d=function(){try{a._processResult(b.fn.apply(b.context||a.context,b.args||[]))}catch(c){throw X(c),a._finish(),c;}};"raf"==b.async||!b.async&&"raf"==a.async?H(d):fa(d,null,null,c)}else try{a._processResult(b.fn.apply(b.context||a.context,b.args||[]))}catch(e){throw X(e),a._finish(),e;}},_processResult:function(a){var b=this;b.thenable&&Z(a)?a.then(function(){b._finish()},function(){b._finish()}):b._finish();return a},_finish:function(){this._running=!1;(this.auto||this._nextRequested)&&this.next()},
destroy:function(){this.context=this._map=this._queue=null;this._running=this._nextRequested=!1;this.next=G}},!0,!1);var Pb=/-./g,Qb=function(){return function(a){if(a.dataset)return a.dataset;var b;if(void 0!==(b=I(a,"data")))return b;b=a.attributes;var c={},d,e,f;d=0;for(e=b.length;d<e;d++)f=b[d].name,0===f.indexOf("data-")&&(c[Ob(f.substr(5))]=b[d].value);b=c;I(a,"data",b);return b}}(),kb=w({$class:"ListRenderer",id:null,model:null,itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,
nextEl:null,trackBy:null,trackByWatcher:null,animateMove:!1,animate:!1,trackByFn:null,griDelegate:null,tagMode:!1,queue:null,buffered:!1,bufferPlugin:null,$constructor:function(a,b,c){a=U(b,a);this.tagMode="mjs-each"==b.nodeName.toLowerCase();this.animateMove=!this.tagMode&&!a.buffered&&a.animateMove&&V.cssAnimationSupported();this.animate=!this.tagMode&&!a.buffered&&(null!==x(b,"mjs-animate")||a.animate);this.id=a.id||R();b.removeAttribute("mjs-animate");this.animate&&this.animateMove&&this.$plugins.push("plugin.ListAnimatedMove");
a.observable&&this.$plugins.push("plugin.Observable");this.tagMode&&(a.buffered=!1);a.buffered&&(this.buffered=!0,this.$plugins.push("plugin.ListBuffered"))},$init:function(a,b,c){this.tagMode&&(c=x(b,"value"));this.parseExpr(c);this.tpl=this.tagMode?da(b.childNodes):b;this.renderers=[];this.prevEl=b.previousSibling;this.nextEl=b.nextSibling;this.parentEl=b.parentNode;this.node=null;this.scope=a;this.queue=new ca({async:!1,auto:!0,thenable:!0,stack:!1,context:this,mode:ca.ONCE});this.parentEl.removeChild(b);
this.afterInit(a,b);this.queue.add(this.render,this,[Y(this.watcher.getLastResult())])},afterInit:function(a,b){var c=U(b,a);this.watcher=ha(a,this.model,this.onChange,this,null,B);(this.trackBy=c.trackBy)&&"$"!=this.trackBy?this.trackByWatcher=ha(a,this.trackBy,this.onChangeTrackBy,this,null,B):"$"==this.trackBy||this.watcher.hasInputPipes()||(this.trackBy="$$"+this.watcher.id);this.griDelegate=r(this.scopeGetRawIndex,this)},trigger:G,render:function(a){var b=this.renderers,c=this.tpl,d=this.parentEl,
e=this.nextEl,f=this.buffered,g=window.document.createDocumentFragment(),k,l,m;l=0;for(m=a.length;l<m;l++)k=c.cloneNode(!0),b.push(this.createItem(k,a,l)),f||(g.appendChild(k),b[l].attached=!0);f?(this.bufferPlugin.getScrollOffset(),this.bufferPlugin.updateScrollBuffer()):(d.insertBefore(g,e),this.doUpdate());this.trigger("render",this)},doUpdate:function(a,b,c,d){var e=this.renderers;a=a||0;var f=e.length;b=b||f-1;var g=this.watcher.getLastResult(),k=this.getTrackByFunction();for(b>f-1&&(b=f-1);a<=
b;a++)c&&e[a].action!=c||this.renderItem(a,e,g,k,d)},renderItem:function(a,b,c,d,e){c=c||this.watcher.getLastResult();b=b||this.renderers;d=d||this.getTrackByFunction();var f=b[a],g=f.scope;b=b.length-1;var k=!(a%2);e&&f.rendered||(g.$index=a,g.$first=0===a,g.$last=a===b,g.$even=k,g.$odd=!k,g.$trackId=d(c[a]),g.$getRawIndex=this.griDelegate,f.renderer?g.$check():(f.renderer=new Ua(f.el,g),f.renderer.process(),f.rendered=!0))},createItem:function(a,b,c){var d=this.itemName,e=this.scope.$new(),f=this.tagMode;
e[d]=this.getListItem(b,c);a=f?Y(a.childNodes):a;return{index:c,action:"enter",el:a,firstEl:f?a[0]:a,lastEl:f?a[a.length-1]:a,scope:e,attached:!1,rendered:!1}},onChange:function(a,b){this.queue.prepend(this.applyChanges,this,[b],ca.REPLACE)},applyChanges:function(a){var b=this,c=b.renderers,d=b.tpl,e=0,f=Y(b.watcher.getLastResult()),g=null,k=b.animateMove,l=b.animate,m=[],p=b.itemName,q=c.slice(),n=!1,u,s,t,v,r,w;a=b.watcher.getMovePrescription(a,b.getTrackByFunction(),f);t=0;for(v=a.length;t<v;t++)u=
a[t],1===W(u)?(s=u,u=c[s],s!=e&&null===g&&(g=t),u.action="move",u.scope[p]=b.getListItem(f,t),n=k,m.push(u),c[s]=null,e++):(null===g&&(g=t),r=b.createItem(d.cloneNode(!0),f,t),m.push(r));b.renderers=m;if(l){b.doUpdate(g,null,"enter");n&&(w=b.calculateTranslates(m,q,c));var d=[],x=new D,K=new D,y=new D,z=D.counter(m.length),e=function(){z.countdown();return x};t=0;for(v=c.length;t<v;t++)if(r=c[t])r.scope.$destroy(),ta(r.el),d.push(V(r.el,"leave",null,!1,B).done(function(a){a.style.visibility="hidden"}));
t=0;for(v=m.length;t<v;t++)r=m[t],ta(r.el),"enter"==r.action?d.push(V(r.el,"enter",e,!1,B)):d.push(b.moveAnimation(r.el,n?w[t][0]:null,n?w[t][1]:null,e,K));z.done(function(){H(function(){K.resolve();b.applyDomPositions(c);n||b.doUpdate(g,null,"move");H(function(){x.resolve()});b.trigger("change",b)})});D.all(d).always(function(){H(function(){var a=Ca();b.doUpdate(g||0);b.removeOldElements(c);if(n)for(b.doUpdate(g,null,"move"),t=0,v=m.length;t<v;t++)r=m[t],r.el.style[a.transform]=null,r.el.style[a.transform]=
"";y.resolve()})});return y}b.buffered?(b.bufferPlugin.getScrollOffset(),b.removeOldElements(c),b.queue.append(b.bufferPlugin.updateScrollBuffer,b.bufferPlugin,[!0])):(b.applyDomPositions(),b.doUpdate(g||0),b.removeOldElements(c));b.trigger("change",b)},removeOldElements:function(a){var b,c,d,e,f,g=this.parentEl;b=0;for(c=a.length;b<c;b++){if((d=a[b])&&d.attached)if(d.attached=!1,self.tagMode)for(e=0,f=d.el.length;e<f;e++)g.removeChild(d.el[e]);else g.removeChild(d.el);d&&d.scope&&d.scope.$destroy()}},
applyDomPositions:function(a){var b=this.renderers,c=this.parentEl,d=this.prevEl,e=this.tagMode,d=d?d.nextSibling:c.firstChild,f,g,k,l,m;g=0;for(k=b.length;g<k;g++)m=b[g],l=m.el,f=a&&a[g]?a[g].lastEl.nextSibling:0<g?b[g-1].lastEl.nextSibling||d:d,m.firstEl!==f&&(f&&m.lastEl.nextSibling!==f?c.insertBefore(e?da(l):l,f):f||c.appendChild(e?da(l):l)),m.attached=!0},getListItem:function(a,b){return a[b]},onChangeTrackBy:function(a){this.trackByFn=null;this.trackBy=a},getTrackByFunction:function(){var a;
this.trackByFn||((a=this.trackBy)&&"$"!=a?A(a)?this.trackByFn=a:this.trackByFn=function(b){return b&&!wa(b)?b[a]:void 0}:this.trackByFn=function(a){return wa(a)?a:void 0});return this.trackByFn},scopeGetRawIndex:function(a){if(void 0===a)return-1;var b=this.watcher.getUnfilteredValue(),c=this.getTrackByFunction(),d,e;d=0;for(e=b.length;d<e;d++)if(c(b[d])===a)return d;return-1},getNodePositions:function(a,b,c){return{}},calculateTranslates:function(a,b,c){return[]},moveAnimation:function(a,b,c,d,e){return V(a,
"move",d,!1,B)},scrollTo:function(){},parseExpr:function(a){a=a.split(" ");var b,c,d,e,f;b=0;for(c=a.length;b<c;b++)if(f=a[b],""!=f&&"in"!=f)if(e){d=a.slice(b).join(" ");break}else e=f;this.model=d;this.itemName=e||"item"},destroy:function(){var a=this.renderers,b,c;b=0;for(c=a.length;b<c;b++)a[b].renderer.$destroy();this.trackByWatcher&&this.trackByWatcher.unsubscribeAndDestroy();this.queue.destroy();this.watcher.unsubscribeAndDestroy(this.onChange,this)}},{$stopRenderer:!0,$registerBy:"id"}),cc=
/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,Ha=function(a){var b=a.match(cc)||[],c=("undefined"!=typeof window?window.location:null)||{};return{protocol:b[4]||c.protocol||"http:",hostname:b[11]||c.hostname||"",host:(b[11]||"")+(b[12]?":"+b[12]:"")||c.host||"",username:b[8]||c.username||"",password:b[9]||c.password||"",port:parseInt(b[12],10)||c.port||"",href:a,path:(b[13]||
"/")+(b[16]||""),pathname:b[13]||"/",search:b[16]||"",hash:b[17]&&"#"!=b[17]?b[17]:""}},lb=function(a,b){var c="";b=b||{};b.onlyPath||(c+=a.protocol+"//",a.username&&a.password&&(c+=a.username+":"+a.password+"@"),c+=a.hostname,a.hostname&&a.port&&(c+=":"+a.port));b.onlyHost||(c+=a.pathname||"/",a.search&&"?"!=a.search&&(c+=a.search),a.hash&&"#"!=a.hash&&(c+=a.hash));return c},Ia=function(){var a,b,c,d=new ka,e,f,g="undefined"==typeof window,k=null,l,m,p;d.createEvent("before-location-change",!1);
var q=function(a,b){"string"==typeof a&&(a=Ha(a));"string"==typeof b&&(b=Ha(b));var c=["protocol","host","port"],d,e,f;d=0;for(e=c.length;d<e;d++)if(f=c[d],a[f]&&b[f]&&a[f]!=b[f])return!0;return!1},n=function(a,b){"string"==typeof a&&(a=Ha(a));"string"==typeof b&&(b=Ha(b));return q(a,b)||a.pathname!=b.pathname||a.search!=b.search||a.hash!=b.hash},u=function(a){a=Ha(a);if(!l||p)a.hash="#!"+encodeURIComponent(a.path),a.pathname="/",a.search="";return lb(a,{onlyPath:!0})},s=function(a){c.hash=a?"!"+
a:""},t=function(){var a,b;l?a=lb(c):(a=c.hash.substr(1),b=v({},c,!0,!1),a&&("!"==a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a).split("?"),b.pathname=a[0],b.search=a[1]?"?"+a[1]:""),a=lb(b));return a},r=function(a){k=v({},c,!0,!1);y("location-change",a)},w=function(){if(n(k,c)){var a=t();k=v({},c,!0,!1);y("location-change",a)}},y=function(a,b){var c=b||t();return d.trigger(a,c)},z=function(){a=window;b=a.history;c=a.location;l=!!b.pushState;m="onhashchange"in a;p=l&&(navigator.vendor||"").match(/Opera/);
k=v({},c,!0,!1);if(l)C(a,"popstate",w),e=function(a){if(!1===y("before-location-change",a))return!1;b.pushState(null,null,u(a));r(a)},f=function(a){if(!1===y("before-location-change",a))return!1;b.replaceState(null,null,u(a));r(a)};else if(m)f=e=function(a){if(!1===y("before-location-change",a))return!1;fa(s,null,[u(a)])},C(a,"hashchange",w);else{var d=null,t=!1;a.onIframeHistoryChange=function(a){t||fa(function(){s(a);w()})};var A=function(a){var b=d.contentWindow.document;b.open();b.write("<html><head><title>"+
document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');b.close()};e=function(a){if(!1===y("before-location-change",a))return!1;A(u(a))};f=function(a){if(!1===y("before-location-change",a))return!1;a=u(a);d.contentWindow.hashValue=a};var B=function(){d=window.document.createElement("iframe");d.src="about:blank";d.style.display="none";window.document.body.appendChild(d);t=!0;A(u(c.hash.substr(1)));
t=!1};g?B():C(a,"load",B)}C(window.document.documentElement,"click",function(b){b=S(b||a.event);for(var d=b.target,f;d&&"a"!=d.nodeName.toLowerCase();)d=d.parentNode;if(d&&!b.isDefaultPrevented()){f=x(d,"href");if("#"==f)return b.preventDefault(),b.stopPropagation(),!1;if(f&&"#"!=f.substr(0,1)&&!x(d,"target")){var d=v({},c,!0,!1),g=Ha(f);if(q(d,g))return null;n(d,g)&&e(f);b.preventDefault();b.stopPropagation();return!1}}return null});z=G};C(window,"load",function(){g=!0});return v({},d.getApi(),{push:function(a){z();
b.pushState(null,null,a)},replace:function(a){z();b.replaceState(null,null,a)},current:function(){z();return t()},init:function(){return z()},polyfill:function(){z();window.history.pushState=function(a,b,c){e(c)};window.history.replaceState=function(a,b,c){f(c)}}})}(),Hb=Ia.current,dc=function(){var a={},b=w({$mixins:["mixin.Observable"],extractor:null,context:null,regexp:null,valueIndex:1,prev:null,value:null,enabled:!0,$init:function(a){v(this,a,!0,!1);this.regexp&&y(this.regexp)&&(this.regexp=
Ka(this.regexp));!this.name||this.regexp||this.extractor||(this.regexp=Ka(this.name+"=([^&]+)"));if(!this.regexp&&!this.extractor)throw"Invalid UrlParam config, missing regexp or extractor";this.enabled&&(this.enabled=!1,this.enable())},enable:function(){this.enabled||(this.enabled=!0,Ia.on("location-change",this.onLocationChange,this),this.onLocationChange(Hb()))},disable:function(){this.enabled&&(this.enabled=!1,Ia.un("location-change",this.onLocationChange,this))},onLocationChange:function(a){a=
this.extractValue(a);this.value!=a&&(this.prev=this.value,this.value=a,this.trigger("change",a,this.prev))},extractValue:function(a){if(this.regexp)return(a=a.match(this.regexp))?a[this.valueIndex]:null;if(this.extractor)return this.extractor.call(this.context,a)},getValue:function(){return this.value},getPrev:function(){return this.prev},destroyIfIdle:function(){this.$$observable.hasListener()||this.$destroy()},destroy:function(){this.disable()}},{get:function(c){return c.id&&a[c.id]?a[c.id]:new b(c)}});
return b}();w({$class:"View",route:null,node:null,scope:null,cmp:null,id:null,currentViewId:null,currentComponent:null,cmpCache:null,domCache:null,currentView:null,watchable:null,defaultCmp:null,currentCls:null,currentHtmlCls:null,scrollOnChange:!0,$init:function(a){v(this,a,!0,!1);a=this.node;var b=U(a,this.scope);v(this,b,!0,!1);a&&a.firstChild&&I(a,"mjs-transclude",da(a.childNodes));this.id||(this.id=R());this.cmpCache={};this.domCache={};this.initView();this.scope.$app.registerCmp(this,this.scope,
"id");this.route?(Ia.init(),Ia.on("location-change",this.onLocationChange,this),this.initRoutes(),this.onLocationChange()):this.cmp&&(this.watchable=ha(this.scope,this.cmp,this.onCmpChange,this,null,B),this.onCmpChange())},initView:function(){},initRoutes:function(){var a=this.route,b,c,d,e,f,g,k;e=0;for(f=a.length;e<f;e++)if(d=a[e],d.id=d.id||R(),d.params){b={};g=0;for(k=d.params.length;g<k;g++)c=d.params[g],c.name&&(b[c.name]=new dc(v({},c,{enabled:!1},!0,!1)));d.params=b}},onCmpChange:function(){var a=
this.watchable.getLastResult()||this.defaultCmp;a?this.setComponent(a):this.defaultCmp&&this.setComponent(this.defaultCmp)},onLocationChange:function(){var a=Hb(),b=this.route,c,d,e,f,g;d=0;for(e=b.length;d<e;d++){f=b[d];if(f.reg&&(g=a.match(f.reg))){this.setRouteComponent(f,g);return}f["default"]&&!c&&(c=f)}c?this.setRouteComponent(c,[]):this.defaultCmp&&this.setComponent(this.defaultCmp)},clearComponent:function(){var a=this,b=a.node,c=a.currentView||{};a.currentCls&&F(a.node,a.currentCls);a.currentHtmlCls&&
F(window.document.documentElement,a.currentHtmlCls);a.currentComponent&&V(b,"leave",null,!0).done(function(){if(c.keepAlive)for(var d=a.domCache[c.id];b.firstChild;)d.appendChild(b.firstChild);else for(a.currentComponent.destroy();b.firstChild;)b.removeChild(b.firstChild);a.currentComponent=null})},toggleRouteParams:function(a,b){if(a.params)for(var c in a.params)a.params[c][b]()},setRouteClasses:function(a){a.cls&&(this.currentCls=a.cls,Q(this.node,a.cls));a.htmlCls&&(this.currentHtmlCls=a.htmlCls,
Q(window.document.documentElement,a.htmlCls))},setRouteComponent:function(a,b){var c=this,d=c.node,e=a.params,f=c.currentView||{};a.id!=f.id&&(c.beforeRouteCmpChange(a),c.toggleRouteParams(f,"disable"),c.toggleRouteParams(a,"enable"),ta(c.node),c.clearComponent(),c.setRouteClasses(a),c.currentView=a,V(d,"enter",function(){var f=b||[],k={destroyEl:!1,node:d,scope:a.$isolateScope?c.scope.$newIsolated():c.scope.$new()};a.as&&(k.as=a.as);a.template&&(k.template=a.template);f.shift();e&&v(k,e,!1,!1);if(c.cmpCache[a.id])c.currentComponent=
c.cmpCache[a.id],d.appendChild(c.domCache[a.id]),c.afterRouteCmpChange(),c.afterCmpChange();else return Ma(a.cmp||"MetaphorJs.Component",k,k.scope,d,null,f).done(function(b){c.currentComponent=b;a.keepAlive&&(c.cmpCache[a.id]=b,c.domCache[a.id]=window.document.createDocumentFragment());c.afterRouteCmpChange();c.afterCmpChange()})},!0))},setComponent:function(a){var b=this,c=b.node;b.beforeCmpChange(a);ta(b.node);b.clearComponent();b.currentView=null;V(c,"enter",function(){var d=Da(a)?a:{},e=(y(a)?
a:null)||"MetaphorJs.Component",f=d.scope||b.scope.$new();d.destroyEl=!1;return Ma(e,d,f,c).done(function(a){b.currentComponent=a;b.afterCmpChange()})},!0)},beforeRouteCmpChange:function(a){},afterRouteCmpChange:function(){},beforeCmpChange:function(a){},afterCmpChange:function(){var a=this;a.scrollOnChange&&H(function(){a.node.scrollTop=0})},destroy:function(){this.clearComponent();if(this.route){Ia.un("location-change",this.onLocationChange,this);var a,b,c;a=0;for(b=this.route.length;a<b;a++)if(this.route[a].params)for(c in this.route[a].params)this.route[a].params[c].$destroy();
this.route=null}this.watchable&&(this.watchable.unsubscribeAndDestroy(this.onCmpChange,this),this.watchable=null);this.currentComponent=this.scope=null;this.$super()}});z.registerAttribute("mjs-app",100,xa);var ua=function(){var a=/\r/,b={option:function(a){var b=a.getAttribute("value")||a.value;return void 0!=b?b:L(a.innerText||a.textContent)},select:function(a){for(var b,e=a.options,f=a.selectedIndex,g=(a="select-one"===a.type||0>f)?null:[],k=a?f+1:e.length,l,m=0>f?k:a?f:0;m<k;m++)if(b=e[m],l=b.disabled||
b.parentNode.disabled,(b.selected||m===f)&&!l){b=ua(b);if(a)return b;g.push(b)}return g},radio:function(a){return $a(a.getAttribute("value"))?"on":a.value},checkbox:function(a){return $a(a.getAttribute("value"))?"on":a.value}};return function(c){var d,e;if((d=b[c.type]||b[c.nodeName.toLowerCase()])&&void 0!==(e=d(c,"value")))return e;e=c.value;return y(e)?e.replace(a,""):null==e?"":e}}(),mb=function(){var a={select:function(a,c){for(var d,e,f=a.options,g=Y(c),k=f.length,l,m=-1;k--;)e=f[k],(l=g?-1!=
Ta.call(g,e.value):!1)?(e.setAttribute("selected","selected"),d=e.selected=!0):e.removeAttribute("selected"),l||$a(x(e,"mjs-default-option"))||(m=k);d||(a.selectedIndex=m);return g}};a.radio=a.checkbox=function(a,c){if(P(c)){var d;d=ua(a);d=c?-1!=Ta.call(c,d):!1;return a.checked=d}};return function(b,c){if(1===b.nodeType){null===c?c="":1===W(c)&&(c+="");var d=a[b.type]||a[b.nodeName.toLowerCase()];d&&void 0!==d(b,c,"value")||(b.value=c)}}}(),T=function(){var a=null,b=null;return function(c,d,e){null===
a&&(a=c.detachEvent?"detachEvent":"removeEventListener",b=c.detachEvent?"on":"");c[a](b+d,e)}}(),ec=function(){var a=null;return function(){null===a&&(a=parseInt((/android (\d+)/i.exec(navigator.userAgent)||[])[1],10)||!1);return a}}(),Wa=function(){var a;return function(){if(null===a){var b=navigator.userAgent;a=parseInt((/msie (\d+)/i.exec(b)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/i.exec(b)||[])[1],10)||!1)}return a}}(),Ib=function(){var a={},b;return function(c){if(void 0===
a[c]){if("input"==c&&9==Wa())return a[c]=!1;b||(b=window.document.createElement("div"));a[c]=!!("on"+c in b)}return a[c]}}(),ga=function(a,b,c){if(a.$$input){if(b)a.$$input.on("change",b,c);return a.$$input}var d=U(a);this.observable=new ka;this.el=a;this.inputType=a.type.toLowerCase();this.dataType=d.type||this.inputType;this.listeners=[];if(b)this.onChange(b,c)};v(ga.prototype,{el:null,inputType:null,dataType:null,listeners:null,radio:null,keydownDelegate:null,changeInitialized:!1,destroy:function(){var a;
this.observable.destroy();this._addOrRemoveListeners(T,!0);this.el.$$input=null;for(a in this)this.hasOwnProperty(a)&&(this[a]=null)},_addOrRemoveListeners:function(a,b){var c=this.inputType,d=this.listeners,e=this.radio,f=this.el,g,k,l,m;k=0;for(l=d.length;k<l;k++)if(g=!!d[k][2],g==b){if("radio"==c)for(g=0,m=e.length;g<m;g++)a(e[g],d[k][0],d[k][1]);else a(f,d[k][0],d[k][1]);d[k][2]=!b}},initInputChange:function(){var a=this.inputType;"radio"==a?this.initRadioInput():"checkbox"==a?this.initCheckboxInput():
this.initTextInput();this._addOrRemoveListeners(C,!1);this.changeInitialized=!0},initRadioInput:function(){var a=this.el,b=a.name;if(Na(a))a=a.ownerDocument;else for(;a.parentNode;)a=a.parentNode;this.radio=N("input[name="+b+"]",a);this.onRadioInputChangeDelegate=r(this.onRadioInputChange,this);this.listeners.push(["click",this.onRadioInputChangeDelegate,!1])},initCheckboxInput:function(){this.onCheckboxInputChangeDelegate=r(this.onCheckboxInputChange,this);this.listeners.push(["click",this.onCheckboxInputChangeDelegate,
!1])},initTextInput:function(){var a=!1,b=this,c=b.listeners,d;ec()||(c.push(["compositionstart",function(){a=!0},!1]),c.push(["compositionend",function(){a=!1;e()},!1]));var e=b.onTextInputChangeDelegate=function(){if(!a)b.onTextInputChange()},f=function(a){d||(d=setTimeout(function(){e(a);d=null},0))},g=function(a){a=a||window.event;var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||f(a)};Ib("input")?c.push(["input",e,!1]):(c.push(["keydown",g,!1]),Ib("paste")&&(c.push(["paste",f,!1]),c.push(["cut",
f,!1])));c.push(["change",e,!1])},processValue:function(a){switch(this.dataType){case "number":a=parseInt(a,10);isNaN(a)&&(a=0);break;case "bool":case "boolean":return!("false"===a||"0"===a||0===a||"off"===a||!1===a||""===a)}return a},onTextInputChange:function(){var a=this.getValue();this.observable.trigger("change",this.processValue(a))},onCheckboxInputChange:function(){var a=this.el;this.observable.trigger("change",this.processValue(a.checked?x(a,"value")||!0:!1))},onRadioInputChange:function(a){a=
a||window.event;this.observable.trigger("change",this.processValue((a.target||a.srcElement).value))},setValue:function(a){var b=this.inputType,c,d;a=this.processValue(a);if("radio"==b)for(b=this.radio,c=0,d=b.length;c<d;c++)b[c].checked=this.processValue(b[c].value)==a;else"checkbox"==b?(b=this.el,b.checked=!0===a||a==this.processValue(b.value)):mb(this.el,a)},getValue:function(){var a=this.inputType,b,c;if("radio"==a){a=this.radio;b=0;for(c=a.length;b<c;b++)if(a[b].checked)return this.processValue(a[b].value);
return null}return"checkbox"==a?this.processValue(this.el.checked?x(this.el,"value")||!0:!1):this.processValue(ua(this.el))},onChange:function(a,b){this.changeInitialized||this.initInputChange();this.observable.on("change",a,b)},unChange:function(a,b){this.observable.un("change",a,b)},onKey:function(a,b,c){this.keydownDelegate||(this.keydownDelegate=r(this.keyHandler,this),this.listeners.push(["keydown",this.keydownDelegate,!1]),C(this.el,"keydown",this.keydownDelegate),this.observable.createEvent("key",
!1,!1,this.keyEventFilter));this.observable.on("key",b,c,{key:a})},unKey:function(a,b,c){this.observable.un("key",b,c)},keyEventFilter:function(a,b){var c=a.key,d=b[0];return"object"!=typeof c?c==d.keyCode:void 0!==c.ctrlKey&&c.ctrlKey!=d.ctrlKey||void 0!==c.shiftKey&&c.shiftKey!=d.shiftKey?!1:!(void 0!==c.keyCode&&c.keyCode!=d.keyCode)},keyHandler:function(a){a=S(a||window.event);this.observable.trigger("key",a)}},!0,!1);ga.get=function(a){return a.$$input?a.$$input:new ga(a)};ga.getValue=ua;ga.setValue=
mb;z.registerAttribute("mjs-bind",1E3,w({$extends:z,isInput:!1,input:null,lockInput:null,recursive:!1,textRenderer:null,$init:function(a,b,c){var d=U(b,a);this.isInput=bb(b);this.recursive=d.recursive||null!==x(b,"mjs-recursive");this.lockInput=d.lockInput;b.removeAttribute("mjs-recursive");this.isInput&&(this.input=new ga(b,this.onInputChange,this));this.recursive?(this.scope=a,this.node=b,this.textRenderer=new Db(a,"{{"+c+"}}",null,null,!0),this.textRenderer.subscribe(this.onTextRendererChange,
this),this.onTextRendererChange(),a instanceof ma&&a.$on("destroy",this.onScopeDestroy,this)):this.$super(a,b,c)},onInputChange:function(){if(this.lockInput)this.onChange()},onTextRendererChange:function(){this.updateElement(this.textRenderer.getString())},onChange:function(){var a=this.watcher.getLastResult();this.updateElement(a)},updateElement:function(a){this.isInput?this.input.setValue(a):this.node["string"==typeof this.node.textContent?"textContent":"innerText"]=a},destroy:function(){this.textRenderer&&
(this.textRenderer.$destroy(),this.textRenderer=null);this.input&&(this.input.destroy(),this.input=null);this.$super()}}));z.registerAttribute("mjs-bind-html",1E3,w({$extends:"attr.mjs-bind",updateElement:function(a){this.node.innerHTML=a}}));z.registerAttribute("mjs-break-if",500,function(a,b,c){(a=!!aa(c)(a))&&b.parentNode.removeChild(b);return!a});(function(){var a=function(a,b,e,f){if(null!==e){if(e==Pa(a,b))return;e=!e}else e=Pa(a,b);e?f?V(a,[b+"-remove"],null,!0).done(function(){F(a,b)}):F(a,
b):f?V(a,[b+"-add"],null,!0).done(function(){Q(a,b)}):Q(a,b)},b=function(a){var b={},e,f,g;if(!a)return b;if(y(a))b[a]=!0;else if(P(a))for(e=-1,g=a.length;++e<g;b[a[e]]=!0);else for(e in a)if("_"==e)for(f=-1,g=a._.length;++f<g;b[a._[f]]=!0);else b[e]=a[e];return b};z.registerAttribute("mjs-class",1E3,w({$extends:z,initial:!0,onChange:function(){var c=this.node,d=b(this.watcher.getLastResult()),e=b(this.watcher.getPrevValue()),f;ta(c);for(f in e)e.hasOwnProperty(f)&&void 0===d[f]&&a(c,f,!1,!1);for(f in d)d.hasOwnProperty(f)&&
a(c,f,d[f]?!0:!1,!this.initial);this.initial=!1}}))})();z.registerAttribute("mjs-cmp-prop",200,["$parentCmp","$node","$attrValue",function(a,b,c){a&&(a[c]=b)}]);(function(){var a=function(a,c,d,e){var f,g,k,l,m,p=U(c,a);d=d.split(" ");k=0;for(l=d.length;k<l;k++)m=d[k],""!=m&&"as"!=m&&(f?g=m:f=m);d=ya(f,!0);k=p.sameScope||d.$sameScope;a=p.isolateScope||d.$isolateScope?a.$newIsolated():k?a:a.$new();e=v({scope:a,node:c,as:g,parentRenderer:e,destroyScope:!0},p,!1,!1);Ma(f,e,a,c);return d.$resumeRenderer||
!!d.$shadow};a.$breakScope=!1;z.registerAttribute("mjs-cmp",200,a)})();z.registerAttribute("mjs-config",50,function(a,b,c){U(b,a,c)});z.registerAttribute("mjs-each",100,kb);var qa=function(a,b,c){if(window.getComputedStyle){if(a===window)return b?c?0:null:{};a=getComputedStyle(a,null)}else a=a.currentStyle||a.style||{};b=b?a[b]:a;return c?parseFloat(b)||0:b},fc=function(){var a;return function(){if(void 0===a){var b=window.document,c=b.createElement("div"),d=b.createElement("div"),b=b.body;d.style&&
window.getComputedStyle?(c.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",c.appendChild(d),d.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",d.innerHTML="",b.appendChild(c),d="4px"===window.getComputedStyle(d,null).width,b.removeChild(c),a=d):a=!1}return a}}(),Xa=function(a,b){var c=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,
d=["Top","Right","Bottom","Left"],e=a?"inner"==a?"padding":"":"content";return function(a,g){if(a===window)return a.document.documentElement["client"+b];if(9===a.nodeType){var k=a.documentElement;return Math.max(a.body["scroll"+b],k["scroll"+b],a.body["offset"+b],k["offset"+b],k["client"+b])}a:{var l=b.toLowerCase(),m=e||(!0===g?"margin":"border"),k=qa(a),p=!0,q="width"===l?a.offsetWidth:a.offsetHeight,n="border-box"===k.boxSizing;if(0>=q||null==q){q=a.style[l];if(c.test(q)){k=q;break a}p=n&&(fc()||
q===a.style[l]);q=parseFloat(q)||0}m=m||(n?"border":"content");l=m===(p?"border":"content")?4:"width"===l?1:0;for(n=0;4>l;l+=2)"margin"===m&&(n+=parseFloat(k[m+d[l]])),p?("content"===m&&(n-=parseFloat(k["padding"+d[l]])),"margin"!==m&&(n-=parseFloat(k["border"+d[l]+"Width"]))):(n+=parseFloat(k["padding"+d[l]]),"padding"!==m&&(n+=parseFloat(k["border"+d[l]+"Width"])));k=q+n}return k}},nb=Xa("","Width"),ob=Xa("","Height"),Jb=function(a){var b,c=a?"pageYOffset":"pageXOffset",d=a?"scrollTop":"scrollLeft";
a=window.document;var e=a.body,f=a.documentElement;b=void 0!==window[c]?function(){return window[c]}:f.clientHeight?function(){return f[d]}:function(){return e[d]};return function(a){return a&&a!==window?a&&1==a.nodeType&&a!==e&&a!==f?a[d]:b():b()}},Aa=Jb(!0),Ba=Jb(!1),gc=function(){var a=w({queue:null,observable:null,handlerDelegate:null,triggerDelegate:null,watchers:null,breaks:null,running:!1,lastEvent:null,currentEvent:null,interval:null,$init:function(a,c,d){var e="$$"+c+"_"+d;if(a[e])return a[e];
a[e]=this;this.breaks={};this.watchers={};this.node=a;this.event=c;this.observable=new ka;this.interval=d||0;this.handlerDelegate=r(this.handler,this);this.triggerDelegate=r(this.trigger,this);this.up()},handler:function(a){this.running?a&&(this.lastEvent=a):this.next(a)},next:function(a){var c=this.interval;if(a=a||this.lastEvent)this.lastEvent=null,this.running=!0,this.currentEvent=a,"raf"==c?H(this.triggerDelegate):setTimeout(this.triggerDelegate,c)},watchWidth:function(){this.addWatcher("width",
nb)},watchHeight:function(){this.addWatcher("width",ob)},watchScrollTop:function(){this.addWatcher("scrollTop",Aa)},watchScrollLeft:function(){this.addWatcher("scrollLeft",Ba)},addWatcher:function(a,c,d){this.watchers[a]||(this.watchers[a]={fn:c,context:d,prev:null,current:parseInt(c.call(d,this.node),10)})},removeWatcher:function(a){delete this.watchers[a]},breakFilter:function(a,c,d){a=a.breakValue;var e=this.watchers[d.watcher];d=e.current;var f=e.prev,e=Math.min(f,d),f=Math.max(f,d);c[0].breakPosition=
d<a?-1:1;return e<=a&&a<=f},onBreak:function(a,c,d,e,f){var g=a+"_"+c;f=f||{};f.breakValue=c;this.breaks[g]||(this.breaks[g]=this.observable.createEvent(g,{watcher:a,triggerFilter:this.breakFilter,filterContext:this}));this.breaks[g].on(d,e,f)},unBreak:function(a,c,d,e,f){a=a+"_"+c;this.breaks[a]&&(this.breaks[a].un(d,e),this.breaks[a].hasListener()||(this.breaks[a].destroy(),delete this.breaks[a]));f&&this.destroyIfIdle()},on:function(a,c){this.observable.on(this.event,a,c)},un:function(a,c,d){this.observable.un(this.event,
a,c);d&&this.destroyIfIdle()},trigger:function(){var a=this.currentEvent,c=this.watchers,d=this.breaks,e=this.node,f,g;this.observable.trigger(this.event,a);for(f in c)c[f].prev=c[f].current,c[f].current=parseInt(c[f].fn.call(c[f].context,e,a),10);for(g in d)d[g].trigger(a);this.running=!1;this.currentEvent=null;this.next()},up:function(){C(this.node,this.event,this.handlerDelegate)},down:function(){T(this.node,this.event,this.handlerDelegate)},destroyIfIdle:function(){if(!this.observable.hasListener())return this.$destroy(),
!0},destroy:function(){this.down();this.observable.destroy();this.queue.destroy()}},{get:function(b,c,d){var e="$$"+c+"_"+d;return b[e]?b[e]:b[e]=new a(b,c,d)}});return a}(),Kb=w({cfg:null,scope:null,node:null,listeners:null,event:null,buffers:null,updateRoot:!1,$init:function(a,b,c,d,e){this.event=d;e=e||{};c=c||{};"string"==typeof c&&(this.updateRoot=-2!=c.indexOf("$root")+c.indexOf("$parent"),d=c.substr(0,1),"{"==d?(this.watcher=ha(a,c,this.onConfigChange,this),c=this.watcher.getLastResult()):
"="==d?(c=c.substr(1),this.watcher=ha(a,c,this.onConfigChange,this),c=this.watcher.getLastResult()):c={handler:aa(c)});this.prepareConfig(c,e);this.buffers={};this.listeners=[];this.scope=a;this.node=b;this.up()},prepareConfig:function(a,b){var c,d=this.event;if(a.event){c={};var d=a.event.split(","),e,f;delete a.event;e=0;for(f=d.length;e<f;e++)c[L(d[e])]=a;a=c}else d&&(c={},c[d]=a,a=c);v(a,b,!1,!1);this.cfg=a},onConfigChange:function(a){this.down();this.prepareConfig(a);this.up()},createHandler:function(a,
b){var c=this.updateRoot;return function(d){var e,f=!0,g=!1,k=!1;void 0!==a.preventDefault&&(f=a.preventDefault);void 0!==a.stopPropagation&&(k=a.stopPropagation);void 0!==a.returnValue&&(g=a.returnValue);void 0!==a.keyCode&&(e=a.keyCode);d=S(d||window.event);if(e&&("number"==typeof e&&e!=d.keyCode||-1==e.indexOf(d.keyCode)))return null;b.$event=d;a.handler&&a.handler.call(a.context||null,b);b.$event=null;c?b.$root.$check():b.$check();k&&d.stopPropagation();f&&d.preventDefault();return g}},up:function(){var a=
this.cfg,b=this.listeners,c=this.buffers,d=this.node,e=this.scope,f=a.buffer,g,k;for(k in a)if(void 0===a.if||a.if)g=this.createHandler(a[k],e),b.push([k,g]),f?c[k]||(c[k]=gc.get(d,k,f),c[k].on(g)):C(d,k,g)},down:function(){var a=this.listeners,b=this.buffers,c=this.node,d=this.cfg.buffer,e,f,g,k;g=0;for(k=a.length;g<k;g++)e=a[g][0],f=a[g][1],d?(b[e].un(f),!0===b[e].destroyIfIdle()&&delete b[e]):T(c,e,f);this.listeners=[]},destroy:function(){this.down();this.watcher&&this.watcher.unsubscribeAndDestroy(this.onConfigChange,
this)}});(function(){z.registerAttribute("mjs-event",1E3,function(a,b,c){var d=new Kb(a,b,c);return function(){d.$destroy();d=null}})})();var pb=hb.createFunc;(function(){var a="click dblclick mousedown mouseup mouseover mouseout mousemove keydown keyup keypress focus blur copy cut paste mousewheel touchstart touchend touchcancel touchleave touchmove".split(" "),b,c;b=0;for(c=a.length;b<c;b++)(function(a){z.registerAttribute("mjs-"+a,1E3,function(b,c,g){var k=new Kb(b,c,g,a,{stopPropagation:!0});
return function(){k.$destroy();k=null}})})(a[b]);z.registerAttribute("mjs-submit",1E3,function(a,b,c){var g=pb(c),k=-2!=c.indexOf("$root")+c.indexOf("$parent"),l=function(){g(a);k?a.$root.$check():a.$check()};ga.get(b).onKey(13,l);return function(){ga.get(b).unKey(13,l);g=l=null}});a=null})();z.registerAttribute("mjs-show",500,w({$extends:z,initial:!0,display:"",$init:function(a,b,c){this.display=U(b,a).display||"";this.$super(a,b,c)},runAnimation:function(a){var b=this,c=b.node.style,d=function(){c.display=
a?b.display:"none"};b.initial?d():V(b.node,a?"show":"hide",function(){a&&(c.display=b.display)},!0).done(d)},onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(a);this.initial=!1}}));z.registerAttribute("mjs-hide",500,w({$extends:"attr.mjs-show",onChange:function(){var a=this.watcher.getLastResult();this.runAnimation(!a);this.initial=!1}}));z.registerAttribute("mjs-if",500,z.$extend({parentEl:null,prevEl:null,el:null,initial:!0,cfg:null,$init:function(a,b,c){this.parentEl=b.parentNode;
this.prevEl=b.previousSibling;this.$super(a,b,c)},onScopeDestroy:function(){this.parentEl=this.prevEl=null;this.$super()},onChange:function(){var a=this,b=a.watcher.getLastResult(),c=a.parentEl,d=a.node,e=function(){a.prevEl?c.insertBefore(d,a.prevEl?a.prevEl.nextSibling:null):c.appendChild(d)},f=function(){c.removeChild(d)};b?a.initial?e():V(d,"enter",e,!0):d.parentNode&&(a.initial?f():V(d,"leave",null,!0).done(f));a.initial?a.initial=!1:(a.cfg||(a.cfg=U(d,a.scope)),a.cfg.ifOnce&&a.$destroy())}}));
z.registerAttribute("mjs-ignore",0,xa);z.registerAttribute("mjs-include-file",900,function(a,b,c){a=require("fs");b.innerHTML=a.readFileSync(c).toString()});z.registerAttribute("mjs-include",900,function(a,b,c,d){a=new Fa({scope:a,node:b,url:c,parentRenderer:d});return a.ownRenderer?!1:a.initPromise});z.registerAttribute("mjs-init",250,function(a,b,c){pb(c)(a)});z.registerAttribute("mjs-key",1E3,function(a,b,c){var d=aa(c)(a),e=d.handler,f=d.context||a;delete d.handler;delete d.context;ga.get(b).onKey(d,
e,f);return function(){ga.get(b).unKey(d,e,f)}});z.registerAttribute("mjs-model",1E3,z.$extend({inProg:!1,input:null,binding:null,updateRoot:!1,autoOnChange:!1,$init:function(a,b,c){var d=U(b,a);this.node=b;this.input=ga.get(b);this.binding=d.binding||"both";this.updateRoot=-2!=c.indexOf("$root")+c.indexOf("$parent");this.input.onChange(this.onInputChange,this);this.$super(a,b,c);a=this.input.getValue();b=this.watcher.getLastResult();if(b!=a)if("input"!=this.binding&&void 0!=b)this.onChange(b);else if("scope"!=
this.binding&&void 0!=a)this.onInputChange(a)},onInputChange:function(a){var b=this.scope;"scope"!=this.binding&&(a&&y(a)&&-1!=a.indexOf("\\{")&&(a=a.replace(/\\{/g,"{")),this.watcher.getLastResult()!=a&&(this.watcher.setValue(a),this.inProg=!0,b instanceof ma?this.updateRoot?b.$root.$check():b.$check():this.watcher.checkAll(),this.inProg=!1))},destroy:function(){this.input.destroy();this.$super()},onChange:function(){var a=this.watcher.getLastResult()||"",b;"input"==this.binding||this.inProg||((b=
Wa())&&8>b?fa(this.input.setValue,this.input,[a]):this.input.setValue(a))}}));z.registerAttribute("mjs-on",1E3,function(a,b,c){var d=aa(c)(a),e=function(b){var c,e,l,m,p;l=0;for(m=d.length;l<m;l++)c=d[l],e=c[0],(c=c[1])&&e&&(c[b]||c["$"+b])&&(p=c[b]||c["$"+b],p.call(c,e,a.$check,a))};e("on");return function(){e("un");d=null}});z.registerAttribute("mjs-options",100,w({$extends:z,model:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,$init:function(a,b,c){this.parseExpr(c);
this.node=b;this.scope=a;for(this.defOption=b.options.length?b.options[0]:null;b.firstChild;)b.removeChild(b.firstChild);this.defOption&&this.defOption.setAttribute("mjs-default-option","");try{this.watcher=ha(a,this.model,this.onChange,this,null,B)}catch(d){X(d)}this.render(Y(this.watcher.getValue()))},onChange:function(){this.render(Y(this.watcher.getValue()))},renderOption:function(a,b,c){var d=this.groupEl||this.fragment,e=Wa();c.item=a;c.$index=b;a=this.getterFn(c);void 0!=a.group&&(a.group=
""+a.group);a.group!==this.prevGroup&&(a.group?(this.groupEl=d=window.document.createElement("optgroup"),d.setAttribute("label",a.group),a.disabledGroup&&d.setAttribute("disabled","disabled"),this.fragment.appendChild(d)):(d=this.fragment,this.groupEl=null));this.prevGroup=a.group;b=window.document.createElement("option");b.setAttribute("value",a.value);b.text=a.name;e&&9>e&&(b.innerHTML=a.name);a.disabled&&b.setAttribute("disabled","disabled");d.appendChild(b)},render:function(a){var b=this.node,
c=ua(b),d=this.defOption,e=this.scope.$new(),f=Wa(),g,k,l,m;this.fragment=window.document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;b.firstChild;)b.removeChild(b.firstChild);l=0;for(m=a.length;l<m;l++)this.renderOption(a[l],l,e);d&&b.insertBefore(d,b.firstChild);e.$destroy();f&&8>f&&(k=b.nextSibling,g=b.parentNode,g.removeChild(b));b.appendChild(this.fragment);this.fragment=null;f&&8>f&&g.insertBefore(b,k);mb(b,c)},parseExpr:function(a){var b=a.indexOf(" in "),c;-1==b?(c=a,a="{name: .item, value: .$index}"):
(c=a.substr(b+4),a=a.substr(0,b));this.model=c;this.getterFn=aa(a)}}));(function(){var a="selected checked disabled readonly open required".split(" "),b,c,d=w({$extends:z,propName:null,$init:function(a,b,c,d){this.propName=d;this.$super(a,b,c)},onChange:function(a){var b=this.propName;a?this.node.setAttribute(b,b):this.node.removeAttribute(b)}});b=0;for(c=a.length;b<c;b++)(function(a){z.registerAttribute("mjs-"+a,1E3,function(b,c,k){return new d(b,c,k,a)})})(a[b])})();z.registerAttribute("mjs-scope-prop",
200,function(a,b,c){a[c]=b});var Lb=function(){var a={},b=0;return function(c){if(a[c])return D.resolve(c);1E3<b&&(a={},b=0);var d=window.document,e=d.createElement("img"),f=e.style,g=new D;C(e,"load",function(){a[c]=!0;b++;d.body.removeChild(e);g.resolve(c)});f.position="absolute";f.visibility="hidden";f.left="-10000px";f.top="0";e.src=c;d.body.appendChild(e);return g}}();z.registerAttribute("mjs-src",1E3,w({$extends:z,queue:null,usePreload:!0,noCache:!1,$constructor:function(a,b,c){var d=U(b,a);
d.deferred&&this.$plugins.push("plugin.SrcDeferred");d.preloadSize&&this.$plugins.push("plugin.SrcSize");if(d.srcPlugin){var d=d.srcPlugin.split(","),e,f;e=0;for(f=d.length;e<f;e++)this.$plugins.push(L(d[e]))}this.$super(a,b,c)},$init:function(a,b,c){var d=U(b,a);d.noCache&&(this.noCache=!0);d.noPreload?this.usePreload=!1:b.style.visibility="hidden";this.queue=new ca({auto:!0,async:!0,mode:ca.REPLACE,thenable:!0});this.$super(a,b,c)},onChange:function(){this.usePreload&&(this.node.style.visibility=
"hidden");this.queue.add(this.doChange,this)},doChange:function(){var a=this,b=a.watcher.getLastResult();if(b){a.noCache&&(b+=(-1!=b.indexOf("?")?"&amp;":"?")+"_"+(new Date).getTime());if(a.usePreload)return Lb(b).done(function(){a&&a.node&&H(function(){a.node.src=b;a.node.setAttribute("src",b);a.onSrcChanged();a.node.style.visibility=""})});a.node&&(a.node.src=b,a.node.setAttribute("src",b),a.onSrcChanged())}},onSrcChanged:function(){},destroy:function(){this.queue.destroy();this.$super()}}));var Oa=
function(){return window.document.createElement("div").style.removeProperty?function(a,b){a.style.removeProperty(b)}:function(a,b){a.style.removeAttribute(b)}}();z.registerAttribute("mjs-style",1E3,z.$extend({onChange:function(){var a=this.node,b=a.style,c=this.watcher.getLastResult(),d=this.watcher.getPrevValue(),e;for(e in d)void 0===c[e]&&Oa(a,e);for(e in c)c[e]?b[e]=c[e]:Oa(a,e)}}));z.registerAttribute("mjs-transclude",1E3,function(a,b){return wb(b)});z.registerAttribute("mjs-view",200,function(a,
b,c){Ma(c||"MetaphorJs.View",{scope:a,node:b},a,b);return!1});z.registerTag("mjs-bind-html",function(a,b){var c=x(b,"value"),c=ha(a,c,null,null,null,B),d=c.getLastResult(),d=da(d),e=b.nextSibling,f=Y(d.childNodes);b.parentNode.insertBefore(d,e);b.parentNode.removeChild(b);c.unsubscribeAndDestroy();return f});z.registerTag("mjs-bind",function(a,b){var c=x(b,"value"),c=aa(c)(a),c=window.document.createTextNode(c);b.parentNode.insertBefore(c,b.nextSibling);b.parentNode.removeChild(b);return[c]});z.registerTag("mjs-each",
kb);z.registerTag("mjs-if",function(a,b){var c=x(b,"value");if(aa(c)(a)){var c=Y(b.childNodes),d=da(b.childNodes);b.parentNode.insertBefore(d,b.nextSibling);b.parentNode.removeChild(b);return c}b.parentNode.removeChild(b);return!1});z.registerTag("mjs-include",function(a,b,c,d){return(new Fa({scope:a,node:b,url:x(b,"src"),parentRenderer:d,replace:!0})).initPromise});z.registerTag("mjs-tag",function(a,b){var c=x(b,"value");if(c=aa(c)(a)){for(var c=window.document.createElement(c),d=b.nextSibling,e=
sb(b),f;b.firstChild;)c.appendChild(b.firstChild);delete e.value;for(f in e)c.setAttribute(f,e[f]);b.parentNode.insertBefore(c,d);b.parentNode.removeChild(b);return[c]}b.parentNode.removeChild(b);return!1});z.registerTag("mjs-transclude",function(a,b){return wb(b,!0)});J("filter.collect",function(a,b,c){b=[];var d,e,f;d=0;for(e=a.length;d<e;d++)f=a[d][c],void 0!=f&&b.push(f);return b});var Mb=function(){var a=function(a,b,c){if(A(b))return b(a,c);if(""===b||void 0===b)return!0;if(void 0!==a){if(va(a))return a===
b;if(b instanceof RegExp)return b.test(""+a);if("strict"==c)return""+a===""+b;if(!0===c||null===c||void 0===c)return-1!=""+a.indexOf(b);if(!1===c)return-1==""+a.indexOf(b)}return!1},b=function(b,c,f){if(wa(b))return void 0===c.$?!0:a(b,c.$,f);var g,k;for(g in c)if("$"==g)for(k in b){if(a(b[k],c.$,f))return!0}else if(a(b[g],c[g],f))return!0;return!1},c=function(a,c,f){pa(c)||(c={$:c});var g=[],k,l;k=-1;for(l=a.length;++k<l;)b(a[k],c,f)&&g.push(a[k]);return g};c.compare=b;return c}();J("filter.filter",
function(a,b,c,d){return Mb(a,c,d)});J("filter.get",function(a,b,c){for(b=(""+c).split(".");c=b.shift();)if(a=a[c],void 0==a)return;return a});J("filter.join",function(a,b,c){c=c||", ";return a&&a.length?(P(a)||(a=Y(a)),a.join(c)):""});J("filter.l",function(a,b){return b.$app.lang.get(a)});J("filter.limitTo",function(a,b,c){b=y(a);if(!P(a)&&!b)return a;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);if(b)return c?0<=c?a.slice(0,c):a.slice(c,a.length):"";b=[];var d;c>a.length?c=a.length:
c<-a.length&&(c=-a.length);0<c?d=0:(d=a.length+c,c=a.length);for(;d<c;d++)b.push(a[d]);return b});J("filter.linkify",function(a,b,c){return a?a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(c?' target="'+c+'"':"")+">$1</a>"):""});J("filter.lowercase",function(a){return a.toLowerCase()});J("filter.map",function(a,b,c){var d=ya(c,!0)||window[c]||aa(c)(b);if(d)for(b=0,c=a.length;b<c;b++)a[b]=d(a[b]);return a});var hc={};J("filter.moment",function(a,
b,c){c=hc[c]||c;return moment(a).format(c)});var ic={};J("filter.numeral",function(a,b,c){c=ic[c]||c;return numeral(a).format(c)});J("filter.offset",function(a,b,c){b=y(a);if(!P(a)&&!b)return a;c=Infinity===Math.abs(Number(c))?Number(c):parseInt(c,10);return b?a.substr(c):a.slice(c)});J("filter.p",function(a,b,c){return b.$app.lang.plural(a,parseInt(c,10)||0)});J("filter.preloaded",function(a,b){if(!a)return!1;var c=Lb(a);if(c.isFulfilled())return!0;c.done(function(){b.$check()});return!1});J("filter.sortBy",
function(a,b,c,d){return xb(a,c,d)});J("filter.split",function(a,b,c,d){d=d||void 0;c=c||"/\\n|,/";if(!a)return[];a=""+a;"/"==c.substr(0,1)&&"/"==c.substr(c.length-1)&&(c=Ka(c.substring(1,c.length-1)));a=a.split(c,d);b=-1;for(c=a.length;++b<c;a[b]=L(a[b]));return a});J("filter.toArray",function(a){if(pa(a)){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push({key:c,value:a[c]});return b}return Y(a)});J("filter.ucfirst",function(a){return a.substr(0,1).toUpperCase()+a.substr(1)});J("filter.uppercase",
function(a){return a.toUpperCase()});(function(a,b){var c=a||window;if(!c)throw"Window object neither defined nor provided";Rb(function(){var a=N("[mjs-app]",c.document),e,f,g;e=-1;for(f=a.length;++e<f;)g=a[e],Sb(g,x(g,"mjs-app"),b,!0)},c)})();var la=Ga.factory,oa=function(){var a={},b={};return w({$class:"Model",type:null,fields:null,record:null,store:null,plain:!1,lastAjaxResponse:null,$init:function(a){this.fields||(this.fields={});v(this,{record:{load:null,save:null,"delete":null,id:null,data:null,
success:null,extra:{}},store:{load:null,save:null,"delete":null,id:null,data:null,total:null,start:null,limit:null,success:null,extra:{}}},!1,!0);v(this,a,!0,!0);this.plain=!this.type},isPlain:function(){return this.plain},getRecordProp:function(a,b){return this.getProp("record",a,b)},setRecordProp:function(a,b){this.record[a]=b},getStoreProp:function(a,b){return this.getProp("store",a,b)},setStoreProp:function(a,b){this.store[a]=b},getProp:function(a,b,e){a=this[a];return a[b]&&a[b][e]||a[e]||this[e]||
null},setProp:function(a,b){return this[a]=b},_makeRequest:function(a,b,e,f,g){var k=this,l=k[a],m=v({},y(l[b])||A(l[b])?{url:l[b]}:l[b]),p=k.getProp(a,b,"id"),q=k.getProp(a,b,"data"),n=k.getProp(a,b,"url"),u=k.getProp(a,b,"json");if(!m)if(n)m={url:n};else throw a+"."+b+" not defined";if(y(m)||A(m))m={url:m};if(!m.url){if(!n)throw a+"."+b+" url not defined";m.url=n}m.data=v({},m.data,k.extra,l.extra,l[b]?l[b].extra:{},g,!0,!0);if(A(m.url)){e=m.url(m.data);var s=new D;e.then(function(e){"record"==
a?k._processRecordResponse(b,e,s):"store"==a&&k._processStoreResponse(b,e,s)});return s}m.method||(m.method="load"==b?"GET":"POST");e&&(m.data[p]=e);f&&(q?m.data[q]=f:m.data=f);u&&m.data&&"GET"!=m.method&&(m.data=JSON.stringify(m.data));m.callbackScope=k;"record"==a?m.processResponse=function(a,c){k.lastAjaxResponse=a;k._processRecordResponse(b,a,c)}:"store"==a&&(m.processResponse=function(a,c){k.lastAjaxResponse=a;k._processStoreResponse(b,a,c)});return Va(m)},_processRecordResponse:function(a,b,
e){var f=this.getRecordProp(a,"id"),g=this.getRecordProp(a,"data"),f=(g=g?b[g]:b)&&g[f]||b[f];this._getSuccess("record",a,b)?e.resolve({id:f,data:g}):e.reject(b)},_processStoreResponse:function(a,b,e){var f=this.getStoreProp(a,"data"),g=this.getStoreProp(a,"total"),f=f?b[f]:b,g=g?b[g]:null;this._getSuccess("store",a,b)?e.resolve({data:f,total:g}):e.reject(b)},_getSuccess:function(a,b,e){return(a=this.getProp(a,b,"success"))&&void 0!=e[a]?e[a]:!0},loadRecord:function(a){return this._makeRequest("record",
"load",a)},saveRecord:function(a,b,e){return this._makeRequest("record",a.getId()?"save":"create",a.getId(),v({},a.storeData(a.getData(b)),e))},deleteRecord:function(a){return this._makeRequest("record","delete",a.getId())},loadStore:function(a,b){return this._makeRequest("store","load",null,null,b)},saveStore:function(a,b){return this._makeRequest("store","save",null,b)},deleteRecords:function(a,b){return this._makeRequest("store","delete",b)},getFields:function(){return this.fields},restoreField:function(a,
b,e){var f=this.fields[b];if(f){switch(y(f)?f:f.type){case "int":e=parseInt(e);break;case "bool":case "boolean":y(e)?(e=e.toLowerCase(),e=!("off"===e||"no"===e||"0"===e||"false"==e||"null"==e)):e=e?!0:!1;break;case "double":case "float":e=parseFloat(e);break;case "date":f.parseFn?e=f.parseFn(e,f.format):Date.parse?e=Date.parse(e,f.format):("timestamp"==f.format&&(e=1E3*parseInt(e)),e=new Date(e))}f.restore&&(e=f.restore.call(a,e,b))}return this.onRestoreField(a,b,e)},onRestoreField:function(a,b,e){return e},
storeField:function(a,b,e){var f=this.fields[b];if(f){switch(y(f)?f:f.type){case "bool":case "boolean":e=e?"1":"0";break;case "date":e=f.formatFn?f.formatFn(e,f.format):Date.format?Date.format(e,f.format):"timestamp"==f.format?e.getTime()/1E3:e.format?e.format(f.format):e.toString();break;default:e=e.toString()}f.store&&(e=f.store.call(a,e,b))}return this.onStoreField(a,b,e)},onStoreField:function(a,b,e){return e}},{create:function(b,d){return"MetaphorJs.Model"==b?la(b,d):d?la(b,d):a[b]?a[b]:a[b]=
la(b)},addToCache:function(a){var d=a.$getClass(),e=a.getId();"MetaphorJs.Record"!=d&&(b[d]||(b[d]={}),b[d][e]=a)},getFromCache:function(a,d){return b[a]&&b[a][d]?b[a][d]:null},removeFromCache:function(a,d){b[a]&&b[a][d]&&delete b[a][d]}})}(),Ja=w({$class:"Record",$mixins:["mixin.Observable"],id:null,data:null,orig:null,modified:null,loaded:!1,dirty:!1,model:null,standalone:!0,stores:null,$init:function(a,b,c){var d=arguments.length;1==d?(c=a,b=a=null):2==d&&(c=b,b=null);this.data={};this.orig={};
this.stores=[];this.modified={};c=c||{};this.$super(c);y(this.model)?this.model=oa.create(this.model):this.model instanceof oa||(this.model=new oa(this.model));this.id=a;b?this.importData(b):!1!==c.autoLoad&&a&&this.load();"MetaphorJs.Record"!=this.$getClass()&&oa.addToCache(this)},isLoaded:function(){return this.loaded},isStandalone:function(){return this.standalone},isDirty:function(){return this.dirty},getModel:function(){return this.model},attachStore:function(a){a=a.getId();-1==this.stores.indexOf(a)&&
this.stores.push(a)},detachStore:function(a){a=a.getId();var b;this.$destroyed||-1==(b=this.stores.indexOf(a))||(this.stores.splice(b,1),0!=this.stores.length||this.standalone||this.$destroy())},setDirty:function(a){this.dirty!=a&&(this.dirty=!!a,this.trigger("dirty-change",this,a))},importData:function(a){var b={},c;if(a){for(c in a)b[c]=this.model.restoreField(this,c,a[c]);this.data=b}this.orig=v({},this.data);this.modified={};this.loaded=!0;this.setDirty(!1)},storeData:function(a){var b={},c;for(c in a)b[c]=
this.model.storeField(this,c,a[c]);return b},getId:function(){return this.id},getData:function(a){if(a){var b={},c,d;a=y(a)?[a]:a;c=0;for(d=a.length;c<d;c++)b[a[c]]=this.data[a[c]];return b}return v({},this.data)},getChanged:function(){return v({},this.modified)},isChanged:function(a){return this.modified[a]||!1},get:function(a){return this.data[a]},setId:function(a){!this.id&&a&&(this.id=a)},set:function(a,b){var c=this.data[a];b=this.model.restoreField(this,a,b);this.data[a]=b;c!=b&&(this.modified[a]=
!0,this.setDirty(!0),this.trigger("change",this,a,b,c),this.trigger("change-"+a,this,a,b,c))},revert:function(){this.dirty&&(this.data=v({},this.orig),this.modified={},this.setDirty(!1))},load:function(){var a=this;a.trigger("before-load",a);return a.model.loadRecord(a.id).done(function(b){a.setId(b.id);a.importData(b.data);a.trigger("load",a)}).fail(function(){a.trigger("failed-load",a)})},save:function(a,b){var c=this;c.trigger("before-save",c);return c.model.saveRecord(c,a,b).done(function(a){c.setId(a.id);
c.importData(a.data);c.trigger("save",c)}).fail(function(a){c.trigger("failed-save",c)})},"delete":function(){var a=this;a.trigger("before-delete",a);return a.model.deleteRecord(a).done(function(){a.trigger("delete",a);a.$destroy()}).fail(function(){a.trigger("failed-delete",a)})},reset:function(){this.id=null;this.data={};this.orig={};this.modified={};this.dirty=this.loaded=!1;this.trigger("reset",this)},destroy:function(){oa.removeFromCache(this.$getClass(),this.id);this.$super()}});(function(){var a=
{};return w({$class:"Store",$mixins:["mixin.Observable"],id:null,autoLoad:!1,clearOnLoad:!0,model:null,extraParams:null,loaded:!1,loading:!1,local:!1,items:null,current:null,map:null,currentMap:null,length:0,currentLength:0,maxLength:0,totalLength:0,start:0,pageSize:null,pages:null,filtered:!1,sorted:!1,filterBy:null,filterOpt:null,sortBy:null,sortDir:null,publicStore:!1,idProp:null,loadingPromise:null,$init:function(b,c,d){this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=
!1;this.extraParams=this.extraParams||{};b&&!y(b)&&(d=c,c=b,b=null);c=c||{};b&&(c.url=b);this.$super(c);v(this,c,!0,!1);this.id=this.id||R();this.publicStore&&(a[this.id]=this);this.initModel(c);this.$$observable.createEvent("beforeload",!1);!this.local&&this.autoLoad?this.load():d&&(P(d)?this._loadArray(d):this._loadAjaxData(d));this.local&&(this.loaded=!0)},initModel:function(a){y(this.model)?this.model=oa.create(this.model):this.model instanceof oa||(this.model=new oa(this.model));a.url&&(this.model.store.load=
a.url);this.idProp=this.model.getStoreProp("load","id")},getId:function(){return this.id},isLoaded:function(){return this.loaded},isLocal:function(){return this.local},setLocal:function(a){this.local=!!a},isLoading:function(){return this.loading},isFiltered:function(){return this.filtered},isSorted:function(){return this.sorted},getLength:function(a){return a?this.length:this.currentLength},getTotalLength:function(){return this.totalLength||this.currentLength},getPagesCount:function(){return null!==
this.pageSize?parseInt(this.totalLength/this.pageSize):1},setParam:function(a,c){this.extraParams[a]=c},getParam:function(a){return this.extraParams[a]},setStart:function(a){this.start=a},setPageSize:function(a){this.pageSize=a},getAjaxData:function(){return this.ajaxData},hasDirty:function(a){if(this.model.isPlain())return!1;var c=!1;this.each(function(a){return a.isDirty()?(c=!0,!1):!0},null,a);return c},getDirty:function(a){var c=[];if(this.model.isPlain())return c;this.each(function(a){a.isDirty()&&
c.push(a)},null,a);return c},getModel:function(){return this.model},_loadAjaxData:function(a,c){var d=this;c=c||{};if(c.silent||!1!==d.trigger("before-load",d))d.ajaxData=a,d.model._processStoreResponse("load",a,{resolve:function(a){d._onModelLoadSuccess(a,c)},reject:function(a){d._onModelLoadFail(a,c)}})},_loadArray:function(a,c){c=c||{};(c.silent||!1!==this.trigger("before-load",this))&&P(a)&&(this._load(a,c),this.totalLength=this.length)},_load:function(a,c){var d=c.prepend;c=c||{};a=a||[];for(var e=
0;e<a.length;e++)d?this.insert(e,a[e],!0,!0):this.add(a[e],!0,!0);this.loaded=!0;this.loading=!1;this.trigger("loading-end",this);this.onLoad();c.skipUpdate||this.update();c.silent||this.trigger("load",this)},load:function(a,c){var d=this,e=d.model.store,f=e.start,e=e.limit,g=d.pageSize;d.loadingPromise&&d.loadingPromise.abort();c=c||{};if(d.local)return null;a=v({},d.extraParams,a||{});null===g||a[f]||a[e]||(f&&(a[f]=d.start),e&&(a[e]=g));if(!c.silent&&!1===d.trigger("before-load",d))return null;
d.loading=!0;d.trigger("loading-start",d);return d.loadingPromise=d.model.loadStore(d,a).done(function(a){d.loadingPromise=null;d.ajaxData=d.model.lastAjaxResponse;d._onModelLoadSuccess(a,c)}).fail(function(a){d.loadingPromise=null;d.ajaxData=d.model.lastAjaxResponse;d._onModelLoadFail(a,c)})},_onModelLoadSuccess:function(a,c){c=c||{};if(!c.noopOnEmpty||a.data.length)!c.prepend&&!c.append&&this.clearOnLoad&&0<this.length&&this.clear(!0),this.totalLength=parseInt(a.total),this._load(a.data,c)},_onModelLoadFail:function(a,
c){this.onFailedLoad();c.silent||this.trigger("failed-load",this,a)},onLoad:G,onFailedLoad:G,save:function(a){var c=this,d={},e=0;if(c.local)return null;if(c.model.isPlain())throw Error("Cannot save plain store");c.each(function(a){a.isDirty()&&(d[a.getId()]=a.storeData(a.getData()),e++)});if(!e)throw Error("Nothing to save");return a||!1!==c.trigger("before-save",c,d)?c.model.saveStore(c,d).done(function(d){c._onModelSaveSuccess(d,a)}).fail(function(d){c._onModelSaveFail(d,a)}):null},_onModelSaveSuccess:function(a,
c){var d,e,f,g=a.data;if(g&&g.length)for(d=0,e=g.length;d<e;d++)f=this.getRecordId(g[d]),(f=this.getById(f))&&f.importData(g[d]);this.onSave();c||this.trigger("save",this)},_onModelSaveFail:function(a,c){this.onFailedSave(a);c||this.trigger("failed-save",this)},onSave:G,onFailedSave:G,deleteById:function(a,c,d){var e=this,f,g,k;if(e.local)return null;if(!a||P(a)&&!a.length)throw Error("Record id required");P(a)||(a=[a]);f=0;for(g=a.length;f<g;f++)k=e.getById(a[f]),e.remove(k,c,d),k instanceof Ja&&
k.$destroy();return c||!1!==e.trigger("before-delete",e,a)?e.model.deleteRecords(e,a).done(function(){e.totalLength-=a.length;e.onDelete();c||e.trigger("delete",e,a)}).fail(function(){e.onFailedDelete();c||e.trigger("failed-delete",e,a)}):null},onDelete:G,onFailedDelete:G,deleteAt:function(a,c,d){var e=this.getAt(a);if(!e)throw Error("Record not found at "+a);return this["delete"](e,c,d)},"delete":function(a,c,d){return this.deleteById(this.getRecordId(a),c,d)},deleteRecords:function(a,c,d){var e=
[],f,g;f=0;for(g=a.length;f<g;f++)e.push(this.getRecordId(a[f]));return this.deleteById(e,c,d)},loadOr:function(a,c,d){this.local||this.isLoading()||(this.isLoaded()?a&&a.call(c||this):this.load(null,d))},addPrevPage:function(a){a=a||{};a.append=!1;a.prepend=!0;a.noopOnEmpty=!0;return this.loadPrevPage(a)},addNextPage:function(a){a=a||{};a.append=!0;a.prepend=!1;a.noopOnEmpty=!0;if(!this.local&&(!this.totalLength||this.length<this.totalLength))return this.load({start:this.length,limit:this.pageSize},
a)},loadNextPage:function(a){if(!this.local&&(!this.totalLength||this.length<this.totalLength))return this.start+=this.pageSize,this.load(null,a)},loadPrevPage:function(a){if(!this.local&&0<this.start)return this.start-=this.pageSize,0>this.start&&(this.start=0),this.load(null,a)},loadPage:function(a,c){if(!this.local)return this.start=parseInt(a,10),0>this.start&&(this.start=0),this.load(null,c)},getRecordId:function(a){return a instanceof Ja?a.getId():a[this.idProp]||null},getRecordData:function(a){return this.model.isPlain()?
a:a.data},processRawDataItem:function(a){if(a instanceof Ja||this.model.isPlain())return a;var c=this.model.type,d=this.getRecordId(a),e;d&&(e=oa.getFromCache(c,d));e||(e=la(c,d,a,{model:this.model,standalone:!1}));return e},bindRecord:function(a,c){c[a]("change",this.onRecordChange,this);c[a]("destroy",this.onRecordDestroy,this);c[a]("dirty-change",this.onRecordDirtyChange,this);return c},onRecordDirtyChange:function(a){this.trigger("update",this,a)},onRecordChange:function(a,c,d,e){this.trigger("update",
this,a)},onRecordDestroy:function(a){this.remove(a)},shift:function(a,c,d){return this.removeAt(0,a,c,d)},unshift:function(a,c,d){return this.insert(0,a,c,d)},pop:function(a,c,d){return this.removeAt(this.length-1,a,c,d)},addMany:function(a,c,d){var e,f,g=this.length;e=0;for(f=a.length;e<f;e++)this.insert(g+e,a[e],!0,!0);d||this.update();0<f&&!c&&this.trigger("add",a)},add:function(a,c,d){return this.insert(this.length,a,c,d)},onAdd:G,removeAt:function(a,c,d,e){e||(a=this.items.indexOf(this.current[a]));
if(a<this.length&&0<=a)return this.length--,e=this.items[a],this.items.splice(a,1),a=this.getRecordId(e),void 0!=a&&(delete this.map[a],delete this.currentMap[a]),this.onRemove(e,a),d||this.update(),c||this.trigger("remove",e,a),e instanceof Ja?(this.bindRecord("un",e),e.detachStore(this),e.$destroyed?void 0:e):e},onRemove:G,insertMany:function(a,c,d,e){var f,g;f=0;for(g=c.length;f<g;f++)this.insert(a+f,c[f],!0,!0);0<g&&!e&&this.update();0<g&&!d&&this.trigger("add",c)},insert:function(a,c,d,e){var f,
g=!1;c=this.processRawDataItem(c);f=this.getRecordId(c);this.map[f]&&(this.suspendAllEvents(),this.removeId(f),this.resumeAllEvents());a>=this.length?(this.items.push(c),g=!0):this.items.splice(a,0,c);this.length++;this.maxLength&&this.length>this.maxLength&&(g?this.pop(d,!0):this.shift(d,!0));void 0!=f&&(this.map[f]=c);c instanceof Ja&&(c.attachStore(this),this.bindRecord("on",c));this.onAdd(a,c);e||this.update();d||this.trigger("add",[c]);return c},replace:function(a,c,d,e){var f;f=this.items.indexOf(a);
this.removeAt(f,!0,!0,!0);this.insert(f,c,!0,!0);e||this.update();d||this.trigger("replace",a,c);return c},onReplace:G,remove:function(a,c,d){return this.removeAt(this.indexOf(a,!0),c,d,!0)},removeId:function(a,c,d){return this.removeAt(this.indexOfId(a,!0),c,d,!0)},contains:function(a,c){return-1!=this.indexOf(a,c)},containsId:function(a,c){return c?void 0!==this.map[a]:void 0!==this.currentMap[a]},clear:function(a){var c=this.getRange();this._reset();this.onClear();a||this.trigger("clear",c)},onClear:G,
reset:function(){this._reset();this.start=0},_reset:function(a){var c,d;if(!a)for(a=0,c=this.items.length;a<c;a++)d=this.items[a],d instanceof Ja&&(this.bindRecord("un",d),d.detachStore(this));this.totalLength=this.currentLength=this.length=0;this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=this.local},getAt:function(a,c){return c?this.items[a]||void 0:this.current[a]||void 0},getById:function(a,c){return c?this.map[a]||void 0:this.currentMap[a]||void 0},indexOf:function(a,
c){return c?this.items.indexOf(a):this.current.indexOf(a)},indexOfId:function(a,c){return this.indexOf(this.getById(a,c),c)},each:function(a,c,d){d=d?this.items.slice():this.current.slice();for(var e=0,f=d.length;e<f&&!1!==a.call(c,d[e],e,f);e++);},eachId:function(a,c,d){var e=this;e.each(function(d,g,k){return a.call(c,e.getRecordId(d),g,k)},null,d)},collect:function(a,c){var d=[],e=!this.model.isPlain();this.each(function(c){(c=e?c.get(a):c[a])&&d.push(c)},null,c);return d},first:function(a){return a?
this.items[0]:this.current[0]},last:function(a){return a?this.items[this.length-1]:this.current[this.current-1]},getRange:function(a,c,d){d=d?this.items:this.current;var e=[];if(1>d.length)return e;a=a||0;c=Math.min(void 0==c?this.length-1:c,this.length-1);if(a<=c)for(;a<=c;a++)e.push(d[a]);else for(;a>=c;a--)e.push(d[a]);return e},findBy:function(a,c,d,e){a=this.findIndexBy(a,c,d,e);return-1==a?void 0:this.getAt(a,e)},findIndexBy:function(a,c,d,e){e=e?this.items:this.current;d=d||0;for(var f=e.length;d<
f;d++)if(a.call(c,e[d],this.getRecordId(e[d])))return d;return-1},find:function(a,c,d,e){var f=!this.model.isPlain(),g;return this.findIndexBy(function(e){g=f?e.get(a):e[a];return d?g===c:g==c},this,0,e)},findExact:function(a,c,d){return this.find(a,c,!0,d)},findBySet:function(a,c){var d=null,e,f;this.each(function(c){e=!0;for(f in a)if(a[f]!=c[f]){e=!1;break}return e?(d=c,!1):!0},null,c);return d},update:function(){var a=this,c=a.filtered,d=a.sorted;a.currentLength=a.length;a.currentMap=a.map;a.current=
a.items;if(c){var e=a.filterBy,f=a.filterOpt,g,k;a.current=g=[];a.currentMap=k={};a.each(function(c){Mb.compare(c.data,e,f)&&(g.push(c),k[a.getRecordId(c)]=c)},null,!0);a.currentLength=a.current.length}if(d){var l=a.sortBy,m=!a.model.isPlain();a.current=xb(a.current,function(a){return m?a.get(l):a[l]},a.sortDir)}a.trigger("update",a)},filter:function(a,c){this.filtered=!0;this.filterBy=a;this.filterOpt=c;this.update()},clearFilter:function(){this.filtered&&(this.filterOpt=this.filterBy=null,this.update())},
sort:function(a,c){this.sorted=!0;this.sortBy=a;this.sortDir=c;this.update()},clearSorting:function(){this.sorted=!1;this.sortDir=this.sortBy=null;this.update()},destroy:function(){delete a[this.id];this.clear();this.$super()}},{lookupStore:function(b){return a[b]||null},eachStore:function(b,c){for(var d in a)if(!1===b.call(c,a[d]))break}})})();w({$class:"FirebaseStore",$extends:"Store",firebase:null,$init:function(a){this.firebase=y(a)?new Firebase(a):a;this.firebase.on("child_added",r(this.onChildAdded,
this));this.firebase.on("child_removed",r(this.onChildRemoved,this));this.firebase.on("child_changed",r(this.onChildChanged,this));this.firebase.on("child_moved",r(this.onChildMoved,this));this.$super()},initModel:G,ref:function(){return this.firebase.ref?this.firebase.ref():this.firebase},load:function(){if(!this.loaded)this.firebase.once("value",r(this.onSnapshotLoaded,this))},onSnapshotLoaded:function(a){var b=this;a.forEach(function(a){b.add(a,!0,!0)});b.update();b.loaded=!0;b.trigger("load",
b)},onChildAdded:function(a,b){if(this.loaded){var c=this.indexOfId(b,!0);this.insert(c+1,a)}},onChildRemoved:function(a){this.loaded&&this.removeId(a.name())},onChildChanged:function(a,b){if(this.loaded){var c=this.getById(a.name(),!0);this.replace(c,a)}},onChildMoved:function(a,b){},getRecordId:function(a){return a.name()},getRecordData:function(a){return a.val()},processRawDataItem:function(a){return a},bindRecord:G});var jc=kb.$extend({$class:"StoreRenderer",store:null,$constructor:function(a,
b,c){var d=U(b,a);d.pullNext&&(d.buffered&&(d.bufferedPullNext=!0,d.buffered=!1),this.$plugins.push("plugin.ListPullNext"));this.$super(a,b,c)},afterInit:function(a,b,c){this.store=a=aa(this.model)(a);this.watcher=ha(a,".current",this.onChange,this,null,B);this.trackByFn=r(a.getRecordId,a);this.griDelegate=r(a.indexOfId,a);this.bindStore(a,"on")},bindStore:function(a,b){a[b]("update",this.onStoreUpdate,this);a[b]("clear",this.onStoreUpdate,this);a[b]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},
getListItem:function(a,b){return this.store.getRecordData(a[b])},onStoreDestroy:function(){this.onStoreUpdate();this.watcher.unsubscribeAndDestroy(this.onChange,this);this.watcher=null},destroy:function(){this.bindStore(this.store,"un");this.$super()}},{$stopRenderer:!0,$registerBy:"id"});z.registerAttribute("mjs-each-in-store",100,jc);var qb=function(){var a=/(auto|scroll)/,b,c=function(a){a=qa(a);return a.overflow+a.overflowY+a.overflowY};return function(d){b||(b=window.document.body);for(;d&&d!==
b;){if(a.test(c(d)))return d;d=d.parentNode}return window}}();w({$class:"plugin.ListBuffered",list:null,itemSize:null,itemsOffsite:1,bufferState:null,scrollOffset:0,horizontal:!1,bufferEventDelegate:null,topStub:null,botStub:null,$init:function(a){this.list=a;a.$intercept("scrollTo",this.scrollTo,this,"instead");a.$intercept("afterInit",this.afterInit,this,"before");a.bufferPlugin=this},afterInit:function(){var a=U(this.list.node);this.itemSize=a.itemSize;this.itemsOffsite=a.itemsOffsite||5;this.horizontal=
a.horizontal||!1;this.initScrollParent(a);this.initScrollStubs(a);this.bufferEventDelegate=r(this.bufferUpdateEvent,this);C(this.scrollEl,"scroll",this.bufferEventDelegate);C(window,"resize",this.bufferEventDelegate)},initScrollParent:function(a){this.scrollEl=qb(this.list.parentEl)},initScrollStubs:function(a){var b=this.list,c=b.parentEl,d=b.prevEl,e,f,g={fontSize:0,lineHeight:0,padding:0,paddingTop:0,paddingLeft:0,paddingBottom:0,paddingRight:0,margin:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0};
this.topStub=e=window.document.createElement(a.stub||"div");this.botStub=a=window.document.createElement(a.stub||"div");Q(e,"mjs-buffer-top");Q(a,"mjs-buffer-bottom");for(f in g)e.style[f]=g[f],a.style[f]=g[f];c.insertBefore(e,d?d.nextSibling:c.firstChild);c.insertBefore(a,b.nextEl);b.prevEl=e;b.nextEl=a},getScrollOffset:function(){var a=db(this.topStub,this.scrollEl);return this.scrollOffset=this.horizontal?a.left:a.top},getBufferState:function(a){var b=this.scrollEl,c=this.horizontal,d=window.document.documentElement,
d=b===window?window[c?"innerWidth":"innerHeight"]||d[c?"clientWidth":"clientHeight"]:b[c?"offsetWidth":"offsetHeight"],e=c?Ba(b):Aa(b),b=this.itemSize,c=this.itemsOffsite,f=a?this.getScrollOffset():this.scrollOffset;a=this.list.renderers.length;var g,e=Math.max(0,e+f),f=Math.ceil(e/b);0>f&&(f=0);e=f;g=d=f+Math.ceil(d/b);f=f>c?f-c:0;g+=c;g>a-1&&(g=a-1);return f>g?this.bufferState:this.bufferState={first:f,last:g,viewFirst:e,viewLast:d,ot:f*b,ob:(a-g-1)*b}},updateStubs:function(a){var b=this.horizontal;
this.topStub.style[b?"width":"height"]=a.ot+"px";this.botStub.style[b?"width":"height"]=a.ob+"px"},bufferUpdateEvent:function(){this.list.queue.add(this.updateScrollBuffer,this)},updateScrollBuffer:function(a){var b=this,c=b.list,d=b.bufferState,e=c.parentEl,f=c.renderers,g=b.botStub,k=b.getBufferState(!1),l=new D,m,p,q,n;if(!k)return null;d&&k.first==d.first&&k.last==d.last||c.trigger("buffer-change",b,k,d);H(function(){if(a||!d||k.last<d.first||k.first>d.last){if(d)for(p=d.first,q=d.last;p<=q;p++)(n=
f[p])&&n.attached&&(e.removeChild(n.el),n.attached=!1);m=window.document.createDocumentFragment();p=k.first;for(q=k.last;p<=q;p++)if(n=f[p])n.rendered||c.renderItem(p),m.appendChild(n.el),n.attached=!0;e.insertBefore(m,g)}else{if(d.first<k.first)for(p=d.first,q=k.first;p<q;p++)(n=f[p])&&n.attached&&(e.removeChild(n.el),n.attached=!1);else if(d.first>k.first){m=window.document.createDocumentFragment();p=k.first;for(q=d.first;p<q;p++)if(n=f[p])n.rendered||c.renderItem(p),m.appendChild(n.el),n.attached=
!0;e.insertBefore(m,f[d.first].el)}if(d.last<k.last){m=window.document.createDocumentFragment();p=d.last+1;for(q=k.last;p<=q;p++)if(n=f[p])n.rendered||c.renderItem(p),m.appendChild(n.el),n.attached=!0;e.insertBefore(m,g)}else if(d.last>k.last)for(p=k.last+1,q=d.last;p<=q;p++)(n=f[p])&&n.attached&&(e.removeChild(n.el),n.attached=!1)}b.updateStubs(k);c.trigger("buffer-update",b);b.onBufferStateChange(k,d);l.resolve()});return l},scrollTo:function(a){var b=this.list,c=this.itemSize,d=this.scrollEl||
qb(b.parentEl),e=this.horizontal,f=e?"scrollLeft":"scrollTop",g=new D,k;b.queue.append(function(){H(function(){k=c*a;d===window?window.scrollTo(e?k:Ba(),e?Aa():k):d[f]=k;g.resolve()});return g});return g},onBufferStateChange:function(a,b){},$beforeHostDestroy:function(){var a=this.list.parentEl;a.removeChild(this.topStub);a.removeChild(this.botStub);T(this.scrollEl,"scroll",this.bufferEventDelegate);T(window,"resize",this.bufferEventDelegate)}});w({$class:"plugin.ListPullNext",$extends:"plugin.ListBuffered",
buffered:!1,$init:function(a,b){var c=U(b[1]);c.bufferedPullNext&&(this.buffered=c.bufferedPullNext,a.buffered=!0);this.$super(a,b)},afterInit:function(){this.$super();this.getScrollOffset()},updateScrollBuffer:function(a){if(this.buffered)return this.$super(a);a=this.bufferState;var b=this.getBufferState();a&&b.first==a.first&&b.last==a.last||(this.trigger("buffer-change",this,b,a),this.onBufferStateChange(b,a))},onBufferStateChange:function(a,b){var c=this.list,d=c.store.getLength();this.$super(a,
b);d-a.last<(a.last-a.first)/3&&!c.store.loading&&(c.store.addNextPage(),c.trigger("pull",this))}});var eb=N.is,Ya=Xa("outer","Width"),Za=Xa("outer","Height"),Ra={};w({$class:"dialog.position.Abstract",dialog:null,positionBase:null,correct:"solid",$init:function(a){this.dialog=a;v(this,a.getCfg().position,!0,!1);this.onWindowResizeDelegate=r(this.onWindowResize,this);this.onWindowScrollDelegate=r(this.onWindowScroll,this);var b=this.preferredType||this.type;if("string"==typeof b){var c=this.getAllPositions(),
d;-1!=(d=c.indexOf(b))&&(c.splice(d,1),c.unshift(b));this.preferredType=c}else b||(this.preferredType=this.getAllPositions());a.on("reposition",this.onReposition,this);a.on("show-after-delay",this.onShowAfterDelay,this);a.on("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onShowAfterDelay()},getPositionBase:function(){if(this.positionBase)return this.positionBase;var a;return(a=this.dialog.getCfg().position.base)?this.positionBase="string"==typeof a?N(a).shift():a:null},getBoundary:function(){var a=
this.getPositionBase(),b=this.screenX||0,c=this.screenY||0,d,e,f;if(a)return e=za(a),d=Ya(a),a=Za(a),{x:e.left+b,y:e.top+c,x1:e.left+d-b,y1:e.top+a-c,w:d,h:a};d=nb(window);a=ob(window);e=Aa(window);f=Ba(window);return{x:f+b,y:e+c,x1:f+d-b,y1:e+a-c,w:d,h:a}},getPrimaryPosition:function(a){return!1},getSecondaryPosition:function(a){return!1},getAllPositions:function(){return[]},correctPosition:function(a){var b=this.getPrimaryPosition(),c=this.correct;if(b&&c){var d=this.dialog,b=this.getBoundary(),
d=d.getDialogSize(),e=this.preferredType,f=e[0];if(c&&"solid"!=c){if(this.type!=f&&this.checkIfFits(a,f,b,d,!1))return this.changeType(f),this.fitToBoundary(this.getCoords(a),b,d);if(this.checkIfFits(a,this.type,b,d,!1))return this.fitToBoundary(this.getCoords(a),b,d)}if(c&&"position-only"!=c)for(c=0,f=e.length;c<f;c++)if(this.checkIfFits(a,e[c],b,d,!0)){this.changeType(e[c]);break}return this.getCoords(a)}},checkIfFits:function(a,b,c,d,e){a=this.getCoords(a,b,!0);if(!e&&this.getSecondaryPosition(b))return!1;
if(e)return!(a.x<c.x||a.y<c.y||a.x+d.width>c.x1||a.y+d.height>c.y1);switch(this.getPrimaryPosition(b)){case "t":return a.y>=c.y;case "r":return a.x+d.width<=c.x1;case "b":return a.y+d.height<=c.y1;case "l":return a.x>=c.x}},fitToBoundary:function(a,b,c){var d=this.getPositionBase(),e=d?0:b.x,f=d?0:b.y,g=d?b.w:b.x1;b=d?b.h:b.y1;var k=d=0,l=this.dialog.getPointer();a.x<e&&(d=a.x-e,a.x=e);a.y<f&&(k=a.y-f,a.y=f);a.x+c.width>g&&(d=a.x+c.width-g,a.x-=d);a.y+c.height>b&&(k=a.y+c.height-b,a.y-=k);l.setCorrectionOffset(d,
k);l.reposition();return a},changeType:function(a){var b=this.dialog.getPointer();this.type=a;b.setType(null,null)},onReposition:function(a,b){var c;c=!1!==this.screenX||!1!==this.screenY?this.correctPosition(b):this.getCoords(b);this.apply(c)},getCoords:function(a){return{left:0,top:0}},apply:function(a){a&&ja(this.dialog.getElem(),{left:a.x+"px",top:a.y+"px"})},onWindowResize:function(a){this.dialog.reposition(S(a))},onWindowScroll:function(a){this.dialog.reposition(S(a))},onShowAfterDelay:function(){(this.resize||
this.screenX||this.screenY)&&C(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&C(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},onHideAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&T(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&T(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},destroy:function(){var a=this.dialog;a.un("reposition",this.onReposition,
this);a.un("show-after-delay",this.onShowAfterDelay,this);a.un("hide-after-delay",this.onHideAfterDelay,this);if(this.dialog.isVisible())this.onHideAfterDelay()}});w({$class:"dialog.position.Target",$extends:"dialog.position.Abstract",getCoords:function(a,b,c){var d=this.dialog,e=d.getCfg(),f=d.getTarget();if(!f)return null;var g=this.getPositionBase();a=d.getDialogSize();c=g&&!c?db(f,g):za(f);f=d.getTargetSize();g={};b=b||this.type;var k=b.substr(0,1),l=b.substr(1),m=e.position.offsetX,e=e.position.offsetY;
b=d.pointer.getDialogPositionOffset(b);switch(k){case "t":g.y=c.top-a.height-e;break;case "r":g.x=c.left+f.width+m;break;case "b":g.y=c.top+f.height+e;break;case "l":g.x=c.left-a.width-m}switch(l){case "t":g.y=c.top+e;break;case "r":g.x=c.left+f.width-a.width-m;break;case "b":g.y=c.top+f.height-a.height-e;break;case "l":g.x=c.left+m;break;case "rc":g.x=c.left+f.width+m;break;case "lc":g.x=c.left-a.width-m;break;case "":switch(k){case "t":case "b":g.x=c.left+f.width/2-a.width/2;break;case "r":case "l":g.y=
c.top+f.height/2-a.height/2}}b&&(g.x+=b.x,g.y+=b.y);return g},getPrimaryPosition:function(a){return(a||this.type).substr(0,1)},getSecondaryPosition:function(a){return(a||this.type).substr(1)},getAllPositions:function(){return"t r b l tl tr rt rb br bl lb lt tlc trc brc blc".split(" ")}});w({$class:"dialog.position.Mouse",$extends:"dialog.position.Target",correct:"position",$init:function(a){this.onMouseMoveDelegate=r(this.onMouseMove,this);this.$super(a)},getCoords:function(a,b,c){if(!a)return null;
var d=b||this.type,e=this.dialog,f=e.getCfg(),g=e.getDialogSize(),k=this.getPositionBase(),l={};b=(b||this.type).substr(1);var m=f.position.offsetX,p=f.position.offsetY,f=f.position.axis,d=e.getPointer().getDialogPositionOffset(d),q=0,n=0;!c&&k&&(k=za(k),q=k.left,n=k.top);switch(b){case "":l=this.get.call(e.$$callbackContext,e,a,b,c);break;case "c":l.y=a.pageY-n-g.height/2;l.x=a.pageX-q-g.width/2;break;case "t":l.y=a.pageY-n-g.height-p;l.x=a.pageX-q-g.width/2;break;case "r":l.y=a.pageY-n-g.height/
2;l.x=a.pageX-q+m;break;case "b":l.y=a.pageY-n+p;l.x=a.pageX-q-g.width/2;break;case "l":l.y=a.pageY-n-g.height/2;l.x=a.pageX-q-g.width-m;break;case "rt":l.y=a.pageY-n-g.height-p;l.x=a.pageX-q+m;break;case "rb":l.y=a.pageY-n+p;l.x=a.pageX-q+m;break;case "lt":l.y=a.pageY-n-g.height-p;l.x=a.pageX-q-g.width-m;break;case "lb":l.y=a.pageY-n+p,l.x=a.pageX-q-g.width-m}d&&(l.x+=d.x,l.y+=d.y);f&&(a=this.$super(a,b))&&("x"==f?l.y=a.y:l.x=a.x);return l},onShowAfterDelay:function(){this.$super();C(window.document.documentElement,
"mousemove",this.onMouseMoveDelegate)},onHideAfterDelay:function(){this.$super();T(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onMouseMove:function(a){this.dialog.reposition(S(a))},getPrimaryPosition:function(a){return(a||this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||this.type).substr(2)},getAllPositions:function(){return"mt mr mb ml mrt mrb mlb mlt".split(" ")}});w({$class:"dialog.position.Window",$extends:"dialog.position.Abstract",getCoords:function(a){var b=
this.dialog;a=this.getPositionBase()||window;var b=b.getDialogSize(),c={},d=this.type.substr(1),e=this.offsetX,f=this.offsetY,g=Aa(a),k=Ba(a),l=Ya(a);a=Za(a);switch(d){case "c":c.y=a/2-b.height/2+g;c.x=l/2-b.width/2+k;break;case "t":c.y=g+f;c.x=l/2-b.width/2+k;break;case "r":c.y=a/2-b.height/2+g;c.x=l-b.width+k-e;break;case "b":c.y=a-b.height+g-f;c.x=l/2-b.width/2+k;break;case "l":c.y=a/2-b.height/2+g;c.x=k+e;break;case "rt":c.y=g+f;c.x=l-b.width+k-e;break;case "rb":c.y=a-b.height+g-f;c.x=l-b.width+
k-e;break;case "lt":c.y=g+f;c.x=k+e;break;case "lb":c.y=a-b.height+g-f,c.x=k+e}return c},getPrimaryPosition:function(){return this.type.substr(1,1)},getSecondaryPosition:function(){return this.type.substr(2)},correctType:function(){},correctPosition:function(){}});w({$class:"dialog.position.Custom",$extends:"dialog.position.Abstract",getCoords:function(a){var b=this.dialog;return this.get.call(b.$$callbackContext,b,a)}});w({$class:"dialog.pointer.Abstract",enabled:null,node:null,correctX:0,correctY:0,
$init:function(a,b){v(this,b,!0,!1);this.origCfg=b;this.dialog=a;this.opposite={t:"b",r:"l",b:"t",l:"r"};this.names={t:"top",r:"right",b:"bottom",l:"left"};this.sides={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]};this.enabled=!1!==this.enabled&&b.size?!0:!1},enable:function(){this.enabled||(this.enabled=!0,this.render(),this.dialog.isVisible()&&this.dialog.reposition())},disable:function(){this.enabled&&(this.remove(),this.enabled=!1,this.dialog.isVisible()&&this.dialog.reposition())},getElem:function(){return this.node},
getSize:function(){return this.enabled?this.size:0},setCorrectionOffset:function(a,b){this.correctX=a;this.correctY=b},getCorrectionValue:function(a,b,c){if(!b)return 0;var d=c.substr(0,1);c=c.substr(1,1);var e=this.dialog.getDialogSize(),f=this.width,g="t"==d||"b"==d?"width":"height",k,l;switch(c){case "":l=e[g]/2-f/2;k=-l;break;case "l":k=0;l=e[g]-f/2;break;case "r":k=-(e[g]-f/2),l=0}b=0>b?Math.max(k,b):Math.min(l,b);return("t"==d||"b"==d)&&"x"==a||("l"==d||"r"==d)&&"y"==a?b:0},getDialogPositionOffset:function(a){var b=
(this.detectPointerPosition(a)||"").substr(0,1);a=this.dialog.getPosition().getPrimaryPosition(a);var c={x:0,y:0};if(!this.enabled)return c;b==this.opposite[a]&&(c["t"==b||"b"==b?"y":"x"]="b"==b||"r"==b?-this.size:this.size);return c},detectPointerPosition:function(a){var b;if(this.position&&!a)return A(this.position)?this.position.call(this.dialog.$$callbackContext,this.dialog,this.origCfg):this.position;b=this.dialog.getPosition().getPrimaryPosition(a);a=this.dialog.getPosition().getSecondaryPosition(a);
if(!b)return null;b=this.opposite[b];a&&(a=a.substr(0,1),b+=a);return b},detectPointerDirection:function(a){return this.direction?A(this.direction)?this.direction.call(this.dialog.$$callbackContext,this.dialog,a,this.origCfg):this.direction:a},update:function(){this.remove();this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},setType:function(a,b){this.position=a;this.direction=b;this.update();this.reposition()},render:function(){},destroy:function(){this.remove()},reposition:function(){},
append:function(){if(this.enabled&&(this.node||this.render(),this.node)){this.reposition();var a=this.dialog.getElem();a&&a.appendChild(this.node)}},remove:function(){var a=this.node;a&&(a.parentNode&&a.parentNode.removeChild(a),this.node=null)}});(function(){var a=null,b={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"};return w({$class:"dialog.pointer.Html",$extends:"dialog.pointer.Abstract",node:null,sub:null,$init:function(b,d){null===
a&&(a=window.document.all&&!window.XMLHttpRequest);this.$super(b,d);this.width=this.width||2*this.size;this.inner&&(this.enabled=!0)},createInner:function(){var a=v({},this.origCfg);a.size=this.size-2*this.border;a.width=this.width-4*this.border;a.border=0;a.borderColor=null;a.borderCls=null;a.offset=0;a.inner=this.border;this.sub=la("dialog.pointer.Html",this.dialog,a)},getBorders:function(b,d,e){var f={},g=b.substr(0,1);b=d.substr(0,1);var k=d.substr(1);d=a?"dotted":"solid";var l=this.names,m=this.sides,
p=this.opposite;f["border"+ra(l[p[g]])]=this.size+"px solid "+e;f["border"+ra(l[g])]="0 "+d+" transparent";k?(f["border"+ra(l[k])]="0 solid transparent",f["border"+ra(l[p[k]])]=this.width+"px "+d+" transparent"):(e=Math.floor(this.width/2),f["border"+ra(l[m[b][0]])]=e+"px "+d+" transparent",f["border"+ra(l[m[b][1]])]=e+"px "+d+" transparent");return f},getOffsets:function(a,b){var e={},f=this.names,g=this.opposite,k=a.substr(0,1),l="t"==k||"b"==k?"r":"b";e[f[k]]=this.inner?"auto":-this.size+"px";
e[f[l]]="auto";if(this.inner){var k=b.substr(0,1),m=b.substr(1);e[f[g[l]]]=m?"l"==m||"t"==m?this.inner+"px":-this.width-this.inner+"px":Math.floor(-this.width/2)+"px";e[f[g[k]]]=-(this.size+2*this.inner)+"px"}else{switch(a){case "t":case "r":case "b":case "l":k=b!=a?"l"==b||"t"==b?this.offset:-this.width+this.offset:-this.width/2+this.offset;break;case "bl":case "tl":case "lt":case "rt":k=this.offset;break;default:k=-this.width-this.offset}e["margin"+ra(f[g[l]])]=k+"px";switch(a){case "t":case "r":case "b":case "l":k=
"50%";break;case "tr":case "rb":case "br":case "lb":k="100%";break;default:k=0}e[f[g[l]]]=k;f=Ca().transform;g="";l=this.correctX;k=this.correctY;f&&(l&&(g+=" translateX("+this.getCorrectionValue("x",l,a)+"px)"),k&&(g+=" translateY("+this.getCorrectionValue("y",k,a)+"px)"),e[f]=g)}return e},render:function(){if(this.enabled&&!this.node&&this.detectPointerPosition()){this.border&&!this.sub&&this.createInner();this.node=window.document.createElement("div");var a=window.document.createComment(" ");this.node.appendChild(a);
ja(this.node,b);Q(this.node,this.borderCls||this.cls);this.sub&&(this.sub.render(),this.node.appendChild(this.sub.getElem()))}},reposition:function(){var a=this.detectPointerPosition(),b=this.detectPointerDirection(a);this.node&&(ja(this.node,this.getBorders(a,b,this.borderColor||this.color)),ja(this.node,this.getOffsets(a,b)),this.sub&&this.sub.reposition())},update:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.remove();this.node=null;this.render();this.append();this.dialog.isVisible()&&
this.dialog.reposition()},destroy:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.$super()},remove:function(){this.sub&&this.sub.remove();this.$super()}})})();w({$class:"dialog.Overlay",dialog:null,enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1,$init:function(a){this.dialog=a;this.onClickDelegate=r(this.onClick,this);v(this,a.getCfg().overlay,!0,!1);this.enabled&&(this.enabled=!1,this.enable())},getElem:function(){this.enabled&&!this.node&&this.render();return this.node},
enable:function(){this.enabled||(this.enabled=!0)},disable:function(){this.enabled&&(this.remove(),this.enabled=!1)},show:function(a){this.enabled&&(this.animateShow?this.animate("show",a):this.node.style.display="block")},hide:function(a){this.node&&(this.animateHide?this.animate("hide",a):this.node.style.display="none")},render:function(){if(this.enabled){var a=window.document.createElement("div"),b=this.dialog.getCfg();ja(a,{display:"none",position:"fixed",left:0,top:0,right:0,bottom:0,opacity:this.opacity,
backgroundColor:this.color});C(a,"click",this.onClickDelegate);b.render.zIndex&&ja(a,"zIndex",b.render.zIndex);this.cls&&Q(a,this.cls);this.node=a}},remove:function(){var a=this.dialog,b=this.node;b&&H(function(){!a.isVisible()&&b.parentNode&&b.parentNode.removeChild(b)})},append:function(){var a=this.dialog.getCfg().render.appendTo||window.document.body;this.enabled&&(this.node||this.render(),a.appendChild(this.node))},animate:function(a,b){var c=this.node,d;d="show"==a?this.animateShow:this.animateHide;
A(d)&&(d=d(this,b));va(d)?d=a:y(d)&&(d=[d]);return V(c,d,function(){if("show"==a){var b=new D;H(function(){c.style.display="";b.resolve()});return b}},!1)},onClick:function(a){return this.modal?(a=S(a),a.preventDefault(),a.stopPropagation(),!1):null},destroy:function(){this.remove()}});w({$class:"dialog.Manager",all:null,groups:null,$init:function(){this.all={};this.groups={}},register:function(a){var b=a.getInstanceId(),c=a.getGroup(),d=this.groups,e,f,g;this.all[b]=a;e=0;for(f=c.length;e<f;e++)g=
c[e],d[g]||(d[g]={}),d[g][b]=!0;a.on("destroy",this.unregister,this)},unregister:function(a){a=a.getInstanceId();delete this.all[a]},hideAll:function(a){var b=a.getInstanceId();a=a.getGroup();var c=this.all,d=this.groups,e,f,g,k;e=0;for(f=a.length;e<f;e++)for(k in g=a[e],g=d[g],g)c[k]?k==b||c[k].isHideAllIgnored()||c[k].hide(null,!0,!0):delete g[k]}});var kc=function(){var a=la("dialog.Manager"),b=function(a,b,c,d){if("show"==c||!d)return b.preventDefault(),b.stopPropagation(),!1},c=function(a,b,
c,d){var e=a[b],f=!1;if(void 0!==e){switch(d){case "string":f=y(e);break;case "function":f=A(e);break;case "number":f=1===W(e)||e==parseInt(e);break;case "dom":f=e&&(e.tagName||e.nodeName)?!0:!1;break;case "jquery":(f=e&&e.jquery?!0:!1)&&(e=e.get(0));break;case "boolean":if(!0===e||!1===e)f=!0;break;default:!0===d&&!0===e&&(f=!0),!1===d&&!1===e&&(f=!0)}f&&(a[b]={},a[b][c]=e)}},d=function(a){if(!a)return{};c(a,"content","value","string");c(a,"content","value","boolean");c(a,"content","fn","function");
c(a,"ajax","url","string");c(a,"cls","dialog","string");c(a,"render","tpl","string");c(a,"render","fn","function");c(a,"render","el","dom");c(a,"render","el","jquery");c(a,"show","events",!1);c(a,"show","events","string");c(a,"hide","events",!1);c(a,"hide","events","string");c(a,"toggle","events",!1);c(a,"toggle","events","string");c(a,"position","type","string");c(a,"position","type",!1);c(a,"position","get","function");c(a,"overlay","enabled","boolean");c(a,"pointer","position","string");c(a,"pointer",
"size","number");return a},e={target:null,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},ajax:{url:null,data:null,dataType:"text",method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",fn:null,el:null,zIndex:null,lazy:!0,style:null,appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{"*":{process:b}},hide:{"*":{process:b}}},show:{delay:null,single:!1,events:null,
animate:!1,ignoreHideAll:!1,focus:!1,preventScroll:!1,display:"block"},hide:{delay:null,timeout:null,events:null,destroy:!1,remove:!1,animate:!1,cancelShowDelay:!0},toggle:{events:null},position:{type:"t",preferredType:null,offsetX:0,offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,base:null,scroll:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",opacity:.5,cls:null,
animateShow:!1,animateHide:!1},callback:{scope:null,contentchange:null,beforeshow:null,show:null,beforehide:null,hide:null,render:null,lifetime:null,targetchange:null,button:null}},f=w({$class:"Dialog",$mixins:["mixin.Observable"],id:null,node:null,overlay:null,pointer:null,cfg:null,position:null,target:null,dynamicTarget:!1,dynamicTargetEl:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,bindSelfOnRender:!1,hideTimeout:null,hideDelay:null,showDelay:null,destroyDelay:null,images:0,positionGetType:null,
positionClass:null,positionAttempt:0,$init:function(b){b=b||{};var c=b.preset;b.preset=null;this.cfg=b=v({},e,d(f.defaults),d(f[c]),d(b),!0,!0);this.id=R();this.onPreventScrollDelegate=r(this.onPreventScroll,this);this.onButtonClickDelegate=r(this.onButtonClick,this);this.onButtonKeyupDelegate=r(this.onButtonKeyup,this);this.showDelegate=r(this.show,this);this.hideDelegate=r(this.hide,this);this.toggleDelegate=r(this.toggle,this);this.onImageLoadDelegate=r(this.onImageLoad,this);a.register(this);
b.modal&&(b.overlay.enabled=!0);this.overlay=la("dialog.Overlay",this);c=ra(b.pointer.$class||"Html");this.pointer=la("dialog.pointer."+c,this,b.pointer);A(b.position.type)&&(this.positionGetType=b.position.type);this.setTarget(b.target);b.target&&b.useHref&&(c=x(this.getTarget(),"href"),"#"==c.substr(0,1)?b.render.el=c:b.ajax.url=c);b.render.lazy||this.render();this.trigger("init",this);this.setHandlers("bind")},getElem:function(){return this.node},getInstanceId:function(){return this.id},getCfg:function(){return this.cfg},
getPointer:function(){return this.pointer},getOverlay:function(){return this.overlay},isEnabled:function(){return this.enabled},isVisible:function(){return this.visible},isHideAllIgnored:function(){return this.cfg.show.ignoreHideAll},isFrozen:function(){return this.frozen},isRendered:function(){return this.rendered},enable:function(){this.enabled=!0},disable:function(){this.hide();this.enabled=!1},freeze:function(){this.frozen=!0},unfreeze:function(){this.frozen=!1},getGroup:function(){var a=this.cfg;
return a.group?y(a.group)?[a.group]:a.group:[""]},toggle:function(a,b){return a&&a.stopPropagation&&this.dynamicTarget&&this.visible&&this.isDynamicTargetChanged(a)?this.show(a):this[this.visible?"hide":"show"](a,b)},resetHandlers:function(a,b){this.setHandlers("unbind");this.bindSelfOnRender=!1;a&&a.call(b,this,this.getCfg());this.setHandlers("bind")},setHandlers:function(a,b){for(var c=this.cfg,d=["show","hide","toggle"],e="bind"==a?C:T,f="bind"==a?Tb:Ub,n,u,s,t,r,v,w,x,z,A;n=d.shift();)if(u=c[n].events,
!1!==u){if(y(u)||P(u))this.dynamicTarget?(r={},r[u]=c.target,u={_html:r}):u={_target:u};for(s in u){if(b)if("_self"==b){if("_self"!=s&&"_overlay"!=s&&">"!=s.substr(0,1))continue}else if(s!=b)continue;if("_self"!=s&&"_overlay"!=s&&">"!=s.substr(0,1)||this.node){if(w=u[s]){switch(s){case "_target":x=[this.getTarget()];break;case "_self":x=[this.node];break;case "_window":x=[window];break;case "_document":x=[window.document];break;case "_html":x=[window.document.documentElement];break;case "_overlay":x=
[this.overlay.getElem()];break;default:x=">"==s.substr(0,1)?N(s.substr(1),this.node):N(s)}if(x&&x.length)if(y(w)&&(w=[w]),P(w))for(r=0,v=w.length;r<v;r++)for(z=-1,A=x.length;++z<A;e(x[z],w[r],this[n+"Delegate"]));else for(t in w)for(z=-1,A=x.length;++z<A;f(x[z],w[t],t,this[n+"Delegate"]));}}else this.bindSelfOnRender=!0}}},onPreventScroll:function(a){S(a).preventDefault()},onButtonClick:function(a){var b=S(a).target;(b=I(b,"metaphorjsTooltip-button-id"))&&this.trigger("button",this,b,a)},onButtonKeyup:function(a){if(13==
a.keyCode||32==a.keyCode){var b=I(a.target,"metaphorjsTooltip-button-id");b&&this.trigger("button",this,b,S(a))}},show:function(b,c){var d=this.cfg,e=null,f=d.show,q=null;this.isEnabled()||(q="disabled");!q&&this.visible&&this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=fa(this.hide,this,null,d.hide.timeout),q="hidetimeout");!q&&this.hideDelay&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0,q="hidedelay");!q&&this.frozen&&(q="frozen");this.destroyDelay&&
(window.clearTimeout(this.destroyDelay),this.destroyDelay=null);var n=!1;b&&b.stopPropagation&&this.dynamicTarget&&(n=this.changeDynamicTarget(b));this.visible&&(n?(this.reposition(b),q="reposition"):q=q||"visible");if(!q||n)this.node?n&&this.changeDynamicContent():this.render();q||!1!==this.trigger("before-show",this,b)||(q="beforeshow");b&&b.stopPropagation&&d.events.show&&(d.events.show[b.type]||d.events.show["*"])&&(d=d.events.show[b.type]||d.events.show["*"],d.process?e=d.process(this,b,"show",
q):(d.stopPropagation&&b.stopPropagation(),d.preventDefault&&b.preventDefault(),e=d.returnValue));if(q)return q;ta(this.node);this.visible=!0;f.single&&a.hideAll(this);this.toggleTitleAttribute(!1);f.delay&&!c?this.showDelay=fa(this.showAfterDelay,this,[b],f.delay):this.showAfterDelay(b,c);return e},showAfterDelay:function(a,b){var c=this,d=c.cfg;c.showDelay=null;if(c.visible){c.trigger("show-after-delay",c,a);d.hide.remove&&c.appendElem();c.reposition(a);if(d.show.preventScroll){var e=d.show.preventScroll,
f,n;!0===e&&(e="body");e=N(e);f=-1;for(n=e.length;++f<n;C(e[f],"mousewheel",c.onPreventScrollDelegate)&&C(e[f],"touchmove",c.onPreventScrollDelegate));}c.overlay.show();d.show.animate&&!b?c.animate("show").done(function(){c.showAfterAnimation(a)}):H(function(){c.showAfterAnimation(a)})}},showAfterAnimation:function(a){var b=this.cfg,c=this.node;this.visible&&(F(c,b.cls.hidden),Q(c,b.cls.visible),b.render.keepVisible||(c.style.display=b.show.display||"block"),b.hide.timeout&&(this.hideTimeout=fa(this.hide,
this,null,b.hide.timeout)),b.show.focus&&fa(this.setFocus,this,null,20),this.trigger("show",this,a))},hide:function(a,b,c){var d=null,e=null,f=this.cfg;this.hideTimeout=null;!this.visible&&this.hideDelay&&b&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0);this.node&&this.visible&&this.isEnabled()||(e=this.node?this.visible?"disabled":"hidden":"noelem");this.showDelay&&!e&&(f.hide.cancelShowDelay||c?(window.clearTimeout(this.showDelay),this.showDelay=null,this.visible=!1,
e="cancel"):e="delay");this.frozen&&!e&&(e="frozen");e||!1!==this.trigger("before-hide",this,a)||(e="beforehide");a&&a.stopPropagation&&f.events.hide&&(f.events.hide[a.type]||f.events.hide["*"])&&(c=f.events.hide[a.type]||f.events.hide["*"],c.process?d=c.process(this,a,"hide",e):(c.stopPropagation&&a.stopPropagation(),c.preventDefault&&a.preventDefault(),d=c.returnValue));if(e)return d;ta(this.node);this.visible=!1;this.toggleTitleAttribute(!0);this.dynamicTarget&&this.resetDynamicTarget();f.hide.delay&&
!b?this.hideDelay=fa(this.hideAfterDelay,this,[a],f.hide.delay):this.hideAfterDelay(a,b);return d},hideAfterDelay:function(a,b){var c=this,d=c.cfg;c.hideDelay=null;if(!c.visible){c.trigger("hide-after-delay",c,a);if(d.show.preventScroll){var e=d.show.preventScroll,f,n;!0===e&&(e="body");e=N(e);f=-1;for(n=e.length;++f<n;T(e[f],"mousewheel",c.onPreventScrollDelegate)&&T(e[f],"touchmove",c.onPreventScrollDelegate));}c.overlay.hide();d.hide.animate&&!b?c.animate("hide").done(function(){c.hideAfterAnimation(a)}):
H(function(){c.hideAfterAnimation(a)})}},hideAfterAnimation:function(a){var b=this,c=b.cfg,d=b.node;b.visible||(F(d,c.cls.visible),Q(d,c.cls.hidden),c.render.keepVisible||(d.style.display="none"),b.trigger("hide",b,a),a=c.render.lifetime,null!==a&&(0===a?b.destroyElem():b.destroyDelay=fa(b.destroyElem,b,null,a)),d&&c.hide.destroy&&H(function(){I(d,c.instanceName,null);b.destroy()}),d&&c.hide.remove&&H(function(){b.removeElem()}))},render:function(){var a=this.cfg,b;if(!this.node){var c=a.render,d=
a.cls;c.fn&&(b=c.fn.call(this.$$callbackContext,this),c[y(b)?"tpl":"el"]=b);c.el?y(c.el)?(b=N(c.el).shift(),c.keepInDOM=!0):b=c.el:(b=window.document.createElement("div"),b.innerHTML=c.tpl,b=b.firstChild);b||(b=window.document.createElement("div"));this.node=b;c.id&&b.setAttribute("id",c.id);a.render.keepVisible||(b.style.display="none");Q(b,d.dialog);Q(b,d.hidden);c.style&&ja(b,c.style);this.overlay.render();a.hide.remove?b.parentNode&&b.parentNode.removeChild(b):this.appendElem();c.zIndex&&ja(b,
{zIndex:c.zIndex});c=a.content;if(!1!==c.value)if(c.value)this.setContent(c.value);else if(c.fn)this.setContent(c.fn.call(this.$$callbackContext,this));else this[a.ajax.url?"loadContent":"readContent"]();this.pointer.render();this.pointer.append();if(a.buttons)for(var e in a.buttons)if(c=N(a.buttons[e],b).shift())I(c,"metaphorjsTooltip-button-id",e),C(c,"click",this.onButtonClickDelegate),C(c,"keyup",this.onButtonKeyupDelegate);this.bindSelfOnRender&&(this.setHandlers("bind","_self"),this.bindSelfOnRender=
!1);this.rendered=!0;this.trigger("render",this)}},setPositionType:function(a){var b=this.getPositionClass(a);this.cfg.position.type=a;this.positionClass==b&&this.position?this.position.type=a:(this.position&&(this.position.$destroy(),this.position=null),b&&(this.position=la(b,this)));this.isVisible()&&this.reposition()},getPosition:function(a){var b=this.cfg.position;if(!this.position){!this.positionGetType&&"custom"!=b.type&&A(b.get)&&"m"!=b.type&&(b.type="custom");a=this.positionGetType?this.positionGetType.call(this.$$callbackContext,
this,a):b.type;var c=this.getPositionClass(a);b.type=a;if(!1===c)return;this.positionClass!=c?this.position=la(this.getPositionClass(a),this):this.position.type=a}return this.position},getPositionClass:function(a){return a?A(a)||"custom"==a?"dialog.position.Custom":(a=a.substr(0,1))?"w"==a?"dialog.position.Window":"m"==a?"dialog.position.Mouse":"dialog.position.Target":!1:!1},reposition:function(a){this.repositioning||(this.repositioning=!0,a&&(a=S(a)),this.getPosition(a),this.trigger("before-reposition",
this,a),this.getPosition(a),this.trigger("reposition",this,a),this.repositioning=!1)},getTarget:function(){return this.dynamicTarget?this.dynamicTargetEl:this.target},setTarget:function(a){if(a){var b=!1,c=this.target;this.target?(this.setHandlers("unbind","_target"),b=!0):this.dynamicTarget&&(b=!0);var d=y(a);d&&"#"!=a.substr(0,1)?(this.dynamicTarget=!0,this.target=null):(d&&(a=N(a).shift()),this.dynamicTarget=!1,this.target=a);b&&(this.setHandlers("bind","_target"),this.trigger("target-change",
this,a,c))}},resetDynamicTarget:function(){var a=this.dynamicTargetEl;a&&(this.setHandlers("unbind","_target"),this.trigger("target-change",this,null,a))},isDynamicTargetChanged:function(a){var b=this.cfg.target;a=a.target;for(var c=this.dynamicTargetEl;a&&!eb(a,b);)a=a.parentNode;return a?!c||c!==a:!1},changeDynamicTarget:function(a){var b=this.cfg.target;a=a.target;for(var c=this.dynamicTargetEl;a&&!eb(a,b);)a=a.parentNode;if(!a||c&&c===a)return!1;c&&this.setHandlers("unbind","_target");this.dynamicTargetEl=
a;this.setHandlers("bind","_target");this.trigger("target-change",this,a,c);return!0},getContentElem:function(){var a=this.node;return a?this.cfg.selector.content?N(this.cfg.selector.content,a).shift()||a:a:null},setContent:function(a,b){b=b||"";var c=this.node,d=this.cfg,e=this.pointer;if(!c)return d.content.value=a,this;d.content.prepare&&(a=d.content.prepare.call(this.$$callbackContext,this,b,a));var f=this.getContentElem(),n=this.rendered&&!d.selector.content&&e,e=n&&e.getElem();if(n&&e)try{c.removeChild(e)}catch(r){}if(y(a))f.innerHTML=
a;else for(var s in a){var t=d.selector[s];t&&(t=N(t,f).shift())&&(t.innerHTML=a[s])}if(n&&e)try{c.appendChild(e)}catch(v){}c=N("img",f);this.images=c.length;s=-1;for(d=c.length;++s<d;C(c[s],"load",this.onImageLoadDelegate));this.trigger("content-change",this,a,b);this.onContentChange()},readContent:function(){var a=this.cfg,b=this.getTarget(),c;b&&(c=a.content.attr?x(b,a.content.attr):x(b,"tooltip")||x(b,"title")||x(b,"alt"));c&&this.setContent(c,"attribute")},loadContent:function(a){var b=this.cfg;
Q(this.node,b.cls.loading);a=v({},b.ajax,a,!0,!0);this.trigger("before-ajax",this,a);return Va(a).done(this.onAjaxLoad,this)},onAjaxLoad:function(a){F(this.node,this.cfg.cls.loading);this.setContent(a,"ajax")},onImageLoad:function(){this.images--;this.onContentChange()},onContentChange:function(){this.visible&&this.reposition()},changeDynamicContent:function(){var a=this.cfg;a.content.fn?this.setContent(a.content.fn.call(this.$$callbackContext,this)):a.content.attr&&this.readContent()},toggleTitleAttribute:function(a){var b=
this.getTarget(),c;b&&(!1===a?(I(b,"tmp-title",x(b,"title")),b.removeAttribute("title")):(c=I(b,"tmp-title"))&&b.setAttribute("title",c))},getDialogSize:function(){this.rendered||this.render();var a=this.cfg,b=this.node,c=a.cls.hidden?Pa(b,a.cls.hidden):!(b&&!(0>=b.offsetWidth||0>=b.offsetHeight)),d=b.style.left;c&&(ja(b,{left:"-1000px"}),b.style.display=a.show.display);a={width:Ya(b),height:Za(b)};c&&(ja(b,{left:d}),b.style.display="none");return a},getTargetSize:function(){var a=this.getTarget();
return a?{width:Ya(a),height:Za(a)}:null},setFocus:function(){var a=this.cfg,b=a.show.focus,c=this.node,d;if(!0===b)if(b=N("input",c).concat(N("textarea",c)),0<b.length)b[0].focus();else{if(a.buttons)for(d in a.buttons){(a=N(a.buttons[d],c).shift())&&a.focus();break}}else(a=N(b,c).shift())&&a.focus()},getScrollEl:function(a){return!0===a||!1===a?window:"string"==typeof a?N(a).shift():a},animate:function(a,b){var c=this.cfg,d=this.node,e,f;e=c[a].animate;A(e)&&(e=e(this,b));f=e.skipDisplayChange||
!1;va(e)?e=a:y(e)&&(e=[e]);return V(d,e,function(){if("show"==a&&!f){var b=new D;H(function(){d.style.display=c.show.display||"block";b.resolve()});return b}},!1)},removeElem:function(){var a=this,b=a.node;a.overlay.remove();b&&b.parentNode&&H(function(){a.visible||b.parentNode.removeChild(b)})},appendElem:function(){var a=window.document.body,a=this.cfg.render.appendTo||a;this.overlay.append();this.node&&a.appendChild(this.node)},destroyElem:function(){var a=this.node;this.setHandlers("unbind","_self");
this.bindSelfOnRender=!0;this.pointer.remove();this.overlay.remove();a&&(this.cfg.render.keepInDOM||a.parentNode.removeChild(a),this.node=null);this.trigger("lifetime",this)},destroy:function(){this.trigger("destroy",this);T(window,"resize",this.onWindowResizeDelegate);T(window,"scroll",this.onWindowScrollDelegate);this.setHandlers("unbind");this.destroyElem();this.overlay&&this.overlay.$destroy();this.pointer&&this.pointer.$destroy();this.position&&this.position.$destroy()}},{defaults:null});return f}();
bc.$extend({$class:"dialog.Component",dialog:null,dialogPreset:null,dialogCfg:null,dialogNode:null,hidden:!0,target:null,isTooltip:!1,$init:function(a){this.isTooltip&&(this.target=a.node,a.node=null);this.$super(a)},initComponent:function(){this.$super();this._createDialog()},_getDialogCfg:function(){return v({},this.dialogCfg,{preset:this.dialogPreset,render:{el:this.dialogNode||this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=new kc(this._getDialogCfg());this.dialog.on("show",
this.onDialogShow,this);this.dialog.on("hide",this.onDialogHide,this);this.dialog.on("before-show",this.onBeforeDialogShow,this);this.dialog.on("before-hide",this.onBeforeDialogHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},onRenderingFinished:function(){this.rendered=!0;this.afterRender();this.trigger("after-render",this)},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},onBeforeDialogShow:function(){this.rendered||this.render();this.template.setAnimation(!0);
this.hidden=!1},onDialogShow:function(){this.onShow();this.trigger("show",this)},onBeforeDialogHide:function(){},onDialogHide:function(){this.template.setAnimation(!1);this.hidden=!0;this.onHide();this.trigger("hide",this)},onDialogDestroy:function(){this.destroying||(this.dialog=null,this.$destroy())},destroy:function(){this.destroying=!0;this.dialog&&this.dialog.destroy();this.$super()}});B.register("validator.messages",{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",
url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:"Please enter no more than {0} characters.",minlength:"Please enter at least {0} characters.",rangelength:"Please enter a value between {0} and {1} characters long.",
range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."});B.register("validator.checkable",function(a){return/radio|checkbox/i.test(a.type)});(function(){var a=B.get("validator.checkable");return B.register("validator.getLength",function(b,c){var d=0;switch(c.nodeName.toLowerCase()){case "select":return Sa(c,function(a){a.selected&&d++}),d;case "input":if(a(c)){if(c.form)Sa(c.form,function(a){a.type==
c.type&&a.name==c.name&&a.checked&&d++});else{var e,f,g;if(Na(c))e=c.ownerDocument;else for(e=c;e.parentNode;)e=e.parentNode;e=N("input[name="+c.name+"]",e);f=0;for(g=e.length;f<g;f++)e[f].checked&&d++}return d}}return b.length})})();(function(){var a=B.get("validator.checkable"),b=B.get("validator.getLength");return B.register("validator.empty",function(c,d){if(!d)return void 0==c||""===c;switch(d.nodeName.toLowerCase()){case "select":var e=ua(d);return!e||0==e.length;case "input":if(a(d))return 0==
b(c,d)}return 0==L(c).length})})();(function(){var a=B.get("validator.empty"),b=B.get("validator.getLength");return B.register("validator.methods",{required:function(b,d,e){return!1===e?!0:!a(b,d)},regexp:function(b,d,e){e=e instanceof RegExp?e:new RegExp(e);return a(b,d)||e.test(b)},notregexp:function(b,d,e){e=e instanceof RegExp?e:new RegExp(e);return a(b,d)||!e.test(b)},minlength:function(c,d,e){return a(c,d)||(d?b(L(c),d)>=e:c.toString().length>=e)},maxlength:function(c,d,e){return a(c,d)||(d?
b(L(c),d)<=e:c.toString().length<=e)},rangelength:function(c,d,e){var f=d?b(L(c),d):c.toString().length;return a(c,d)||f>=e[0]&&f<=e[1]},min:function(b,d,e){return a(b,d)||parseInt(b,10)>=e},max:function(b,d,e){return a(b,d)||parseInt(b,10)<=e},range:function(b,d,e){b=parseInt(b,10);return a(b,d)||b>=e[0]&&b<=e[1]},email:function(b,d){return a(b,d)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(b)},
url:function(b,d){return a(b,d)||rUrl.test(b)},date:function(b,d){return a(b,d)||!/Invalid|NaN/.test(new Date(b))},dateiso:function(b,d){return a(b,d)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(b)},number:function(b,d){return a(b,d)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(b)},digits:function(b,d){return a(b,d)||/^\d+$/.test(b)},creditcard:function(b,d){if(a(b,d))return!0;if(/[^0-9-]+/.test(b))return!1;var e=0,f=!1,g;b=b.replace(/\D/g,"");for(var k=b.length-1;0<=k;k--)g=b.charAt(k),g=parseInt(g,
10),f&&9<(g*=2)&&(g-=9),e+=g,f=!f;return 0==e%10},accept:function(b,d,e){e=y(e)?e.replace(/,/g,"|"):"png|jpe?g|gif";return a(b,d)||b.match(new RegExp(".("+e+")$","i"))},equalto:function(a,b,e,f){e=(b=f.getValidator().getField(e))?b.getElem():e;return a==ua(e)},notequalto:function(a,b,e,f){e=(b=f.getValidator().getField(e))?b.getElem():e;return a!=ua(e)},zxcvbn:function(a,b,e){return zxcvbn(a).score>=parseInt(e)}})})();B.register("validator.format",function(a,b){if(A(b))return a;P(b)||(b=[b]);var c,
d=b.length;for(c=-1;++c<d;a=a.replace(new RegExp("\\{"+c+"\\}","g"),b[c]));return a});(function(){var a={allowSubmit:!0,alwaysCheck:!1,alwaysDisplayState:!1,data:null,ignore:null,disabled:!1,cls:{valid:"",error:"",ajax:""},errorBox:{cls:"",fn:null,tag:"",position:"after",elem:null,enabled:!0},callback:{scope:null,destroy:null,statechange:null,errorchange:null,submit:null,check:null,beforeAjax:null,afterAjax:null,displaystate:null},rules:{},messages:{}},b=function(a){if(!a)return{};var b=function(b,
c,d){var e=a[b],f=!1;if(void 0!==e){switch(d){case "string":f=y(e);break;case "function":f=A(e);break;case "boolean":f=va(e)}f&&(a[b]={},a[b][c]=e)}};b("errorBox","enabled","boolean");b("errorBox","tag","string");b("errorBox","fn","function");return a},c=B.get("validator.messages"),d=B.get("validator.methods"),e=B.get("validator.empty"),f=B.get("validator.format"),g=w({$class:"validator.Field",$mixins:["mixin.Observable"],vldr:null,elem:null,rules:null,cfg:null,input:null,enabled:!0,valid:null,dirty:!1,
id:null,prev:"",error:null,errorRule:null,pending:null,rulesNum:0,displayState:!1,data:null,checking:!1,checkTmt:null,errorBox:null,customError:!1,$init:function(d,e,f){e=e||{};var p;this.cfg=p=v({},a,b(g.defaults),b(e),!0,!0);this.input=ga.get(d);this.input.onChange(this.onInputChange,this);this.input.onKey(13,this.onInputSubmit,this);this.elem=d;this.vldr=f;this.enabled=!d.disabled;this.id=x(d,"name")||x(d,"id");this.data=e.data;this.rules={};p.messages=v({},c,p.messages,!0,!0);e=f.getVldId();d.setAttribute("data-validator",
e);this.input.radio&&this.initRadio();p.rules&&this.setRules(p.rules,!1);this.readRules();this.prev=this.input.getValue();p.disabled&&this.disable()},getValidator:function(){return this.vldr},initRadio:function(){var a=this.input.radio,b=this.vldr.getVldId(),c,d;c=0;for(d=a.length;c<d;c++)a[c].setAttribute("data-validator",b)},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check(!1):this.setValidState(null);return this},setRule:function(a,b,c){var d=this.rules;
c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check(!1):this.setValidState(null);return this},setMessage:function(a,b){this.cfg.messages[a]=b;return this},setMessages:function(a){for(var b in a)this.setMessage(b,a[b]);return this},getMessages:function(){return v({},this.cfg.messages)},readRules:function(){var a=this.elem,b=a.className,c={},e,f;for(f in d)d.hasOwnProperty(f)&&(e=x(a,f)||x(a,"data-validate-"+
f),void 0!=e&&!1!==e&&("minlength"!=f&&"maxlength"!=f||-1!=parseInt(e,10))&&(c[f]=e,(e=x(a,"data-message-"+f))&&this.setMessage(f,e)));if(e=x(a,"remote"))c.remote=e;if(b)for(b=b.split(" "),f=0,e=b.length;f<e;f++)if(a=L(b[f]),d[a]||"remote"==a)c[a]=!0;for(f in c)this.setRule(f,c[f],!1)},getRules:function(){return this.rules},hasRule:function(a){return this.rules[a]?!0:!1},getValue:function(){return this.input.getValue()},getUserData:function(){return this.data},setUserData:function(a){var b=this.data;
this.data=a;return b},isEmpty:function(){return e(this.getValue(),this.elem)},enable:function(){this.enabled=!0;this.vldr.reset();return this},disable:function(){this.enabled=!1;!1===this.valid&&(this.setValidState(!0),this.doDisplayState());return this},enableDisplayState:function(){this.displayState=!0},disableDisplayState:function(){this.displayState=!1},isDisplayStateEnabled:function(){return this.displayState},toggleErrorBox:function(a){var b=this.cfg,c=b.errorBox.enabled;b.errorBox.enabled=
a;!c&&a&&a.displayState&&!1===this.valid()&&this.doDisplayState()},isEnabled:function(){return this.enabled},getElem:function(){return this.elem},getName:function(){return this.id},getError:function(){return this.error},getErrorRule:function(){return this.errorRule},isValid:function(){return this.isEnabled()?this.customError?!1:!0===this.valid&&!this.pending||0===this.rulesNum:!0},getExactValidState:function(){return this.valid},setCustomError:function(a,b){this.customError=a?!0:!1;this.setValidState(a?
!1:!0);this.setError(!0===a?null:a,b);this.doDisplayState()},reset:function(){this.abort();this.dirty=!1;this.prev="";this.setValidState(null);this.setError(null);this.doDisplayState();return this},abort:function(){this.pending&&(this.pending.abort(),this.pending=null);return this},check:function(a){var b=this.rules,c=this.cfg,e=this.elem;if(!this.isEnabled())return!0;if(this.customError)return!1;if(0==this.rulesNum&&!1!==this.valid)return!0;if(this.checking)return this.checkTmt||(this.checkTmt=setTimeout(r(this.checkTimeout,
this),100)),!0===this.valid;this.checking=!0;if(!(!0===a||b.equalTo||b.notEqualTo||this.dirty||null===this.valid||c.alwaysCheck))return this.pending||this.doDisplayState(),this.checking=!1,!0===this.valid;var g=!0,n=!1,u=this.getValue(),s,t;for(t in b)if("remote"==t){if(this.dirty||c.alwaysCheck||null===this.valid||!0===a)if(u||b[t].checkEmpty)n=!0}else if(!0!==(s=(A(b[t])?b[t]:d[t]).call(this.$$callbackContext,u,e,b[t],this))){g=!1;this.setError(f(s||c.messages[t]||"",b[t]),t);break}n=n&&g;g&&this.setError(null);
n?this.ajaxCheck():(this.setValidState(g),this.doDisplayState());this.checking=this.dirty=!1;this.trigger("check",this,this.valid);return!0===this.valid&&!n},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,d=a.cls.valid,e=this.elem;this.displayState||a.alwaysDisplayState||(b=null);null===this.valid&&(b=null);c&&(!1===b?Q(e,c):F(e,c));d&&(!0===b?Q(e,d):F(e,d));c=this.getErrorBox();d=this.error;c&&(!1===b&&d&&(c.innerHTML=state.error),c.style.display=!1===b&&d&&a.errorBox.enabled?
"block":"none");this.trigger("display-state",this,b,this.error)},getErrorBox:function(){var a=this.cfg.errorBox;return a.tag||a.fn||a.selector?(!this.errorBox&&a.enabled&&this.createErrorBox(),this.errorBox):null},destroy:function(){this.elem.removeAttribute("data-validator");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this.input.destroy()},isPending:function(){return null!==this.pending},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("state-change",this,
a))},setError:function(a,b){if(this.error!=a||this.errorRule!=b)this.error=a,this.errorRule=b,this.trigger("error-change",this,a,b)},checkTimeout:function(){this.checkTmt=null;this.checking||this.check(!1)},onInputChange:function(a){this.prev!==a&&(this.dirty=!0,this.customError=!1,this.abort(),this.pending||this.check(!1),this.prev=this.input.getValue())},onInputSubmit:function(a){a=S(a);if(!(a.isDefaultPrevented&&a.isDefaultPrevented()||!1!==this.trigger("submit",this,a)))return a.preventDefault(),
!1},createErrorBox:function(){var a=this.cfg.errorBox,b=a.tag,c=a.cls,d=a.fn,e=a.position,a=a.elem;d?this.errorBox=d.call(this.$$callbackContext,this):a?this.errorBox=a:(this.errorBox=window.document.createElement(b),this.errorBox.className=c,b=(b=this.input.radio)?b[b-1]:this.elem,"appendParent"==e?b.parentNode.appendChild(this.errorBox):"before"==e?b.parentNode.insertBefore(this.errorBox,b):b.parentNode.insertBefore(this.errorBox,b.nextSibling))},ajaxCheck:function(){var a=this.elem,b=this.rules.remote,
c=this.getValue(),d=this.cfg,b=v({},y(b)?{url:b}:b,!0);b.data=b.data||{};b.data[b.paramName||x(a,"name")||x(a,"id")]=c;b.handler||(b.dataType="text");b.cache=!1;d.cls.ajax&&Q(a,d.cls.ajax);this.trigger("before-ajax",this,b);this.pending=Va(b);this.pending.done(r(this.onAjaxSuccess,this));this.pending.fail(r(this.onAjaxError,this))},onAjaxSuccess:function(a){var b=this.rules,c=this.cfg;this.pending=null;var d=!0;b.remote.handler?(a=b.remote.handler.call(this.$$callbackContext,this,a),!0!==a&&(this.setError(f(a||
c.messages.remote||"",b.remote),"remote"),d=!1)):a?(this.setError(a,"remote"),d=!1):this.setError(null);c.cls.ajax&&F(this.elem,c.cls.ajax);this.setValidState(d);this.doDisplayState();this.trigger("after-ajax",this)},onAjaxError:function(a,b){var c=this.cfg;c.cls.ajax&&F(this.elem,c.cls.ajax);this.pending=null;"abort"!=b&&"abort"!=a&&(this.setValidState(!1),this.doDisplayState(),this.trigger("after-ajax",this))}},{defaults:{},messages:{}});return g})();(function(){var a={alwaysCheck:!1,alwaysDisplayState:!1,
disabled:!1,value:null,elem:null,errorBox:null,errorField:null,data:null,cls:{valid:"",error:""},fields:[],rules:{},messages:{},callback:{scope:null,destroy:null,statechange:null,errorchange:null,displaystate:null}},b=B.get("validator.messages"),c=B.get("validator.methods"),d=B.get("validator.format"),e=w({$class:"validator.Group",$mixins:["mixin.Observable"],fields:null,rules:null,cfg:null,vldr:null,enabled:!1,invalid:null,valid:null,displayState:!1,rulesNum:0,error:null,data:null,errorBox:null,
el:null,$init:function(c,d){c=c||{};var k;this._vldr=d;this.cfg=k=v({},a,e.defaults,c,!0,!0);this.data=c.data;this.el=c.elem;this.fields={};this.rules={};k.messages=v({},b,k.messages,!0,!0);var l,m;k.rules&&this.setRules(k.rules,!1);if(k.fields)for(l=0,m=c.fields.length;l<m;l++)this.add(d.getField(k.fields[l]));this.enabled=!k.disabled},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},isValid:function(){return!this.enabled||
0===this.invalid&&!0===this.valid},getExactValidState:function(){return this.valid},reset:function(){this.invalid=0;this.setValidState(null);this.setError(null);this.doDisplayState();return this},getUserData:function(){return this.data},getName:function(){return this.cfg.name},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check():this.setValidState(null);return this},setRule:function(a,b,c){var d=this.rules;c=void 0==c?!0:c;null===b?(d[a]&&this.rulesNum--,delete d[a]):
(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check():this.setValidState(null);return this},getRules:function(){return v({},this.rules)},hasRule:function(a){return this.rules[a]?!0:!1},setError:function(a){var b=this.cfg;this.error!=a&&(b.errorField?(this.vldr.getField(b.errorField).setError(a),this.error=null):(this.error=a,this.trigger("error-change",this,a)))},getError:function(){return this.error},getFields:function(){return this.fields},enableDisplayState:function(){this.displayState=
!0;return this},disableDisplayState:function(){this.displayState=!1;return this},check:function(){var a=this.cfg,b=this.fields,e=this.rules;if(!this.enabled||0==this.rulesNum)return this.setValidState(null),this.doDisplayState(),!0;this.countInvalid();if(0<this.invalid)return this.setValidState(null),this.doDisplayState(),!0;var l={},m=!0,p=null,q;if(a.value){for(q in b)l[q]=b[q].getValue();p=a.value.call(this.$$callbackContext,l,this)}for(q in e)if(!0!==(b=(A(e[q])?e[q]:c[q]).call(this.$$callbackContext,
p,null,e[q],this,l))){m=!1;b||a.messages[q]?this.setError(d(b||a.messages[q]||"",e[q])):this.setError(null);break}m&&this.setError(null);this.setValidState(m);this.doDisplayState();return!0===this.valid},doDisplayState:function(){var a=this.valid,b=this.cfg;this.displayState||b.alwaysDisplayState||(a=null);if(b.errorBox){var c=this.getErrorBox();null!==a?c&&(c.innerHTML=this.error||"",c.style.display=!1===this.valid?"block":"none"):c&&(c.style.display="none")}c=b.cls.error;b=b.cls.valid;a=this.valid;
c&&(!1===a?Q(this.el,c):F(this.el,c));b&&(!0===a?Q(this.el,b):F(this.el,b));this.trigger("display-state",this,this.valid)},getErrorBox:function(){var a=this.cfg,b=this.fields,c=a.errorBox;if(b[c])return b[c].getErrorBox();this.errorBox||(A(a.errorBox)?this.errorBox=a.errorBox.call(this.$$callbackContext,this):this.errorBox=a.errorBox);return this.errorBox},destroy:function(){var a=this.fields,b;for(b in a)a[b]&&this.setFieldEvents(a[b],"un");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox)},
add:function(a){var b=this.fields,c=a.getName();b[c]||(b[c]=a,this.setFieldEvents(a,"on"))},setFieldEvents:function(a,b){a[b]("state-change",this.onFieldStateChange,this)},remove:function(a){var b=this.fields,c=a.getName();b[c]&&(delete b[c],this.setFieldEvents(a,"un"));return this},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("state-change",this,a))},countInvalid:function(){var a=this.fields;this.invalid=0;for(var b in a)this.invalid+=a[b].isValid()?0:1},onFieldStateChange:function(a,
b){this.trigger("field-state-change",this,a,b);this.check()}},{defaults:{}});return e})();var lc=function(){var a={},b=sa.validator.Field,c=sa.validator.Group,d={form:null,all:{},fields:{},rules:{},cls:{valid:"",error:"",checking:""},groups:{},callback:{scope:null,destroy:null,reset:null,beforesubmit:null,submit:null,statechange:null,check:null,displaystate:null,displaystatechange:null}},e=w({$class:"Validator",$mixins:["mixin.Observable"],id:null,el:null,cfg:null,enabled:!1,invalid:null,pending:0,
grps:0,outside:!0,submitted:!1,displayState:!1,isForm:!1,isField:!1,submitButton:null,hidden:null,preventFormSubmit:!1,fields:null,groups:null,$init:function(b,c,k){var l=b.nodeName.toLowerCase();this.id=R();a[this.id]=this;b.setAttribute("data-validator",this.id);this.el=b;c&&!y(c)&&(k=c,c=null);this.cfg=b=v({},d,e.defaults,e[c],k,!0,!0);this.isForm="form"==l;this.isField=/input|select|textarea/.test(l);this.fields={};this.groups={};this.$$observable.createEvent("submit",!1);this.$$observable.createEvent("beforesubmit",
!1);this.onRealSubmitClickDelegate=r(this.onRealSubmitClick,this);this.resetDelegate=r(this.reset,this);this.onSubmitClickDelegate=r(this.onSubmitClick,this);this.onFormSubmitDelegate=r(this.onFormSubmit,this);var m;this.initFields();l=this.fields;for(m in b.rules)l[m]&&l[m].setRules(b.rules[m],!1);b.rules=null;for(m in b.groups)this.addGroup(m,b.groups[m]);this.initForm("bind");delete b.rules;delete b.fields;delete b.groups;this.enabled=!0},getVldId:function(){return this.id},getElem:function(){return this.el},
getGroup:function(a){return this.groups[a]||null},getField:function(a){return this.fields[a]||null},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},enableDisplayState:function(){var a=this.fields,b=this.groups,c;if(!0!==this.displayState){this.displayState=!0;for(c in a)a[c].enableDisplayState();for(c in b)b[c].enableDisplayState();this.trigger("display-state-change",this,!0)}return this},disableDisplayState:function(){var a=
this.groups,b=this.fields,c;if(!1!==this.displayState){this.displayState=!1;for(c in b)b[c].disableDisplayState();for(c in a)a[c].disableDisplayState();this.trigger("display-state-change",this,!1)}return this},isDisplayStateEnabled:function(){return this.displayState},isValid:function(){return!1===this.enabled?!0:0===this.invalid&&0===this.pending&&0===this.grps&&!0===this.outside},getErrors:function(a){var b=!0==a?[]:{},c,d,e,p=[this.fields,this.groups],q;if(!this.isEnabled())return b;for(e=0;2>
e;e++)for(d in q=p[e],q)null===q[d].getExactValidState()&&q[d].check(),q[d].isValid()||(c=q[d].getError())&&(a?b.push(c):b[d]=c);return b},check:function(){var a=this.fields,b=this.groups;if(!this.isEnabled())return!0;var c=this.isValid(),d;for(d in a)a[d].check();for(d in b)b[d].check();this.outside=!1!==this.trigger("check",this);a=this.isValid();c!=a&&(this.doDisplayState(),this.trigger("state-change",this,!1));return a},add:function(a,c){if(!bb(a)||null!==x(a,"data-no-validate")||null!==x(a,"data-validator"))return this;
var d=x(a,"name")||x(a,"id"),e=this.cfg,m=this.fields;if(!d)return this;d=e.fields&&e.fields[d]?e.fields[d]:c||{};y(d)&&(d={rules:[d]});d=v({},e.all||{},d,!0,!0);if(d.ignore)return this;d.callback||(d.callback={context:this.$$callbackContext});e=new b(a,d,this);d=e.getName();if(m[d])return this;m[d]=e;this.setFieldEvents(e,"on");this.displayState&&e.enableDisplayState();this.isEnabled()&&null!==this.invalid&&e.check();return this},addGroup:function(a,b){var d=this.groups;d[a]||(b.name=a,d[a]=new c(b,
this),this.setGroupEvents(d[a],"on"),this.isEnabled()&&null!==this.invalid&&d[a].check())},focusInvalid:function(){var a=this.fields,b;for(b in a)if(!a[b].isValid()){a[b].getElem().focus();break}},reset:function(){var a=this.fields,b=this.groups,c;this.submitted=!1;this.disableDisplayState();for(c in b)b[c].reset();for(c in a)a[c].reset();this.pending=0;this.invalid=null;this.grps=0;this.outside=!1;this.doDisplayState();this.trigger("reset",this);return this},submit:function(){var a=this.el;if(this.isForm)if(A(a.submit))!1!==
this.trigger("before-submit",this)&&!1!==this.trigger("submit",this)&&a.submit();else this.onSubmit();else this.onSubmit()},setFieldEvents:function(a,b){a[b]("state-change",this.onFieldStateChange,this);a[b]("before-ajax",this.onBeforeAjax,this);a[b]("after-ajax",this.onAfterAjax,this);a[b]("submit",this.onFieldSubmit,this);a[b]("destroy",this.onFieldDestroy,this);a[b]("error-change",this.onFieldErrorChange,this)},setGroupEvents:function(a,b){a[b]("state-change",this.onGroupStateChange,this)},initFields:function(){var a=
this.el,b,c;if(this.isField)return this.add(a),this;a=N("input, textarea, select",a);b=-1;for(c=a.length;++b<c;this.add(a[b]));return this},initForm:function(a){var b=this.el,c=b.getElementsByTagName("input"),d=N(".submit",b),e=N(".reset",b);a="bind"==a?C:T;var p,q,n,r;p=0;for(q=c.length;p<q;p++)r=c[p],n=r.type,"submit"==n?a(r,"click",this.onRealSubmitClickDelegate):"reset"==n&&a(r,"click",this.resetDelegate);p=-1;for(q=d.length;++p<q;"submit"!=d[p].type&&a(d[p],"click",this.onSubmitClickDelegate));
p=-1;for(q=e.length;++p<q;"reset"!=e[p].type&&a(e[p],"click",this.resetDelegate));this.isForm&&a(b,"submit",this.onFormSubmitDelegate)},onRealSubmitClick:function(a){a=S(a||window.event);this.submitButton=a.target||a.srcElement;this.preventFormSubmit=!1;return this.onSubmit(a)},onSubmitClick:function(a){this.preventFormSubmit=!1;return this.onSubmit(S(a||window.event))},onFormSubmit:function(a){a=S(a);if(!this.isValid()||this.preventFormSubmit)return a.preventDefault(),!1},onFieldSubmit:function(a,
b){this.preventFormSubmit=!1;this.enableDisplayState();this.submitted=!0;return this.onSubmit(b)},onSubmit:function(a){this.enableDisplayState();this.isForm||(a&&a.preventDefault(),a&&a.stopPropagation());if(this.pending)return a&&a.preventDefault(),!1;var b=this.submitButton?!0:!1;this.isForm&&(this.hidden&&(this.el.removeChild(this.hidden),this.hidden=null),this.submitButton&&/input|button/.test(this.submitButton.nodeName)&&(this.hidden=window.document.createElement("input"),this.hidden.type="hidden",
this.hidden.setAttribute("name",this.submitButton.name),this.hidden.value=this.submitButton.value,this.el.appendChild(this.hidden)));this.submitButton=null;if(!this.isValid()&&(this.check(),this.onFieldStateChange(),this.pending))return a&&a.preventDefault(),!1;if(!1===this.trigger("before-submit",this)||!this.isValid())return a&&(a.preventDefault(),a.stopPropagation()),this.pending||(this.focusInvalid(),this.submitted=!1),this.trigger("failed-submit",this,b),!1;this.pending||(this.submitted=!1);
a=this.trigger("submit",this);this.preventFormSubmit=!a;return this.isForm?a:!1},onFieldDestroy:function(a){a=a.getElem();a=x(a,"name")||x(a,"id");delete this.fields[a]},onFieldErrorChange:function(a,b){this.trigger("field-error-change",this,a,b)},onFieldStateChange:function(a,b){var c=this.invalid,d=this.fields;this.invalid=0;for(var e in d)this.invalid+=d[e].isValid()?0:1;a&&this.trigger("field-state-change",this,a,b);if(null===c||null!==c&&this.invalid!==c)this.doDisplayState(),this.trigger("state-change",
this,this.isValid())},onGroupStateChange:function(){var a=this.groups,b=this.grps;this.grps=0;for(var c in a)this.grps+=a[c].isValid()?0:1;if(null===b||null!==b&&this.grps!==b)this.doDisplayState(),this.trigger("state-change",this,this.isValid())},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,a=a.cls.valid,d=this.el;if(this.isField||!this.displayState)b=null;null===this.invalid&&(b=null);c&&(!1===b?Q(d,c):F(d,c));a&&(!0===b?Q(d,a):F(d,a));this.trigger("display-state",this,
b)},onBeforeAjax:function(){this.pending++;this.cfg.cls.ajax&&Q(this.el,this.cfg.cls.ajax)},onAfterAjax:function(){var a=this.fields,b=this.cfg;this.pending=0;for(var c in a)this.pending+=a[c].isPending()?1:0;this.doDisplayState();b.cls.ajax&&F(this.el,b.cls.ajax);this.submitted&&0==this.pending&&(this.submitted=!1,this.isValid()?this.submit():this.focusInvalid())},destroy:function(){var b=this.groups,c=this.fields,d;this.reset();delete a[this.id];for(d in b)b.hasOwnProperty(d)&&b[d]&&(this.setGroupEvents(b[d],
"un"),b[d].destroy());for(d in c)c.hasOwnProperty(d)&&c[d]&&(this.setFieldEvents(c[d],"un"),c[d].destroy());this.initForm("unbind");this.cfg=this.el=this.groups=this.fields=null}},{defaults:{},addMethod:function(a,b,c){var d=B.get("validator.methods");d[a]||(d[a]=b,c&&(e.messages[a]=c))},getValidator:function(b){b=x(b,"data-validator");return a[b]||null}});return e}();w({$class:"validator.Component",node:null,scope:null,validator:null,scopeState:null,fields:null,formName:null,$init:function(a,b,c){this.node=
a;this.scope=b;this.scopeState={};this.fields=[];this.validator=this.createValidator();this.formName=x(a,"name")||x(a,"id")||"$form";this.initScope();this.initScopeState();this.initValidatorEvents();c.once("rendered",this.validator.check,this.validator);c.on("destroy",this.$destroy,this);b.$on("destroy",this.$destroy,this)},createValidator:function(){var a=this.node,b={},c;if(c=U(a).submit)b.callback=b.callback||{},b.callback.submit=function(a,b){return function(){try{return a(b)}catch(c){X(c)}}}(pb(c),
this.scope);return new lc(a,b)},initValidatorEvents:function(){var a=this.validator;a.on("field-state-change",this.onFieldStateChange,this);a.on("state-change",this.onFormStateChange,this);a.on("display-state-change",this.onDisplayStateChange,this);a.on("field-error-change",this.onFieldErrorChange,this);a.on("reset",this.onFormReset,this)},initScope:function(){this.scope[this.formName]=this.scopeState},initScopeState:function(){var a=this.node,b=this.scopeState,c=this.fields,d,e,f;a.elements?d=a.elements:
(d=[],Sa(a,function(a){bb(a)&&d.push(a)}));a=-1;for(f=d.length;++a<f;)e=d[a],(e=x(e,"name")||x(e,"id"))&&!b[e]&&(c.push(e),b[e]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null});b.$$validator=this.validator;b.$invalid=!1;b.$pristine=!0;b.$submit=r(this.validator.onSubmit,this.validator);b.$reset=r(this.validator.reset,this.validator)},onDisplayStateChange:function(a,b){if(b){b=this.scopeState;var c,d,e,f=this.fields;c=0;for(d=f.length;c<d;c++)e=b[f[c]],e.$real&&(b[f[c]]=e.$real);b.$invalid=
!a.isValid();b.$pristine=!1;this.scope.$check()}else this.onFormReset(a)},onFieldErrorChange:function(a,b,c){this.onFieldStateChange(a,b,b.isValid())},onFormReset:function(a){a=this.scopeState;var b,c,d,e=this.fields;b=0;for(c=e.length;b<c;b++)d=a[e[b]],d.$error=null,d.$errorMessage=null,d.$invalid=null,d.$pristine=!0;a.$invalid=!1;a.$pristine=!0;this.scope.$check()},onFormStateChange:function(a,b){var c=this.scopeState;c.$invalid=!1===b&&a.isDisplayStateEnabled();c.$pristine=!1;this.scope.$check()},
onFieldStateChange:function(a,b,c){var d=this.scopeState,e=b.getName();a=a.isDisplayStateEnabled();b={$error:b.getErrorRule(),$errorMessage:b.getError(),$invalid:!1===c,$pristine:null===b.getExactValidState()};a?d[e]=b:d[e].$real=b;this.scope.$check()},destroy:function(){this.destroyed||this.validator.destroy();this.scope&&delete this.scope[this.formName]}});z.registerAttribute("mjs-validate",250,function(a,b,c,d){c=c||"validator.Component";var e=ya(c);e?new e(b,a,d):X(Error("Class '"+c+"' not found"))});
w({$class:"plugin.ListAnimatedMove",$init:function(a){a.$implement({getNodePositions:function(a,c,d){for(var e=[],f,g,k,l={};a.firstChild;)a.removeChild(a.firstChild);f=0;for(g=c.length;f<g;f++)d&&d[f]&&(k=d[f].el.cloneNode(!0),a.appendChild(k)),k=c[f].el.cloneNode(!0),a.appendChild(k),e.push(k);f=0;for(g=e.length;f<g;f++)a=e[f],(d=c[f].renderer)&&(l[d.id]={left:a.offsetLeft,top:a.offsetTop});return l},calculateTranslates:function(a,c,d){var e=this.parentEl,f=e.parentNode,g=e.cloneNode(!0),k=e.offsetWidth,
l=[],m=0,p=0,q;q=g.style;q.position="absolute";q.left="-10000px";q.visibility="hidden";q.width=k+"px";f.insertBefore(g,e);q.width=k-(g.offsetWidth-k)+"px";c=this.getNodePositions(g,c);d=this.getNodePositions(g,a,d);e=this.getNodePositions(g,a);f.removeChild(g);f=0;for(g=a.length;f<g;f++)k=a[f].el,q=a[f].renderer,q=q.id,0==f&&(m=k.offsetLeft,p=k.offsetTop),l.push([{left:e[q].left-m-(d[q].left-m),top:e[q].top-p-(d[q].top-p)},c[q]?{left:c[q].left-m-(d[q].left-m),top:c[q].top-p-(d[q].top-p)}:null]);return l},
moveAnimation:function(a,c,d,e,f){var g=a.style;f.done(function(){if(d){var a=Ca();g[a.transform]="translateX("+d.left+"px) translateY("+d.top+"px)"}});return V(a,"move",e,!1,B,function(a,b,d){0==b&&"start"!=d&&c&&(a=Ca(),g[a.transform]="translateX("+c.left+"px) translateY("+c.top+"px)")})}})}});w({$class:"plugin.SrcDeferred",directive:null,scrollEl:null,scrollDelegate:null,resizeDelegate:null,position:null,sw:null,sh:null,checkVisibility:!0,$init:function(a){this.directive=a;a.$intercept("onChange",
this.onChange,this,"instead")},$beforeHostInit:function(a,b){this.scrollEl=qb(b);this.scrollDelegate=r(this.onScroll,this);this.resizeDelegate=r(this.onResize,this);C(this.scrollEl,"scroll",this.scrollDelegate);C(window,"resize",this.resizeDelegate)},isVisible:function(){if(!this.checkVisibility)return!0;var a=this.scrollEl,b=Aa(a),c=Ba(a),d=this.sw,e=this.sh,f;this.position||(this.position=db(this.directive.node,a));d||(d=this.sw=nb(a),e=this.sh=ob(a));a=this.position.top;f=this.position.left;return a>
b&&a<b+e&&f>c&&f<c+d},onScroll:function(){this.directive.queue.add(this.changeIfVisible,this)},onResize:function(){this.sw=this.position=null;this.directive.queue.add(this.changeIfVisible,this)},onChange:function(){this.directive.queue.add(this.changeIfVisible,this)},changeIfVisible:function(){if(this.isVisible())return this.stopWatching(),this.directive.doChange()},stopWatching:function(){this.scrollEl&&(T(this.scrollEl,"scroll",this.scrollDelegate),T(window,"resize",this.resizeDelegate),this.scrollEl=
null,this.checkVisibility=!1)},$beforeHostDestroy:function(){this.stopWatching()}});w({$class:"plugin.SrcSize",directive:null,width:null,height:null,origOnChange:null,$init:function(a){this.directive=a;this.origOnChange=a.$intercept("onSrcChanged",this.onSrcChanged,this,"after")},$afterHostInit:function(a,b){var c=U(b,a).preloadSize,d=b.style;"attr"!=c&&(c=aa(c)(a));var e="attr"==c?parseInt(x(b,"width"),10):c.width,c="attr"==c?parseInt(x(b,"height"),10):c.height;if(e||c)d.display="block";e&&(d.width=
e+"px");c&&(d.height=c+"px")},onSrcChanged:function(){var a=this.directive,b=a.node;a.onSrcChanged=this.origOnChange;Oa(b,"width");Oa(b,"height");Oa(b,"display");this.$destroy()}})})();
